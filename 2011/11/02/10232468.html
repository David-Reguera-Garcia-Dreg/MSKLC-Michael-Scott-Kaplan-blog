<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2011/11/02/10232468.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:34 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>The evolving Story of Locale Support, part 2 (raising the roof on keyboards)</title></head><body>
<h1>The evolving Story of Locale Support, part 2 (raising the roof on keyboards)</h1>
<p><em>by Michael S. Kaplan, published on 2011/11/02 07:01 -04:00, original URI: http://blogs.msdn.com/b/michkap/archive/2011/11/02/10232468.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<p>Previous blogs from this series:</p>
<ul>
<li><strong><a title="part 0 (The introduction)" href="http://archives.miloush.net/michkap/archive/2011/10/31/10231661.html">part 0 (The introduction)</a></strong></li>
<li><strong><a title="part 1 (Some people don't want to double-d's)" href="http://archives.miloush.net/michkap/archive/2011/11/01/10232070.html">part 1 (Some people don't want to double-d's)</a></strong></li>
</ul>
<p>Some of the most ground-breaking work in the area of locales has (ironically) been in other areas entirely.</p>
<p>I won't go so far as to call it innovative, but some of it involves clever thinking outside the box to get around long-standing&nbsp;architectural limitations in the platform.</p>
<p>The limitation I refer to is the fact that every keyboard we have ever shipped is associated with some locale -- with some LCID.</p>
<p>The LCID, or to be more precise, the LANGID portion of the LCID, is embedded in both the KLID value that defines the keyboard layout itself and the HKL that acts as a handle to an installed layout that's in use.</p>
<p>So the attempt to be creative kind of&nbsp;started with MSKLC 1.4, which added support for the creation of keyboards attached t custom locales (as described in <strong><a title="Getting the language of an LCID-less keyboard" href="http://archives.miloush.net/michkap/archive/2007/05/22/2800224.html">Getting the language of an LCID-less keyboard</a></strong>&nbsp;and <strong><a title="Getting the language (and more!) of an LCID-less keyboard" href="http://archives.miloush.net/michkap/archive/2007/08/23/4535058.html">Getting the language (and more!) of an LCID-less keyboard</a></strong>).</p>
<p>One of the important design decisions we made in order to support a keyboard based on a custom language:</p>
<ul>
<li>At keyboard layout authoring time, the author must have a custom culture or custom locale installed covering the language;</li>
<li>At keyboard layout install time on the target machine, no custom culture or custom locale needs to be installed.</li>
</ul>
<p>The first point makes it easier to provide UI that limits the ability to support the custom language to the existing architecture without making major changes:</p>
<p><a href="http://trigeminal.com/images/valleygirl02.png"><img style="max-width: 550px;" border="0" alt="" src="http://trigeminal.fmsinc.com/images/valleygirl02.png" /></a></p>
<p>This sets the bar a little high, but keeps from requiring some crazy mechanism to add custom names at a time when MSKLC 1.4 was given limited resources.</p>
<p>However, requiring the custom culture/locale to be on the target machine would have been unreasonable, and not needed.</p>
<p>I mean all we needed was a way to get the name in.</p>
<p>So the mechanism to add a name was added, with a special&nbsp;KLID value of <strong>A00#0c00</strong>.</p>
<p>Years later, Peter Constable and Andrew Glass were dealing with an entirely different problem.</p>
<p>They have long been&nbsp;suffering through the support of languages and scripts support in typography for which no keyboard supported existed.</p>
<p>Claiming to support "Language X" in a new font for a new version while providing no way to type Language X feels like a bad answer to the problem.</p>
<p>So after a meeting with Andrew, the plan was formed: take the custom language solution in MSKLC 1.4 that supports custom LCID-less&nbsp;languages and use it to solve the LCID-less languages and scripts we ship in Windows 8!</p>
<p>A quick check in the registry of a Windows 8 machine (you can see it yourself&nbsp;in the Developer Preview, with the only difference between what you would see and this screenshot being that mine is pseudo mirrored):</p>
<p><a href="http://msdnshared.blob.core.windows.net/media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/33/81/0537.Win8Keyboard.jpg"><img style="max-width: 550px;" border="0" alt="" src="http://msdnshared.blob.core.windows.net/media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/33/81/0537.Win8Keyboard.jpg" /></a></p>
<p>With the telltale 000#0c00 KLIDs, they are pretty easy to spot. And by this method, all of the following languages have keyboards have been added to Windows 8 despite having no specific locale being added for them:</p>
<ul>
<li>New Tai Lue</li>
<li>Tai Le</li>
<li>Tifinagh</li>
<li>Myanmar</li>
<li>Ogham</li>
<li>Phags-Pa</li>
<li>Lisu</li>
<li>N'Ko</li>
</ul>
<p>All of them are supported in fonts (in several cases even in existing versions), and now (as of Windows 8) you can type them with <strong>built-in</strong> keyboards!</p>
<p>Of course there are some interesting tangentially related problems that came up along the way, but those can be subjects for other blogs, on other days.</p>
<p>For now, the fact that&nbsp;a new shipping keyboard&nbsp;in Windows doesn't always mean a new locale is cool enough that I think it can stand on its own merits.... :-)</p>
<hr/><p><strong>Van</strong> on 2 Nov 2011 10:04 AM:</p><div style="margin-left: 1em"><p>Forgive the possibly rookie question, but does the KLID numbering imply a limit of 16 (# = 0-9, A-F) custom-language keyboards on a given computer, or can these be non-unique?</p>
</div>
<p><strong>Michael S. Kaplan</strong> on 2 Nov 2011 10:09 AM:</p><div style="margin-left: 1em"><p>Yes, the KLID is 8 hexadecimal digits.</p>
</div>
<p><strong>Azarien</strong> on 8 Nov 2011 12:57 AM:</p><div style="margin-left: 1em"><p>I see some disturbance in the &quot;[(value not set)]&quot; and &quot;[(Default)]&quot; strings. The additional characters are switched when compared to all other strings.</p>
</div>
<hr/><p><em>referenced by</em></p><div style="margin-left: 1em"><p>2012/12/20 <a href="http://archives.miloush.net/michkap/archive/2012/12/20/10379645.html">The Cherokee LIP on Windows 8, part 2: Let's talk about the keyboards!</a></p><p>2012/10/26 <a href="http://archives.miloush.net/michkap/archive/2012/10/26/10362603.html">The evolving Story of Locale Support, part 28: We finally fixed that 'Install New Languages' thing!</a></p><p>2012/10/02 <a href="http://archives.miloush.net/michkap/archive/2012/10/02/10354988.html">The evolving Story of Locale Support, part 27: No, the T and the H aren't silent...</a></p><p>2012/08/20 <a href="http://archives.miloush.net/michkap/archive/2012/08/20/10341516.html">The evolving Story of Locale Support, part 26: Hey Windows 8, there's someone on the phone for you.</a></p><p>2012/07/11 <a href="http://archives.miloush.net/michkap/archive/2012/07/11/10327775.html">The evolving Story of Locale Support, part 25: Something old, something new, something repurposed, and something...</a></p><p>2012/06/07 <a href="http://archives.miloush.net/michkap/archive/2012/06/07/10316511.html">The evolving Story of Locale Support, part 24: I Adar you! Hell, I Double Adar you! (Windows 8 ed.)</a></p><p>2012/06/05 <a href="http://archives.miloush.net/michkap/archive/2012/06/05/10315033.html">The evolving Story of Locale Support, part 23: Tamazight? Outta sight!</a></p><p>2012/05/17 <a href="http://archives.miloush.net/michkap/archive/2012/05/17/10306133.html">That 'keyboard culture list' you may have heard so much about</a></p><p>2012/04/12 <a href="http://archives.miloush.net/michkap/archive/2012/04/12/10292952.html">The evolving Story of Locale Support, part 22: Digit Substitution 2.0</a></p><p>2012/03/08 <a href="http://archives.miloush.net/michkap/archive/2012/03/08/10278921.html">The evolving Story of Locale Support, part 21: The Windows 8 Hijripalooza extraordinaire!</a></p><p>2012/03/02 <a href="http://archives.miloush.net/michkap/archive/2012/03/02/10276258.html">The evolving Story of Locale Support, part 20: Yes, it's Bangla. Not Bengali!</a></p><p>2012/02/21 <a href="http://archives.miloush.net/michkap/archive/2012/02/21/10270502.html">The evolving Story of Locale Support, part 19: In honor of International Mother Language Day...</a></p><p>2012/02/15 <a href="http://archives.miloush.net/michkap/archive/2012/02/15/10268235.html">The evolving Story of Locale Support, part 18: Two scripts that share ten digits can be trouble</a></p><p>2012/02/02 <a href="http://archives.miloush.net/michkap/archive/2012/02/02/10263136.html">The evolving Story of Locale Support, part 17: Today I feel like translating you more than before</a></p><p>2012/01/24 <a href="http://archives.miloush.net/michkap/archive/2012/01/24/10259941.html">The evolving Story of Locale Support, part 16: We can't scale to a Xishuangbanna Dai locale, butâ€¦</a></p><p>2012/01/17 <a href="http://archives.miloush.net/michkap/archive/2012/01/17/10256884.html">The evolving Story of Locale Support, part 15: Fixing our listings up in Windows 8!</a></p><p>2011/12/22 <a href="http://archives.miloush.net/michkap/archive/2011/12/22/10250349.html">The evolving Story of Locale Support, part 14: Tifinagh, Tamazight, and Berber? Oh my!</a></p><p>2011/12/21 <a href="http://archives.miloush.net/michkap/archive/2011/12/21/10249983.html">The evolving Story of Locale Support, part 13: Divvying up locales, yet again!</a></p><p>2011/12/09 <a href="http://archives.miloush.net/michkap/archive/2011/12/09/10246051.html">The evolving Story of Locale Support, part 12: Logic dictates that we keep a sense of proportion about the RATIO</a></p><p>2011/11/23 <a href="http://archives.miloush.net/michkap/archive/2011/11/23/10240896.html">The evolving Story of Locale Support, part 11: What language is that keyboard for?</a></p><p>2011/11/22 <a href="http://archives.miloush.net/michkap/archive/2011/11/22/10239572.html">The evolving Story of Locale Support, part 10: Perhaps it is best to think of it as unintelligent design?</a></p><p>2011/11/16 <a href="http://archives.miloush.net/michkap/archive/2011/11/16/10237715.html">The evolving Story of Locale Support, part 9: Nastaleeq vs. Nastaliq? Either way, Windows 8 has got it!</a></p><p>2011/11/15 <a href="http://archives.miloush.net/michkap/archive/2011/11/15/10237317.html">The evolving Story of Locale Support, part 8: [Finally] taking care of some [more] languages in Pakistan</a></p><p>2011/11/11 <a href="http://archives.miloush.net/michkap/archive/2011/11/11/10236194.html">The evolving Story of Locale Support, part 7: That would be a "call and a raise" for Hawaiian</a></p><p>2011/11/09 <a href="http://archives.miloush.net/michkap/archive/2011/11/09/10235391.html">The evolving Story of Locale Support, part 6: Behind the Cherokee Phonetic layout in Windows 8</a></p><p>2011/11/08 <a href="http://archives.miloush.net/michkap/archive/2011/11/08/10234995.html">The evolving Story of Locale Support, part 5 (...until the decision was made to not refuse to add it)</a></p><p>2011/11/04 <a href="http://archives.miloush.net/michkap/archive/2011/11/04/10233999.html">The evolving Story of Locale Support, part 4 (working beyond one's bugs, and the case for an MSKLC update)</a></p><p>2011/11/03 <a href="http://archives.miloush.net/michkap/archive/2011/11/03/10233591.html">The evolving Story of Locale Support, part 3 (working beyond one's bugs, the setup)</a></p></div><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2011/11/03/10233591.html" title="The evolving Story of Locale Support, part 3 (working beyond one&#39;s bugs, the setup)">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2011/11/01/10232070.html" title="The evolving Story of Locale Support, part 1 (Some people don&#39;t want to double-d&#39;s)">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2011-11">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2011-11-02">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2011/11/02/10232468.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:34 GMT -->
</html>