<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2011/04/02/10149149.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:34 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>There's no "I" in IDN, part 2: Try not to use the wrong functions!</title></head><body>
<h1>There's no "I" in IDN, part 2: Try not to use the wrong functions!</h1>
<p><em>by Michael S. Kaplan, published on 2011/04/02 07:03 -04:00, original URI: http://blogs.msdn.com/b/michkap/archive/2011/04/02/10149149.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<p>&nbsp;It started a while back in <a href="http://archives.miloush.net/michkap/archive/2011/02/14/10128621.html" title="There's no &quot;I&quot; in IDN, part 1: If you're not Unicode, you're just wrong!"><strong>There's no "I" in IDN, part 1: If you're not Unicode, you're just wrong!</strong></a>.</p>
<p>And in that blog I mentioned some functions that can't handle Unicode domain names, and thus should never be used in situations where Unicode domain names might be needed or expected.</p>
<p>But there can be another class of usage to look out for -- functions that might be just fine on their own in situations they need but which you have to be careful about using once you move into the world of IDN and EAI and such.</p>
<p>Like the question that came up the other day:</p>
<p style="padding-left: 30px;"><span>Does anyo<span>ne</span> know a way to convert full-width characters to half width (or vice <span>versa</span>)? We have a need where when we generate hash of a string that needs to be equal with width insensitivity. </span></p>
<p style="padding-left: 30px;">Here is the example of equivalent strings when width is ignored.</p>
<p style="padding-left: 30px;"><span>test53496<span>aaa</span>@ae2.<span>dion</span>.<span>ne</span>.<span>jp</span></span><br />test53496ａａａ@ａe2.dion.ne.jp</p>
<p>Of course the simple answer would be to use <a href="http://msdn.microsoft.com/library/dd318700.aspx"><span><span>LCMapStringW</span></span></a>/<a href="http://msdn.microsoft.com/library/dd318702.aspx"><span><span>LCMapStringEx</span></span></a> to convert between full and half width.</p>
<p>But if these entries are domain names (they look like email addresses, which contain domain names), then following those rules and using the IDN functions --&nbsp;in this case <a href="http://msdn.microsoft.com/library/dd318150.aspx"><span><span>IdnToNameprepUnicode</span></span></a>&nbsp;--&nbsp;to do the various conversions (at least for the "domain" piece after the "@" sign)&nbsp;can make a lot more sense.</p>
<p>The issue to the text before the "@" sign is slightly more complicated, so we'll leave that for another time...</p>
<p>But for now, the rule is simple: don't do IDN things with non-IDN functions!</p>
<hr/><div style="margin-left: 1em"><em>no comments</em></div><hr/><p><em>referenced by</em></p><div style="margin-left: 1em"><p>2013/10/17 <a href="http://archives.miloush.net/michkap/archive/2013/10/17/10453790.html">There's no "I" in IDN, part 19: There's no "I" in IPv6, either!</a></p><p>2013/10/08 <a href="http://archives.miloush.net/michkap/archive/2013/10/08/10454553.html">There's no "I" in IDN, part 18: There isn't even an "I" in John C. Klensin's name!</a></p><p>2013/09/13 <a href="http://archives.miloush.net/michkap/archive/2013/09/13/10448110.html">There's no "I" in IDN, part 17: EAI made it to China, and everybody knows it!</a></p><p>2013/04/19 <a href="http://archives.miloush.net/michkap/archive/2013/04/19/10412471.html">There's no "I" in IDN, part 16: It's a good thing they decided to call it EAI!</a></p><p>2012/10/12 <a href="http://archives.miloush.net/michkap/archive/2012/10/12/10359120.html">There's no "I" in IDN, part 15: Still no 'I' in EAI.... but we could use an US sometime soon!</a></p><p>2012/08/08 <a href="http://archives.miloush.net/michkap/archive/2012/08/08/10337799.html">There's no "I" in IDN, part 14: It turns out there's no "I" in IE, either</a></p><p>2012/05/18 <a href="http://archives.miloush.net/michkap/archive/2012/05/18/10305223.html">There's no "I" in IDN, part 13: Desktop and Managed and Metro; oh my!</a></p><p>2012/02/27 <a href="http://archives.miloush.net/michkap/archive/2012/02/27/10273315.html">There's no "I" in IDN, part 12: Emoji + IDN == U+1F4A9 (PILE OF POO)</a></p><p>2011/10/25 <a href="http://archives.miloush.net/michkap/archive/2011/10/25/10229790.html">There's no "I" in IDN, part 11: There's no place like ::1, not even 127.0.0.1!</a></p><p>2011/09/21 <a href="http://archives.miloush.net/michkap/archive/2011/09/21/10214081.html">There's no "I" in IDN, part 10: Who needs IDN support? How much? When? (Part 2)</a></p><p>2011/09/16 <a href="http://archives.miloush.net/michkap/archive/2011/09/16/10212216.html">There's no "I" in IDN, part 9: Who needs IDN support? How much? When? (Part 1)</a></p><p>2011/08/12 <a href="http://archives.miloush.net/michkap/archive/2011/08/12/10195062.html">There's no "I" in IDN part 8: Punycode don't do the PUA</a></p><p>2011/07/28 <a href="http://archives.miloush.net/michkap/archive/2011/07/28/10190701.html">There's no "I" in IDN, part 7: IDN comes to AdWords</a></p><p>2011/07/14 <a href="http://archives.miloush.net/michkap/archive/2011/07/14/10186414.html">There's no "I" in IDN, part 6: It isn't like there's an "I" in EAI, either!</a></p><p>2011/06/29 <a href="http://archives.miloush.net/michkap/archive/2011/06/29/10181212.html">There's no "I" in IDN, part 5: Stephen Colbert's job is not in any jeopardy</a></p><p>2011/06/17 <a href="http://archives.miloush.net/michkap/archive/2011/06/17/10173790.html">There's no "I" in IDN, part 4: the 'path' to Hell is paved with IDN bugs</a></p><p>2011/05/25 <a href="http://archives.miloush.net/michkap/archive/2011/05/25/10168228.html">There's no "I" in IDN, part 3: There's no "I" in DIY, either!</a></p></div><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2011/04/03/10149190.html" title="It&#39;s like a lower class of Lowercase...">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2011/04/01/10148569.html" title="One developer&#39;s supported scenario is another&#39;s awful bolt-on job...">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2011-04">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2011-04-02">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2011/04/02/10149149.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:34 GMT -->
</html>