<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2011/01/05/10111348.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:34 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>Short-sighted text processing #5: PU[A]! That pad THAI is pretty spicy....</title></head><body>
<h1>Short-sighted text processing #5: PU[A]! That pad THAI is pretty spicy....</h1>
<p><em>by Michael S. Kaplan, published on 2011/01/05 07:01 -05:00, original URI: http://blogs.msdn.com/b/michkap/archive/2011/01/05/10111348.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<p>Previous blogs in this series:</p>
<ul>
<li><a href="http://archives.miloush.net/michkap/archive/2010/12/18/10106789.html"><strong>#1: Uniscribe filters nothing</strong></a></li>
<li><a href="http://archives.miloush.net/michkap/archive/2010/12/20/10107008.html"><strong>#2: Getting hurt while playing on the bleeding edge</strong></a></li>
<li><a href="http://archives.miloush.net/michkap/archive/2010/12/30/10110184.html" title="#3: The Protocols of the EDIT for i18n"><strong>#3: The Protocols of the EDIT for i18n</strong></a></li>
<li><a href="http://archives.miloush.net/michkap/archive/2011/01/04/10110938.html" title="#4: Squeezing every bit of text you possibly can out of MacOffice 2011"><strong>#4: Squeezing every bit of text you possibly can out of MacOffice 2011</strong></a> </li>
</ul>
<p>&nbsp;This part of the series is going to talk about a slightly different issue that the stuff I mentioned in Parts 1 and 2.</p>
<p>It is about the way that Thai was supported until its support in Unicode became more widespread, and the way that Lao is still supported in a lot of places while Lao Unicode support is finally gaining more ground.</p>
<p>Some of this will apply to other scripts as well, but Thai and Lao are the two languages/scripts where there seems to be a lot of it.</p>
<p>Now some of the interesting official support for Thai if you go back to Windows &lt;= Server 2003 took advantage of two specific&nbsp;OpenType tables: GSUB (<a href="http://partners.adobe.com/public/developer/opentype/index_table_formats1.html">The Glyph Substitition Table</a>) and GPOS (<a href="http://partners.adobe.com/public/developer/opentype/index_table_formats2.html">The Glyph Positioning Table</a>). And they did it in an interesting way, one that pissed off some people.</p>
<p>They used some slots in the PUA (private use area) of Unicode.</p>
<p><img src="http://blogs.msdn.com/cfs-file.ashx/__key/CommunityServer-Blogs-Components-WeblogFiles/00-00-00-33-81/3162.thai0.jpg" border="1" /></p>
<p>&nbsp;Now these characters are quite similar to some actual characters in the <a href="http://www.unicode.org/charts/PDF/U0E00.pdf">Thai Unicode block</a>, but small differences help a lot when you are trying to support a complex script!</p>
<p><em>Others had previously mentioned this like Peter Constable when he worked for SIL, in docs like <a href="http://scripts.sil.org/cms/scripts/page.php?item_id=VendorUseOfPUA">Use of the Unicode Private Use Areas by Software Vendors</a> and <a href="http://scripts.sil.org/cms/scripts/page.php?item_id=PUACharsInMSSotware">Handling of PUA Characters in Microsoft Software</a>.</em></p>
<p>Now as it turns out, there are some interesting consequences of this.</p>
<p>You see, some time after Server 2003 shipped (I'd have to ask someone like Simon or Judy to know exactly when), this kind of use of the PUA was determined to really bad. It just got many people very upset and unhappy.</p>
<p>From a language/script support standpoint, OpenType can substitute and position glyphs even if they are not in the font's CMAP and don't have code points, so there was no special reason that they had to be in the PUA.</p>
<p>Though that may have made it slightly easier for some people doing their own private versions of Thai support. Especially people using our fonts on non-Microsoft platforms, which may be why it was not such a priority. Idle speculation on my part, though other areas that used thye PUA like some of the CJK cases were left in when this one was not; perhaps&nbsp;this blog could have been part of <a href="http://archives.miloush.net/michkap/archive/2010/12/10/10102521.html"><strong>the anti-Microsoft</strong></a> <a href="http://archives.miloush.net/michkap/archive/2010/12/07/10101187.html"><strong>conspiracy</strong></a> <a href="http://archives.miloush.net/michkap/archive/2010/12/06/10100616.html"><strong>theory</strong></a> series? :-)</p>
<p>Anyway, I digress....</p>
<p>There was a huge push to remove as much PUA as possible, so these little guys went.</p>
<p>So you could look at fonts from XP and look at the same font in Windows 7 and see that they were removed:</p>
<p><img src="http://blogs.msdn.com/cfs-file.ashx/__key/CommunityServer-Blogs-Components-WeblogFiles/00-00-00-33-81/1018.thai4.jpg" />&nbsp;&nbsp;&nbsp; <img src="http://blogs.msdn.com/cfs-file.ashx/__key/CommunityServer-Blogs-Components-WeblogFiles/00-00-00-33-81/7875.thai5.jpg" /></p>
<p>On the whole, most people consider this to be a good thing.</p>
<p>Though some legacy issues have popped up!</p>
<p>Do you remember my <a href="http://archives.miloush.net/michkap/archive/2007/09/24/5082103.html" title="Documented, schmockumented! It's still kind of cool...."><strong>Documented, schmockumented! It's still kind of cool....</strong></a>blog from a few years back that talked about how you could get Unicode characters from glyphids? In it I mentioned:</p>
<p style="padding-left: 30px;"><em>any time the glyph ID values would actually have been obtained via other means (like the </em><a href="http://www.microsoft.com/typography/OTSPEC/gsub.htm"><strong><span style="color: #006bad;"><em>GSUB</em></span></strong></a><em> glyph substitution table or via </em><a href="http://www.microsoft.com/typography/otspec/features_uz.htm"><strong><span style="color: #006bad;"><em>more advanced features</em></span></strong></a><em> like VERT for vertical writing), no characters will be found.</em></p>
<p>This turns out to not always be the case when the technique for getting characters is a bit more sophisticated (like&nbsp;perhaps Office's UCSCRIBE wrapper around&nbsp;Uniscribe) and/or when the thing being substituted is not (like&nbsp;perhaps these Thai PUA mappings).</p>
<p>Thus leading to a recent bug report:</p>
<p style="padding-left: 60px;"><em><span style="font-family: times new roman,times;">I have a Thai customer who has recently migrated from Server 2003 to Server 2008 using Office 2003 and has come across what appears to be some form of Unicode related OS backwards compatibility issue I am looking for some input on.</span></em></p>
<p style="padding-left: 60px;"><em><span style="font-family: times new roman,times;">If they open an _MS Word_ document in Server 2008 with Thai characters that was created and saved in Server 2003, they see that certain Thai characters (those with accents above/below letters) are substituted with square characters.</span></em></p>
<p style="padding-left: 60px;"><em><span style="font-family: times new roman,times;">If they save the document as Rich Text Format and open this in Server 2008, these special characters are substituted by Japanese characters instead.</span></em></p>
<p style="padding-left: 60px;"><em><span style="font-family: times new roman,times;">Creating a new document in Server 2008 is absolutely fine &ndash; the issue only occurs when opening documents created in Server 2003 and then opened in Server 2008.</span></em></p>
<p>After investigating, it was determined that the bytes that looked like square characters (notdef glyphs) and Japanese characters were actually those PUA code points,the ones that in the older versions of the Thai fonts were these alternate forns, anad now they aren't anything (except they happen to be in that area which is often used for CJK).</p>
<p>In the end, the visious fast move to try to get of the PUA is only partially to blame; really whoever was doing actual physical substitutions bears the bulk of the responsibility....</p>
<hr/><div style="margin-left: 1em"><em>no comments</em></div><hr/><p><em>referenced by</em></p><div style="margin-left: 1em"><p>2011/06/24 <a href="http://archives.miloush.net/michkap/archive/2011/06/24/10178528.html">An irresistible force walks into an immovable object (aka the Thai that binds us)</a></p><p>2011/01/06 <a href="http://archives.miloush.net/michkap/archive/2011/01/06/10111881.html">Short-sighted text processing #6: OpenType and Apple and OpenType</a></p></div><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2011/01/06/10111881.html" title="Short-sighted text processing #6: OpenType and Apple and OpenType">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2011/01/04/10110938.html" title="Short-sighted text processing #4: Squeezing every bit of text you possibly can out of MacOffice 2011">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2011-01">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2011-01-05">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2011/01/05/10111348.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:34 GMT -->
</html>