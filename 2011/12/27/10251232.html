<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2011/12/27/10251232.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:34 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>You don't waste my time if you 'reinvent the wheel' but you often waste yours!</title></head><body>
<h1>You don't waste my time if you 'reinvent the wheel' but you often waste yours!</h1>
<p><em>by Michael S. Kaplan, published on 2011/12/27 08:06 -05:00, original URI: http://blogs.msdn.com/b/michkap/archive/2011/12/27/10251232.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<p>The other day, a colleague asked me a question that disturbed me:</p>
<p style="padding-left: 60px;"><em>Hi Michael,</em></p>
<p style="padding-left: 60px;"><em>I want&nbsp;our product&nbsp;to get out of the business of maintaining timezones and leave this up to the OS. However, I realized that the system only provides one language at a time, so if the administrator language is English and the end user&rsquo;s language is French the time zone names would show up as English. Err. Do you know how other teams have solved this problem (without maintaining their own list of timezones)?</em></p>
<p style="padding-left: 60px;"><em>Thanks</em></p>
<p>Okay, there are a couple of problems here.</p>
<p>The huge push to bring time zone to the world of the Windows Multilingual User Interface, something I mentioned in pasing in <strong><a title="Keyboards and time zones have something in common" href="http://archives.miloush.net/michkap/archive/2006/05/06/591631.html">Keyboards and time zones have something in common</a></strong>, is a huge and expansive architecture that gives you the ability to do quite a bit.</p>
<p>Now by default, a service running as LOCALSYSTEM is limited to one language.</p>
<p>But&nbsp;simple use of the <a href="http://msdn.microsoft.com/library/windows/desktop/dd317834.aspx">EnumUILanuages</a> function will give you a list of every single language for which resources are available. From there, you just have to set the process and/or thread UI language and then you can load up whatever you like -- thus a sever component communicating with clients can&nbsp;use <a href="http://msdn.microsoft.com/library/dd374050.aspx">SetProcessPreferredUILanguages</a>&nbsp;or <a href="http://msdn.microsoft.com/library/dd374052.aspx">SetThreadPreferredUILanguages</a>&nbsp;(as I discussed in <strong><a title="New for Windows 7: The PROCESS to keep MUI from being THREADbare...." href="http://archives.miloush.net/michkap/archive/2010/04/29/10003565.html">New for Windows 7: The PROCESS to keep MUI from being THREADbare...</a></strong>).</p>
<p>And you can thereby get the appropriate strings for any language available -- mostly&nbsp;via the documented Win32 APIs for MUI and time zones that&nbsp;will give you almost everything you need (time zone enumeration itself still requires the registry which is nevertheless fully documented, but everything else has API coverage).</p>
<p>For earlier versions like Server 2003 I'm comfortable telling them to upgrade if they want the feature,&nbsp;<strong>and you should too!</strong>&nbsp;(a lot of engineering went into this, after all!)</p>
<p>Perhaps it feels burdensome to require UI languages be installed to get this feature, but this hardly seems like an undue burden to get the feature....</p>
<p>When I think about the original question, the part that worries me the most is that the act of "getting out of the business" implies that right now they are in the business, with one of the single most expensive items to maintain -- time zone data. The sheer weight of standards tracking and potential geopolitical issues with&nbsp;names and zone definitions? Maintaining them is staggering -- why would anyone want to duplicate that effort?</p>
<p>And how many features have had to be postponeed version after version that those resources could have been applied to?</p>
<p>I'm being facetious there, actually -- that effort currently <strong>is</strong> duplicated a bunch, and those resources are in&nbsp;fact wasted, many times over.</p>
<p>Though my hope is that soon after I send this link, there may be one less case of duplication on the horizon.... :-)</p>
<hr/><p><strong>John Cowan</strong> on 27 Dec 2011 11:21 AM:</p><div style="margin-left: 1em"><p>Good to hear. &nbsp;With time zones as many other things, the point is not to see who can pick the most potatoes, it&#39;s to get the *@#$ potatoes picked before the (@#$ frost hits.</p>
</div>
<hr/><p><em>referenced by</em></p><div style="margin-left: 1em"><p>2011/12/29 <a href="http://archives.miloush.net/michkap/archive/2011/12/29/10251662.html">What do Samoa and Seattle have in common? The sun won't shine on either on Dec 30th!</a></p></div><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2011/12/28/10251541.html" title="I won&#39;t Dari or double Dari you to knock our Persian calendar support...">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2011/12/26/10251012.html" title="Thanks for making it work; what happens now?">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2011-12">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2011-12-27">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2011/12/27/10251232.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:34 GMT -->
</html>