<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2011/12/28/10251541.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:34 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>I won't Dari or double Dari you to knock our Persian calendar support...</title></head><body>
<h1>I won't Dari or double Dari you to knock our Persian calendar support...</h1>
<p><em>by Michael S. Kaplan, published on 2011/12/28 08:51 -05:00, original URI: http://blogs.msdn.com/b/michkap/archive/2011/12/28/10251541.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<p>It was not too long ago (by some scales of time and duration, at least!)&nbsp;that the following question found its way into my inbox:</p>
<p style="padding-left: 60px;"><span style="font-family: times new roman,times; font-size: medium;"><em>Why all famous calendars in the world are included in Microsoft Windows in the Date section, except Hejri Shamsi (Iranian Calendar)?! Does it have any political reason? Or it is only because you are not aware of the importance, accuracy and history of this calendar? Hejri Calendar has two branches, one is Hejri Ghamari (Lunar Hejri) and the other is Hejri Shamsi (Solar Hejri) and just the first one is included in Windows while the second one is more accurate.</em></span></p>
<p>This is a very complicated question.</p>
<p>And when i say complicated, I don't just mean complicated.</p>
<p>I mean <span style="font-size: x-large;"><strong>complicated!</strong></span></p>
<p>If you know what I mean.</p>
<p>Hell, even if you don't know what I mean!</p>
<p>Okay, we'll start from here. From now.</p>
<p>.Net supports the <a href="http://msdn.microsoft.com/library/ms229279.aspx">PersianCalendar class</a>, which the documentation describes thusly:</p>
<p style="padding-left: 60px;"><span style="font-family: times new roman,times; font-size: medium;">The Persian calendar is used in most countries where Persian is spoken, although some regions use different month names. The Persian calendar is the official calendar of Iran and Afghanistan, and it is one of the alternative calendars in regions such as Kazakhstan and Tajikistan.</span><br />&nbsp;<br /><span style="font-family: times new roman,times; font-size: medium;">Dates in the Persian calendar start from the year of the Hijra, which corresponds to 622 C.E. and is the year when Muhammad migrated from Mecca to Medina. For example, the date March 21, 2002 C.E. corresponds to the first day of the month of Farvardeen in the year 1381 Anno Persico.</span><br />&nbsp;<br /><span style="font-family: times new roman,times; font-size: medium;">The Persian calendar is based on a solar year and is approximately 365 days long. A year cycles through four seasons, and a new year begins when the sun appears to cross the equator from the southern hemisphere to the northern hemisphere as viewed from the center of the Earth. The new year marks the first day of the month of Farvardeen, which is the first day of spring in the northern hemisphere.</span><br />&nbsp;<br /><span style="font-family: times new roman,times; font-size: medium;">Each of the first six months in the Persian calendar has 31 days, each of the next five months has 30 days, and the last month has 29 days in a common year and 30 days in a leap year. A leap year is a year that, when divided by 33, has a remainder of 1, 5, 9, 13, 17, 22, 26, or 30. For example, the year 1370 is a leap year because dividing it by 33 yields a remainder of 17. There are approximately eight leap years in every 33-year cycle.</span></p>
<p>Mind you, this already complicated description glosses over things a scosh, as befits anyone trying to compress a calendar system as old as this calendar - at times lunar, at times lunisolar, at times solar, at times starting in the "true Spring", at times starting at the birth of Cyrus the Great, and at times of the emigration of Muhammed, at times using Farsi/Persian, at times using Dari (which is mostly Farsi for month name purposes though I am really oversimplifyin here), at times with Pashto names, and...</p>
<p>I give up. See the <a href="http://en.wikipedia.org/wiki/Jalali_calendar">Iranian calendars</a> article for more detail on the variations over the millennia. Note that the lunar calendar has been out of favor since 1925, which has&nbsp;two interesting&nbsp;consequences for usa:</p>
<ul>
<li>Using the lunar calendar for dates after 1925 would involve extrapolating from theoretical dates that depend observations to determine months -- not unlike the Hijri calendar, but without the data in modern times to get the right dates;</li>
<li>using the solar calendar for dates before 1925 could involve converting from&nbsp;dates usually recorded using the Lunar calendar, unless one is looking at data that does the conversion already.</li>
</ul>
<p>Both problems <strong>could</strong> have been addressed -- but it would be complicated to do so&nbsp;-- perhaps moreso than anyone would want to tackle here, and it may have just been considered out of scope.</p>
<p><em>Ranom factoid: during the .NE 2.0&nbsp;beta, the PersianCalendar class was named the JalaliCalendar class, but this was fixed prior to RTM. The Jalali term is more accurately used to refer to the Persian <strong>lunar</strong> calendar, so this "breaking" change between Beta and RTM was&nbsp;a <strong>good</strong> one, in the sense that it was a <strong>correct</strong> one. </em></p>
<p><em>I kind of wish the analogious bug in the ThaiBuddhistCalendar class (described in <strong><a title="The 'Thai Buddhist' calendar isn't" href="http://archives.miloush.net/michkap/archive/2011/08/02/10191919.html">The 'Thai Buddhist' calendar isn't</a></strong>) had been found during the .NET 1.0 beta and saved us all a much more serious conversation about a really complicated "correctness vs. backcompat" bug that may have to be tackled some day! </em></p>
<p><em>To date, we don't even have a KB articke or doc bug on this</em><em>, AFAIK.</em></p>
<p>This is most interesting for Microsoft in general&nbsp;and Windows/.Net in&nbsp;particular since:</p>
<ul>
<li>we do not implement the lunar calendar at all, and</li>
<li>we do not implement the solar calendar on Windows (which also leads to problems like those discussed in <strong><a title="Behold the [non-fa-IR default] PersianCalendar class" href="http://archives.miloush.net/michkap/archive/2007/06/26/3559309.html">Behold the [non-fa-IR default] PersianCalendar class</a></strong>), and</li>
<li>the problems with the [non-Arabic, not-Divehi] Hijri calendar&nbsp;I mentioned in <strong><a title="The example was wrong, but the point of the example was spot on!" href="http://archives.miloush.net/michkap/archive/2011/04/06/10150467.html">The example was wrong, but the point of the example was spot on!</a></strong> would also apply to many non-Persian users of the PersianCalendar, and</li>
<li>there are some mildly inconsistent&nbsp;reports of problems with the PersianCalendar in .Net, currently unverified but which may in some cases have to do with a few of the many differences that Wikipedia article I mentioned discusses.</li>
</ul>
<p>Note that the third problem can't be solved ntil/uless the secdond problem is -- we can't pick the "right" language if we don't know what culture to use.</p>
<p>So in the end, we are really underwhelming in our support for this small sheaf of calendars asociated with Persian --&nbsp;wih both the solvable issues and the [at this point]&nbsp;largely unsolvable ones....</p>
<hr/><p><strong>Random832</strong> on 28 Dec 2011 11:55 AM:</p><div style="margin-left: 1em"><p>Would a hybrid calendar that uses the lunar calendar before 1925 and the solar calendar after be possible, or would the transition run into issues similar to the ones that make one for the western civil calendar (Julian/Gregorian) impossible?</p>
</div>
<p><strong>Michael S. Kaplan</strong> on 28 Dec 2011 4:32 PM:</p><div style="margin-left: 1em"><p>Well, the issues are similar, but even more profound in terms of amount of change. So, possible in theory but different than anything we&#39;ve ever done before....</p>
<p>Plus, the solar calendar was first proposed in 1911 -- which means the period from 1911 to 1925 would be a bigger&nbsp;nightmare to contemplate how to resolve conversions for.</p></div>
<hr/><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2011/12/29/10251662.html" title="What do Samoa and Seattle have in common? The sun won&#39;t shine on either on Dec 30th!">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2011/12/27/10251232.html" title="You don&#39;t waste my time if you &#39;reinvent the wheel&#39; but you often waste yours!">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2011-12">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2011-12-28">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2011/12/28/10251541.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:34 GMT -->
</html>