<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2011/06/15/10174716.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:34 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>Does your code avoid the [government sanctioned] Y1.45K bug?</title></head><body>
<h1>Does your code avoid the [government sanctioned] Y1.45K bug?</h1>
<p><em>by Michael S. Kaplan, published on 2011/06/15 07:01 -04:00, original URI: http://blogs.msdn.com/b/michkap/archive/2011/06/15/10174716.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<p>So I was asked if I knew what the following comment from the site was about:</p>
<p style="padding-left: 120px;"><strong><span style="color: #00cc00; font-size: medium;">The Microsoft Implementation of the Umm al-Qura Calendar</span></strong></p>
<p style="padding-left: 120px;"><span>The implementation of the Umm al-Qura calendar in Microsoft&rsquo;s recent operating system Vista is claimed to be valid between 1318&nbsp;AH and 1450&nbsp;AH. However, as the Microsoft Vista algorithm erroneously assumes that the computational rule used between 1395&nbsp;AH and 1419&nbsp;AH was also used before 1395&nbsp;AH the Microsoft algorithm will often give faulty results for dates before 1395&nbsp;AH.</span></p>
<p>I am really not sure what this comment refers to.</p>
<p>I mean I have mentioned issues I know about in blogs like <strong><a href="http://archives.miloush.net/michkap/archive/2006/04/14/576627.html" title="Long term planning is not always done">Long term planning is not always done</a></strong>, and <strong><a href="http://archives.miloush.net/michkap/archive/2010/09/14/10061557.html" title="Using a culture's format, without using that culture to format?">Using a culture's format, without using that culture to format?</a>.</strong></p>
<p>Not to mention <strong><a href="http://archives.miloush.net/michkap/archive/2010/02/12/9962835.html" title="Evil Date Parsing lives! Viva Evil Date Parsing!, explained">Evil Date Parsing lives! Viva Evil Date Parsing!, explained</a></strong>. </p>
<p>Or <strong><a href="http://archives.miloush.net/michkap/archive/2008/12/16/9225748.html" title="Grody to the Max[Date]!]">Grody to the Max[Date]!</a></strong>.</p>
<p>Even without issues that would cut down our effective dates, looking to the future the 1450 limit would take us to (unless my mental math is off) some time in 2028, which is not that many years away.</p>
<p>With computer programs written in .Net that work with MaxDate so gratuitously (and I have seen many of those), this is not a very wide range.</p>
<p>Given that there are features in Windows that can deal with dates outside of this range (including certificate creation), I think any application running on Windows that doesn't handle the Um al-Quara calendar is pretty irresponsible....</p>
<p>By the way, does anyone know what that "bug" in our implementation is? I'll ask some people around here, but I thought I'd ask my readers first in case anyone knew.</p>
<hr/><p><strong>ray</strong> on 15 Jun 2011 1:43 PM:</p><div style="margin-left: 1em"><p>Don&#39;t worry, it&#39;s just a calendar rule change that happened in 1395... (1975 in Gregorian years)</p>
</div>
<p><strong>Michael S. Kaplan</strong> on 15 Jun 2011 4:44 PM:</p><div style="margin-left: 1em"><p>There&#39;s still the 1450 stopping point, so I&#39;m still worried. :-)</p>
</div>
<p><strong>r.h.vangent@uu.nl</strong> on 16 Jun 2011 1:41 AM:</p><div style="margin-left: 1em"><p>The above comment (regarding the accuracy of the Microsoft Vista implementation of the Umm al-Qura calendar before 1395 AH) is from</p>
<p> &nbsp;<a rel="nofollow" target="_new" href="http://www.staff.science.uu.nl/~gent0113/islam/ummalqura.htm">www.staff.science.uu.nl/.../ummalqura.htm</a></p>
<p>where you can find a date converter valid between 1356 AH and 1500 AH.</p>
</div>
<p><strong>Mike Dimmick</strong> on 16 Jun 2011 10:47 AM:</p><div style="margin-left: 1em"><p>Digging around in the .NET source code, I can see that .NET 3.5 SP1 &#39;red bits&#39; and .NET 4.0 RTM both are just based on a table lookup that runs from 1318 AH to 1450 AH. There&#39;s no reason that the table couldn&#39;t be corrected if the historical record shows that it&#39;s wrong, except of course for compatibility reasons (it may be wrong, but it&#39;s consistently wrong). The web page referenced by r.h.vangent@uu.nl (his/her own, apparently) says &#39;Dates for the years 1356 AH to 1411 AH are based on a calendar conversion table published in the early 1990s by the King Fahd University of Petroleum &amp; Minerals Research Institute (Dhahran)&#39; so are probably correct.</p>
<p>The calendar on that page is also table-based, but this goes up to 1500 AH. That&#39;s why it says the results are wrong after that point!</p>
<p>The only real solution is to incorporate astronomical calculation software into Windows so that it can calculate any date in the future. Developers and users might be surprised at how long it&#39;s taking to figure out the date, though!</p>
<p>HijriCalendar is a specific tabular calendar that alternates 29 and 30 days per month, and a fixed schedule of &#39;leap years&#39;, so can be projected indefinitely into the future.</p>
</div>
<hr/><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2011/06/16/10175121.html" title="&quot;...and I know it actually happened, because the person it actually happened to was me.&quot;">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2011/06/14/10174165.html" title="Since nobody @#%&amp;*! owns en-USâ€¦">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2011-06">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2011-06-15">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2011/06/15/10174716.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:34 GMT -->
</html>