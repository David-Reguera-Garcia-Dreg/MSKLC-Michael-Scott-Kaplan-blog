<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2011/10/13/10224477.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:34 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>Every rose has it's Þ....</title></head><body>
<h1>Every rose has it's Þ....</h1>
<p><em>by Michael S. Kaplan, published on 2011/10/13 07:01 -04:00, original URI: http://blogs.msdn.com/b/michkap/archive/2011/10/13/10224477.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<p>Over on the Unicore List, the question was a familar one:</p>
<p style="padding-left: 60px;"><span style="font-family: times new roman,times;">I am converting text in an ANSI-encoded document to Unicode using&nbsp; </span><br /><span style="font-family: times new roman,times;">search and replace in Notepad on Windows Vista SP2. The source&nbsp; </span><br /><span style="font-family: times new roman,times;">document contains text in the 8-bit CSX+ encoding for Indic&nbsp; </span><br /><span style="font-family: times new roman,times;">transliteration. A chart of the CSX+ encoding is available at:&nbsp; </span><br /><span style="font-family: times new roman,times;"><a href="http://homepage.ntlworld.com/richard.wordingham/10646/CSX+.htm" target="_blank">http://homepage.ntlworld.com/richard.wordingham/10646/CSX+.htm</a></span><br /><br /><span style="font-family: times new roman,times;">In the CSX+ encoding, ASCII 254 '&thorn;' represents the character 'ḥ'&nbsp; </span><br /><span style="font-family: times new roman,times;">(h-underdot). When I perform a search and replace of ASCII 254 '&thorn;' to&nbsp; </span><br /><span style="font-family: times new roman,times;">Unicode 'ḥ' U+1E25 LATIN SMALL LETTER H WITH DOT BELOW, the operation&nbsp; </span><br /><span style="font-family: times new roman,times;">not only converts all instances of '&thorn;' to 'ḥ', but also all instances&nbsp; </span><br /><span style="font-family: times new roman,times;">of 'th' to 'ḥ'. For example, the word 'ratha&thorn;' gets caught in the&nbsp; </span><br /><span style="font-family: times new roman,times;">replace and is changed to 'raḥaḥ'.</span><br /><br /><span style="font-family: times new roman,times;">This is rather unexpected behavior. I would consider this an error,&nbsp; </span><br /><span style="font-family: times new roman,times;">but perhaps a very well-intentioned one, given that the phonetic&nbsp; </span><br /><span style="font-family: times new roman,times;">representation of '&thorn;' in Old English is in fact /th/.</span><br /><br /><span style="font-family: times new roman,times;">Is there some internal Windows mechanism that treats ASCII 254 &thorn; as&nbsp; </span><br /><span style="font-family: times new roman,times;">being canonically equivalent to 'th'? Or, perhaps is the equivalent&nbsp; </span><br /><span style="font-family: times new roman,times;">rule the dastardly deed of some Old English language enthusiast turned&nbsp; </span><br /><span style="font-family: times new roman,times;">techie? :)</span><br /><br /><span style="font-family: times new roman,times;">Best,</span><br /><span style="font-family: times new roman,times;">Anshuman</span></p>
<p>Yet another "misuse" of Notepad beyond the old UTF-8 BOM? :-)</p>
<p>This one is kind of my fault., too.... not directly since I am not the one who changed Notepad, but I&nbsp;am the one&nbsp;who added&nbsp;the function and then pushed them to use it in Notepad (fixing the problems&nbsp;I pointed out in blogs like <strong><a title="When Notepad's Find doesn't" href="http://archives.miloush.net/michkap/archive/2005/04/06/405847.html">When Notepad's Find doesn't</a></strong>&nbsp;and <strong><a title="The fallacy of comparing out of context" href="http://archives.miloush.net/michkap/archive/2006/07/09/658454.html">The fallacy of comparing out of context</a></strong>&nbsp;and so on more than&nbsp;half a decade&nbsp;ago).</p>
<p>In Vista, bringing FindNLSString brought the full power of Windows collation to the Find/Replace capabilities of Notepad.</p>
<p>So all of the various Unicode canonical forms will always&nbsp;be equal and so on.</p>
<p>This is a good thing.</p>
<p>Unfortunately for Anshuman, it also brings our EXPANSIONS along.</p>
<p>In particular, the following two entries:</p>
<p style="padding-left: 30px;"><strong><span style="font-family: courier new,courier; font-size: medium;">0x00de&nbsp;0x0054&nbsp;0x0048&nbsp;;TH</span></strong><br /><strong><span style="font-family: courier new,courier; font-size: medium;">0x00fe&nbsp;0x0074&nbsp;0x0068&nbsp;;th</span></strong></p>
<p>The only locale whose sorting negates this equivalence is Icelandic.</p>
<p>Perhaps if one is running on Vista or later, switching to an <strong>Icelandic</strong> user locale (aka "Standards and Formats") will provide a workaround for the Thorn in your side.</p>
<p>Well, this one, at least!</p>
<hr/><p><strong>John Cowan</strong> on 13 Oct 2011 8:17 AM:</p><div style="margin-left: 1em"><p>The actual moral, I think, is that while a search function should be permissive, a replace-all function should be rather more persnickety, because it is destructive and not undoable.</p>
</div>
<p><strong>Michael S. Kaplan</strong> on 13 Oct 2011 8:26 AM:</p><div style="margin-left: 1em"><p>^Z is very handy in those cicumstances, as is choosing not to save. :-)</p>
<p>The replace choice lets you review every change; it is only the &quot;replace all&quot; button that is nuclear....</p>
</div>
<p><strong>ErikF</strong> on 13 Oct 2011 9:39 AM:</p><div style="margin-left: 1em"><p>WordPad seems not to have this &quot;feature&quot; in its search-and-replace (at least not in Windows 7 using the English (Canada) locale.) I just tried that replacement and it worked fine. So, if you can use WordPad for the replacement part if nothing else, that seems like another workaround.</p>
</div>
<p><strong>Michael S. Kaplan</strong> on 13 Oct 2011 10:10 AM:</p><div style="margin-left: 1em"><p>There are tradeoffs, though -- they don&#39;t do the Unicode canonical equivalence thing so well in Wordpad....</p>
</div>
<p><strong>Doug Ewell</strong> on 13 Oct 2011 10:24 AM:</p><div style="margin-left: 1em"><p>The whole notion of using Notepad, or any other editor, as a charset conversion tool seems a bit suspect. If he has the time and ability, he&#39;d probably be better off writing a custom Encoding class.</p>
</div>
<p><strong>Joshua</strong> on 14 Oct 2011 9:08 AM:</p><div style="margin-left: 1em"><p>I would hope that &quot;match case&quot; would fix the problem but I&#39;ll bet it doesn&#39;t.</p>
<p>People keep on trying to use notepad for what it was in &#39;98: a *dumb* text editor. Back in the day, you could do a search&amp;replace on a binary file and expect it to work most of the time if you didn&#39;t change the length of anything.</p>
</div>
<p><strong>Michael S. Kaplan</strong> on 14 Oct 2011 10:37 AM:</p><div style="margin-left: 1em"><p>It does fix &nbsp;in &lt;= Server 2003.</p>
</div>
<hr/><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2011/10/14/10225146.html" title="Improving genitive. Or not.... (part 1)">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2011/10/12/10223697.html" title="On [not] being what&#39;s next [yet!]">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2011-10">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2011-10-13">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2011/10/13/10224477.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:34 GMT -->
</html>