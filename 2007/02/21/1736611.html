<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2007/02/21/1736611.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:38 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>Here is what's up with localized paths in Vista (and in Windows!)</title></head><body>
<h1>Here is what's up with localized paths in Vista (and in Windows!)</h1>
<p><em>by Michael S. Kaplan, published on 2007/02/21 15:36 -05:00, original URI: http://blogs.msdn.com/b/michkap/archive/2007/02/21/1736611.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<P>Some of you may recall the confusion surrounding <STRONG><A class="" href="http://archives.miloush.net/michkap/archive/2007/01/18/1487464.html" mce_href="http://archives.miloush.net/michkap/archive/2007/01/18/1487464.html">localized paths in Vista</A></STRONG> that I mentioned not too long ago. The comments in that post made it clear that lots of folks had opinions about the design and that there was much confusion about how to get the localized information.</P>
<P>Well, confusion can now be over, as Ming Zhu, a dev on the Shell team, has stepped up and not only clarified the usage of <A class="" href="http://msdn2.microsoft.com/library/ms647786.aspx" mce_href="http://msdn2.microsoft.com/library/ms647786.aspx">SHGetLocalizedName</A> but also provided some code to get the localized names as well. </P>
<P>I wanted to&nbsp;elevate his response</P>
<P>His comment and code are <STRONG><A class="" href="http://archives.miloush.net/michkap/archive/2007/01/18/1487464.html#1736328" mce_href="http://archives.miloush.net/michkap/archive/2007/01/18/1487464.html#1736328">here</A></STRONG>, and I think this should help resolve some of the confusion here, if for no other reason than pointing to the right methods to be considering (namely <A class="" href="http://msdn2.microsoft.com/library/ms632803.aspx" mce_href="http://msdn2.microsoft.com/library/ms632803.aspx">IShellItem::GetDisplayName</A> and <A class="" href="http://msdn2.microsoft.com/library/ms632963.aspx" mce_href="http://msdn2.microsoft.com/library/ms632963.aspx">IShellFolder::GetDisplayNameOf</A>).</P>
<P>The methodology will work not only in Vista but in prior versions, too. Excellent! :-)</P>
<P>It might be nice to see the docs for <A class="" href="http://msdn2.microsoft.com/library/ms647786.aspx" mce_href="http://msdn2.microsoft.com/library/ms647786.aspx">SHGetLocalizedName</A> fixed up to both make the limitations clearer (for most users this is NOT the function they want) and to point folks in the right direction for some of the more common needs people will likely have here. But for now I'll just bask in the glow of a great answer to a confusing question....</P>
<P>For the other questions raised in the comments from people wondering about the design, I think we can probably let go of those ones now (since it is too late to change the design anyway).</P>
<P mce_keep="true">&nbsp;</P>
<P><FONT color=#ff00ff><EM>This post brought to you by</EM>&nbsp;<FONT size=5>·ç®</FONT> </FONT><EM><FONT color=#ff00ff>(</FONT><A class="" href="http://www.fileformat.info/info/unicode/char/1368" mce_href="http://www.fileformat.info/info/unicode/char/1368">U+1368</A><FONT color=#ff00ff>, a.k.a. ETHIOPIC PARAGRAPH SEPARATOR)</FONT></EM></P>
<hr/><p><strong>Mike</strong> on 22 Feb 2007 3:42 AM:</p><div style="margin-left: 1em"><p>Will this mean that roaming Vista profiles who log in under a different MUI environment will now no longer get special shell folders created in additional languages? </p>
<p>I can't remember the exact case as I haven't done this in at about 4-5 years, but one would get the localized version of (say) My Pictures created under your roaming My Docs folder in addition to the regular one. It was quite repro-able (and apparently well known to people on loc projects), and when bugged it went to one of the Windows Architects, who was not exactly happy about it. </p>
<p>It was annoying because it was very difficult to delete these new folders, and they would just keep coming back when you logged into other language-interface machines.</p></div>
<p><strong>Michael S. Kaplan</strong> on 22 Feb 2007 2:03 PM:</p><div style="margin-left: 1em"><p>The point is that they will always be in English, but the display will change dynamically based on UI language. So that bug goes away?</p>
</div>
<hr/><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2007/02/22/1738268.html" title="Culture vs. Culture">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2007/02/21/1733999.html" title="If we must be inconsistent, we should endeavor to be consistent about it">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2007-02">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2007-02-21">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2007/02/21/1736611.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:38 GMT -->
</html>