<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2007/02/14/1674482.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:38 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>Quite a [non]character, it is</title></head><body>
<h1>Quite a [non]character, it is</h1>
<p><em>by Michael S. Kaplan, published on 2007/02/14 03:01 -05:00, original URI: http://blogs.msdn.com/b/michkap/archive/2007/02/14/1674482.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<P>Mini (no, not <A class="" href="http://minimsft.blogspot.com/" mce_href="http://minimsft.blogspot.com/">that</A> mini!) asks:</P>
<BLOCKQUOTE>
<P><FONT face="times new roman,times" size=2><EM>I am on the&nbsp;##### ####### ######## team. Hoping you can help me with a question about String.Normalize. <BR><BR>We got a few Watson dumps where String.Normalize threw the following exception: System.ArgumentException: Invalid Unicode code point found at index &lt;n&gt;. Looking at the dump, the character (0xfde2) is the one that it complains about.<BR><BR>I tried writing a standalone program to try this out and it does throw the exception for this character. <BR><BR>I tried using Encoding.Unicode.GetChars on a byte array with the value (0xfde2) and it works. 0xfde2 appears to be a valid Unicode char. Do you know why System.Normalize says itâ€™s invalid?</EM></FONT></P></BLOCKQUOTE>
<P mce_keep="true">Well, the problem is essentially the one I pointed out in <STRONG><A class="" href="http://archives.miloush.net/michkap/archive/2006/11/11/1061686.html" mce_href="http://archives.miloush.net/michkap/archive/2006/11/11/1061686.html">Keeping out more of the undesirables</A></STRONG>. </P>
<P mce_keep="true">And U+fde2 is actually an ideal Unicode code value to show off what is happening here, as it part of the 32 code value range from U+fdd0 to U+fdef in the <A class="" href="http://www.unicode.org/charts/PDF/UFB50.pdf" mce_href="http://www.unicode.org/charts/PDF/UFB50.pdf">Arabic Presentation Forms-A block</A> that are all documented <STRONG>noncharacters</STRONG> with a defined suggested usage: "<EM>These codes are intended for process-internal uses, but are not permitted for interchange.</EM>"</P>
<P mce_keep="true">and like I said in that other posts, one of the things that happens when you use <A class="" href="http://msdn2.microsoft.com/en-us/library/system.string.normalize.aspx" mce_href="http://msdn2.microsoft.com/en-us/library/system.string.normalize.aspx">String.Normalize</A> is that it will throw on invalid Unicode characters, and noncharacters are really not an appropriate normalization target. Mini checked out the source of the data and it appeared to be from a test case that was generating random strings,&nbsp;which is a bad idea for all of the possible invalid values that could be generated.</P>
<P mce_keep="true">&nbsp;</P>
<P mce_keep="true"><FONT color=#ff00ff><EM>This post brought to you by <A class="" href="http://www.fileformat.info/info/unicode/char/fde2" mce_href="http://www.fileformat.info/info/unicode/char/fde2">U+fde2</A>, a noncharacter.</EM></FONT></P>
<hr/><div style="margin-left: 1em"><em>no comments</em></div><hr/><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2007/02/14/1675303.html" title="Nothing seems to be parsing the crap out of *this* number">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2007/02/13/1671523.html" title="An opportunity to start down the right [long ]path">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2007-02">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2007-02-14">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2007/02/14/1674482.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:38 GMT -->
</html>