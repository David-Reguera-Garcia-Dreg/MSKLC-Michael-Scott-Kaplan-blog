<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2007/02/05/1606868.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:38 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>I'm sorry, but Microsoft does not get time zones</title></head><body>
<h1>I'm sorry, but Microsoft does not get time zones</h1>
<p><em>by Michael S. Kaplan, published on 2007/02/05 17:45 -05:00, original URI: http://blogs.msdn.com/b/michkap/archive/2007/02/05/1606868.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<P>Okay, it's official. We still don't know anything whatsoever about reasonable customer time zone experiences at Microsoft.</P>
<P>Now this is the communal <STRONG>we</STRONG> that I am using here, as I take all 76,003 full time employees (exact number may be wrong, but I am not in HR) and say for the record that if the single most visible application we provide in relation to time zones gets it wrong (Microsoft Outlook), that we are getting it wrong as a company. No matter how many people are doing it right, this is just way too lame for words.</P>
<P>Someone from the Outlook team should get in touch with Ken Getz (in re: <A class="" href="http://www.mcwtech.com/CS/blogs/keng/archive/2007/01/26/304.aspx" mce_href="http://www.mcwtech.com/CS/blogs/keng/archive/2007/01/26/304.aspx">Time Zone Disaster--All Outlook Appointments Bite the Dust</A>) and at the very least provide an apology and at the very most provide a fix.</P>
<P>In the meantime, I can't claim to officially speak for&nbsp;over 70,000 people in any legal/moral/ethical/social/educational/professional/veterinarial sense, but I'll do my best.&nbsp;</P>
<P>I'm sorry, Ken. I'll buy you a drink next time we are in the same city. :-(</P>
<P mce_keep="true">&nbsp;</P>
<P><FONT color=#ff00ff><EM>This post brought to you by</EM>&nbsp;<FONT size=5>ùÑµ</FONT> <EM>(<A class="" href="http://www.fileformat.info/info/unicode/char/1d135" mce_href="http://www.fileformat.info/info/unicode/char/1d135">U+1d135</A>, a.k.a. MUSICAL SYMBOL CUT TIME)</EM></FONT></P>
<hr/><p><a id="1607835" href="#1607835">#</a> <strong>Anthony Zoko</strong> on 5 Feb 2007 8:19 PM:</p><div style="margin-left: 1em"><p>MS Released a tool a few days ago which may help affect users</p>
<p><a rel="nofollow" target="_new" href="http://www.microsoft.com/downloads/details.aspx?FamilyID=e343a233-b9c8-4652-9dd8-ae0f1af62568&amp;DisplayLang=en">http://www.microsoft.com/downloads/details.aspx?FamilyID=e343a233-b9c8-4652-9dd8-ae0f1af62568&amp;DisplayLang=en</a></p></div>
<p><a id="1607863" href="#1607863">#</a> <strong>damieng</strong> on 5 Feb 2007 8:27 PM:</p><div style="margin-left: 1em"><p>With America spanning a few timezones itself it's strange that Microsoft just doesn't get it.</p>
<p>The setting up of a non-US machine might be an eye opener for Microsoft engineer. &nbsp;The amount of times you have to choose UK/English during an install of XP must be at least 4-5 times.</p>
<p>Maybe timezones and setting regional details should be a team itself spread world-wide - is this how localisation is currently handled?</p>
<p>[)amien</p>
</div>
<p><a id="1608394" href="#1608394">#</a> <strong>Michael S. Kaplan</strong> on 5 Feb 2007 10:02 PM:</p><div style="margin-left: 1em"><P>The UK English case is a special one that is worse since there is no actual UK SKU and thus none of the benefits that other language versions can get will show up....</P>
<P>It makes this particular case (and the rest of the problems with non-US English) much worse.</P></div>
<p><a id="1610540" href="#1610540">#</a> <strong>Mike</strong> on 6 Feb 2007 3:51 AM:</p><div style="margin-left: 1em"><p>Microsoft has made a mess of it for years. We had a Windows CE O/S where daylight saving didn't work in the Southern Hemisphere, and 2 releases of Windows Media Player (v9 and v10) where all tracks labelled in a timezone outside of the Americas (actually every timezone in GMT or forward of GMT) have release year altered by a full year.</p>
<p>None of these releases was ever patched, although frequently reported. We had to wait for years for full new releases for the issue to be addressed. </p></div>
<p><a id="1670407" href="#1670407">#</a> <strong>Chris Parsons</strong> on 13 Feb 2007 1:15 PM:</p><div style="margin-left: 1em"><p>The fall out over this DST timezone change is hitting us hard despite our software doing things right (so we thought) over the last 10 years.</p>
<p>Our software stores all times in UTC, just like Windows NT does, and converts them to a presentation time using the _tcsftime() (strftime) in the CRT. &nbsp;Everything has worked great for us as it has correctly calculated all historic times correctly, until now.</p>
<p>Apparently we were na&#239;ve, as now historic times are calculated incorrectly due to Windows inability to calculate the correct DST times from previous years, including 2006! &nbsp;You can try it for yourself, by changing the system clock to March 13th 2006 on a Windows XP machine (or 2000 machine with manual registry patch as suggested in KB914387). &nbsp;Vista gets it right, but as that represents &lt; 0.1% of our install base it's not much consolation at the moment.</p>
<p>As part of the research to this problem I discovered that new registry entries where supplied as part of this &quot;patch&quot;. &nbsp;There is a new registry subkey called &quot;Dynamic DST&quot; which appears to have a year corrected formula as mentioned in KB928388 and described in the MSDN information for DYNAMIC_TIME_ZONE_INFORMATION <a rel="nofollow" target="_new" href="http://msdn2.microsoft.com/en-us/library/ms724253.aspx">http://msdn2.microsoft.com/en-us/library/ms724253.aspx</a>, however this new key appears to be there on XP/2000 merely for a) grins b) confusion c) consistency with Vista that actually uses it.</p>
<p>My countdown for finding a working solution is growing short, and all kinds of nasty hacks have been crossing my mind. &nbsp;The only workable solution that I can think of so far involves modifying our software to change the TZ environment variable to disable daylight saving and doing a manual calculation using the newly found registry setting by writing an XP equivalent of GetDynamicTimeZoneInformation().</p>
<p>Any and all suggestions welcome.</p>
<p>-Chris</p>
<p>P.S. Yes I did think of lobbying the government to abandon DST and it's questionable value but I discovered that politicians don't do anything unless they are politically motivated to do so.</p></div>
<p><a id="1670933" href="#1670933">#</a> <strong>Michael S. Kaplan</strong> on 13 Feb 2007 3:17 PM:</p><div style="margin-left: 1em"><p>&quot;Everything has worked great for us as it has correctly calculated all historic times correctly, until now.&quot;</p>
<p>Um, this has never, ever, EVER worked. Your code was getting lucky and not needing one of the many time zones that have had changes over the years, that's all.</p>
</div>
<p><a id="1671205" href="#1671205">#</a> <strong>Chris Parsons</strong> on 13 Feb 2007 3:54 PM:</p><div style="margin-left: 1em"><p>Then why did they bother to set about &quot;correcting&quot; this on Vista? &nbsp;Obviously DST times in the US haven't changed for 40 years hence there hasn't been a local need. &nbsp;Had we sold any of the software to Israel or other country that changes DST on a regular basis then obviously I would have caught this limitation earlier.</p>
<p>Vista understands that for 2006 the dates for DST where April 2nd to October 29th (and so on for previous years) and that 2007 is March 11th to November 4th. &nbsp;Why wasn't this intelligence retrofitted into XP? &nbsp;Why bother having the new registry keys if they go unused by the operating system?</p></div>
<p><a id="1671415" href="#1671415">#</a> <strong>Michael S. Kaplan</strong> on 13 Feb 2007 4:29 PM:</p><div style="margin-left: 1em"><p>Actually, this has been broken for a loing time. We are finally trying to do something about it, but there is more to do here, obviously (as I have pointed out in other posts).</p>
<p>Claiming there was no problem previously is just wrong, as this HAS been a problem for a long time.</p>
<p>I assume the new reg keys were added to the old platform to make the patch easier to run; they are just ignored on earlier platforms so they do no harm?</p>
<p>I cannot speak as to why nothing was retrofitted into earlier versions, it wasn't really up to me to decide though. :-)</p>
</div>
<p><a id="1671606" href="#1671606">#</a> <strong>Chris Parsons</strong> on 13 Feb 2007 5:21 PM:</p><div style="margin-left: 1em"><p>I wasn't claiming that it wasn't a problem previously, just that it had never been a problem for us do to our limited deployment in US and Western Europe. &nbsp;:-)</p>
<p>As those new registry settings are now documented in MSDN do you think that would be a reasonable &quot;global&quot; means of calculating DST historically? &nbsp;I don't like reading such registry entries directly, but it's the only way I can see to calculate time historically and globally.</p></div>
<p><a id="1671870" href="#1671870">#</a> <strong>Michael S. Kaplan</strong> on 13 Feb 2007 6:23 PM:</p><div style="margin-left: 1em"><p>Well, since it is documented one has much more of a leg to stand on in regard to backcompat, which is helpful here. </p>
<p>Of course the timeline is limited (no earlier historical info is included), but it sounds like that problem does not worry you as much. :-)</p>
</div>
<hr/><p><em>referenced by</em></p><div style="margin-left: 1em"><p>2008/06/29 <a href="http://archives.miloush.net/michkap/archive/2008/06/29/8667900.html">Did someone break GetTimeZoneInformation in XP?</a></p><p>2007/03/11 <a href="http://archives.miloush.net/michkap/archive/2007/03/11/1857439.html">The weirdness of the DST change on SIAO....</a></p></div><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2007/02/06/1607855.html" title="What are the fonts in Vista?">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2007/02/05/1606112.html" title="The myth of consistent user interfaces">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2007-02">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2007-02-05">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2007/02/05/1606868.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:38 GMT -->
</html>