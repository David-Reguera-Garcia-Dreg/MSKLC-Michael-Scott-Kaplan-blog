<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2007/02/18/1709479.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:38 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>He had the strength of an OX[IA], I tell you</title></head><body>
<h1>He had the strength of an OX[IA], I tell you</h1>
<p><em>by Michael S. Kaplan, published on 2007/02/18 19:30 -05:00, original URI: http://blogs.msdn.com/b/michkap/archive/2007/02/18/1709479.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<P>Remember the other day when I was talking about how <STRONG><A class="" href="http://archives.miloush.net/michkap/archive/2005/01/18/355210.html" mce_href="http://archives.miloush.net/michkap/archive/2005/01/18/355210.html">the jury giving the string no weight</A></STRONG>?</P>
<P>Well, it looks like this problem is just going to keep getting worse. Earlier today, Vineet asked:</P>
<BLOCKQUOTE><FONT face="Times New Roman,Times" size=2><I>
<P>Hello,<BR><BR>Could someone tell me how to use Unicode text as a parameter in an MS Access 2003 query on a WinXP box?<BR><BR>This is a query that should return a single line from the table.<BR><BR></I>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SELECT t030_StrongsLexicon.Lemma<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; FROM t030_StrongsLexicon<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; WHERE (((t030_StrongsLexicon.Lemma)="<FONT face=tahoma,arial,helvetica,sans-serif>βρέχω</FONT>"));<I><BR><BR>However, it returns two lines: records with <FONT face=tahoma,arial,helvetica,sans-serif>βρέχω</FONT> as well as βρύχω.<BR><BR>Access is ignoring the characters with the accents over them. &nbsp;It apparently is reading both words as βρ?χω.<BR><BR>Thanks<BR>Vineet</P></FONT></I></BLOCKQUOTE>
<P mce_keep="true">However, the problem is not a lack of Unicode support.</P>
<P mce_keep="true">Microsoft Jet 4.0 and thus every version of Access (2000 and later) supports Unicode.</P>
<P mce_keep="true">The two characters in question <FONT face=tahoma,arial,helvetica,sans-serif>έ</FONT> and <FONT face=tahoma,arial,helvetica,sans-serif>ύ</FONT> (<A class="" href="http://www.fileformat.info/info/unicode/char/1f73" mce_href="http://www.fileformat.info/info/unicode/char/1f73">U+1f73</A> and <A class="" href="http://www.fileformat.info/info/unicode/char/1f7b" mce_href="http://www.fileformat.info/info/unicode/char/1f7b">U+1f7b</A>, aka GREEK SMALL LETTER EPSILON WITH OXIA and GREEK SMALL LETTER UPSILON WITH OXIA), are not in the Jet, SQL Server, or Windows &lt;= Server 2003 collation tables.</P>
<P mce_keep="true">Thus they are equal as they have no weight. Their equality has nothing to do with the idea of them both being converted to question marks.</P>
<P mce_keep="true">Unfortunately there is no easy clever&nbsp;workaround like <A class="" href="http://archives.miloush.net/michkap/archive/2006/12/27/1366186.html" mce_href="http://archives.miloush.net/michkap/archive/2006/12/27/1366186.html"><STRONG>this one</STRONG></A> since neither character has a direct decomposition, either for canonical equivalence or compatibility.</P>
<P mce_keep="true">Though perhaps there is some hope; attend me for&nbsp;a moment:</P>
<P mce_keep="true"><A class="" href="http://www.fileformat.info/info/unicode/char/1ffd" mce_href="http://www.fileformat.info/info/unicode/char/1ffd">U+1ffd</A> (GREEK OXIA) has a canonical equivalence to <A class="" href="http://www.fileformat.info/info/unicode/char/00b4" mce_href="http://www.fileformat.info/info/unicode/char/00b4">U+00b4</A> (ACUTE ACCENT).</P>
<P mce_keep="true">And <A class="" href="http://www.fileformat.info/info/unicode/char/00b4" mce_href="http://www.fileformat.info/info/unicode/char/00b4">U+00b4</A> (ACUTE ACCENT) has a compatibility decomposition to <A class="" href="http://www.fileformat.info/info/unicode/char/0020" mce_href="http://www.fileformat.info/info/unicode/char/0020">U+0020</A> <A class="" href="http://www.fileformat.info/info/unicode/char/0301" mce_href="http://www.fileformat.info/info/unicode/char/0301">U+0301</A>, meaning&nbsp;it is the non-spacing form of <A class="" href="http://www.fileformat.info/info/unicode/char/0301" mce_href="http://www.fileformat.info/info/unicode/char/0301">U+0301</A> (COMBINING ACUTE ACCENT).</P>
<P mce_keep="true">So in theory you could use <A class="" href="http://www.fileformat.info/info/unicode/char/03b5" mce_href="http://www.fileformat.info/info/unicode/char/03b5">U+03b5</A> <A class="" href="http://www.fileformat.info/info/unicode/char/0301" mce_href="http://www.fileformat.info/info/unicode/char/0301">U+0301</A> and <A class="" href="http://www.fileformat.info/info/unicode/char/03c5" mce_href="http://www.fileformat.info/info/unicode/char/03c5">U+03c5</A> <A class="" href="http://www.fileformat.info/info/unicode/char/0301" mce_href="http://www.fileformat.info/info/unicode/char/0301">U+0301</A> for <A class="" href="http://www.fileformat.info/info/unicode/char/1f73" mce_href="http://www.fileformat.info/info/unicode/char/1f73">U+1f73</A> and <A class="" href="http://www.fileformat.info/info/unicode/char/1f7b" mce_href="http://www.fileformat.info/info/unicode/char/1f7b">U+1f7b</A>.</P>
<P mce_keep="true">And they do look kind of alike though not really (έ is not <FONT face=tahoma,arial,helvetica,sans-serif>έ</FONT>, ύ is not <FONT face=tahoma,arial,helvetica,sans-serif>ύ</FONT>), since some fonts have the OXIA as a straight line rather than a slanted one as the ACUTE ACCENT pretty much always has.</P>
<P mce_keep="true">The most compelling reason to not use this somewhat convoluted logic is that there is no&nbsp;conformant process like Unicode normalization that can lead to equivalence here, and no real promise that such an equivalence will be honored in products.</P>
<P mce_keep="true">Luckily, there is a more direct way to get there, using <A class="" href="http://www.fileformat.info/info/unicode/char/03ad" mce_href="http://www.fileformat.info/info/unicode/char/03ad">U+03ad</A> (GREEK SMALL LETTER EPSILON WITH TONOS) and <A class="" href="http://www.fileformat.info/info/unicode/char/03cd" mce_href="http://www.fileformat.info/info/unicode/char/03cd">U+03cd</A> (GREEK SMALL LETTER UPSILON WITH TONOS) which <STRONG>does</STRONG> have a direct connection via canonical decomposition mappings to <A class="" href="http://www.fileformat.info/info/unicode/char/03b5" mce_href="http://www.fileformat.info/info/unicode/char/03b5">U+03b5</A> <A class="" href="http://www.fileformat.info/info/unicode/char/0301" mce_href="http://www.fileformat.info/info/unicode/char/0301">U+0301</A> and <A class="" href="http://www.fileformat.info/info/unicode/char/03c5" mce_href="http://www.fileformat.info/info/unicode/char/03c5">U+03c5</A> <A class="" href="http://www.fileformat.info/info/unicode/char/0301" mce_href="http://www.fileformat.info/info/unicode/char/0301">U+0301</A>, respectively.</P>
<P mce_keep="true">If this workaround works for you, most products do support both <A class="" href="http://www.fileformat.info/info/unicode/char/03ad" mce_href="http://www.fileformat.info/info/unicode/char/03ad">U+03ad</A> (GREEK SMALL LETTER EPSILON WITH TONOS) and <A class="" href="http://www.fileformat.info/info/unicode/char/03cd" mce_href="http://www.fileformat.info/info/unicode/char/03cd">U+03cd</A> (GREEK SMALL LETTER UPSILON WITH TONOS), which provides a better route for support in both fonts and in collation/casing.</P>
<P mce_keep="true">Though I am not claiming that an OXIA is always a TONOS (I believe there are specific meanings in a linguistic framework for these two), so your mileage may vary....</P>
<P mce_keep="true">&nbsp;</P>
<P mce_keep="true"><FONT color=#ff00ff><EM>This post brought to you by</EM> <FONT face=Tahoma>έ <EM>and</EM> έ <EM>(<A class="" href="http://www.fileformat.info/info/unicode/char/1f73" mce_href="http://www.fileformat.info/info/unicode/char/1f73">U+1f73</A> and <A class="" href="http://www.fileformat.info/info/unicode/char/03ad" mce_href="http://www.fileformat.info/info/unicode/char/03ad">U+03ad</A>, a.k.a. GREEK SMALL LETTER EPSILON WITH OXIA and GREEK SMALL LETTER EPSILON WITH TONOS)</EM></FONT></FONT></P>
<hr/><div style="margin-left: 1em"><em>no comments</em></div><hr/><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2007/02/18/1710716.html" title="When Equals ≠ ==">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2007/02/17/1701561.html" title="Why I think System.String.IndexOf(Char) sucks">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2007-02">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2007-02-18">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2007/02/18/1709479.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:38 GMT -->
</html>