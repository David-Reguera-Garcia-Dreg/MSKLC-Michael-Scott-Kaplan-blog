<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2007/05/09/2497106.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:38 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>Sometimes you need more than StringInfo</title></head><body>
<h1>Sometimes you need more than StringInfo</h1>
<p><em>by Michael S. Kaplan, published on 2007/05/09 03:11 -04:00, original URI: http://blogs.msdn.com/b/michkap/archive/2007/05/09/2497106.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<P>Sometimes people expect <A class="" href="http://msdn2.microsoft.com/library/system.globalization.stringinfo.aspx" mce_href="http://msdn2.microsoft.com/library/system.globalization.stringinfo.aspx">StringInfo</A> to do more than it is designed to do.</P>
<P>Like just the other day when Federica asked:</P>
<BLOCKQUOTE>
<P><FONT face="times new roman,times"><EM>Hi<BR><BR>We are trying to parse a set of strings and read each joined char as 1 text element<BR>Using the System.Globalization.StringInfo::ParseCombiningCharacters it returns the indexes of each base character / high-surrogate<BR>But we have examples where a high surrogate is in the middle of a joined char and this method fails.<BR>Is there a way to handle correctly these strings?<BR><BR>Here are 2 examples in Assamese:<BR><BR></EM><FONT size=4>ম্পা&nbsp;</FONT><EM>&nbsp; [4 joined chars] but ParseCombiningCharacters reads 2 text elements<BR>text element ম্ starts at index 0<BR>text element পা starts at index 2<BR><BR></EM><FONT size=4>ত্ত&nbsp;</FONT><EM> [3 joined chars] but ParseCombiningCharacters reads 2 text elements<BR>text element ত্ starts at index 0<BR>text element ত starts at index 2<BR><BR>Thanks<BR>Federica</EM></FONT></P></BLOCKQUOTE>
<P>Now I am the last person in the world to knock <A class="" href="http://msdn2.microsoft.com/library/system.globalization.stringinfo.aspx" mce_href="http://msdn2.microsoft.com/library/system.globalization.stringinfo.aspx">StringInfo</A>, given all the times before that I have <STRONG><A class="" href="http://archives.miloush.net/michkap/archive/2005/02/07/368570.html" mce_href="http://archives.miloush.net/michkap/archive/2005/02/07/368570.html">talked</A></STRONG> <STRONG><A class="" href="http://archives.miloush.net/michkap/archive/2005/04/28/413019.html" mce_href="http://archives.miloush.net/michkap/archive/2005/04/28/413019.html">about</A></STRONG> <A class="" href="http://archives.miloush.net/michkap/archive/2005/04/29/413366.html" mce_href="http://archives.miloush.net/michkap/archive/2005/04/29/413366.html"><STRONG>it</STRONG></A>. :-)</P>
<P>But it is important to keep in mind that <A class="" href="http://msdn2.microsoft.com/library/system.globalization.stringinfo.aspx" mce_href="http://msdn2.microsoft.com/library/system.globalization.stringinfo.aspx">StringInfo</A>&nbsp;bases all of its rules on Unicode characteristics of the string, not based upon linguistic ones such as Federica is hoping for here.</P>
<P>In this case, one can use Uniscribe (specifically the <A class="" href="http://msdn2.microsoft.com/library/ms776521.aspx" mce_href="http://msdn2.microsoft.com/library/ms776521.aspx">ScriptItemize</A> and <A class="" href="http://msdn2.microsoft.com/library/ms776474.aspx" mce_href="http://msdn2.microsoft.com/library/ms776474.aspx">ScriptBreak</A> functions) to get what you are looking for here, which is to see these strings as&nbsp;being made up of&nbsp;larger clusters ) just like Notepad does, for example....</P>
<P>Maybe this one needs a sample too, what do you think? :-)</P>
<P mce_keep="true">&nbsp;</P>
<P><FONT color=#ff00ff><EM>This post brought to you by</EM> <FONT size=6>ত</FONT> <EM>(<A class="" href="http://www.fileformat.info/info/unicode/char/09a4" mce_href="http://www.fileformat.info/info/unicode/char/09a4">U+09a4</A>, a.k.a. BENGALI LETTER TA)</EM></FONT></P>
<hr/><div style="margin-left: 1em"><em>no comments</em></div><hr/><p><em>referenced by</em></p><div style="margin-left: 1em"><p>2008/10/15 <a href="http://archives.miloush.net/michkap/archive/2008/10/15/9000371.html">UCS-2 to UTF-16, Part 5: What's on the Next Level?</a></p><p>2008/09/18 <a href="http://archives.miloush.net/michkap/archive/2008/09/18/8956650.html">UCS-2 to UTF-16, Part 3: It starts with cursor movement (where MS simultaneously gets better and worse)</a></p></div><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2007/05/09/2503785.html" title="Language support for non-native speakers">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2007/05/08/2474854.html" title="Update⁴ for Romanian and Bulgarian">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2007-05">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2007-05-09">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2007/05/09/2497106.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:38 GMT -->
</html>