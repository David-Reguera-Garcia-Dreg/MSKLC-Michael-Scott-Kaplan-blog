<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2007/05/17/2692362.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:38 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>If a bunch of specific Unicode characters can no longer live in the same apartment together, can they really claim that they needed their space?</title></head><body>
<h1>If a bunch of specific Unicode characters can no longer live in the same apartment together, can they really claim that they needed their space?</h1>
<p><em>by Michael S. Kaplan, published on 2007/05/17 05:45 -04:00, original URI: http://blogs.msdn.com/b/michkap/archive/2007/05/17/2692362.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<P>So dipaksmistry asks (in an off-topic manner in response to <STRONG><A class="" href="http://archives.miloush.net/michkap/archive/2007/05/05/2430935.html" mce_href="http://archives.miloush.net/michkap/archive/2007/05/05/2430935.html">this</A></STRONG> post):</P>
<BLOCKQUOTE>
<P><EM><FONT face="times new roman,times">Hi,<BR><BR>I have written a small programme. Its code is as below.<BR><BR>#########################<BR>#include "stdafx.h"<BR>#include &lt;tchar.h&gt;<BR>#include &lt;Shellapi.h&gt;<BR>#include &lt;malloc.h&gt;<BR>#include &lt;stdlib.h&gt;<BR><BR>int APIENTRY WinMain(HINSTANCE hInstance,<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; HINSTANCE hPrevInstance,<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; LPSTR &nbsp; &nbsp; lpCmdLine,<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; int &nbsp; &nbsp; &nbsp; nCmdShow) {<BR>&nbsp;&nbsp;&nbsp; TCHAR t3[15];<BR><BR>&nbsp;&nbsp;&nbsp; t3[0] = 65279; &nbsp; &nbsp; // equivalent to 0xFEFF, &nbsp; (in my real application this byte is read from a unicode file in UTF-16 format and its value is 0xFEFF)<BR>&nbsp;&nbsp;&nbsp; t3[1] =_T('a');&nbsp;<BR>&nbsp;&nbsp;&nbsp; t3[2] =_T('b');&nbsp;<BR>&nbsp;&nbsp;&nbsp; t3[3] =_T('c');&nbsp;<BR>&nbsp;&nbsp;&nbsp; t3[4] =_T('d');&nbsp;<BR>&nbsp;&nbsp;&nbsp; t3[5] =_T('e');&nbsp;<BR>&nbsp;&nbsp;&nbsp; t3[6] =_T('\0');&nbsp;<BR><BR>&nbsp;&nbsp;&nbsp; if ((lstrcmpi (t3,_T("abcde"))) == 0) {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MessageBox(NULL,_T("two strings are equal"), _T("match result"), MB_OK);<BR>&nbsp;&nbsp;&nbsp; } else {<BR>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; MessageBox(NULL,_T("NOT EQUAL"), _T("match result"), MB_OK);<BR>&nbsp;&nbsp;&nbsp; }<BR><BR>&nbsp;&nbsp;&nbsp; return 1;<BR>}<BR>#########################<BR><BR>I have build it and made a executable.<BR><BR>Not when I run this executable on XP machine(with SP2 installed), it gives messages one.("two strings are equal"). <BR><BR>string comparison passes on XP machine.<BR><BR>But when I run this application on Vista machine it gives second message.("NOT EQUAL")<BR><BR>string comparison fails on Vista machine.<BR><BR>Do anybody have any idea, why this is happening....?</FONT></EM></P></BLOCKQUOTE>
<P>This was actually an intentional change that happened in the new version sorting.</P>
<P>It works like this:</P>
<P>The space character, <A class="" href="http://www.fileformat.info/info/unicode/char/0020" mce_href="http://www.fileformat.info/info/unicode/char/0020">U+0020</A>, is given weight in the&nbsp;collation table.</P>
<P>For that matter, so do <A class="" href="http://www.fileformat.info/info/unicode/char/205f" mce_href="http://www.fileformat.info/info/unicode/char/205f">U+205f</A> (MEDIUM MATHEMATICAL SPACE), <A class="" href="http://www.fileformat.info/info/unicode/char/3000" mce_href="http://www.fileformat.info/info/unicode/char/3000">U+3000</A> (IDEOGRAPHIC SPACE),&nbsp;<A class="" href="http://www.fileformat.info/info/unicode/char/1680" mce_href="http://www.fileformat.info/info/unicode/char/1680">U+1680</A> (OGHAM SPACE MARK),&nbsp;<A class="" href="http://www.fileformat.info/info/unicode/char/2002" mce_href="http://www.fileformat.info/info/unicode/char/2002">U+2002</A> (EN SPACE), <A class="" href="http://www.fileformat.info/info/unicode/char/2003" mce_href="http://www.fileformat.info/info/unicode/char/2003">U+2003</A> (EM SPACE), <A class="" href="http://www.fileformat.info/info/unicode/char/2004" mce_href="http://www.fileformat.info/info/unicode/char/2004">U+2004</A> (THREE-PER-EM SPACE),&nbsp;<A class="" href="http://www.fileformat.info/info/unicode/char/2005" mce_href="http://www.fileformat.info/info/unicode/char/2005">U+2005</A> (FOUR-PER-EM SPACE), <A class="" href="http://www.fileformat.info/info/unicode/char/2006" mce_href="http://www.fileformat.info/info/unicode/char/2006">U+2006</A> (SIX-PER-EM SPACE), <A class="" href="http://www.fileformat.info/info/unicode/char/2007" mce_href="http://www.fileformat.info/info/unicode/char/2007">U+2007</A> (FIGURE SPACE), <A class="" href="http://www.fileformat.info/info/unicode/char/2008" mce_href="http://www.fileformat.info/info/unicode/char/2008">U+2008</A> (PUNCTUATION SPACE),&nbsp;<A class="" href="http://www.fileformat.info/info/unicode/char/2009" mce_href="http://www.fileformat.info/info/unicode/char/2009">U+2009</A> (THIN SPACE), and <A class="" href="http://www.fileformat.info/info/unicode/char/200a" mce_href="http://www.fileformat.info/info/unicode/char/200a">U+200a</A> (HAIR SPACE).</P>
<P>Perhaps more to the point, <A class="" href="http://www.fileformat.info/info/unicode/char/200b" mce_href="http://www.fileformat.info/info/unicode/char/200b">U+200b</A> (ZERO WIDTH SPACE) and <A class="" href="http://www.fileformat.info/info/unicode/char/00a0" mce_href="http://www.fileformat.info/info/unicode/char/00a0">U+00a0</A> (NO-BREAK SPACE) have weight. Which made the fact that&nbsp;<A class="" href="http://www.fileformat.info/info/unicode/char/feff" mce_href="http://www.fileformat.info/info/unicode/char/feff">U+feff</A> (ZERO WIDTH NO-BREAK SPACE) was not just a little bit inconsistent...</P>
<P>With a new major sorting version in Vista, this one inconsistency was removed and made consistent....</P>
<P>As I pointed out in&nbsp; <STRONG><A class="" href="http://archives.miloush.net/michkap/archive/2006/03/25/560416.html" mce_href="http://archives.miloush.net/michkap/archive/2006/03/25/560416.html">I need my SPACE, symbolically speaking</A></STRONG>, the weight these characters are given is in the symbol range, so if you truly want to ignore <A class="" href="http://www.fileformat.info/info/unicode/char/feff" mce_href="http://www.fileformat.info/info/unicode/char/feff">U+feff</A>&nbsp;or any of them, you can just call <A class="" href="http://msdn2.microsoft.com/library/ms647476.aspx" mce_href="http://msdn2.microsoft.com/library/ms647476.aspx">CompareString</A> or <A class="" href="http://msdn2.microsoft.com/library/ms647477.aspx" mce_href="http://msdn2.microsoft.com/library/ms647477.aspx">CompareStringEx</A> with the NORM_IGNORESYMBOLS&nbsp;flag. And you can go from there....</P>
<P>Now of course some people will cry out that <A class="" href="http://www.fileformat.info/info/unicode/char/feff" mce_href="http://www.fileformat.info/info/unicode/char/feff">U+feff</A>&nbsp;is not just&nbsp;a space like the others, it is also the BYTE ORDER MARK (ref: <STRONG><A class="" href="http://archives.miloush.net/michkap/archive/2005/01/20/357028.html" mce_href="http://archives.miloush.net/michkap/archive/2005/01/20/357028.html">Every character has a story #4: U+feff (alternate title: UTF-8 is the BOM, dude!)</A></STRONG>). But the BOM has an even clearer semantic meaning attached to it, so ignoring it completely would not really be a linguistic or even a&nbsp;semantic&nbsp;requirement like some other characters like the ones I mention in <STRONG><A class="" href="http://archives.miloush.net/michkap/archive/2006/09/02/736881.html" mce_href="http://archives.miloush.net/michkap/archive/2006/09/02/736881.html">Every character has a story #23: U+00ad (SOFT HYPHEN)</A></STRONG> and <STRONG><A class="" href="http://archives.miloush.net/michkap/archive/2007/01/12/1454496.html" mce_href="http://archives.miloush.net/michkap/archive/2007/01/12/1454496.html">You've got to be kashidding me</A></STRONG>....</P>
<P>Getting back to the title of this post, if looks like in Vista that <A class="" href="http://www.fileformat.info/info/unicode/char/feff" mce_href="http://www.fileformat.info/info/unicode/char/feff">U+feff</A>&nbsp;finally can feel like it is not being ignored, so it won't need to move out claiming that it needs its space. :-)</P>
<P mce_keep="true">&nbsp;</P>
<P><FONT color=#ff00ff><EM>This post brought to you by</EM> <A class="" href="http://www.fileformat.info/info/unicode/char/feff" mce_href="http://www.fileformat.info/info/unicode/char/feff">U+feff</A>, a.k.a. ZERO WIDTH NO-BREAK SPACE</FONT></P>
<hr/><p><a id="2699745" href="#2699745">#</a> <strong>Mihai</strong> on 17 May 2007 2:23 PM:</p><div style="margin-left: 1em"><p>&lt;&lt;Now of course some people will cry out that U+feff is not just a space like the others, it is also the BYTE ORDER MARK&gt;&gt;</p>
<p>And I would say they are wrong :-)</p>
<p>BOM is to be used if and only if the endianess of the data stream is unknown.</p>
<p>Which is not at all the case with the Windows API.</p>
<p>What if Windows moves to Power PC? :-)</p>
<p>No problem. Because the endianess of the Windows API strings is not Little-Endian, is &quot;processor-endianess.&quot;</p>
<p>It so just happens that this is LE on Intel processors.</p></div>
<p><a id="2706344" href="#2706344">#</a> <strong>dipaksmistry</strong> on 18 May 2007 1:50 AM:</p><div style="margin-left: 1em"><p>Hi Michael ,</p>
<p>Thank you very much for helping me!</p>
<p>Best Regards,</p>
<p>Dipak M</p>
</div>
<hr/><p><em>referenced by</em></p><div style="margin-left: 1em"><p>2012/07/16 <a href="http://archives.miloush.net/michkap/archive/2012/07/16/10330046.html">if you see a ZWNBSP in the Release Preview, don't be insensitive and comment it hasn't been eating enough lately!</a></p></div><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2007/05/17/2696800.html" title="A private CultureAndRegionInfoBuilder does not imply a private CultureInfo">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2007/05/14/2629747.html" title="Stripping is an interesting job (aka On the meaning of meaningless, aka All Mn characters are non-spacing, but some are more non-spacing than others)">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2007-05">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2007-05-17">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2007/05/17/2692362.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:38 GMT -->
</html>