<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2007/05/17/2696800.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:38 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>A private CultureAndRegionInfoBuilder does not imply a private CultureInfo</title></head><body>
<h1>A private CultureAndRegionInfoBuilder does not imply a private CultureInfo</h1>
<p><em>by Michael S. Kaplan, published on 2007/05/17 11:13 -04:00, original URI: http://blogs.msdn.com/b/michkap/archive/2007/05/17/2696800.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<P>Brian asks via the Contact link:</P>
<BLOCKQUOTE><FONT size=2>
<P><FONT face="times new roman,times"><EM>I have a quick question about your </EM><EM>post</EM></FONT></FONT><FONT size=2><EM><FONT face="times new roman,times"> and I must be missing something. I would like to create a custom CultureInfo in memory and maybe save it to disk and I think your solution could do that, but how to load it into a CultureInfo object with out adding a registry key? Thank you for your help.</FONT></EM></P></FONT></BLOCKQUOTE>
<P>The post Brian is referring to is <A class="" href="http://archives.miloush.net/michkap/archive/2007/01/08/1432947.html" mce_href="http://archives.miloush.net/michkap/archive/2007/01/08/1432947.html"><STRONG>Using without registering [the source code]</STRONG></A>, which outlines the technique to make use of the <A class="" href="http://msdn2.microsoft.com/library/system.globalization.cultureandregioninfobuilder.aspx" mce_href="http://msdn2.microsoft.com/library/system.globalization.cultureandregioninfobuilder.aspx">CultureAndRegionInfoBuilder class</A> without requiring administrative permissions on the box one uses for the custom culture creation.</P>
<P>This is very useful when the goal is to create the file on a machine where one does not need to actually use the completed culture, a common design pattern also used in tools like MSKLC.</P>
<P>However, what Brian is looking for is something different -- a way to actually <STRONG>use</STRONG> a custom culture with the <A class="" href="http://msdn2.microsoft.com/en-us/library/system.globalization.cultureinfo.aspx" mce_href="http://msdn2.microsoft.com/en-us/library/system.globalization.cultureinfo.aspx">CultureInfo class</A> without requiring the culture to be installed on the machine.</P>
<P>This is a feature that is not currently available, though I have talked about the idea before, in posts like <STRONG><A class="" href="http://archives.miloush.net/michkap/archive/2005/11/20/494829.html" mce_href="http://archives.miloush.net/michkap/archive/2005/11/20/494829.html">Private fonts: for members only</A></STRONG>, where I mentioned:</P>
<BLOCKQUOTE>
<P><FONT face="times new roman,times"><EM>As I think about the way that private fonts are implemented in both GDI and GDI+, a possible model for a future version of a "private CultureInfo" seems to emerge.<BR><BR>It is obvious that if you are creating a CultureInfo that can be enumerated and&nbsp;used by everyone on the machine that you should have administrative permissions. But perhaps this model could be used to create a more private CultureInfo for use in a particular application. Just as with the private fonts you could not enumerate them or use them systemwide, but there already is a mechanism to get those things done. Is it something you could use in an application yourself.<BR><BR>Seems like an interesting idea, right?</EM></FONT></P></BLOCKQUOTE>
<P>In my opinion this could be a pretty compelling feature, one that has been requested both by customers like Brian and also by product teams with the notion of "document locales/cultures" like WPF (Avalon) and Word where they would like to have the ability to make use of the functionality without having to install it for all users publicly....</P>
<P>But for the moment that feature is not available. To make use of a custom culture via the <A class="" href="http://msdn2.microsoft.com/en-us/library/system.globalization.cultureinfo.aspx" mce_href="http://msdn2.microsoft.com/en-us/library/system.globalization.cultureinfo.aspx">CultureInfo class</A>, you must have permission to write the file to the&nbsp;appropriate directory and some info to the registry under HKLM.</P>
<P>You may have some luck in the meantime doing the work manually -- i.e. loading the info/data via the <A class="" href="http://msdn2.microsoft.com/library/system.globalization.cultureandregioninfobuilder.aspx" mce_href="http://msdn2.microsoft.com/library/system.globalization.cultureandregioninfobuilder.aspx">CultureAndRegionInfoBuilder class</A>&nbsp;and making use of it directly (some of the classes within the <A class="" href="http://msdn2.microsoft.com/library/system.globalization.cultureandregioninfobuilder.aspx" mce_href="http://msdn2.microsoft.com/library/system.globalization.cultureandregioninfobuilder.aspx">CultureAndRegionInfoBuilder class</A>&nbsp;are even functional like the <A class="" href="http://msdn2.microsoft.com/library/system.globalization.datetimeformatinfo.aspx" mce_href="http://msdn2.microsoft.com/library/system.globalization.datetimeformatinfo.aspx">DateTimeFormat</A> it has....</P>
<P>I could probably write&nbsp;a more substantive sample of using a "pseudo-culture" built up via this technique if people were interested.</P>
<P mce_keep="true">&nbsp;</P>
<P><FONT color=#ff00ff><EM>This post brought to you by</EM> à¸Š <EM>(<A class="" href="http://www.fileformat.info/info/unicode/char/0e0a" mce_href="http://www.fileformat.info/info/unicode/char/0e0a">U+0e0a</A>, a.k.a. THAI CHARACTER CHO CHANG)</EM></FONT></P>
<hr/><p><a id="3085286" href="#3085286">#</a> <strong>G Rojas</strong> on 4 Jun 2007 3:58 PM:</p><div style="margin-left: 1em"><p>I am investigating using a custom culture to have different strings displayed on our application based on client. &nbsp;I am able to create the custom culture and register it, however the ResourceManager does not seem to read the correct values from the custom culture file (i.e. en-US-XX)? &nbsp;Any ideas on why, or a better solution for this scenario?</p></div>
<hr/><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2007/05/18/2710448.html" title="Not spacing out on spacing forms of characters">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2007/05/17/2692362.html" title="If a bunch of specific Unicode characters can no longer live in the same apartment together, can they really claim that they needed their space?">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2007-05">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2007-05-17">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2007/05/17/2696800.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:38 GMT -->
</html>