<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2007/09/19/4992574.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:37 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>Don't just delete registry keys!</title></head><body>
<h1>Don't just delete registry keys!</h1>
<p><em>by Michael S. Kaplan, published on 2007/09/19 03:01 -04:00, original URI: http://blogs.msdn.com/b/michkap/archive/2007/09/19/4992574.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<P>The other day, someone from product support was working with a customer whose <STRONG>Add</STRONG> button on the Text Services and Input Languages dialog was grayed out.</P>
<P>You know, the <STRONG>Add</STRONG> button in this dialog:</P>
<P><IMG src="http://trigeminal.fmsinc.com/images/Deleted01.png"></P>
<P>It turns out this can only happen in some pretty catastrophic circumstances, like the registry key being missing.</P>
<P>I found myself intrigued about what the behavior might be like, so I decided to test things out here. So that you won't have to! :-)</P>
<P>First, let me point out the usual warning that the Microsoft Knowledge Base does:</P>
<BLOCKQUOTE>
<P><FONT color=#ff0000><STRONG>WARNING</STRONG>: If you use Registry Editor incorrectly, you may cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that you can solve problems that result from using Registry Editor incorrectly. Use Registry Editor at your own risk.</FONT></P></BLOCKQUOTE>
<P>Let me add one thing to that, if you wanted to do this yourself, <STRONG>back up the registry subkey, as the menu option below does</STRONG>:</P>
<P><IMG src="http://trigeminal.fmsinc.com/images/Deleted00.png"></P>
<P>PLEASE follow this advice -- if you don't then you are kind of semi-screwed without independently fixing the key back up....</P>
<P>Ok, now I will delete the "HKLM\SYSTEM\CurrentControlSet\Control\Keyboard Layouts" subkey.</P>
<P>So what happens when you try to launch the dialog?</P>
<P>Well, something very sad:</P>
<P><IMG src="http://trigeminal.fmsinc.com/images/Deleted02.png"></P>
<P>The <STRONG>A<U>d</U>d...</STRONG> button is definitely disabled. It seems that since the dialog needs that data to populate the dialog, lack of any into pretty much makes it empty.</P>
<P>That IME is a Text Services Framework TIP, which is mostly stored elsewhere....</P>
<P>Of course that begs the question of what would have happened if I only had regular keyboards and no TSF IMEs, more like this situation:</P>
<P><IMG src="http://trigeminal.fmsinc.com/images/Deleted03.png"></P>
<P>If I deleted the key then, what would happen?</P>
<P>You don't want to know, trust me. :-)</P>
<P>Well, if you are going to twist my arm:</P>
<P><IMG src="http://trigeminal.fmsinc.com/images/Deleted04.png"></P>
<P>Yikes!</P>
<P><STRONG>Incompatible keyboard driver detected.&nbsp; This dialog has been disabled.</STRONG></P>
<P>In case someone as confused about the&nbsp;blank dialog. :-)</P>
<P>Of course you know what's next, right?</P>
<P>I have to try all of this on Vista.</P>
<P><STRONG>Backing up the registry key first, of course!!!</STRONG></P>
<P>Here is what the deleted keyboards registry key does:</P>
<P><IMG src="http://trigeminal.fmsinc.com/images/Deleted05.png"></P>
<P>The <STRONG>Add...</STRONG> button is not disabled!</P>
<P>Maybe it will work somehow?</P>
<P>Though the fact that it lists none of my keyboards makes me nervous, if you know what I mean....</P>
<P>Here goes:</P>
<P><IMG src="http://trigeminal.fmsinc.com/images/Deleted06.png"></P>
<P>Doesn't inspire much confidence, huh? :-)</P>
<P>Okay, enough excitement for one day, let's add those backup up registry keys back.</P>
<P>Hold our breath, launch the dialog again, and </P>
<P><IMG src="http://trigeminal.fmsinc.com/images/Deleted07.png"></P>
<P>Whew! Everything is back.</P>
<P>And the <STRONG>Add...</STRONG> button?</P>
<P><IMG src="http://trigeminal.fmsinc.com/images/Deleted08.png"></P>
<P>Good, everything is back.</P>
<P>Let's not delete sections of the registry any more. Some of those dialogs are plain disturbing!</P>
<P mce_keep="true">&nbsp;</P>
<P><FONT color=#ff00ff><EM>This post brought to you by</EM> <FONT size=5>á¸µ</FONT> <EM>(<A class="" href="http://www.fileformat.info/info/unicode/char/1e35" mce_href="http://www.fileformat.info/info/unicode/char/1e35">U+1e35</A>, a.k.a. LATIN SMALL LETTER K WITH LINE BELOW)</EM></FONT></P>
<hr/><p><a id="5003203" href="#5003203">#</a> <strong>Dean Harding</strong> on 19 Sep 2007 8:56 PM:</p><div style="margin-left: 1em"><p>Pretty cool that it handles it so gracefully, really! I know plenty of applications would just die horribly if data they were expecting wasn't there!</p>
</div>
<p><a id="5579417" href="#5579417">#</a> <strong>Dan</strong> on 21 Oct 2007 2:12 PM:</p><div style="margin-left: 1em"><p>This might be unrelated, but do you know what one might do if there's a language that is impossible to remove. It doesn't appear in the &quot;Text Services and Input Languages&quot; form, but it appears on the taskbar as one of the optional languages available.</p></div>
<p><a id="5580228" href="#5580228">#</a> <strong>Michael S. Kaplan</strong> on 21 Oct 2007 2:52 PM:</p><div style="margin-left: 1em"><p>Hi Dan -- It is hard to say without more information. What input language/keyboard is it, specifically?</p>
</div>
<p><a id="8993873" href="#8993873">#</a> <strong>vroland</strong> on 10 Oct 2008 3:42 AM:</p><div style="margin-left: 1em"><p>hi michael, nice one, where can i define in the registry to install more language options (for example english, chinese, japanese, hungarian)</p>
<p>thx for your help</p>
<p>regards,</p>
<p>r</p></div>
<p><a id="8994025" href="#8994025">#</a> <strong>Michael S. Kaplan</strong> on 10 Oct 2008 6:25 AM:</p><div style="margin-left: 1em"><p>You mean to add keyboards? Don't do it in the registry; do it using Regional Options unattend!</p>
</div>
<p><a id="8994067" href="#8994067">#</a> <strong>vroland</strong> on 10 Oct 2008 7:05 AM:</p><div style="margin-left: 1em"><p>my problem is this:</p>
<p>when i deploy a fresh vista desktop i want to add more languages to the installed services in the text services and input languages</p>
<p>and make it default for all new users, i tried to add to the registry key hku\.default\keyboard layout\preload another string with the id:2 and value: 0000040e but when i made a new user he only got the default 00000409 keyboard layout</p>
<p>how can i do it using regional options unattend?</p>
<p>sorry for my english</p>
<p>regards,</p>
<p>r</p></div>
<p><a id="8994399" href="#8994399">#</a> <strong>Michael S. Kaplan</strong> on 10 Oct 2008 11:09 AM:</p><div style="margin-left: 1em"><p>You can look here</p>
<p><a rel="nofollow" target="_new" href="http://archives.miloush.net/michkap/archive/2006/05/30/610505.html">http://blogs.msdn.com/michkap/archive/2006/05/30/610505.aspx</a></p>
<p>or actually for an even better answer, here:</p>
<p><a rel="nofollow" target="_new" href="http://archives.miloush.net/michkap/archive/2007/07/30/4126966.html">http://blogs.msdn.com/michkap/archive/2007/07/30/4126966.aspx</a></p>
<p>for the info on how to do this in &gt;= Vista.</p>
<p>Don't use the registry for this. That white paper in the second blog explains how to make the change get applied to new users....</p>
</div>
<p><a id="8997464" href="#8997464">#</a> <strong>vroland</strong> on 13 Oct 2008 2:12 AM:</p><div style="margin-left: 1em"><p>thx for your help Michael,</p>
<p>i'll look the url-s, they will help solving my problem</p>
<p>regards,</p>
<p>r</p></div>
<p><a id="8999116" href="#8999116">#</a> <strong>vroland</strong> on 14 Oct 2008 2:52 AM:</p><div style="margin-left: 1em"><p>it helped, i managed to solve my problem</p>
<p>thx again for your help</p>
<p>regards,</p>
<p>r</p></div>
<hr/><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2007/09/19/4998754.html" title="Every character[ sequence] has a story #30: The SMILEY (a 25-year old story, in fact)">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2007/09/18/4971899.html" title="Depending on when/where/who you ask, that character may not be your [c]type">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2007-09">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2007-09-19">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2007/09/19/4992574.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:37 GMT -->
</html>