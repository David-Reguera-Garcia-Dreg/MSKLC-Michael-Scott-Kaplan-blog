<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2007/09/27/5132462.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:37 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>Don't look directly at the 951 code page if you can avoid it</title></head><body>
<h1>Don't look directly at the 951 code page if you can avoid it</h1>
<p><em>by Michael S. Kaplan, published on 2007/09/27 03:16 -04:00, original URI: http://blogs.msdn.com/b/michkap/archive/2007/09/27/5132462.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<P>K. M. Leung asks over the Suggestion Box:</P>
<BLOCKQUOTE>
<P><FONT face="times new roman,times"><EM>Big5 Unicode conversion in .net 2.0.<BR><BR>I have read your article "Kowloon 951" and Ji Cheng's question. I know that there are a couple of ways to twist .net 2.0's encoding, such as changing the EncoderFallback. What if I am using BizTalk 2006's flatfile PipeLine encoding?<BR><BR>From the latest unicode version, Big5 9563 should converted to UTF16 8137 (As Cheung said, it is the case with Framework 1.1 and HKSCS). As you have said, .net 2.0 came with its own encoding tables. Can we say that it is a bug for .net 2.0 to convert Big5 9563 to UTF16 E77F and Microsoft should provide a fix? Below is the code that you can run under (1.1 + HKSCS) and (2.0)</EM></FONT></P>
<P><FONT face="times new roman,times">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;string tsource = "95 63";<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;string[] ahex = tsource.Split(new char[] { ' ' });<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;byte[] source = new byte[ahex.Length];<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int i = 0;<BR><BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;foreach (string hex in ahex)&nbsp;{<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;source[i] = (byte)ushort.Parse(hex, System.Globalization.NumberStyles.HexNumber);<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i += 1;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<BR><BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;byte[] target = Encoding.Convert(Encoding.GetEncoding("Big5"), Encoding.BigEndianUnicode, source);<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;string tTarget = "";<BR><BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;foreach (Byte bb in target) {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tTarget += bb.ToString("X") + " ";<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<BR><BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Console.WriteLine("Big5: " + tsource + " is converted to UTF16: " + tTarget);<BR><BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Console.ReadLine();</FONT></P></BLOCKQUOTE>
<P mce_keep="true">(The Kowloon 951&nbsp;post can be found <A class="" href="http://archives.miloush.net/michkap/archive/2007/05/12/2561904.html" mce_href="http://archives.miloush.net/michkap/archive/2007/05/12/2561904.html"><STRONG>here</STRONG></A>.)&nbsp;</P>
<P mce_keep="true">This is actually by design.</P>
<P mce_keep="true">The whole "code page 951" hack for HKSCS was just a hack, and not at all intended to be the way that HKSCS should be supported in Windows (the real HKSCS solution needs and has its own solution that does not involve returning results not in the original code page 950, which treats the code point in question as part of the Big5 and Unicode private use areas for EUDC, respectively....</P>
<P mce_keep="true">It was really a short term mistake in Windows that .NET 1.0 and 1.1 inherited by accident of all the code page support coming from Windows.</P>
<P mce_keep="true">I would definitely recommend against trying to use the Encoding support in .NET &gt;= 2.0 to munge any code page....</P>
<P mce_keep="true">On a not entirely unrelated note (and perhaps partially in recognition of issues I pointed out in posts like <A class="" href="http://archives.miloush.net/michkap/archive/2007/01/19/1492539.html" mce_href="http://archives.miloush.net/michkap/archive/2007/01/19/1492539.html"><STRONG>this one</STRONG></A>!), just this last month, the Chinese Language Interface Advisory Committee (CLIAC) made it clear that their intent is to in the future only assign code points to HKSCS when they have been assigned to Unicode (you can read about this in the&nbsp;NOTICE entitled <A class="" href="http://www.info.gov.hk/digital21/eng/hkscs/revised_principles.html" mce_href="http://www.info.gov.hk/digital21/eng/hkscs/revised_principles.html">Revised Principles for the Inclusion of Characters in the HKSCS</A>, or you read the 通告 in Chinese entitled <A class="" href="http://www.info.gov.hk/digital21/chi/hkscs/revised_principles.html" mce_href="http://www.info.gov.hk/digital21/chi/hkscs/revised_principles.html">修訂《香港增補字符集》字符增收原則</A>).</P>
<P mce_keep="true">&nbsp;</P>
<P mce_keep="true"><FONT color=#ff00ff><EM>This post brought to you by</EM> <FONT size=5>脷</FONT> <EM>(<A class="" href="http://www.fileformat.info/info/unicode/char/8137" mce_href="http://www.fileformat.info/info/unicode/char/8137">U+8137</A>, a CJK Unified Ideograph that is appears to be in&nbsp;neither the Taiwan CNS-11643 standard nor Microsoft's Big5 code page)</EM></FONT></P>
<hr/><div style="margin-left: 1em"><em>no comments</em></div><hr/><p><em>referenced by</em></p><div style="margin-left: 1em"><p>2011/01/13 <a href="http://archives.miloush.net/michkap/archive/2011/01/13/10115302.html">Doing it for appearances, Hong Kong style!</a></p></div><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2007/09/27/5141426.html" title="Wouldn&#39;t you bet, Fret (aka You&#39;ve got 50 ways to fix your characters)">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2007/09/27/5110938.html" title="Where does the time go? And when I said where, I meant when?">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2007-09">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2007-09-27">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2007/09/27/5132462.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:37 GMT -->
</html>