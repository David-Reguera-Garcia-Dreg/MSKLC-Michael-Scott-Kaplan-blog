<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2007/09/10/4850360.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:37 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>The SendKeys *blog post* juice was definitely not worth the squeeze</title></head><body>
<h1>The SendKeys *blog post* juice was definitely not worth the squeeze</h1>
<p><em>by Michael S. Kaplan, published on 2007/09/10 03:01 -04:00, original URI: http://blogs.msdn.com/b/michkap/archive/2007/09/10/4850360.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<P>It was over a year ago that I wrote a post about a Visual Basic language feature that has been around forever, and two specific problems with it (entitled <STRONG><A class="" href="http://archives.miloush.net/michkap/archive/2006/06/10/625285.html" mce_href="http://archives.miloush.net/michkap/archive/2006/06/10/625285.html">Is the SendKeys juice worth the squeeze?</A></STRONG>) that intended to focus on two specific issues:</P>
<OL>
<LI>The way SendKeys combines the Windows <A class="" href="http://msdn2.microsoft.com/library/ms646280.aspx" mce_href="http://msdn2.microsoft.com/library/ms646280.aspx">WM_KEYDOWN</A> and <A class="" href="http://msdn2.microsoft.com/library/ms646276.aspx" mce_href="http://msdn2.microsoft.com/library/ms646276.aspx">WM_CHAR</A> notifications, a simplification that actually makes it harder to explain the concepts behind the two separate messages when people run into functionality problems with the combined functionality, and</LI>
<LI>The over-complicated implementation of SendKeys that used the low level functionality of journal hooks, a feature that requires permissions that users do not have by default, as a bonus making the method not work so well in Vista.</LI></OL>
<P>Both of these architectural moves were mistakes, in my opinion.</P>
<P>The first issue made up as much as 5% of my pre-Microsoft career consulting for folks to help fix up VB projects needing language support due to how much confusion it inevitably leads to.</P>
<P>And the second was a short-sightedly naive as opening up registry keys for read using a <A class="" href="http://msdn2.microsoft.com/library/ms724878.aspx" mce_href="http://msdn2.microsoft.com/library/ms724878.aspx">KEY_ALL_ACCESS</A> request in the call to <A class="" href="http://msdn2.microsoft.com/library/ms724844.aspx" mce_href="http://msdn2.microsoft.com/library/ms724844.aspx">RegCreateKeyEx</A> that works great on Windows 95 but dies on the vine when you run on an NT-based system and get introduced to security. I have some personal experience with that registry issue -- the Microsoft access wizards were riddled with that behavior, and in the world of least privilege with big corporations that did not give all their employees full access it was a deployment blocker of the first order.</P>
<P>Of course this was not communicated well, and you can see in the comments how one customer focused on the VB backcompat issue and the fact that all of their applications would be broken.</P>
<P>Luckily when the VB team stepped up with an updated version of the Visual Basic runtime DLL (msvbvm60.dll)&nbsp;that had a graceful fallback to a <A class="" href="http://msdn2.microsoft.com/library/ms646310.aspx" mce_href="http://msdn2.microsoft.com/library/ms646310.aspx">SendInput</A> implementation, that was communicated as well, and the unhappy customer was able to be happy again (also for correcting me since I had apparently said it would not be fixed -- I had not; I just said that Windows wasn't gonna fix the problem, since it was a VB bug!).</P>
<P>Anyway, long time colleague and comrade <A class="" href="http://vb.mvps.org/" mce_href="http://vb.mvps.org/">Karl Peterson</A> asked me whether the VB6 runtime "shim" could be done for msvbvm50.dll as well. </P>
<P>Of course the fix was not a shim, it was an updated binary. So I guess the answer is (strictly speaking) "NO" since it never was a shim,&nbsp;though the less literal answer to whether a VB5 runtime fix would also be forthcoming&nbsp;would be that "I don't know, since I don't know their plans here." When in doubt I would recommend asking someone like <A class="" href="http://www.panopticoncentral.net/" mce_href="http://www.panopticoncentral.net/">Paul Vick</A> since he is much more likely to know stuff.</P>
<P>Though if I had to guess I'd look at the fact that <A class="" href="http://support.microsoft.com/dllhelp/default.aspx?l=55&amp;fid=214129" mce_href="http://support.microsoft.com/dllhelp/default.aspx?l=55&amp;fid=214129">according the DLL Hell database</A>, the last update was done for products back in 1998 and every white paper I have seen goes out of its way to emphasize the <STRONG>6</STRONG> in its description of the supported, making me really unsure what the VB5 story is here. There has to be a reason, right?</P>
<P>Anyway, I did learn something from that old blog post about misunderstandings and how easy it was to have them happen and how unlike the world of sitcoms like Three's Company they were in the blog -- they simply aren't funny, and they are kind of distracting.</P>
<P>And the juice was not worth the squeeze, in any case....</P>
<P mce_keep="true">&nbsp;</P>
<P><FONT color=#ff00ff><EM>This post brought to you by</EM> <FONT size=5>·Åç</FONT> <EM>(<A class="" href="http://www.fileformat.info/info/unicode/char/104d" mce_href="http://www.fileformat.info/info/unicode/char/104d">U+104d</A>, a.k.a. MYANMAR SYMBOL COMPLETED)</EM></FONT></P>
<hr/><p><strong>Yuhong Bao</strong> on 22 Apr 2009 9:47 PM:</p><div style="margin-left: 1em"><p>BTW, it seems that the versions of msvbvm60.dll shipped with Vista and later has no symbols on the MS symbol server, while some but not all older versions did have symbols though some of them was built with a PDB but only the DBG file was published on the symbol server.</p>
<p>Also you misspelled &quot;DLL Help&quot; as &quot;DLL Hell&quot;.</p></div>
<p><strong>Yuhong Bao</strong> on 22 Apr 2009 10:18 PM:</p><div style="margin-left: 1em"><p>BTW, the frustrating thing about issues with NT security in general is that Windows NT, with all it's security, existed before Windows 95! In fact, the Designed for Windows 95 logo in general required compatibility with NT 3.51, though of course there were exceptions to this rule.</p>
<p>BTW, compare how SetFilePointer supported large (and by large I mean larger than 4 GB) files with how GetDiskFreeSpace (yes, the original GetDiskFreeSpace) was supposed to support large disks (and actually did in NT 3.x). &nbsp;The fact is that SetFilePointer, GetDiskFreeSpace, large files, and large disks all existed since NT 3.1, but MS was forced to cap the output of GetDiskFreeSpace to 4 GB with NT 4.0 and 95 OSR2 because of a common error.</p></div>
<hr/><p><em>referenced by</em></p><div style="margin-left: 1em"><p>2010/05/13 <a href="http://archives.miloush.net/michkap/archive/2010/05/13/9993808.html">Minimalism isn't laziness, really; it's trying to do the job right without side effects!</a></p></div><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2007/09/11/4860978.html" title="Perhaps they don&#39;t quite get it just yet, #1">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2007/09/10/4847780.html" title="A&amp;P of Sort Keys, part 0 (aka The empty string sorts the same in every language)">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2007-09">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2007-09-10">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2007/09/10/4850360.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:37 GMT -->
</html>