<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2007/04/30/2333104.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:38 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>When moving to from XslTransform to XslCompiledTransform...</title></head><body>
<h1>When moving to from XslTransform to XslCompiledTransform...</h1>
<p><em>by Michael S. Kaplan, published on 2007/04/30 03:01 -04:00, original URI: http://blogs.msdn.com/b/michkap/archive/2007/04/30/2333104.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<P>Marco asked:</P>
<BLOCKQUOTE><FONT face="Times New Roman,Times" size=2>
<P><EM>Given a XSLT stylesheet with the following element:<BR><BR></EM><FONT face="consolas,lucida console,courier new,courier"><STRONG>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;xsl:output method="html" encoding="Windows-1252"/&gt;</STRONG></FONT><BR><BR><EM>NET Framework 1.1 System.Xml.Xsl.XslTransform.Transform method outputs:<BR><BR></EM><STRONG><FONT face="consolas,lucida console,courier new,courier">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252"&gt;</FONT></STRONG><BR><BR><EM>Using NET Framework 2.0 System.Xml.Xsl.XslCompiledTransform.Transform method outputs:<BR><BR></EM><STRONG><FONT face="consolas,lucida console,courier new,courier">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;META http-equiv="Content-Type" content="text/html; charset=utf-8"&gt;<BR></FONT></STRONG><BR><EM>I need the 1.1 output but using NET 2.0, <BR><BR>How can I do that?<BR><BR>Thank you very much in advance for any help,</EM></P></FONT></BLOCKQUOTE>
<P mce_keep="true">Luckily Anton was ready with the answer:</P>
<BLOCKQUOTE>
<P mce_keep="true"><EM>If you pass a TextWriter/XmlWriter to the Transform() method, the encoding specified in the xsl:output element is ignored, and the encoding of that TextWriter/XmlWriter is used instead.&nbsp; To respect the xsl:output encoding setting, you need to pass to the Transform() method either a Stream or a TextWriter/XmlWriter created with the desired encoding.&nbsp; For example,<BR></EM><BR><FONT face="consolas,lucida console,courier new,courier">&nbsp;&nbsp;&nbsp; XslCompiledTransform xslt = new XslCompiledTransform();<BR>&nbsp;&nbsp;&nbsp; xslt.Load("MyStylesheet.xsl");<BR>&nbsp;&nbsp;&nbsp; xslt.Transform("MyDocument.xml", XmlWriter.Create(myStream, xslt.OutputSettings));</FONT></P></BLOCKQUOTE>
<P mce_keep="true">This seems quite sensible, though the fact that&nbsp;this information&nbsp;does not seem to be captured in the migration information&nbsp;under either&nbsp;<A class="" href="http://msdn2.microsoft.com/library/system.xml.xsl.xslcompiledtransform.transform.aspx" mce_href="http://msdn2.microsoft.com/library/system.xml.xsl.xslcompiledtransform.transform.aspx">XslCompiledTransform.Transform</A> or <A class="" href="http://msdn2.microsoft.com/library/system.xml.xsl.xsltransform.transform.aspx" mce_href="http://msdn2.microsoft.com/library/system.xml.xsl.xsltransform.transform.aspx">XslTransform.Transform</A> methods (e.g. it is not in the <A class="" href="http://msdn2.microsoft.com/library/66f54faw.aspx" mce_href="http://msdn2.microsoft.com/library/66f54faw.aspx">Migrating From the XslTransform Class</A> topic). </P>
<P mce_keep="true">Which is why I thought I'd mention it here.... :-)</P>
<P mce_keep="true">&nbsp;</P>
<P mce_keep="true"><FONT color=#ff00ff><EM>This post brought to you by</EM> <FONT size=6>à¹›</FONT> <EM>(<A class="" href="http://www.fileformat.info/info/unicode/char/0e5b" mce_href="http://www.fileformat.info/info/unicode/char/0e5b">U+0e5b</A>, a.k.a. THAI CHARACTER KHOMUT)</EM></FONT></P>
<hr/><p><strong>Joey Baghodoughnuts</strong> on 23 Dec 2008 11:32 AM:</p><div style="margin-left: 1em"><p>Thanks for this posting. &nbsp;It has made working with the silly .NET XSLCompiledTransform a lot easier.</p>
<p>-Joe</p></div>
<hr/><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2007/04/30/2335249.html" title="Giving Yi the weight it deserves">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2007/04/29/2330455.html" title="A way better model for features, part 3 (a.k.a. downlevel LoadMUILibrary)">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2007-04">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2007-04-30">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2007/04/30/2333104.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:38 GMT -->
</html>