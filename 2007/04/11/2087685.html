<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2007/04/11/2087685.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:38 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>Microsoft is not uncaron^H^Hing about the issue!</title></head><body>
<h1>Microsoft is not uncaron^H^Hing about the issue!</h1>
<p><em>by Michael S. Kaplan, published on 2007/04/11 11:48 -04:00, original URI: http://blogs.msdn.com/b/michkap/archive/2007/04/11/2087685.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<P>Sometimes, in order get the best results in collation, one has to use constructs that from a linguistic or a Unicode general category standpoint might seem incorrect.</P>
<P>A good example is times that a character which is not on the list of <A class="" href="http://www.fileformat.info/info/unicode/category/Mn/list.htm" mce_href="http://www.fileformat.info/info/unicode/category/Mn/list.htm">Mn (Mark, Nonspacing)</A> characters in Unicode is given only diacritic weight, such as <FONT size=4>ઽ<FONT size=2> </FONT>(</FONT><A class="" href="http://www.fileformat.info/info/unicode/char/0abd" mce_href="http://www.fileformat.info/info/unicode/char/0abd">U+0abd</A> a.k.a. GUJARATI SIGN AVAGRAHA)&nbsp;that I discussed <STRONG><A class="" href="http://archives.miloush.net/michkap/archive/2007/04/10/2071471.html" mce_href="http://archives.miloush.net/michkap/archive/2007/04/10/2071471.html">here</A></STRONG> and which is an <A class="" href="http://www.fileformat.info/info/unicode/category/Lo/index.htm" mce_href="http://www.fileformat.info/info/unicode/category/Lo/index.htm">Lo (Letter, Other)</A>. The expected result in proper linguistic support in collation is achieved, but only by violating the common sense expectations about how the character ought to be classified and used.</P>
<P>Another example came from friend and former colleague Juraj who just emailed me a question&nbsp;the other day:</P>
<BLOCKQUOTE><FONT face="Times New Roman,Times" size=2><I>
<P>My friend in Slovakia asked me: "How do I ignore diacritics when doing a query on a column? I tried COLLATE Slovak_CI_AI but it didn't work. When I did for example a query WHERE Column LIKE '%C%', entries with 'Č' were not selected. Then I found a post on a forum saying that this is not a bug, but a feature. I don't understand: how is such collation useful? Can you explain?"<BR><BR>This is obviously not specific only to Slovak language (and not only to letter 'Č'), as I found through another blog post (in Czech):<BR><A href="http://blog.vyvojar.cz/mafalt/archive/2006/10/31/_0C01ED00_m-n_E100_s-mohou-p_5901_ekvapit-collations_3F00_-II_2E00_.aspx">http://blog.vyvojar.cz/mafalt/archive/2006/10/31/_0C01ED00_m-n_E100_s-mohou-p_5901_ekvapit-collations_3F00_-II_2E00_.aspx</A></P></I></FONT></BLOCKQUOTE>
<P mce_keep="true">Juraj is right -- both Czech and Slovak consider some of the letters such as <A class="" href="http://www.fileformat.info/info/unicode/char/010c" mce_href="http://www.fileformat.info/info/unicode/char/010c">U+010c</A> (LATIN CAPITAL LETTER C WITH CARON) to not be treated as a base letter plus a diacritic but instead as a character with a unique alphabetic weight, an issue I discussed previously in <STRONG><A class="" href="http://archives.miloush.net/michkap/archive/2005/02/05/367666.html" mce_href="http://archives.miloush.net/michkap/archive/2005/02/05/367666.html">this post</A></STRONG> and <STRONG><A class="" href="http://archives.miloush.net/michkap/archive/2006/01/29/518777.html" mce_href="http://archives.miloush.net/michkap/archive/2006/01/29/518777.html">this one</A></STRONG>.</P>
<P mce_keep="true">But notice what is happening both the example Juraj gave and in the Czech blog post he referenced -- people are not trying to order data, they are searching within data and are thus concerned with identity. And because of this, they consider the support that has been calibrated around the principle that ORDER and IDENTITY should be treated the same to be returning non-intuitive results.</P>
<P mce_keep="true">It actually takes me back to the issues I described in <STRONG><A class="" href="http://archives.miloush.net/michkap/archive/2005/11/13/491646.html" mce_href="http://archives.miloush.net/michkap/archive/2005/11/13/491646.html">Hungarian is even more complicated than I thought</A></STRONG> where the fact that collation algorithms such as both Microsoft's and Unicode's do not separate the kind of results produced by a <A class="" href="http://msdn.microsoft.com/library/en-us/winui/winui/windowsuserinterface/resources/strings/stringreference/stringfunctions/comparestring.asp" mce_href="http://msdn.microsoft.com/library/en-us/winui/winui/windowsuserinterface/resources/strings/stringreference/stringfunctions/comparestring.asp">CompareString</A> function and a mythical&nbsp;EqualString function.</P>
<P mce_keep="true">In the specific IDENTITY case of search, however, one can make the case that they should sometimes&nbsp;be separate, on a per-language basis -- it is pretty clear, for example,&nbsp;that most Swedes still would not want&nbsp;<STRONG>å</STRONG> (<A class="" href="http://www.fileformat.info/info/unicode/char/00e5" mce_href="http://www.fileformat.info/info/unicode/char/00e5">U+00e5</A>, a.k.a.&nbsp;LATIN SMALL LETTER A WITH RING ABOVE) to ever be treated like an ordinary <STRONG>a</STRONG> (<A class="" href="http://www.fileformat.info/info/unicode/char/0061" mce_href="http://www.fileformat.info/info/unicode/char/0061">U+0061</A>, a.k.a. LATIN SMALL LETTER A). </P>
<P mce_keep="true">The difference between the two cases is obvious, of course -- if the letter sorts nowhere near its base (as in the case of Swedish where it sorts after <STRONG>z</STRONG> rather than near <STRONG>a</STRONG>), one would probably not want search to find anything other than the character one asked for. While in the cases such as Czech and Slovak (where the letter sorts after the base character but with a unique alphabetic weight), the "folding" within search is perhaps more expected.</P>
<P mce_keep="true">HOWEVER, with that said, a simple IGNORE_NONSPACE result is also not what users would expect. They actually would in all likelihood still (when searching for <STRONG>Č</STRONG>) want the results with the CARON to be preferred, rather than simply treating the characters both with and without the CARON to be treated identically.</P>
<P mce_keep="true">This is not a feature that collation in Windows or .NET or SQL Server or the UCA in Unicode&nbsp;currently supports, and in fact the data are laid out in a way that makes it harder to do, requiring multiple passes over the data.</P>
<P mce_keep="true">This simple fact suggests possible solutions to the problem, none of which are easy but all of which are tractable. People interested in search may even want to be thinking about a whole new semantic around how to morph the meaning of the word to IGNORE to mean something more like PREFERBUTNOTREQUIRE.</P>
<P mce_keep="true">But since someone from Microsoft has pointed the issue out, you clearly can't claim that Microsoft is unCARON about the problem!</P>
<P mce_keep="true">And as an aside I think it is hilarious that most spellcheckers recommend <STRONG>uncaring</STRONG> when they see the word <STRONG>uncaron</STRONG>, my favorite "pun-as-a-psedudo-<A class="" href="http://archives.miloush.net/michkap/archive/2006/08/03/687388.html" mce_href="http://archives.miloush.net/michkap/archive/2006/08/03/687388.html">back-formation</A>" of the day!</P>
<P mce_keep="true"><EM>(this post dedicated to Petra and Oskar, the two people in the world who were special enough to draw away one of the five best collation&nbsp;testers of all time from their job in Redmond; no one will ever accuse Juraj of being unCARON!)</EM>&nbsp;</P>
<P mce_keep="true"><EM><FONT color=#ff00ff></FONT></EM>&nbsp;</P>
<P mce_keep="true"><FONT color=#ff00ff><EM>This post brought to you by</EM> č <EM>(<A class="" href="http://www.fileformat.info/info/unicode/char/010d" mce_href="http://www.fileformat.info/info/unicode/char/010d">U+010d</A>, a.k.a. LATIN SMALL LETTER C WITH CARON)</EM></FONT></P>
<hr/><div style="margin-left: 1em"><em>no comments</em></div><hr/><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2007/04/12/2098486.html" title="Can you really say international support is irreplaceable?">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2007/04/11/2086928.html" title="WinNT keyboard file source?">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2007-04">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2007-04-11">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2007/04/11/2087685.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:38 GMT -->
</html>