<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2007/04/23/2248563.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:38 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>EUDC does not require ADMIN</title></head><body>
<h1>EUDC does not require ADMIN</h1>
<p><em>by Michael S. Kaplan, published on 2007/04/23 14:31 -04:00, original URI: http://blogs.msdn.com/b/michkap/archive/2007/04/23/2248563.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<P>An interesting question came up the other day in relation to EUDC (which I have&nbsp;talked about&nbsp;<STRONG><A class="" href="http://archives.miloush.net/michkap/archive/2005/06/27/433186.html" mce_href="http://archives.miloush.net/michkap/archive/2005/06/27/433186.html">before</A></STRONG>):</P>
<BLOCKQUOTE>
<P><EM><FONT face="times new roman,times">Hi,ALL<BR><BR>I have a question about installation of&nbsp; "Private Character Fonts " using&nbsp; "users authorization".<BR><BR>Currently my customer uses windows XP and users downloads Private Character fonts files distributed by administrators, then apply them to fonts folder and update it.<BR><BR>But administrators cannot add permission to users since fonts folder doesn’t have security tab on Windows Vista.<BR><BR>Following is output of access rights when administrators run "icacls",<BR><BR>C:\Windows&gt;icacls C:\Windows\fonts<BR>C:\Windows\fonts NT SERVICE\TrustedInstaller:(F)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; NT SERVICE\TrustedInstaller:(CI)(IO)(F)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; NT AUTHORITY\SYSTEM:(M)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; NT AUTHORITY\SYSTEM:(OI)(CI)(IO)(F)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; BUILTIN\Administrators:(M)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; BUILTIN\Administrators:(OI)(CI)(IO)(F)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; BUILTIN\Users:(RX)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; BUILTIN\Users:(OI)(CI)(IO)(GR,GE)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CREATOR OWNER:(OI)(CI)(IO)(F)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <BR>I tried to change access rights by using /grant option, but I got “access denied” and couldn’t change access rights.<BR><BR>And when users access EUDC editor without UAC, following error is displayed,<BR><BR>「To use the EUDC editor,you must have write access to the Fonts folder. Ask your administrator to give you this access.」<BR><BR>But I don’t know how administrators add permissions to users.<BR><BR>Based on above information please tell me operation to add permissions to fonts folder or customized way for vista.</FONT></EM></P></BLOCKQUOTE>
<P>Now here we have&nbsp;a good example of taking a simple problem and coming up with a complex solution (and then making the solution much more complex in Vista with UAC!).</P>
<P>As a start, there is a well-documented way to install fonts created by EUDC Editor on other machines, at topics like <A class="" href="http://msdn.microsoft.com/library/en-us/intl/unicode_1b37.asp" mce_href="http://msdn.microsoft.com/library/en-us/intl/unicode_1b37.asp">this one</A>, which basically help give you an easy technique that along with a call to <A class="" href="http://msdn2.microsoft.com/library/aa964954.aspx" mce_href="http://msdn2.microsoft.com/library/aa964954.aspx">EnableEUDC</A> to clear out the cache by passing FALSE and then another to load the fonts by calling it passing TRUE, makes it easy to both provide fonts and provide updates to those fonts. And since the defined registry key is under HKCU, one does not need administrative permissions to use it!</P>
<P>Now this leads to another question: if EUDC fonts do not have to be put in the Fonts folder then why does EUDC Editor put them there? </P>
<P>And further, why does it require administrative permissions?</P>
<P>The answer those two questions (as far as I can tell) is because it was not updated and because this non-update requires those permissions to do what it was doing already.</P>
<P>But smart developers like Claude Bétrisey have pointed out that there really ought to be an easy installation method provided to ad the registry information and call <A class="" href="http://msdn2.microsoft.com/library/aa964954.aspx" mce_href="http://msdn2.microsoft.com/library/aa964954.aspx">EnableEUDC</A>&nbsp;appropriately. </P>
<P>Forcing installation through an authoring tool when no authoring is likely to be needed is like forcing you to install MSKLC to use a keyboard layout.</P>
<P>Which if we did with MSKLC, many would consider to be bad. Including me!</P>
<P>So perhaps there needs to be an update to EUDC Editor to provide installation packages that do not require administrative permissions? :-)</P>
<P><EM>(I'll talk more about EUDC another day, and I won't take as long to do so as&nbsp;I did <STRONG><A class="" href="http://archives.miloush.net/michkap/archive/2005/06/27/433186.html" mce_href="http://archives.miloush.net/michkap/archive/2005/06/27/433186.html">the last time</A></STRONG> I said I would!)</EM></P>
<P mce_keep="true">&nbsp;</P>
<P><FONT color=#ff00ff><EM>This post brought to you by</EM> <FONT size=6>㌍</FONT> <EM>(<A class="" href="http://www.fileformat.info/info/unicode/char/330d" mce_href="http://www.fileformat.info/info/unicode/char/330d">U+330d</A>, a.k.a. SQUARE KARORII)</EM></FONT></P>
<hr/><div style="margin-left: 1em"><em>no comments</em></div><hr/><p><em>referenced by</em></p><div style="margin-left: 1em"><p>2010/01/22 <a href="http://archives.miloush.net/michkap/archive/2010/01/22/9951970.html">From TTE to EUF: Possible?</a></p><p>2007/06/09 <a href="http://archives.miloush.net/michkap/archive/2007/06/09/3174676.html">Guilt by [font ]association (aka The consequences of picking the wrong font #3)</a></p></div><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2007/04/23/2250029.html" title="How long is it in the console?">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2007/04/23/2248563.html" title="EUDC does not require ADMIN">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2007-04">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2007-04-23">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2007/04/23/2248563.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:38 GMT -->
</html>