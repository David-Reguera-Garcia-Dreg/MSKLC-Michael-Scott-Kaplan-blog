<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2007/04/29/2328012.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:38 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>_wsetlocale doesn't support Unicode-only locales</title></head><body>
<h1>_wsetlocale doesn't support Unicode-only locales</h1>
<p><em>by Michael S. Kaplan, published on 2007/04/29 14:51 -04:00, original URI: http://blogs.msdn.com/b/michkap/archive/2007/04/29/2328012.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<P>There are many people who are writing code in C/C++ who try to use the more portable CRT functions rather than the Win32 ones.</P>
<P>Since in many cases the CRT functions actually wrap the Win32 functions when you run on Windows anyway, this approach allows for more portable code if you do ever want to run on other platforms.</P>
<P>This does not always work, though.</P>
<P>I was talking to Ale Contenti over on the C++ team just the other day and one of the things we talked about was the fact that the locale support sitting underneath <A class="" href="http://msdn2.microsoft.com/library/x99tb11d(vs.90).aspx" mce_href="http://msdn2.microsoft.com/library/x99tb11d(vs.90).aspx">setlocale</A> and <A class="" href="http://msdn2.microsoft.com/library/x99tb11d(vs.90).aspx" mce_href="http://msdn2.microsoft.com/library/x99tb11d(vs.90).aspx">_wsetlocale</A> was not stored in a Unicode encoding, which is why even though there is a <A class="" href="http://msdn2.microsoft.com/library/x99tb11d(vs.90).aspx" mce_href="http://msdn2.microsoft.com/library/x99tb11d(vs.90).aspx">_wsetlocale</A>&nbsp;function which clearly provides a Unicode interface to the locales, that the locales that are in fact set will not be Unicode.</P>
<P>This is why the <A class="" href="http://msdn2.microsoft.com/library/39cwe7zf(VS.90).aspx" mce_href="http://msdn2.microsoft.com/library/39cwe7zf(VS.90).aspx">language strings</A> that <A class="" href="http://msdn2.microsoft.com/library/x99tb11d(vs.90).aspx" mce_href="http://msdn2.microsoft.com/library/x99tb11d(vs.90).aspx">_wsetlocale</A>&nbsp;supports do not include any of the Unicode only languages, and why if you try to load them anyway via their three-letter windows code you can expect a lot of question marks in your future if you try to use the data that the locale provides....</P>
<P>In the end, the interface is not the most important part -- the underlying support is. So for now you'll have to stick to Win32 if you want all of the locales that the OS can support....</P>
<P mce_keep="true">&nbsp;</P>
<P><FONT color=#ff00ff><EM>This post brought to you by</EM> <FONT size=5>‡¥è</FONT> <EM>(<A class="" href="http://www.fileformat.info/info/unicode/char/0d0f" mce_href="http://www.fileformat.info/info/unicode/char/0d0f">U+0d0f</A>, a.k.a. MALAYALAM LETTER EE)</EM></FONT></P>
<hr/><div style="margin-left: 1em"><em>no comments</em></div><hr/><p><em>referenced by</em></p><div style="margin-left: 1em"><p>2008/05/02 <a href="http://archives.miloush.net/michkap/archive/2008/05/02/8449317.html">More things that don't work for locales in the CRT</a></p></div><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2007/04/29/2330455.html" title="A way better model for features, part 3 (a.k.a. downlevel LoadMUILibrary)">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2007/04/29/2322357.html" title="What type to use for code page values">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2007-04">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2007-04-29">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2007/04/29/2328012.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:38 GMT -->
</html>