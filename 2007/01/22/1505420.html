<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2007/01/22/1505420.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:38 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>Getting all of the localized names of a font[.NET]</title></head><body>
<h1>Getting all of the localized names of a font[.NET]</h1>
<p><em>by Michael S. Kaplan, published on 2007/01/22 03:01 -05:00, original URI: http://blogs.msdn.com/b/michkap/archive/2007/01/22/1505420.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<P>It was not quite a year ago that I delved into the OpenType standard to look into <STRONG><A class="" href="http://archives.miloush.net/michkap/archive/2006/02/13/530814.html" mce_href="http://archives.miloush.net/michkap/archive/2006/02/13/530814.html">Getting all of the localized names of a font</A></STRONG>.</P>
<P>If you are trying to solve the problem from .NET, it turns out the problem is a bit easier to solve since GDI+ is doing most of the heavy lifting for you. Something simple like this?</P>
<BLOCKQUOTE><FONT face="Consolas,Lucida Console,Courier New,Courier" size=2><B>
<P>using System;<BR>using System.Text;<BR>using System.Drawing;<BR>using System.Globalization;<BR><BR>namespace Testing {<BR>&nbsp;&nbsp;&nbsp; class test {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [STAThread]<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; static void Main(string[] args) {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if(args.Length == 0) {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Console.WriteLine("You must pass a font name.");<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } else {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; foreach(string st in args) {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Console.WriteLine(DumpFontNames(st));<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<BR><BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; static string DumpFontNames(string stFontName) {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; StringBuilder sb = new StringBuilder();<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; FontFamily ff = new FontFamily(stFontName);<BR><BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sb.Append(ff.Name);<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sb.Append("\r\n");<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; foreach(CultureInfo ci in CultureInfo.GetCultures(CultureTypes.SpecificCultures)) {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; string st = ff.GetName(ci.LCID);<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if(! ff.Name.Equals(st, StringComparison.OrdinalIgnoreCase)) {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sb.Append(ci.Name);<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sb.Append('\t');<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sb.Append(st);<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sb.Append("\r\n");<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return(sb.ToString());<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<BR>&nbsp;&nbsp;&nbsp; }<BR>}</P></B></FONT></BLOCKQUOTE>
<P mce_keep="true">Now before you run it you'll want to "chcp 65001" in your console window, but once you do that you'll be able to get all of the localized names that are available in the font, without having to dig into OpenType tables. </P>
<P mce_keep="true">It is hard to deny that this is a lot less work....</P>
<P mce_keep="true">Special things to note -- the use of OrdinalIgnoreCase comparisons to find the unique names (this is okay given the case insensitivity of font names following the OS casing rules, though is likely not completely necessary given the lack of font name localizations that only vary in case!) as I have never seen, as well as the <A class="" href="http://msdn2.microsoft.com/library/system.drawing.fontfamily.getname.aspx" mce_href="http://msdn2.microsoft.com/library/system.drawing.fontfamily.getname.aspx">FontFamily.GetName</A> method that is doing the&nbsp;hard work&nbsp;here.</P>
<P mce_keep="true">On the other hand, writing this code wasn't as much fun as the code in the original sample, if you know what I mean. Not sure I want to see the analysis of the reasons for that! :-)</P>
<P mce_keep="true">&nbsp;</P>
<P mce_keep="true"><FONT color=#ff00ff><EM>This post brought to you by</EM>&nbsp;ゴ <EM>(<A class="" href="http://www.fileformat.info/info/unicode/char/30b4" mce_href="http://www.fileformat.info/info/unicode/char/30b4">U+30b4</A>, a.k.a. KATAKANA LETTER GO)<BR></EM><FONT size=1><EM>(A character used in the font name </EM>ＭＳ ゴシック<EM>)</EM></FONT></FONT></P>
<hr/><div style="margin-left: 1em"><em>no comments</em></div><hr/><p><em>referenced by</em></p><div style="margin-left: 1em"><p>2011/09/13 <a href="http://archives.miloush.net/michkap/archive/2011/09/13/10209739.html">"It was an honest mistake -- I'm not running NT4; I'm just in Hong Kong!"</a></p><p>2008/07/11 <a href="http://archives.miloush.net/michkap/archive/2008/07/11/8720555.html">On installing and removing fonts, Part 4: The easiest part is the addition!</a></p></div><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2007/01/22/1506906.html" title="Confusion in the user interface can happen anywhere">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2007/01/19/1492539.html" title="For HKSCS, Vista ≫ 2004, and 2004 ≫ 2001">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2007-01">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2007-01-22">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2007/01/22/1505420.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:38 GMT -->
</html>