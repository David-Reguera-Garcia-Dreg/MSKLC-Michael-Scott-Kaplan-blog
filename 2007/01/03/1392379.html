<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2007/01/03/1392379.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:38 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>UTF-8 and GB18030 are both 'NT' code pages, they just aren't 'ANSI' code pages</title></head><body>
<h1>UTF-8 and GB18030 are both 'NT' code pages, they just aren't 'ANSI' code pages</h1>
<p><em>by Michael S. Kaplan, published on 2007/01/03 03:01 -05:00, original URI: http://blogs.msdn.com/b/michkap/archive/2007/01/03/1392379.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<P><A class="" href="http://blogs.msdn.com/user/Profile.aspx?UserID=26592" mce_href="http://blogs.msdn.com/user/Profile.aspx?UserID=26592">Michael Entin</A> asks in the Suggestion Box:</P>
<BLOCKQUOTE><I><FONT face="Times New Roman,Times" size=2>
<P>Hi Michael.<BR><BR>I want to revisit UTF-8 discussion.<BR><BR>In several posts you wrote that it is impossible to support UTF-8 as NT code page, since there is a lot of legacy code that assumes maximum of 2 bytes per char. So it is impossible to fix all this code to support UTF-8.<BR><BR>I don't quite understand how then does Windows support GB 18030 encoding? It appears it is a very similar encoding, where a character can be encoded by up to 4 bytes.<BR><BR>What are the differences between these two encodings? How come Windows can support one, but not the other?</P></FONT></I></BLOCKQUOTE>
<P mce_keep="true">I believe he is referring to <A class="" href="http://archives.miloush.net/michkap/archive/2006/07/14/665714.html" mce_href="http://archives.miloush.net/michkap/archive/2006/07/14/665714.html"><STRONG>this post</STRONG></A> and/or <STRONG><A class="" href="http://archives.miloush.net/michkap/archive/2005/02/06/368081.html" mce_href="http://archives.miloush.net/michkap/archive/2005/02/06/368081.html">this post</A></STRONG> and/or the comments in <STRONG><A class="" href="http://archives.miloush.net/michkap/archive/2006/07/04/656051.html" mce_href="http://archives.miloush.net/michkap/archive/2006/07/04/656051.html">this one</A></STRONG>....</P>
<P mce_keep="true">And it is still true that UTF-8 (code page 65001)&nbsp;cannot be an ACP ("ANSI"&nbsp;code page") for&nbsp;a locale.</P>
<P mce_keep="true">But from a technical standpoint, neither can GB-18030 (code page 54936) -- for pretty much the same reason.</P>
<P mce_keep="true">The GB-18030 question is a bit more interesting since I am pretty sure there was an official request that we change the default system code page of the zh-CN locale to GB-18030, but unfortunately the answer was the same.</P>
<P mce_keep="true">These code pages are present for people to convert things out of and to convert things into that a user might run across; they are not for the legacy ("ANSI") support in the Win32 API which, since <STRONG><A class="" href="http://archives.miloush.net/michkap/archive/2005/10/02/476213.html" mce_href="http://archives.miloush.net/michkap/archive/2005/10/02/476213.html">The Unicode train is leaving the station</A></STRONG>, are not being added to or updated. So they work great in <A class="" href="http://msdn2.microsoft.com/library/ms886760.aspx" mce_href="http://msdn2.microsoft.com/library/ms886760.aspx">MultiByteToWideChar</A> and <A class="" href="http://msdn2.microsoft.com/library/aa450989.aspx" mce_href="http://msdn2.microsoft.com/library/aa450989.aspx">WideCharToMultiByte</A>, but the core OS is not going to updated to work internally off of either one.</P>
<P mce_keep="true">Now the job would not be entirely&nbsp;impossible, though I&nbsp;suspect fairly improbable (and I say this as someone who has written a <A class="" href="http://www.microsoft.com/globaldev/handson/dev/mslu_announce.mspx" mce_href="http://www.microsoft.com/globaldev/handson/dev/mslu_announce.mspx">Unicode Layer for Win9x Systems</A> (and&nbsp;who was&nbsp;asked once by another company to&nbsp;write a UTF-8&nbsp;Encoding Layer for NT (or UELNT, I guess?), this would&nbsp;require&nbsp;a serious and non-trivial development effort, whether one is inside or outside of Microsoft. There simply isn't a specific reason or benefit to doing it that would outweigh the cost).</P>
<P mce_keep="true"><EM>Now if I ever retired, that UELNT project might be something interesting to take a&nbsp;shot at if someone really wanted to fund it. But I would probably have to run out of other stuff to do first, and that doesn't seem likely to happen any time soon.</EM> :-)</P>
<P mce_keep="true">&nbsp;</P>
<P mce_keep="true"><FONT color=#ff00ff><EM>This post brought to you by</EM>&nbsp;<FONT size=4>à»†</FONT> <EM>(<A class="" href="http://www.fileformat.info/info/unicode/char/0edc" mce_href="http://www.fileformat.info/info/unicode/char/0edc">U+0edc</A>, a.k.a. LAO KO LA)</EM></FONT></P>
<hr/><p><a id="1403256" href="#1403256">#</a> <strong>Adam</strong> on 3 Jan 2007 4:51 AM:</p><div style="margin-left: 1em"><p>&quot;[UTF-8 code pages] are not for the legacy (&quot;ANSI&quot;) support in the Win32 API which, since The Unicode train is leaving the station&quot;</p>
<p>Hmmmm....... it seems weird when I hear a lot of MS people and most of my cow-orkers talk about &quot;Unicode&quot;; they seem to think that &quot;Unicode&quot;, &quot;UCS-2&quot; and &quot;UTF-16&quot; are all the same thing, and always use the word &quot;Unicode&quot; to describe all three.</p>
<p>Most strangely, they keep claiming that UTF-8 is *not* Unicode! I hear sentences like &quot;Ah, no, that file is in UTF-8, you need to convert it to Unicode to [whatever]&quot; told to customers, and it *really* puts my teeth on edge.</p></div>
<p><a id="1403404" href="#1403404">#</a> <strong>Michael S. Kaplan</strong> on 3 Jan 2007 4:59 AM:</p><div style="margin-left: 1em"><p>Well, you can blame the people who did the Notepad &quot;file types&quot; list one that one. :-)</p>
</div>
<p><a id="9304411" href="#9304411">#</a> <strong>Stephane</strong> on 10 Jan 2009 12:41 PM:</p><div style="margin-left: 1em"><p>You say that UELNT is serious non-trivia development.</p>
<p>Unless I'm missing something, isn't it just writing wrapper functions that would do a MultiByteToWideChar(CP_UTF8,...) on the text parameters on input, call the .....A form of the function, and do a WideCharToMultiByte on the output parameters?</p>
<p>Isn't that already what most .....W functions do?</p></div>
<p><strong>Joshua</strong> on 27 Jun 2011 12:02 PM:</p><div style="margin-left: 1em"><p>I ran across a case where I really wanted this: so I could declare SQL Server&#39;s VARCHAR to be UTF-8 (using NVARCHAR would have caused us to exceed then 8000 byte row limit too easily).</p>
<p>Our use case involved embedding short strings of non-english characters (such as names) into moderate strings of english text (say 50-1000 characters). The maximum was 5500.</p>
</div>
<hr/><p><em>referenced by</em></p><div style="margin-left: 1em"><p>2011/06/22 <a href="http://archives.miloush.net/michkap/archive/2011/06/22/10177704.html">There and Back Again (aka ACP --> UTF-8 --> ACP)</a></p><p>2007/07/11 <a href="http://archives.miloush.net/michkap/archive/2007/07/11/3823291.html">GB18030 isn't an ACP, either</a></p></div><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2007/01/03/1395788.html" title="Converting a Project to Unicode: Part 7 (What does it mean to fit things to a &#39;T&#39;, anyway?)">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2007/01/02/1396598.html" title="Right behavior, wrong scenario">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2007-01">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2007-01-03">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2007/01/03/1392379.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:38 GMT -->
</html>