<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2007/01/02/1396598.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:38 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>Right behavior, wrong scenario</title></head><body>
<h1>Right behavior, wrong scenario</h1>
<p><em>by Michael S. Kaplan, published on 2007/01/02 03:01 -05:00, original URI: http://blogs.msdn.com/b/michkap/archive/2007/01/02/1396598.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<P>So the other day when I posted <STRONG><A class="" href="http://archives.miloush.net/michkap/archive/2006/12/29/1378466.html" mce_href="http://archives.miloush.net/michkap/archive/2006/12/29/1378466.html">By design? Well, not beautifully so....</A></STRONG> it was nice to see that <A class="" href="http://blogs.msdn.com/astebner/" mce_href="http://blogs.msdn.com/astebner/">Aaron Stebner</A> posted on some of the underlying setup issues behind it in his post <A class="" href="http://blogs.msdn.com/astebner/archive/2007/01/01/why-net-framework-2-0-language-packs-will-not-install-correctly-on-windows-vista.aspx" mce_href="http://blogs.msdn.com/astebner/archive/2007/01/01/why-net-framework-2-0-language-packs-will-not-install-correctly-on-windows-vista.aspx">Why .NET Framework 2.0 language packs will not install correctly on Windows Vista</A>, as well as how to work around the issue if you'd really rather just install the little buggers and not have the .NET Framework lie and claim that they are there when they are not.</P>
<P><EM>Though for what its worth I disagree with both Arron's and Marc's (original) characterization that the code I posted in </EM><A class="" href="http://archives.miloush.net/michkap/archive/2006/03/25/560838.html" mce_href="http://archives.miloush.net/michkap/archive/2006/03/25/560838.html"><STRONG><EM>Enumerating available localized language resources in .NET</EM></STRONG></A><EM> is flawed or broken. I am actually quite proud of the fact that my code honestly returns the information on the machine irregardless of the weird licensing rules of Windows and the fibs that .NET Framework language packs tell!</EM></P>
<P>Anyway, this post is not about any of that, really.</P>
<P>It is actually about an issue that Marc keeps bringing up, whether it is <A class="" href="http://musingmarc.blogspot.com/2006/01/somebody-needs-to-understand-page.html" mce_href="http://musingmarc.blogspot.com/2006/01/somebody-needs-to-understand-page.html">here</A> or <A class="" href="http://archives.miloush.net/michkap/archive/2006/03/25/560838.html#562137" mce_href="http://archives.miloush.net/michkap/archive/2006/03/25/560838.html#562137"><STRONG>here</STRONG></A> or his comments on the feedback site <A class="" href="https://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=248617" mce_href="https://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=248617">here</A>, basically an unhappiness in the way that having the download pages for the various language packs localized into.</P>
<P>Now the scenario that makes this reasonable is the one I described in <A class="" href="http://archives.miloush.net/michkap/archive/2005/12/08/501449.html" mce_href="http://archives.miloush.net/michkap/archive/2005/12/08/501449.html"><STRONG>If you can't read it, don't switch to it!</STRONG></A>. And as far as that goes, it is a reasonable scenario.</P>
<P>Anyone who does not see the logic of the scenario is probably in denial.</P>
<P>However, there is another scenario here, one that impacts both managed and unmanaged applications, and which actually is the real limitation that Marc is hitting.</P>
<P>The scenario relates to the times that you need to install all languages on a server (like a web server or a terminal server).</P>
<P>In my mind I think of it as "The Shawn Scenario™" since my colleague <A class="" href="http://blogs.msdn.com/shawnste/" mce_href="http://blogs.msdn.com/shawnste/">Shawn Steele</A> has consistently been the most likely person on the NLS dev team to mention the "<EM>what if you were on a web server and...</EM>" kind of scenario in a dev meeting. :-)</P>
<P>Now in that case, the person who would reasonably expected to be doing the installation of UI language resources is <STRONG>not</STRONG> likely to know all of the languages in question, and thus requiring the person installing all of the languages to know all of them is unrealistic.</P>
<P>Beyond the language issue, is it really reasonable to have them all be separate installs in this case? That is just time consuming and annoying, right? So it seems like it is not just the language issues that are annoying here -- it is the whole way that the langpacks exclusively exist that kind of conflicts with a reasonable scenario that is a problem here!</P>
<P>Since the scenario of a web server having all of the .NET Framework's UI languages available for ASP.NET is just as reasonable as a terminal server that people all over the world log into having all of the MUI languages installed, it is clear that <STRONG>in addition to </STRONG>the need for installs whose UI language is the same as the language being installed, there needs to be coverage of this other scenario where all of the languages can be installed at once.</P>
<P>Windows has this covered for MUI (and if you have all of the MUI langpacks in a single flat location you can install all of them at once), but currently the .NET Framework does not. In the long run, I think it would be a good scenario to cover.</P>
<P>Perhaps they could even fix the other problem where it claims the languages are installed -- I have some code that will them the real install story if they need it! :-)</P>
<P mce_keep="true">&nbsp;</P>
<P><FONT color=#ff00ff><EM>This post brought to you by</EM>&nbsp;<FONT size=5>װ</FONT> <EM>(<A class="" href="http://www.fileformat.info/info/unicode/char/05f0" mce_href="http://www.fileformat.info/info/unicode/char/05f0">U+05f0</A>, a.k.a. HEBREW LIGATURE YIDDISH DOUBLE VAV)</EM></FONT></P>
<hr/><p><a id="1401002" href="#1401002">#</a> <strong>Marc C Brooks</strong> on 2 Jan 2007 7:06 PM:</p><div style="margin-left: 1em"><p>You are right, the code to enumerate the languages is completely correct. &nbsp;I was in error believing the stupid language pack's error message (that the language pack was installed, it clearly wasn't once I dove further).</p>
<p>Once I found that the enumeration code was working correctly, I sent you that second message about WHY it was failing, and how the installations of the language packs was wrong.</p>
<p>I'm sorry I wasn't clearer in retracting the original complaint (you'll note I never blogged about that issue).</p>
<p>As it stands, the only thing I don't like about that code is the enormous number of exceptions it causes (that we catch)... I don't like that any more than I like catching Int32.Parse exceptions.</p>
</div>
<p><a id="1401252" href="#1401252">#</a> <strong>Michael S. Kaplan</strong> on 2 Jan 2007 9:08 PM:</p><div style="margin-left: 1em"><p>Which exceptions do you mean?</p>
</div>
<p><a id="1409641" href="#1409641">#</a> <strong>Marc C Brooks</strong> on 4 Jan 2007 1:35 AM:</p><div style="margin-left: 1em"><p>The ones caught by:</p>
<p> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;foreach(CultureInfo ci in CultureInfo.GetCultures(CultureTypes.SpecificCultures | CultureTypes.NeutralCultures)) {</p>
<p> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;try {</p>
<p> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Assembly satellite = assembly.GetSatelliteAssembly(ci);</p>
<p> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;// If we made it this far, we have the resources</p>
<p> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Console.WriteLine(&quot;\t&quot; + ci.Name);</p>
<p> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</p>
<p> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;catch(FileNotFoundException) {</p>
<p> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;// Swallow this exception, it means no such </p>
<p> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;// resources exist for the given language</p>
<p> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</p>
<p> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</p>
<p>For each locale NOT installed. &nbsp;Throwing exceptions isn't cheap. &nbsp;It would be so much better if there was a TryGetSatelliteAssembly that just returned a bool false if the assembly (or its fallbacks) aren't there.</p>
</div>
<p><a id="1409682" href="#1409682">#</a> <strong>Michael S. Kaplan</strong> on 4 Jan 2007 1:47 AM:</p><div style="margin-left: 1em"><p>There is also the more complicated code to just look for where the file would be in this case. Maybe something I could write up this weekend. :-)</p>
</div>
<hr/><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2007/01/03/1392379.html" title="UTF-8 and GB18030 are both &#39;NT&#39; code pages, they just aren&#39;t &#39;ANSI&#39; code pages">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2007/01/02/1395703.html" title="Converting a Project to Unicode: Part 6 (Upon the road not traveled)">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2007-01">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2007-01-02">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2007/01/02/1396598.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:38 GMT -->
</html>