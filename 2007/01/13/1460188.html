<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2007/01/13/1460188.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:38 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>RichTextBox breaking ranks?</title></head><body>
<h1>RichTextBox breaking ranks?</h1>
<p><em>by Michael S. Kaplan, published on 2007/01/13 03:01 -05:00, original URI: http://blogs.msdn.com/b/michkap/archive/2007/01/13/1460188.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<P>The other day someone noticed something about the WinForms <A class="" href="http://msdn2.microsoft.com/library/system.windows.forms.richtextbox.aspx" mce_href="http://msdn2.microsoft.com/library/system.windows.forms.richtextbox.aspx">RichTextBox</A>.</P>
<P>What he noticed was that the <A class="" href="http://msdn2.microsoft.com/library/system.windows.forms.richtextbox.savefile.aspx" mce_href="http://msdn2.microsoft.com/library/system.windows.forms.richtextbox.savefile.aspx">RichTextBox.SaveFile</A> method, specifically the <A class="" href="http://msdn2.microsoft.com/library/e4a710b1.aspx" mce_href="http://msdn2.microsoft.com/library/e4a710b1.aspx">RichTextBox.SaveFile(String, RichTextBoxStreamType)</A> overload, was not prepending the text file with a BOM when the UnicodePlainText <A class="" href="http://msdn2.microsoft.com/library/system.windows.forms.richtextboxstreamtype.aspx" mce_href="http://msdn2.microsoft.com/library/system.windows.forms.richtextboxstreamtype.aspx">RichTextBoxStreamType enumeration</A> member was passed.</P>
<P>He wondered whether this was a bug.</P>
<P>Now obviously there are lots of people outside of Microsoft (the same ones who I mentioned hate Microsoft's addition of the BOM in Notepad and other places, <STRONG><A class="" href="http://archives.miloush.net/michkap/archive/2005/01/20/357028.html" mce_href="http://archives.miloush.net/michkap/archive/2005/01/20/357028.html">previously</A></STRONG>), would consider this to be the first time that we got it right since the&nbsp;option in StreamWriters I mentioned <STRONG><A class="" href="http://archives.miloush.net/michkap/archive/2006/11/20/1108172.html" mce_href="http://archives.miloush.net/michkap/archive/2006/11/20/1108172.html">before</A></STRONG>.</P>
<P>But it is likely nothing along those lines. Just guessing, but I'd say it was probably something less strategic like just using the underlying RichEdit control's <A class="" href="http://msdn.microsoft.com/library/en-us/shellcc/platform/commctls/richedit/textobjectmodel/textobjectmodelreference/textobjectmodelinterfaces/save.asp" mce_href="http://msdn.microsoft.com/library/en-us/shellcc/platform/commctls/richedit/textobjectmodel/textobjectmodelreference/textobjectmodelinterfaces/save.asp">ITextDocument::Save</A> method rather than .NET's built-in encoding support&nbsp;(that is the method with the bogus idea that code page 1208 is UTF-8, by the way!), which although warning that the BOM ought to be included (along with some&nbsp;unclear and&nbsp;misleading&nbsp;text on Unicode recommendations):</P>
<BLOCKQUOTE>
<P><FONT face="times new roman,times"><EM>Unicode plain-text files should be saved with the Unicode byte-order mark (0xFEFF) as the first character. This character should be removed when the file is read in; that is, it is only used for import/export to identify the plain text as Unicode and to identify the byte order of that text. Microsoft Notepad adopted this convention, which is now recommended by the Unicode standard.</EM></FONT>&nbsp;</P></BLOCKQUOTE>
<P>I didn't look at the <A class="" href="http://msdn2.microsoft.com/library/system.windows.forms.richtextbox.aspx" mce_href="http://msdn2.microsoft.com/library/system.windows.forms.richtextbox.aspx">RichTextBox</A>&nbsp;source, but it is hardly an accident that so many of its properties and methods map to properties/methods/messages on the underlying&nbsp;RichEdit control.</P>
<P>So anyway, I'd say it's not a bug. But the fact that you don't have the option to include the BOM does seem to be a bit of breaking ranks from what Microsoft has usually done here....</P>
<P mce_keep="true">&nbsp;</P>
<P><FONT color=#ff00ff><EM>This post is sponsored by</EM><EM>&nbsp;</EM></FONT><EM><FONT color=#ff00ff><A class="" href="http://www.fileformat.info/info/unicode/char/feff/" mce_href="http://www.fileformat.info/info/unicode/char/feff/">U+feff</A></FONT></EM><EM><FONT color=#ff00ff>&nbsp;(ZERO WIDTH NO-BREAK SPACE)</FONT></EM></P>
<hr/><div style="margin-left: 1em"><em>no comments</em></div><hr/><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2007/01/13/1460724.html" title="Output on customer input on MSLU&#39;s ReadConsoleInputW">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2007/01/12/1454496.html" title="You&#39;ve got to be kashidding me">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2007-01">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2007-01-13">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2007/01/13/1460188.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:38 GMT -->
</html>