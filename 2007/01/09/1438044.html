<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2007/01/09/1438044.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:38 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>The Phantom [Time] Zone</title></head><body>
<h1>The Phantom [Time] Zone</h1>
<p><em>by Michael S. Kaplan, published on 2007/01/09 03:01 -05:00, original URI: http://blogs.msdn.com/b/michkap/archive/2007/01/09/1438044.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<P>Last month, after I posted <A class="" href="http://archives.miloush.net/michkap/archive/2006/12/22/1350684.html" mce_href="http://archives.miloush.net/michkap/archive/2006/12/22/1350684.html"><STRONG>Sometimes when sorting the index is the last thing you want to use</STRONG></A>, in&nbsp;response to a question from Kevin Dente.</P>
<P>I did receive another question after the discussion in the comments of that post:</P>
<BLOCKQUOTE><FONT face="Times New Romn,Times" size=2><I>
<P>Hi Michael. Sorry to bug you, but I was wondering if you might have a suggestion on how we might best go about fixing the time zone issue that we were discussing in blog comments. We are currently using the now-deprecated TimeZoneIndex value as a language independent time zone identifier that gets written in XML messages sent between systems (the message contains a timestamp in UTC and the tz identifier of the sending system). Is there another value that we can use to uniquely identify the time zone - preferably one that's independent of the localized version of Windows thats installed on the sending system? <BR><BR>Thanks much,</P></I></FONT></BLOCKQUOTE>
<P mce_keep="true">I thought this one was already answered, but we can dig in agin, I suppose. :-)</P>
<P mce_keep="true">Now I could point out that a Windows 2000 machine with latest updates has something like 74 time zones while a Windows XP machine has more like 85&nbsp;and Vista has more like 83. </P>
<P mce_keep="true">Or I could point out that time zone definitions also change all the time, so that even if two machines have as time zone they may not have the same definition (especially since not every updates the same things!).</P>
<P mce_keep="true">Or maybe I could point out that plenty of people run tools like tzedit and modify their time zones for whatever reason, good or bad.</P>
<P mce_keep="true">Or perhaps I could allude to the fact that people hae been able to create custom time zones that would be unaware of this arbitrary system.</P>
<P mce_keep="true">Or I could mention the whole issue with the changes that are in Vista that keep the registry from needing to store localized names as static registry data anyway.</P>
<P mce_keep="true">Or I could sugges that all of the supported methods of managing time zone settings and changes do not depend on this value in Vista.</P>
<P mce_keep="true">Or I could point out that until Vista this data was undocumented and subject to change (which it finally did).</P>
<P mce_keep="true">But to be honest, I don't think I want to point out any of these things. At least not in that way.</P>
<P mce_keep="true">So let me stick to the simple engineering issues that one can distill from all of these facts. Like that any application that ignores&nbsp;all this&nbsp;and tries to use the information as if it were consistently available and&nbsp;consistently the same across all machines has a design flaw that someone really need to look into fixing. There simply is no unique index that can be used here, and an application that is assuming there is has pretty much always been on borrowed time.</P>
<P mce_keep="true">This is hardly why the indexes&nbsp;went away. For what it's worth, my original guess was wrong, it had more to do&nbsp;with&nbsp;those "ultimately unsupportable" arguments which come into play here (and the confusion that unsupportabled values and using them can led to).</P>
<P mce_keep="true">So how to solve the problem? </P>
<P mce_keep="true">Well, one could certainly package the binary TZI data, which is supported in the sense that if you have it, you can stick it in calls that take a TIME_ZONE_INFORMATION and do things with it since it tells one how to change settings.</P>
<P mce_keep="true">Such an app will also give more intuitve results! I'll explain....</P>
<P mce_keep="true">If my machine says a particular event happened at a certain date and time that maps to a particular UTC date and time, then I honestly don't give a fig what time someone else's machine thinks it is. Every single attempt to map it on another machine that assumes what the other machine has can accurately describe the event as it occurred for me is simply wrong. If everyone is lucky, the wrongness may just be an hour, but there are plenty of nuances that can increase or decrease&nbsp;that across the span of possible times.</P>
<P mce_keep="true">Because in the end there are two choices: either the time zone is unimportant (in which case one can just use UTC), or it does matter (in which case it really ought to be accurate).</P>
<P mce_keep="true">Although to be honest, if one really wants to store the time I did something then why not just store the two values for the local and UTC time? If one needs more data then storing the TZI data will do the trick.</P>
<P mce_keep="true">Doing it all with that [now defunct, and never so great] index is definitely not a good answer....</P>
<P mce_keep="true">&nbsp;</P>
<P mce_keep="true"><FONT color=#ff00ff><EM>This post brought to you by</EM> <FONT size=5>âˆ„</FONT> <EM>(<A class="" href="http://www.fileformat.info/info/unicode/char/2204" mce_href="http://www.fileformat.info/info/unicode/char/2204">U+2204</A>, a.k.a. THERE DOES NOT EXIST)</EM></FONT></P>
<hr/><p><a id="1438793" href="#1438793">#</a> <strong>Mike Dimmick</strong> on 9 Jan 2007 5:43 AM:</p><div style="margin-left: 1em"><p>I'm really thinking I should pull my CodeProject article at <a rel="nofollow" target="_new" href="http://www.codeproject.com/dotnet/worldclock.asp">http://www.codeproject.com/dotnet/worldclock.asp</a>. No Vista complaints as yet, but I'm afraid I can't be bothered to fix it.</p>
</div>
<p><a id="1439884" href="#1439884">#</a> <strong>Michael S. Kaplan</strong> on 9 Jan 2007 12:51 PM:</p><div style="margin-left: 1em"><p>Well, you could always put in a note that says &quot;doesn't run with Vista&quot; on it? :-)</p>
</div>
<p><a id="1440962" href="#1440962">#</a> <strong>Dean Harding</strong> on 9 Jan 2007 5:42 PM:</p><div style="margin-left: 1em"><p>I'd like to point out the tz database again: <a rel="nofollow" target="_new" href="http://www.twinsun.com/tz/tz-link.htm">http://www.twinsun.com/tz/tz-link.htm</a></p>
<p>If you REALLY need timezone information, this is the BEST source. To be honest, the timezone information that Windows keeps is just *good enough* to satisfy the needs of Windows itself (which aren't many, frankly).</p>
<p>As far as I can tell, the tz database is updated far more often than Windows' database (several times a year, compared to how often in Windows?) and it also includes historical data (if you need that).</p>
</div>
<p><a id="9185987" href="#9185987">#</a> <strong>Halasz, Sandor</strong> on 8 Dec 2008 8:02 PM:</p><div style="margin-left: 1em"><p>This year, 2008, O&amp;E s database is on the eighth version, letter i. All but a small handful of changes are a matter of official acts, changes in local time-keeping law.</p>
<p>Note that the aforesaid link points to <a rel="nofollow" target="_new">ftp://elsie.nci.nih.gov</a>, and explains how to unpack the files.</p></div>
<hr/><p><em>referenced by</em></p><div style="margin-left: 1em"><p>2008/06/29 <a href="http://archives.miloush.net/michkap/archive/2008/06/29/8667900.html">Did someone break GetTimeZoneInformation in XP?</a></p></div><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2007/01/09/1438426.html" title="What happens to the old MUI in Vista?">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2007/01/08/1433251.html" title="Oceania doesn&#39;t document LOCALE_ITIMEMARKERUSE; Oceania has *never* documented LOCALE_ITIMEMARKERUSE">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2007-01">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2007-01-09">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2007/01/09/1438044.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:38 GMT -->
</html>