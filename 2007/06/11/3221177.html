<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2007/06/11/3221177.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:38 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>LCID vs. Powerman and the Locale-name-go-round</title></head><body>
<h1>LCID vs. Powerman and the Locale-name-go-round</h1>
<p><em>by Michael S. Kaplan, published on 2007/06/11 03:01 -04:00, original URI: http://blogs.msdn.com/b/michkap/archive/2007/06/11/3221177.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<P>(If&nbsp;you can tell what CD is playing over here in the background right now, be sure to give yourself two cool points!)</P>
<P>ph_arnaud asks over in the Suggestion Box:</P>
<BLOCKQUOTE>
<P><EM><FONT face="times new roman,times">Are there Win32 (Win2000/XP) functions that convert from LCID to Culture names with same result as CultureInfo class in managed code?<BR><BR>For example:<BR><BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ci = new CultureInfo(1041);<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Console.WriteLine("{0} {1}", ci.LCID, ci.Name);<BR><BR>results in "ja-JP"<BR><BR>However,&nbsp;Mlang-&gt;GetLcidFromRfc1766() </FONT></EM><EM><FONT face="times new roman,times">and the Mlang function LcidToRfc1766W() both return "ja"<BR><BR>Even though it is a 'close' result, the same result would be helpful in some conditions.<BR><BR>I find some LCIDs return the same value (or almost the same except for capitalization) between CultureInfo and the Mlang functions:<BR><BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1033 en-US<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2058 es-MX<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2052 zh-CN<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1028 zh-TW<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1046 pt-BR<BR><BR>But for many LCIDs the result is different (not exhaustive list, but just some more examples of differences), Mlang results do not include country name part:<BR><BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1042 ko<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1029 cs<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1038 hu<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1045 pl<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1049 ru<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1036 fr<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1031 de<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1040 it<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1034 es<BR><BR>I tried the Win32 API LCIDToLocaleName, and this does work the same as CultureInfo (gives the language-country name) for all these LCIDs. &nbsp;This would be a good choice, but unfortunately this API is Vista only, and our app must still run on XP.<BR><BR>thanks,</FONT></EM></P></BLOCKQUOTE>
<P>Ah, luckily there is that <A class="" href="http://www.microsoft.com/downloads/details.aspx?FamilyId=EB72CDA0-834E-4C35-9419-FF14BC349C9D&amp;displaylang=en" mce_href="http://www.microsoft.com/downloads/details.aspx?FamilyId=EB72CDA0-834E-4C35-9419-FF14BC349C9D&amp;displaylang=en">Microsoft National Language Support Downlevel APIs 1.0</A> out there and ready to be downloaded, huh? :-)</P>
<P>This library provides downlevel versions of the LCID/name and name/LCID mapping functions.</P>
<P>I have previously talked about this library in my <STRONG><A class="" href="http://archives.miloush.net/michkap/archive/2006/07/16/667622.html" mce_href="http://archives.miloush.net/michkap/archive/2006/07/16/667622.html">Nobody likes change</A></STRONG> post, and although I think it is not perfect (ref: <STRONG><A class="" href="http://archives.miloush.net/michkap/archive/2007/03/19/1912171.html" mce_href="http://archives.miloush.net/michkap/archive/2007/03/19/1912171.html">A way better model for features, part 2</A></STRONG>), it certainly helps provide the mappings that are being asked about here.</P>
<P>The differences that are being noted here are due to two different traditions....</P>
<P>The MLang methods return names based on the tradition expressed in <STRONG><A class="" href="http://archives.miloush.net/michkap/archive/2005/12/05/499949.html" mce_href="http://archives.miloush.net/michkap/archive/2005/12/05/499949.html">What's up with the language names?</A></STRONG>, while the .NET/Vista names are based on the later tradition that essentially repudiates the earlier one that I described in <STRONG><A class="" href="http://archives.miloush.net/michkap/archive/2007/03/11/1857176.html" mce_href="http://archives.miloush.net/michkap/archive/2007/03/11/1857176.html">Yesterday's 'justified design' is tomorrow's 'bug we fixed'</A></STRONG>.</P>
<P>Of course this is not completely true (the culture names also come from a very different place than the MLang names based on the old RFC), but the shorter names in MLang results are shorter for the same reason -- the full name is not needed to minimally represent things for those languages.</P>
<P>With the distinction now considered irrelevant going forward, I gues it just makes for a curious factoid any time someone notices the difference in behavior!</P>
<P>In any case, the downlevel library will provide the name/LCID mapping for all platforms on which it is supported....</P>
<P mce_keep="true">&nbsp;</P>
<P><FONT color=#ff00ff><EM>This post brought to you by</EM> <FONT size=5>Ç¾</FONT> <EM>(<A class="" href="http://www.fileformat.info/info/unicode/char/01fe" mce_href="http://www.fileformat.info/info/unicode/char/01fe">U+01fe</A>, a.k.a. LATIN CAPITAL LETTER O WITH STROKE AND ACUTE)</EM></FONT></P>
<hr/><p><strong>ph_arnaud</strong> on 11 Jun 2007 11:59 AM:</p><div style="margin-left: 1em"><p>Thanks for the info, sorry I didn't find your other posts when doing a few related searches.</p>
<p>This solves most of the issue, now I've learned about the XP function that gives the same result as the Vista-only version.</p>
<p>However in examining all the languages that are interesting to us, there is still one difference between the result with the CultureInfo constructor, and these downlevel (or Vista only functions)!</p>
<p>1034, CultureInfo constructor, by default (with no further specifications of sort) tells us &quot;es-ES&quot;, while the downlevel functions return &quot;es-ES_tradnl&quot; for the same LCID... &nbsp;there's always one last troublesome one - this time it wasn't zh-CN or zh-TW though...</p></div>
<p><strong>Michael S. Kaplan</strong> on 11 Jun 2007 12:07 PM:</p><div style="margin-left: 1em"><P>You have to use CultureInfo.CompareInfo.Name to get the full name including the sort for "alternate sort" locales/cultures like this one (which 0x040a is, as I discussed <A class="" href="http://archives.miloush.net/michkap/archive/2006/10/03/784459.html">here</A>).</P></div>
<hr/><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2007/06/11/3230072.html" title="The difference between C1_SPACE-ing out and drawing a C1_BLANK">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2007/06/10/3213995.html" title="Don&#39;t IM, Don&#39;t Translate">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2007-06">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2007-06-11">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2007/06/11/3221177.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:38 GMT -->
</html>