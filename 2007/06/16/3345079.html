<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2007/06/16/3345079.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:38 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>You don't have to trust Microsoft's choices about fonts</title></head><body>
<h1>You don't have to trust Microsoft's choices about fonts</h1>
<p><em>by Michael S. Kaplan, published on 2007/06/16 17:25 -04:00, original URI: http://blogs.msdn.com/b/michkap/archive/2007/06/16/3345079.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<P>You probably don't always trust Microsoft.</P>
<P>And that's OK, as far as I am concerned. Most days I don't trust it either (using the metaphor a PM I used to work with, you could fit all of the people I trust across the whole industry in a minivan and still have room for the cooler full of beer!).</P>
<P>But the thing is, if there is as given time when, as a developer, you decide to trust a result that Microsoft returns in a function, you can't really complain later if you decide you don't like the results.</P>
<P>Case in point -- a thread from the microsoft.public.win32.programmer.international newsgroup the other day from Neels:</P>
<BLOCKQUOTE>
<P><FONT face="times new roman,times">Hi,<BR><BR>I am running my app on Japanese system and want windows to use "MS Shell Dlg 2" in my property sheet. Following is the rc file text for one of my property pages -<BR><BR>IDD_PAGE_MY_PAGE DIALOGEX 0, 0, 348, 172<BR>STYLE DS_SETFONT | DS_3DLOOK | DS_FIXEDSYS | WS_POPUP | WS_CAPTION | WS_SYSMENU<BR>CAPTION "My Page"<BR>FONT 9, "MS Shell Dlg 2", 400, 0, 0x1<BR>BEGIN<BR>&nbsp;&nbsp;&nbsp; LTEXT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "This is where TAHOMA should be used..",<BR>IDC_MY_CTRL,123,65,216,48<BR>END<BR><BR>Oberservations:<BR>1) On the japanese system where I am running this property sheet, OS is Windows XP Pro SP2<BR>2) Registry key "FontSubstitutes" translates MS Shell Dlg to "MS UI Gothic" and MS Shell Dlg to "Tahoma"<BR>3) I have tried all the permutations/combinations with the resource script -<BR>&nbsp;&nbsp; a) specified "MS Shell Dlg" instead of "MS Shell Dlg 2" (according to MS, it should automatically get translated to "Tahoma")<BR>&nbsp;&nbsp; b) Used DS_SHELLFONT (although DS_SHELLFONT = DS_SETFONT | DS_FIXEDSYS)<BR>&nbsp;&nbsp; c) specified "Tahoma" after removing DS_SETFONT and DS_FIXEDSYS<BR><BR>In ALL the cases I get "MS UI Gothic" as font when I get the face name using following code in CMyPage::OnInitDialog -<BR><BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CString cs;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; LOGFONT logfont;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; GetDlgItem(IDC_MY_CTRL)-&gt;GetFont()-&gt;GetLogFont(&amp;logfont);<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; cs.Format(_T("Face Name = %s Height = %d"),logfont.lfFaceName, logfont.lfHeight);<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MessageBox(cs);<BR><BR>I can set the "MS Shell Dlg 2" programmatically but then I will have to do that for EVERY page.<BR><BR>Any idea how I can make windows use MS Shell Dlg 2 (Tahoma)? Any help will be appreciated.<BR><BR>Thanks in advance,<BR>Neel.</FONT></P></BLOCKQUOTE>
<P>Now Microsoft decided a long time ago to use the default system locale and the <A class="" href="http://archives.miloush.net/michkap/archive/2006/05/05/590504.html" mce_href="http://archives.miloush.net/michkap/archive/2006/05/05/590504.html"><STRONG>default UI language of the LocalSystem account that is not used for UI</STRONG></A> in order to help make specific decisions about how text would display in Windows. This was done with the help of various experts and contacts within the subsidiaries and affects everything from font fallback in Uniscribe to font linking in GDI and ll of the rest.</P>
<P>You may not like the results.</P>
<P>There are times, for example, that I don't --&nbsp;and this is only partially because of the fact that I am the sort of person who has to change their settings an awful lot as a part of both my job and the general things I am curious about that are probably the main reason I have the job I do.</P>
<P>But if you don't like them, then you have an obligation to not either (a) live with them or (b) stop using constructs like "MS Shell Dlg" or "MS Shell Dlg 2" or DS_SHELLFONT or any of the others, since they are built-in conveniences to make it easier for the system to work the way that Microsoft determined this aspect of the system should run.</P>
<P>They make it more convenient for the OS to do a whole bunch of things. But only if you like the final product -- if you don't, then they aren't more convenient at all.</P>
<P>If you want Tahoma then you should choose Tahoma (I don't care for it much myself because of what it does to Arabic but that's just me). You should never feel like you have to buy into a "best practices" font choice that leads to a font usage that you won't be happy with....</P>
<P mce_keep="true">&nbsp;</P>
<P><FONT color=#ff00ff><EM>This&nbsp; post brought to you by</EM> <FONT size=5>…</FONT> <EM>(<A class="" href="http://www.fileformat.info/info/unicode/char/2026" mce_href="http://www.fileformat.info/info/unicode/char/2026">U+2026</A>, a.k.a. HORIZONTAL ELLIPSIS)</EM></FONT></P>
<hr/><p><strong>Neel.</strong> on 25 Jul 2007 8:02 AM:</p><div style="margin-left: 1em"><p>Hey,</p>
<p>I updated the thread that you have referred to in this article: <a rel="nofollow" target="_new" href="http://groups.google.com/group/microsoft.public.win32.programmer.international/browse_thread/thread/65f764504ac64bc8">http://groups.google.com/group/microsoft.public.win32.programmer.international/browse_thread/thread/65f764504ac64bc8</a></p>
<p>Take a look.</p>
<p>Thanks,</p>
<p>Vishvesh</p></div>
<p><strong>Michael S. Kaplan</strong> on 25 Jul 2007 10:48 AM:</p><div style="margin-left: 1em"><p>Not sure what else to say -- the answer has already been given. DON'T USE constructs like MS Shell Dlg if you don't like their choices. If you like Tahoma, use Tahoma!</p>
</div>
<hr/><p><em>referenced by</em></p><div style="margin-left: 1em"><p>2012/01/26 <a href="http://archives.miloush.net/michkap/archive/2012/01/26/10260726.html">If font linking doesn't fit the text to a T (or ț!), a Romanian letter may be right but not quite look it</a></p></div><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2007/06/17/3349316.html" title="Good blog post titles at SIAO are all about following Beaver">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2007/06/16/3330810.html" title="Apparently the [DataGridView] train might sometimes skip a [FULL] STOP">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2007-06">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2007-06-16">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2007/06/16/3345079.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:38 GMT -->
</html>