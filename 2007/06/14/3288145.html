<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2007/06/14/3288145.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:38 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>The one-way trip of installing supplemental language support</title></head><body>
<h1>The one-way trip of installing supplemental language support</h1>
<p><em>by Michael S. Kaplan, published on 2007/06/14 09:11 -04:00, original URI: http://blogs.msdn.com/b/michkap/archive/2007/06/14/3288145.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<P>Robert asked over in the Suggestion Box:</P>
<BLOCKQUOTE>
<P><EM><FONT face="times new roman,times">In your post&nbsp;</FONT></EM><A class="" href="http://archives.miloush.net/michkap/archive/2006/02/10/529867.html"><STRONG><EM><FONT face="times new roman,times">Installing supplemental langauge support programatically</FONT></EM></STRONG></A><EM><FONT face="times new roman,times"> you strongly advised against accessing the .inf file to install Language support, pointing people to 289125 to explain how to use unattend to install a single language which would install the whole set of languages specific to that particular language set. Could you cover the opposite for Windows XP, how to programatically (or via utilities), remove an entire language set, say remove the "install files for east asian languages" or it's right to left counterpart. There's no real detail available on how to automate removal, say in the event that you had an app that throws up when some part of the "east asian" languages support was present. intl.inf allows for "LANGUAGE_COLLECTION.COMPLEX.REMOVE" but you have now scared me from using it.</FONT></EM></P></BLOCKQUOTE>
<P>Well, the easy answer, I give in <STRONG><A class="" href="http://archives.miloush.net/michkap/archive/2005/09/15/467010.html" mce_href="http://archives.miloush.net/michkap/archive/2005/09/15/467010.html">Unchecking the checkbox does not necessarily mean 'uninstall'</A></STRONG>. </P>
<P>The remove functionality that existed in Windows 2000 was somehow broken in Windows XP and Windows Server 2003.</P>
<P>And then removed entirely as a functionality along with the explicit addition of this support in Vista....</P>
<P>The harder answer is that clearly the sections for the removal are still there, and they work for the Complex Script languages.</P>
<P>And clearly the addition of both East Asian and Complex Script languages works just fine.</P>
<P>The removal is just broken, though clearly this was not intended.</P>
<P>Though technically "removal" still works, though only&nbsp;in&nbsp;a "turn the functionality" off kind of way. And a way that is not programatically accessible....</P>
<P>Programatically, there is no way to remove either one. </P>
<P><EM>(And you may find that trying to use those remove sections for East Asian languages might do the same thing and not do the actual removal of any of the files....)</EM></P>
<P>My personal feeling about an application "...<EM>that throws up when some part of the "east asian" languages support was present.</EM>" is that it should be uninstalled. And uninstalled&nbsp;with extreme prejudice, to quote that CIA operative in that part of Apocalypse Now.</P>
<P>With all that said, if someone really wants to try to go down the road of getting this functionality to work, they are completely on their own -- neither Microsoft nor I&nbsp;can support.&nbsp;Microsoft in the official sense of "if you accidentally format your hard drive then you kind of signed up for it" but me in the philosophical sense of "there are many things that, once you know them, you cannot un-know them."</P>
<P>Think of the machines without this support as young children, with no knowledge of the ways of the world. Machines that have installed EA and CS support are the adults. And attempts to lobotomize machines by making them into children again might do a lot of damage. So if you must&nbsp;proceed, then&nbsp;be careful....</P>
<P mce_keep="true">&nbsp;</P>
<P><FONT color=#ff00ff><EM>This post brought to you by</EM> <FONT size=5>„Éù</FONT> <EM>(<A class="" href="http://www.fileformat.info/info/unicode/char/30dd" mce_href="http://www.fileformat.info/info/unicode/char/30dd">U+30dd</A>, a.k.a. KATAKANA LETTER PO)</EM></FONT></P>
<hr/><p><a id="3291730" href="#3291730">#</a> <strong>GregM</strong> on 14 Jun 2007 11:20 AM:</p><div style="margin-left: 1em"><p>Normally, I would agree with you about removal of the application, except that it may not be the application's fault. &nbsp;There is a bug in USP10.dll on XP SP2 (which is installed when that box is checked, and not removed when it is later unchecked) that can only be fixed by contacting Microsoft Product Support Services to obtain a hotfix.</p>
<p>This hotfix has been available for a long time (since Nov 2005), but is not available through Windows Update or direct download from the web, and Microsoft does not allow anyone other than PSS to distribute the fix.</p>
<p>See knowledge base article 910466.</p></div>
<p><a id="3292364" href="#3292364">#</a> <strong>Michael S. Kaplan</strong> on 14 Jun 2007 11:52 AM:</p><div style="margin-left: 1em"><P>Ah yes, but that does not mean that an app should uninstall (or even want to uninstall) a system-wide component.... :-)</P></div>
<p><a id="3314755" href="#3314755">#</a> <strong>GregM</strong> on 15 Jun 2007 11:43 AM:</p><div style="margin-left: 1em"><p>Ah, but you said that your feeling was about &quot;an application &quot;...that throws up when some part of the &quot;east asian&quot; languages support was present.&quot;&quot;, not &quot;an application that is trying to uninstall a system wide component&quot;.</p>
<p>I read the request as an IT-type person looking to uninstall the component on the company's systems because an app that they use has a problem with it, not an app itself or app vendor looking to uninstall the component.</p></div>
<p><a id="3315711" href="#3315711">#</a> <strong>Michael S. Kaplan</strong> on 15 Jun 2007 1:02 PM:</p><div style="margin-left: 1em"><P>Yes, and I answered that question, too.</P>
<P>But I took the opportunity to get on my soapbox and point out why I thought that was a bad idea. And what I think of applications that can't handle language support being there.</P>
<P>Technically Microsoft has given an implied opinion of those applications, too. By removing the option and always installing language support, Microsoft is clearly expressing that such applications are NOT part of the future.</P></div>
<p><a id="3350547" href="#3350547">#</a> <strong>GregM</strong> on 16 Jun 2007 11:27 PM:</p><div style="margin-left: 1em"><p>Note that if this specific request to uninstall the component wasn't because of the specific problem I posted about, then I'm 100% in agreement with you.</p>
<p>However, as the developer who had to do the investigation of this problem when it affected our application, I can definitively say that the specific problem I posted about wasn't &quot;applications that can't handle language support being there&quot;, it was &quot;applications that can't handle buggy language support being there&quot;. &nbsp;The problem also occurs in a simple AppWizard generated console application with no changes other than linking in the less-forgiving-of-errors memory manager.</p>
<p>The problem occurs when a particular component is installed, and the fix for the component is only available from PSS. &nbsp;Thus, to the user, the obvious options are &quot;uninstall the component which caused the problem&quot; and &quot;contact PSS to obtain the hotfix for the component which caused the problem&quot;. &nbsp;If the component is not needed on that machine, then users are going to try to pursue option #1. &nbsp;I know this from first-hand experience with users that encountered this problem (oddly enough, as recently as yesterday afternoon, I must have jinxed myself by posting about it). &nbsp;They REALLY don't want to contact PSS, because they believe (rightly or wrongly) that PSS is going to try to charge them money to open the case.</p>
<p>So, yes, &quot;uninstalling language support because applications did something wrong and blow up when it's installed&quot; is bad. &nbsp;&quot;Uninstalling unused language support because it causes innocent applications to blow up&quot; is understandable. &nbsp;&quot;Fixing the broken language support&quot; is better.</p></div>
<p><a id="3351874" href="#3351874">#</a> <strong>Michael S. Kaplan</strong> on 17 Jun 2007 12:46 AM:</p><div style="margin-left: 1em"><p>Users can then go to the UI to click the checkbox, right? That solves the user problem. Without apps changing systemwide behavior....</p>
</div>
<p><a id="3352452" href="#3352452">#</a> <strong>Michael S. Kaplan</strong> on 17 Jun 2007 1:29 AM:</p><div style="margin-left: 1em"><p>And like I keep saying, in Vista it is always there.</p>
</div>
<p><a id="3370627" href="#3370627">#</a> <strong>GregM</strong> on 17 Jun 2007 8:40 PM:</p><div style="margin-left: 1em"><p>Yes, if they take the more thorough route, they can then check the box. &nbsp;In all these cases, it's not the application's fault, and it's not the apps changing anything, so blame the OS, not the application.</p></div>
<p><a id="3371781" href="#3371781">#</a> <strong>Michael S. Kaplan</strong> on 17 Jun 2007 9:41 PM:</p><div style="margin-left: 1em"><p>Yes, but the feature is not there; it does not exist. Trying to do this programatically is not supported. </p>
<p>Also, the actual problem report is rare compared to the number of people use complex script and EA support. Which gets us back to the general problem with trying to turn it off for the sake of a bug -- what if it is needed for languasge support, in other apps?</p>
<p>We could probably go back and forth on this for months, though in the end since the requested feature (programatically turning off EA/CS support) ain't there, and the suggested workaround (explain to the user they can click the checkbox) is easy to do, it is hard to believe that anything different will happen....</p>
<p>Sorry to disappoint, in any case.</p>
</div>
<p><a id="3385537" href="#3385537">#</a> <strong>GregM</strong> on 18 Jun 2007 11:23 AM:</p><div style="margin-left: 1em"><p>I think you may have misunderstood. &nbsp;My only problem with the original post was with this statement:</p>
<p>&quot;My personal feeling about an application &quot;...that throws up when some part of the &quot;east asian&quot; languages support was present.&quot; is that it should be uninstalled. And uninstalled with extreme prejudice&quot;</p>
<p>and my problem was that this statement was blaming the application, when there are known cases when it is the OS that was at fault.</p>
<p>I have no problem with there not being a programmatic way to uninstall this support.</p>
<p>I understand the user's desire to do that rather than jump through the hoops to get the hotfix, even if I don't condone it.</p></div>
<p><a id="3386522" href="#3386522">#</a> <strong>Michael S. Kaplan</strong> on 18 Jun 2007 12:20 PM:</p><div style="margin-left: 1em"><P>Fair enough. Though as a general principle I think it is a better rule (every application has bugs, every component has bugs -- one can't architect around them, after all!).</P></div>
<hr/><p><em>referenced by</em></p><div style="margin-left: 1em"><p>2008/04/26 <a href="http://archives.miloush.net/michkap/archive/2008/04/26/8426857.html">Uncheck != uninstall (even in SP3 or SP* for that matter)</a></p></div><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2007/06/14/3302077.html" title="Let&#39;s go Uniscribe / ClearType has a real good vibe / So please use them in Safari, Steve [Jobs]!">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2007/06/14/3283519.html" title="SIAO -- Upcoming live appearance">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2007-06">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2007-06-14">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2007/06/14/3288145.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:38 GMT -->
</html>