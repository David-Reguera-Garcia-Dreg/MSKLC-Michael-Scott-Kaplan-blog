<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2007/06/02/3050031.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:38 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>Objection, managed code! That zero is leading!</title></head><body>
<h1>Objection, managed code! That zero is leading!</h1>
<p><em>by Michael S. Kaplan, published on 2007/06/02 16:51 -04:00, original URI: http://blogs.msdn.com/b/michkap/archive/2007/06/02/3050031.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<P><EM>(Sorry about the title, my long term watching of Law and Order <A class="" href="http://archives.miloush.net/michkap/archive/2005/01/18/355210.html" mce_href="http://archives.miloush.net/michkap/archive/2005/01/18/355210.html"><STRONG>once again</STRONG></A> impacts the blog!)</EM>&nbsp;</P>
<P>Some may remember&nbsp;from a&nbsp;few years back the <STRONG><A class="" href="http://archives.miloush.net/michkap/archive/2005/07/16/439603.html" mce_href="http://archives.miloush.net/michkap/archive/2005/07/16/439603.html">Ambiguity of Language in the Platform SDK</A></STRONG> post which as far as I can remember is the only time I have ever talked about the LOCALE_ILZERO lctype value that one might pass to <A class="" href="http://msdn2.microsoft.com/library/ms776270.aspx" mce_href="http://msdn2.microsoft.com/library/ms776270.aspx">GetLocaleInfo</A>. In fact, it seems like that post is the only time that it has come up across all of the blogs in <A class="" href="http://blogs.msdn.com/search/SearchResults.aspx?q=%22LOCALE_ILZERO%22&amp;o=Relevance" mce_href="http://blogs.msdn.com/search/SearchResults.aspx?q=%22LOCALE_ILZERO%22&amp;o=Relevance">blogs.msdn.com</A> and <A class="" href="http://blogs.technet.com/search/SearchResults.aspx?q=%22LOCALE_ILZERO%22&amp;o=Relevance" mce_href="http://blogs.technet.com/search/SearchResults.aspx?q=%22LOCALE_ILZERO%22&amp;o=Relevance">blogs.technet.com</A>.</P>
<P>I thought about when I was looking at the newsgroups, where Edward Diener asked over in microsoft.public.dotnet.internationalization:</P>
<BLOCKQUOTE><FONT face="times new roman,times"><I>
<P>In the control panel applet for Regional and Language Options, under Regional Options, in&nbsp; the Customize... dialog, Numbers tab, there is an option for Display Leading Zeros. This is a setting related to a particular culture ( which encapsulates a locale ID ) in dotnet, and a particular locale ID in WIN32.<BR><BR>This setting determines whether or not a leading zero should be displayed before the decimal point if the decimal number is greater than -1 and less than +1, ie. it has no whole number before the decimal point.<BR><BR>In Win32 this is equivalent to the Information Type of LOCALE_ILZERO for the GetLocaleInfo/SetLocalInfo functions.<BR><BR>In dotnet the equivalent class for finding cultural numeric information is the System.Globalization.CultureInfo class with its NumberFormat property of type NumberFormatInfo.<BR><BR>Yet I can find no equivalent property in NumberFormatInfo for getting or setting the Display Leading Zeros bool value for decimal numbers in a given culture.<BR><BR>Was this erroneously left out of the dotnet cultureinfo class structure, or is it someplace else where I have not found it ? If it is someplace else I would appreciate someone pointing it out to me where it is.</P></I></FONT></BLOCKQUOTE>
<P>An interesting question, that.</P>
<P>And the answer? Well, in his question, the answer is the former -- this data item was left out of the managed world, and although the data is carried around inside of CultureInfo's data store for the sake of custom locales in Vista, it is never used by the .NET Framework. Just a&nbsp;field not added like <STRONG><A class="" href="http://archives.miloush.net/michkap/archive/2005/04/24/411329.html" mce_href="http://archives.miloush.net/michkap/archive/2005/04/24/411329.html">some others were</A></STRONG>, for whatever reasons. I could speculate as to why, but for now we'll leave that aside, if that is okay.</P>
<P>Let's take some code and try formatting with the locales whose numbers have no leading zeroes:</P>
<BLOCKQUOTE><FONT face="Consolas,Lucida Console,Courier New,Courier"><B>
<P>using System;<BR>using System.Globalization;<BR>using System.Runtime.InteropServices;<BR><BR>namespace Testing {<BR>&nbsp;&nbsp;&nbsp; class&nbsp;LeadingTest {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [DllImport("kernel32.dll", CharSet=CharSet.Unicode, ExactSpelling=true, SetLastError=true)]<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private static extern int GetLocaleInfoW(int Locale, uint LCType, out int lpLCData, int cchData);<BR><BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private const uint LOCALE_RETURN_NUMBER = 0x20000000;&nbsp;&nbsp; // return number instead of string<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private const uint LOCALE_ILZERO = 0x00000012;&nbsp;&nbsp; // leading zeros for decimal<BR><BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [STAThread]<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; static void Main(string[] args) {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; foreach(CultureInfo ci in CultureInfo.GetCultures(CultureTypes.SpecificCultures)) {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; int lpLCData;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if(GetLocaleInfoW(ci.LCID, LOCALE_ILZERO | LOCALE_RETURN_NUMBER, out lpLCData, 2) &gt; 0) {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if(lpLCData == 0) {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; float flt = 0.53f;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Console.WriteLine(ci.Name + "&nbsp;&nbsp;&nbsp; " + flt.ToString(ci));<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<BR>&nbsp;&nbsp;&nbsp; }<BR>}</P></B></FONT></BLOCKQUOTE>
<P>Even running this code on Vista shows the five locales with this exoectation, only to see the expectation dashed:</P>
<BLOCKQUOTE><FONT face="Consolas,Lucida Console,Courier New,Courier"><B>
<P>he-IL&nbsp;&nbsp;&nbsp; 0.53<BR>th-TH&nbsp;&nbsp;&nbsp; 0.53<BR>vi-VN&nbsp;&nbsp;&nbsp; 0,53<BR>zh-CN&nbsp;&nbsp;&nbsp; 0.53<BR>uz-Cyrl-UZ&nbsp;&nbsp;&nbsp; 0,53</P></B></FONT></BLOCKQUOTE>
<P>Damn, it just ain't having an impact, is it?.</P>
<P>But in Windows, it is, as you can see right in Regional and Language Options on one of those locales:</P>
<P><IMG height=833 src="http://trigeminal.fmsinc.com/images/noleadingzero.png" width=1158></P>
<P>Thus my objection that the zero is leading here for managed code when it clearly shouldn't be....</P>
<P mce_keep="true">&nbsp;</P>
<P><FONT color=#ff00ff><EM>This post brought to you by</EM> <FONT size=5>0</FONT> <EM>(<A class="" href="http://www.fileformat.info/info/unicode/char/0030" mce_href="http://www.fileformat.info/info/unicode/char/0030">U+0030</A>, a.k.a. DIGIT ZERO)</EM></FONT></P>
<hr/><p><strong>Gwyn</strong> on 2 Jun 2007 6:56 PM:</p><div style="margin-left: 1em"><p>tslled? ITYM &quot;talked&quot;. The keys are right, like next to each other ;)</p></div>
<p><strong>Michael S. Kaplan</strong> on 2 Jun 2007 7:47 PM:</p><div style="margin-left: 1em"><p>Whoops, fixed now. :-)</p>
</div>
<hr/><p><em>referenced by</em></p><div style="margin-left: 1em"><p>2012/05/22 <a href="http://archives.miloush.net/michkap/archive/2012/05/22/10308620.html">Special casing of locale specific number formatting....</a></p></div><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2007/06/02/3053824.html" title="Azeri zeriouz LIP releaze">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2007/05/31/3019659.html" title="Something .NET does less intuitively than they ought">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2007-06">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2007-06-02">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2007/06/02/3050031.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:38 GMT -->
</html>