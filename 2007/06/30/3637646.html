<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2007/06/30/3637646.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:38 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>Sometimes if the two wrongs are consistent, they may make a right!</title></head><body>
<h1>Sometimes if the two wrongs are consistent, they may make a right!</h1>
<p><em>by Michael S. Kaplan, published on 2007/07/01 02:59 -04:00, original URI: http://blogs.msdn.com/b/michkap/archive/2007/06/30/3637646.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<P>John Caffrey, one of the awesome SDETs we have over at the EDC (European Development Center) over in Dublin, sent mail the other day reporting a bug in the <A class="" href="http://msdn2.microsoft.com/library/system.globalization.cultureandregioninfobuilder.aspx" mce_href="http://msdn2.microsoft.com/library/system.globalization.cultureandregioninfobuilder.aspx">CultureAndRegionInfoBuilder class</A>:</P>
<BLOCKQUOTE>
<P><EM><FONT face="times new roman,times">Hi guys,<BR>We’ve noticed that the CalendarWeekRule setting being saved out to LDML by the CARIB is incorrect. i.e. here’s some code which repros the issue :-<BR><BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CultureAndRegionInfoBuilder carib = new CultureAndRegionInfoBuilder("en-IE", CultureAndRegionModifiers.Replacement);<BR><BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; carib.GregorianDateTimeFormat.CalendarWeekRule = CalendarWeekRule.FirstFourDayWeek;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; carib.Save("Test FirstFourDayWeek.ldml");<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // Bug: Saved LDML file contains &lt;msLocale:weekRule type="firstFullWeek" /&gt;<BR><BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; carib.GregorianDateTimeFormat.CalendarWeekRule = CalendarWeekRule.FirstFullWeek;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; carib.Save("Test FirstFullWeek.ldml");<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // Bug: Saved LDML file contains &lt;msLocale:weekRule type="firstFourDayWeek" /&gt;<BR><BR>Just wondering if this is a known issue?&nbsp;</FONT></EM></P></BLOCKQUOTE>
<P>Well, it wasn't as known issue, though it certainly is now that it has been reported!</P>
<P>As it turns out, this is only&nbsp; bug in the LDML creation code, not in the code of the piece of <A class="" href="http://msdn2.microsoft.com/library/system.globalization.cultureandregioninfobuilder.aspx" mce_href="http://msdn2.microsoft.com/library/system.globalization.cultureandregioninfobuilder.aspx">CultureAndRegionInfoBuilder</A>&nbsp;that creates custom cultures. Though it appears to be "properly" misinterpreted in both read and write operations (i.e. in both <A class="" href="http://msdn2.microsoft.com/library/system.globalization.cultureandregioninfobuilder.save.aspx" mce_href="http://msdn2.microsoft.com/library/system.globalization.cultureandregioninfobuilder.save.aspx">CultureAndRegionInfoBuilder.Save</A> and <A class="" href="http://msdn2.microsoft.com/library/system.globalization.cultureandregioninfobuilder.createfromldml.aspx" mce_href="http://msdn2.microsoft.com/library/system.globalization.cultureandregioninfobuilder.createfromldml.aspx">CultureAndRegionInfoBuilder.CreateFromLdml</A>),&nbsp;which is the most likely reason that no one noticed. :-)</P>
<P>It does lead to an interesting question as to whether it should be fixed or not -- since fixing it would break all prior versions of <A class="" href="http://msdn2.microsoft.com/library/system.globalization.cultureandregioninfobuilder.aspx" mce_href="http://msdn2.microsoft.com/library/system.globalization.cultureandregioninfobuilder.aspx">CultureAndRegionInfoBuilder</A>&nbsp;for this member as well as making LDML files written by prior versions not work as well in versions that are fixed.</P>
<P>Maybe the answer now is to leave it alone, perhaps adding a comment to the XML to explain the "mistake" in the file so no one fixes it? :-)</P>
<P>A good catch, though -- this could be really confusing for people looking at the LDML directly. Kudos to the EDC, as usual!</P>
<P mce_keep="true">&nbsp;</P>
<P><FONT color=#ff00ff><EM>This post brought to you by</EM> <FONT size=5>§</FONT> <EM>(<A class="" href="http://www.fileformat.info/info/unicode/char/00a7" mce_href="http://www.fileformat.info/info/unicode/char/00a7">U+00a7</A>, a.k.a. SECTION SIGN)</EM></FONT></P>
<hr/><p><strong>Bikedude</strong> on 1 Jul 2007 7:28 AM:</p><div style="margin-left: 1em"><p>IMO: Fixing this issue could easily just as well fix many systems that are currently not aware of the bug at all (or they're perhaps waiting to use this function in anticipation of a fix).</p>
<p>I seldom buy into the &quot;this fix can damage existing implementations&quot; philosophy. This only encourages people not to report bugs, because presumably those existing systems would have had to detect the bug in the first place, in order to work around it?</p>
<p>-- </p>
<p>Rune</p>
</div>
<p><strong>Cristian Secară</strong> on 1 Jul 2007 7:41 AM:</p><div style="margin-left: 1em"><p>The &quot;fixing it would break all prior versions of [something]&quot; remembers me of the ISO/IEC 8859-2 (Latin 2) &quot;revision&quot; (in 1998), which in fact revised nothing, thus pushing further a language problem that puzzles things over years and gave headaches to others (like Microsoft :) ...</p>
<p>Cristi</p></div>
<hr/><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2007/07/01/3654867.html" title="Is Simple MAPI simply Unicode?">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2007/06/30/3629368.html" title="Beauty is in [the] Bones?">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2007-06">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2007-06-30">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2007/06/30/3637646.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:38 GMT -->
</html>