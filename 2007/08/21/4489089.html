<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2007/08/21/4489089.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:37 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>In Case there is a bug....</title></head><body>
<h1>In Case there is a bug....</h1>
<p><em>by Michael S. Kaplan, published on 2007/08/21 03:01 -04:00, original URI: http://blogs.msdn.com/b/michkap/archive/2007/08/21/4489089.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<P><EM>(Today's title has two possible meanings, thanks to the verbal Sargasso of unclarity that is English)</EM></P>
<P>Katy King is one of the testers over in the managed world (and sometimes contributor to the <A class="" href="http://blogs.msdn.com/bclteam/" mce_href="http://blogs.msdn.com/bclteam/">BCL Team Blog</A>) who I manage to run across from time to time.</P>
<P>The main reason is that she periodically finds results that seem unexpected or inconsistent, and she wants to ask if she is missing something.</P>
<P>Now her track record is actually pretty good since pretty much all the issues she has raised are either messy things that are known and by design (but still messy) or actual bugs.</P>
<P>So if she wanted to skip the step of sending mail to ask, she wouldn't be out of line. I mean I hope she still sends the mail, since having people interested is always nice and sometimes when they are known issue the conversations get fascinating; I'd hate to lose that. :-)</P>
<P>Anyway, she found a doozy of an issue this time....</P>
<P>The bug she found was that some the case pairs seemed to be reversed!</P>
<P>Here are the <A class="" href="http://www.unicode.org/Public/UNIDATA/UnicodeData.txt" mce_href="http://www.unicode.org/Public/UNIDATA/UnicodeData.txt">UnicodeData.txt</A> entries for the eight characters:</P>
<BLOCKQUOTE>
<P><B><FONT face="consolas,lucida console,courier new,courier">1FC3;GREEK SMALL LETTER ETA WITH YPOGEGRAMMENI;Ll;0;L;03B7 0345;;;;N;;;1FCC;;1FCC<BR>1FCC;GREEK CAPITAL LETTER ETA WITH PROSGEGRAMMENI;Lt;0;L;0397 0345;;;;N;;;;1FC3;<BR><BR>1FF3;GREEK SMALL LETTER OMEGA WITH YPOGEGRAMMENI;Ll;0;L;03C9 0345;;;;N;;;1FFC;;1FFC<BR>1FFC;GREEK CAPITAL LETTER OMEGA WITH PROSGEGRAMMENI;Lt;0;L;03A9 0345;;;;N;;;;1FF3;<BR><BR>2C65;LATIN SMALL LETTER A WITH STROKE;Ll;0;L;;;;;N;;;023A;;023A<BR>023A;LATIN CAPITAL LETTER A WITH STROKE;Lu;0;L;;;;;N;;;;2C65;<BR><BR>2C66;LATIN SMALL LETTER T WITH DIAGONAL STROKE;Ll;0;L;;;;;N;;;023E;;023E<BR>023E;LATIN CAPITAL LETTER T WITH DIAGONAL STROKE;Lu;0;L;;;;;N;;;;2C66;</FONT></B></P></BLOCKQUOTE>
<P mce_keep="true">The Vista uppercase table:</P>
<BLOCKQUOTE>
<P><B><FONT face="consolas,lucida console,courier new,courier">0x1fcc&nbsp;0x1fc3&nbsp;; GREEK LETTER ETA WITH PROSGEGRAMMENI<BR>0x1ffc&nbsp;0x1ff3&nbsp;; GREEK LETTER OMEGA WITH PROSGEGRAMMENI<BR><BR>0x023a&nbsp;0x2c65&nbsp;; LATIN LETTER A WITH STROKE<BR>0x023e&nbsp;0x2c66&nbsp;; LATIN LETTER T WITH DIAGONAL STROKE</FONT></B></P></BLOCKQUOTE>
<P mce_keep="true">And the Vista Lowercase table:</P>
<BLOCKQUOTE>
<P><B><FONT face="consolas,lucida console,courier new,courier">0x1fc3&nbsp;0x1fcc&nbsp;; GREEK LETTER ETA WITH PROSGEGRAMMENI<BR>0x1ff3&nbsp;0x1ffc&nbsp;; GREEK LETTER OMEGA WITH PROSGEGRAMMENI<BR><BR>0x2c65&nbsp;0x023a&nbsp;; LATIN LETTER A WITH STROKE<BR>0x2c66&nbsp;0x023e&nbsp;; LATIN LETTER T WITH DIAGONAL STROKE</FONT></B></P></BLOCKQUOTE>
<P mce_keep="true">So indeed these four pairs have uppercase characters where one would expect lowercase, and vice versa.</P>
<P mce_keep="true">Yick!</P>
<P mce_keep="true">The interesting question is whether to fix (and when, if the decision is made to fix).</P>
<P mce_keep="true">Now for the default behavior of the filesystem and the NT object namespace, which is case preserving as I talked about in <STRONG><A class="" href="http://archives.miloush.net/michkap/archive/2007/06/13/3280569.html" mce_href="http://archives.miloush.net/michkap/archive/2007/06/13/3280569.html">this post</A></STRONG> and <STRONG><A class="" href="http://archives.miloush.net/michkap/archive/2007/06/18/3374502.html" mce_href="http://archives.miloush.net/michkap/archive/2007/06/18/3374502.html">this other one</A></STRONG>, would actually not be affected, since the characters are still treated as equal in comparisons. And since none of the characters are in any code pages, there is no non-Unicode behavioir to worry about.</P>
<P mce_keep="true">But the problem comes in for the people who actually do conversions and then use the results for thing like case insensitive hashes -- which really happens. So the fix would really require something along the lines of an "opt-in" flag for these four case pairs.</P>
<P mce_keep="true">And how did this happen?</P>
<P mce_keep="true"><EM>(People really get in to Root Cause Analysis around here, or maybe that is just me!)</EM></P>
<P mce_keep="true">Funny story, I suppose, bug this is really a bug in two parts!</P>
<P mce_keep="true">The four Greek script characters have been around since Unicode 1.1 but they were never included in the case table for some reason. When they were added, it was through an automated process that was erroneously making the assumption that uppercase comes before lowercase, which in this case it was not.</P>
<P mce_keep="true">And the four Latin script characters had the&nbsp;uppercase letters added in Unicode 4.1 and the lowercase letters added in Uncode 5.0, and it just looks like the distance between the upper and lower case letters confused things a bit. No even automated excuse, just plain old human error....</P>
<P mce_keep="true">I guess I can just console myself thinking about the fact that&nbsp;on the bright side, like over 230 other case pairs were added that weren't wrong. And people had really already been thinking about whether it made sense in the long run to add the notion of versioning to the case table, so now the issue looks like it may be forced appropriately!</P>
<P mce_keep="true">So all is not entirely lost.</P>
<P mce_keep="true">But clearly Katy deserves a raise, in any case. Keep 'em coming, Katy!</P>
<P mce_keep="true">&nbsp;</P>
<P mce_keep="true"><FONT color=#ff00ff><EM>This post brought to you by</EM> <FONT face="Segoe UI">ῃ</FONT>, <FONT face="Segoe UI">ῌ</FONT>, <FONT face="Segoe UI">ῳ</FONT>, <FONT face="Segoe UI">ῼ</FONT>, <FONT face="Segoe UI">ⱥ, <FONT face="Segoe UI">Ⱥ, <FONT face="Segoe UI">ⱦ, <EM>and</EM> <FONT face="Segoe UI">Ⱦ</FONT> <EM>(<A class="" href="http://www.fileformat.info/info/unicode/char/1fc3" mce_href="http://www.fileformat.info/info/unicode/char/1fc3">U+1fc3</A>,&nbsp;<A class="" href="http://www.fileformat.info/info/unicode/char/1fcc" mce_href="http://www.fileformat.info/info/unicode/char/1fcc">U+1fcc</A>, <A class="" href="http://www.fileformat.info/info/unicode/char/1ff3" mce_href="http://www.fileformat.info/info/unicode/char/1ff3">U+1ff3</A>, <A class="" href="http://www.fileformat.info/info/unicode/char/1ffc" mce_href="http://www.fileformat.info/info/unicode/char/1ffc">U+1ffc</A>, <A class="" href="http://www.fileformat.info/info/unicode/char/2c65" mce_href="http://www.fileformat.info/info/unicode/char/2c65">U+2c65</A>, <A class="" href="http://www.fileformat.info/info/unicode/char/023a" mce_href="http://www.fileformat.info/info/unicode/char/023a">U+023a</A>, <A class="" href="http://www.fileformat.info/info/unicode/char/2c66" mce_href="http://www.fileformat.info/info/unicode/char/2c66">U+2c66</A>,&nbsp;and&nbsp;<A class="" href="http://www.fileformat.info/info/unicode/char/023e" mce_href="http://www.fileformat.info/info/unicode/char/023e">U+023e</A>, a.k.a.&nbsp;GREEK SMALL LETTER ETA WITH YPOGEGRAMMENI, GREEK CAPITAL LETTER ETA WITH PROSGEGRAMMENI, GREEK SMALL LETTER OMEGA WITH YPOGEGRAMMENI, GREEK CAPITAL LETTER OMEGA WITH PROSGEGRAMMENI, LATIN SMALL LETTER A WITH STROKE, LATIN CAPITAL LETTER A WITH STROKE, LATIN SMALL LETTER T WITH DIAGONAL STROKE, and LATIN CAPITAL LETTER T WITH DIAGONAL STROKE)</EM></FONT></P></FONT></FONT></FONT>
<hr/><div style="margin-left: 1em"><em>no comments</em></div><hr/><p><em>referenced by</em></p><div style="margin-left: 1em"><p>2008/06/25 <a href="http://archives.miloush.net/michkap/archive/2008/06/25/8652525.html">Seeing the tears, my heart went out to her as I asked her "Why the Long S?"</a></p></div><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2007/08/22/4519235.html" title="İ şéè đêäđ ķéÿš">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2007/08/20/4489662.html" title="It doesn&#39;t always happen on the hour....">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2007-08">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2007-08-21">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2007/08/21/4489089.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:37 GMT -->
</html>