<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2007/03/11/1857043.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:38 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>Two wrongs don't make a right, and two rights can make it wrong</title></head><body>
<h1>Two wrongs don't make a right, and two rights can make it wrong</h1>
<p><em>by Michael S. Kaplan, published on 2007/03/11 03:01 -04:00, original URI: http://blogs.msdn.com/b/michkap/archive/2007/03/11/1857043.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<P>The <A class="" href="http://msdn.microsoft.com/library/en-us/winui/winui/windowsuserinterface/windowing/windows/windowreference/windowfunctions/createwindowex.asp" mce_href="http://msdn.microsoft.com/library/en-us/winui/winui/windowsuserinterface/windowing/windows/windowreference/windowfunctions/createwindowex.asp">CreateWindowEx function</A> has several flags that&nbsp;as documented are clearly&nbsp;related to right-to-left scripts:</P>
<BLOCKQUOTE>
<P><STRONG>WS_EX_LAYOUTRTL</STRONG> <BR>Arabic and Hebrew versions of Windows 98/Me, Windows 2000/XP: Creates a window whose horizontal origin is on the right edge. Increasing horizontal values advance to the left. </P>
<P><STRONG>WS_EX_LEFTSCROLLBAR</STRONG><BR>If the shell language is Hebrew, Arabic, or another language that supports reading order alignment, the vertical scroll bar (if present) is to the left of the client area. For other languages, the style is ignored.<BR>&nbsp;<BR><STRONG>WS_EX_RIGHT</STRONG> <BR>The window has generic "right-aligned" properties. This depends on the window class. This style has an effect only if the shell language is Hebrew, Arabic, or another language that supports reading-order alignment; otherwise, the style is ignored. <BR>Using the WS_EX_RIGHT style for static or edit controls has the same effect as using the SS_RIGHT or ES_RIGHT style, respectively. Using this style with button controls has the same effect as using BS_RIGHT and BS_RIGHTBUTTON styles. </P>
<P><STRONG>WS_EX_RTLREADING</STRONG> <BR>If the shell language is Hebrew, Arabic, or another language that supports reading-order alignment, the window text is displayed using right-to-left reading-order properties. For other languages, the style is ignored.</P></BLOCKQUOTE>
<P>In the&nbsp;minds of most developers who trying to support the input of right-to-left languages, it is&nbsp;quite an understatement to claim that the proper use of these flags can be quite confusing, not least of all because some of it is actually wrong in quite a few cases of every version of Windows &gt;= Windows 2000 (where one can support right-to-left scripts even when the "Shell language" is not itself a right-to-left script.</P>
<P>This particular aspect of the Windows <A class="" href="http://msdn.microsoft.com/library/en-us/winui/winui/windowsuserinterface/windowing/windows/windowreference/windowfunctions/createwindowex.asp" mce_href="http://msdn.microsoft.com/library/en-us/winui/winui/windowsuserinterface/windowing/windows/windowreference/windowfunctions/createwindowex.asp">CreateWindowEx</A> SDK topic (and its <A class="" href="http://msdn2.microsoft.com/library/aa930455.aspx" mce_href="http://msdn2.microsoft.com/library/aa930455.aspx">various</A> <A class="" href="http://msdn2.microsoft.com/ms908193.aspx" mce_href="http://msdn2.microsoft.com/ms908193.aspx">and</A> <A class="" href="http://msdn2.microsoft.com/ms960010.aspx" mce_href="http://msdn2.microsoft.com/ms960010.aspx">sundry</A> CE cousins) may not be the single most obvious case of documentation that&nbsp;should be overhauled to remove anachronistic ambiguity, confusion, and inaccuracy, but it is probably in the top five.</P>
<P>I'll try to make some suggestions here another day, but for now I'll quote some words from Tom Moore,&nbsp;a developer in Office who was recently helping someone who was having to deal with some confusing results due to the strange potential interaction of these flags:</P>
<BLOCKQUOTE>
<P><EM><FONT face="times new roman,times">...please try using only the WS_EX_LAYOUTRTL flag, without the WS_EX_RTLREADING flag.&nbsp; Because WS_EX_LAYOUTRTL will take care of both layout and reading order with the single flag.&nbsp; If you were to use both of the flags together, that would take care of layout, but the reading order would end up being left-to-right again, since the two flags will cancel each other out regarding the reading order, by reversing it twice.</FONT></EM></P></BLOCKQUOTE>
<P>Tom is 100% correct here -- if you include both the WS_EX_LAYOUTRTL and WS_EX_RTLREADING extended style flags together, you will end up with a right-to-left layout with a left-to-right reading order, which makes it obvious that these are not simple "right-to-left" flags when it comes to reading order; they are more "flip the reading order" flags.</P>
<P>So in the end, two RIGHTs in this case are almost certain to make for a WRONG... a WRONG result, that is!</P>
<P>I'll cover some of the additional issues with the documentation of these different flags and their interaction in future posts....</P>
<P mce_keep="true">&nbsp;</P>
<P><FONT color=#ff00ff><EM>This post brought to you by</EM>&nbsp;<FONT size=4>R</FONT> <EM>(<A class="" href="http://www.fileformat.info/info/unicode/char/0052" mce_href="http://www.fileformat.info/info/unicode/char/0052">U+0052</A>, a.k.a. LATIN CAPITAL LETTER R)</EM></FONT></P>
<hr/><p><strong>Ally</strong> on 31 Oct 2008 7:57 PM:</p><div style="margin-left: 1em"><p>Thanks for the tips - I had to revise our app when I was told we needed to support Arabic.</p></div>
<hr/><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2007/03/11/1857176.html" title="Yesterday&#39;s &#39;justified design&#39; is tomorrow&#39;s &#39;bug we fixed&#39;">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2007/03/09/1842581.html" title="But is it mnemonical?">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2007-03">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2007-03-11">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2007/03/11/1857043.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:38 GMT -->
</html>