<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2007/03/13/1871045.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:38 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>We need to be optimizing for more than just the simple cases</title></head><body>
<h1>We need to be optimizing for more than just the simple cases</h1>
<p><em>by Michael S. Kaplan, published on 2007/03/13 05:01 -04:00, original URI: http://blogs.msdn.com/b/michkap/archive/2007/03/13/1871045.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<P>We have to set our goals correctly.</P>
<P>The other day. Murray Sargent was asking some knowledgeable people (I'm not including myself in that assessment, as I was not added to the thread until it was several messages deep!):</P>
<BLOCKQUOTE>
<P><EM><FONT face="times new roman,times">I’m finding that NotePad on Vista is dramatically slower than on XP. I assume this is due to consideration of cool OpenType features. But if I’m only displaying ASCII with Courier New, a common scenario in viewing log files and the like, it makes no sense to invoke Uniscribe.<BR><BR>Basically a program should check to see if OT features are available that would be used for the text in question. If so, then use Uniscribe. Else go the fast route. In principle this approach could be pretty granular, e.g., down to the paragraph level.</FONT></EM></P></BLOCKQUOTE>
<P>There was a little back and forth as people did a combination of pointing out various potential&nbsp;sources of slowdown (<A class="" href="http://msdn.microsoft.com/library/en-us/gdi/fontext_0odw.asp" mce_href="http://msdn.microsoft.com/library/en-us/gdi/fontext_0odw.asp">DrawText</A> in particular was called out as a big contributor to slowdowns here)&nbsp;and people asking for more data on how the slowdown was being defined. I myself pointed out some other inefficiencies such as <A class="" href="http://archives.miloush.net/michkap/archive/2006/02/07/526359.html" mce_href="http://archives.miloush.net/michkap/archive/2006/02/07/526359.html"><STRONG>the LPK connection</STRONG></A> (a feature that is of limited use with complex script support always on as it is in Vista) and Murray pointed out how RichEdit&nbsp;handles this&nbsp;better by not using Uniscribe in "non-complex" cases (though regular readers here might remember how <STRONG><A class="" href="http://archives.miloush.net/michkap/archive/2006/05/31/611340.html" mce_href="http://archives.miloush.net/michkap/archive/2006/05/31/611340.html">that doesn't always work out</A></STRONG>, either!).</P>
<P>Then Peter Constable had what in my opinion was the best answer, one that I honestly wished I had thought to say first:</P>
<BLOCKQUOTE>
<P><FONT face="times new roman,times"><EM>Actually, the real question is whether revising the line breaking in EDIT alone would fix things. Adding logic to detect the “non-complex” case to avoid Uniscribe leaves the bad perf behavior that Hindi, Arabic, Thai, etc. users have always had. If we fix what may be the sole problem, perhaps all users will finally have reasonable perf in Notepad.</EM></FONT></P></BLOCKQUOTE>
<P>You can see why I wished I had thought to say it first. I guess the geek in me got caught up in it all with everyone looking at the problem in the simpler terms of when it was fast and when it was slow and how to better draw the line. </P>
<P><EM>My answer&nbsp;to people who want to turn off complex scripts in Notepad is usually a less polite version of Peter's response, though in my defense I am usually answering someone from the Perf team who is looking at the simple "Notepad with English text" scenario, and I am trying to get them to consider the rest of the world, while in this case my guard was not really up. It is much easier to defend a thing when it is under attack, is it not? </EM>:-)</P>
<P>In any case,&nbsp;Peter is completely right -- the best thing to do when looking at this type of issue is not to spend&nbsp;all the time trying to&nbsp;optimize for the non-complex, English-only, log file kind of scenario. Figuring out where the overall slowdowns are and <EM>then</EM> after that if there are still measurable performance issues trying to look at how to better manage the generic complex vs. non-complex text issue (including taking care of the issues that the RichEdit control in Windows misses these days!) is really the best way to go, for all languages that Windows supports....</P>
<P mce_keep="true">&nbsp;</P>
<P><FONT color=#ff00ff><EM>This post brought to you by</EM>&nbsp;<FONT size=5>ख़</FONT> <EM>(<A class="" href="http://www.fileformat.info/info/unicode/char/0959" mce_href="http://www.fileformat.info/info/unicode/char/0959">U+0959</A>, a.k.a. DEVANAGARI LETTER KHHA)</EM></FONT></P>
<hr/><p><a id="1872020" href="#1872020">#</a> <strong>Mike Dimmick</strong> on 13 Mar 2007 7:14 AM:</p><div style="margin-left: 1em"><p>If you're opening log files, you don't want to be using Notepad anyway because it will copy the entire file into contiguous RAM before beginning any rendering. Textpad (www.textpad.com) is much faster, even on XP.</p>
<p>I have a 12MB log file here that takes 18 seconds to load into Notepad. It loads in under a second in Textpad. I closed and reopened Notepad after the initial attempt to eliminate any cold-start effects, but there actually wasn't much difference in the time taken.</p>
<p>There's a serious case to be made here for carefully evaluating the controls you're using and developing a custom one if the standard controls can't meet the requirement. Notepad, as Raymond is fond of pointing out, is virtually a technology demo of the Edit control. The question is whether it should be, or whether the system should come with a decent editor.</p>
</div>
<p><a id="1872272" href="#1872272">#</a> <strong>Michael S. Kaplan</strong> on 13 Mar 2007 8:19 AM:</p><div style="margin-left: 1em"><p>Well, arguably it does -- Wordpad, the technology demo of the RichEdit control! :-)</p>
</div>
<p><a id="1876056" href="#1876056">#</a> <strong>Dean Harding</strong> on 13 Mar 2007 6:28 PM:</p><div style="margin-left: 1em"><p>I think notepad is fine for what it does, but Mike is right: you shouldn't be using it to open large log files.</p>
<p>Personally, I'm not a fan of 20MB log files at any rate, but I guess there's not much call for anything more complex... The event logging stuff in Windows is pretty cool (especially in Vista) but it's not really optimized for the megabytes-per-day that our servers generate ;)</p>
</div>
<p><a id="1878913" href="#1878913">#</a> <strong>Serge Wautier</strong> on 14 Mar 2007 3:47 AM:</p><div style="margin-left: 1em"><p>Speaking of Notepad as a Edit control wrapped into an exe, did things change in Vista? I mean these perf problems, do they occur in Notepad only or should we expect them in all our edit boxes ? (of course they rarely contain as much text as in Notepad, hence the problem shouldn't be that much scary).</p></div>
<p><a id="1880047" href="#1880047">#</a> <strong>Michael S. Kaplan</strong> on 14 Mar 2007 6:53 AM:</p><div style="margin-left: 1em"><p>Things did not change in Vista in this regard, no.</p>
</div>
<hr/><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2007/03/15/1885864.html" title="Every character has a story #25: U+00a4 (CURRENCY SYMBOL)">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2007/03/13/1850613.html" title="Track change (a.k.a. A new job that has a few things in common with the old one)">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2007-03">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2007-03-13">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2007/03/13/1871045.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:38 GMT -->
</html>