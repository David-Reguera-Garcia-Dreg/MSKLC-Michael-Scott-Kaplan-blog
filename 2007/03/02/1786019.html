<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2007/03/02/1786019.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:38 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>Aye, ye dinna ken kern</title></head><body>
<h1>Aye, ye dinna ken kern</h1>
<p><em>by Michael S. Kaplan, published on 2007/03/02 06:16 -05:00, original URI: http://blogs.msdn.com/b/michkap/archive/2007/03/02/1786019.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<P>The question was deceptively simple:</P>
<BLOCKQUOTE>
<P><EM><FONT face="times new roman,times">I’m trying to use System.Drawing.Graphics.MeasureString to calculate kerning data, but the data I’m getting back isn’t what I’d expect.&nbsp; Basically, the approach I’ve taken is to use MeasureString to calculate the length of character A, then character B, then AB&nbsp; - the two of them put together.<BR><BR>Kerning = AB.width – A.width – B.width<BR><BR>When I do this, kerning is always 0.&nbsp; Is there a parameter or state that I’m missing to set up kerning?&nbsp; I’ve also tried using MeasureCharacterRanges, but with the same result.&nbsp; I’m using times new roman font.<BR><BR>I’m trying to do a relatively simple hardware accelerated font system.&nbsp; I’m using System.Drawing to render a set of characters from a font to a temporary bitmap, which is then copied into a hardware texture.&nbsp; <BR><BR>When drawn, each character is drawn as two triangles using the correct part of the hardware texture. Each successive character is offset by the width of the previous character. I’d like the system to be able to handle kerning pairs, if possible, but I’m not sure what the best approach is to get this information.&nbsp;<BR><BR>Thanks,<BR>Eli</FONT></EM></P></BLOCKQUOTE>
<P mce_keep="true">Clearly the developer asking gave no indication that he was a Scotsman. And although I haven't posted a family tree, there are not many who would mistake me for one either.</P>
<P mce_keep="true">But that word kerning tends to being out the inner Scotsman in me, I guess? </P>
<P mce_keep="true">Kerning in typography is simply something that&nbsp;narrows the space between characters in a proportional font. It is not the process that (for example)&nbsp;keeps the <STRONG>W</STRONG> and the <STRONG>l</STRONG> from taking up the same amount of space, but it is instead&nbsp;the process that (for example)&nbsp;moves the <STRONG>V</STRONG> and the <STRONG>A</STRONG> closer together since they have that common surface that lets them get much closer like in <STRONG>VA</STRONG>.</P>
<P mce_keep="true"><EM>(You an look at the Wikipedia article on </EM><A class="" href="http://en.wikipedia.org/wiki/Kerning" mce_href="http://en.wikipedia.org/wiki/Kerning"><EM>kerning</EM></A><EM>&nbsp;for more info if you like.)</EM></P>
<P mce_keep="true">Mentally I always tend to think of kerning as kind of a static kind of capoeira-style dance&nbsp;between characters that keeps them from touching each other even as it lets them get closer. It&nbsp;might even be fun to try to create a new ClearType font called <STRONG>Capoeira</STRONG> which (with the help of a special shaping engine) would use animations to have the letters move into position in a way that looked somewhat like the martial art. </P>
<P mce_keep="true">Or maybe I am just being unrealistic. And you can likely scratch the maybe. :-)</P>
<P mce_keep="true">But as it cool as it might be, it is only one process that text goes through that can affect the calculation that the developer was trying to do. </P>
<P mce_keep="true">I mean, there are ligatures, combining characters, digraphs, the various contortions that complex scripts being us like reordering, alternate forms, alternate shapes, and so on. In modern typography there is very little text that can calculate the amount of kerning via a simple comparison of the width of a string to the width of its component letters....</P>
<P mce_keep="true">It is one of the unfortunate problems with questions that seem simple (perhaps even&nbsp;amusing/charming in a Mr. Scott kind of way&nbsp;if spoken in a polite accent of an engineer from Glasgow!). The answers often indicate that everything is much more complex than&nbsp;was at first believed....</P>
<P mce_keep="true">I'll talk more about kerning, and about how one might ideally approach this problem, another day.</P>
<P mce_keep="true">&nbsp;</P>
<P mce_keep="true"><FONT color=#ff00ff><EM>This post brought to you by</EM>&nbsp;<FONT size=5>Կ</FONT> <EM>(<A class="" href="http://www.fileformat.info/info/unicode/char/053f" mce_href="http://www.fileformat.info/info/unicode/char/053f">U+053f</A>, a.k.a. ARMENIAN CAPITAL LETTER KEN)</EM></FONT></P>
<hr/><p><a id="1788908" href="#1788908">#</a> <strong>Mihai</strong> on 2 Mar 2007 12:38 PM:</p><div style="margin-left: 1em"><p>&lt;&lt;It is one of the unfortunate problems with questions that seem simple</p>
<p>...</p>
<p>The answers often indicate that everything is much more complex than was at first believed....&gt;&gt;</p>
<p>Unfortunately the usual answer back is &quot;I don't care about all those things you just mentioned, all I care is English&quot;</p></div>
<p><a id="1789587" href="#1789587">#</a> <strong>Michael S. Kaplan</strong> on 2 Mar 2007 2:34 PM:</p><div style="margin-left: 1em"><p>English does ligatures and even digraphs in some fonts, too. :-)</p>
</div>
<p><a id="1796404" href="#1796404">#</a> <strong>RubenP</strong> on 3 Mar 2007 8:39 AM:</p><div style="margin-left: 1em"><p>Isn't the real answer here that System.Drawing doesn't support kerning at all *unless* you're using one of the few predefined 'complex scripts' GDI+ supports? (And the characters of the Latin alphabet are considered 'simple'.) And *that's* why the trick used always returns 0.</p>
<p>But granted, trying to get kerning information *in general* wouldn't work this way, and System.Drawing doesn't have any way to query such information in the right way either, even if it did support using the TrueType 'kern' or OpenType 'gpos' tables.</p>
</div>
<p><a id="1797604" href="#1797604">#</a> <strong>Michael S. Kaplan</strong> on 3 Mar 2007 11:31 AM:</p><div style="margin-left: 1em"><p>Kerning does not require complex scripts to do it work....</p>
</div>
<p><a id="1799925" href="#1799925">#</a> <strong>RubenP</strong> on 3 Mar 2007 6:40 PM:</p><div style="margin-left: 1em"><p>Well, when fonts like Times New Roman don't kern with GDI+, it's gotta need something special... Perhaps GDI+ retired the TrueType 'kern' tables. Anyway, like the original question suggests, it's not kerning, whatever the reason.</p>
<p>WPF seems to have a much better interface to getting such information, and I bet Uniscribe has even more. But that won't help our Scotsman using System.Drawing, and it certainly won't as easy as the naive approach presented above.</p>
</div>
<p><a id="1806156" href="#1806156">#</a> <strong>Dean Harding</strong> on 4 Mar 2007 6:01 PM:</p><div style="margin-left: 1em"><p>Generally, if I'm doing text in a 3D environment (which is what I assume Eli was doing), I'd write the entire line using GDI (or Uniscribe if you want to get fancy) into a texture and use a single quad to display it.</p>
<p>You don't usually have all that much text on the screen at once, so performance is rarely an issue. But you still get pretty good frame coherency - that is, if the text is on screen on frame n, it's quite likely to be on screen in frame n+1 as well, so the performance of this technique is still pretty good.</p>
<p>The main advantage to this, though, is that you don't have to worry about all the kerning, diacritic and ligature support - it's all automatic. Plus you have every Unicode character available to you, not just the ones in your texture!</p>
</div>
<hr/><p><em>referenced by</em></p><div style="margin-left: 1em"><p>2007/08/09 <a href="http://archives.miloush.net/michkap/archive/2007/08/09/4317492.html">The phantom kern get smashed, but he may invade someone else's space if he does</a></p></div><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2007/03/03/1792075.html" title="And it won&#39;t cost you an arm[enia] or a leg, either!">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2007/03/02/1785105.html" title="Maybe I need to get out more">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2007-03">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2007-03-02">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2007/03/02/1786019.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:38 GMT -->
</html>