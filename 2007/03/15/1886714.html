<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2007/03/15/1886714.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:38 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>Intuitive Shmuitive!</title></head><body>
<h1>Intuitive Shmuitive!</h1>
<p><em>by Michael S. Kaplan, published on 2007/03/15 08:01 -04:00, original URI: http://blogs.msdn.com/b/michkap/archive/2007/03/15/1886714.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<P>uberDave asked:</P>
<BLOCKQUOTE>
<P><FONT face="times new roman,times">I'm making my first forays into the world of XAML/WPF, and I'm finding it's handling of bidirectional text to be rather confusing. For example, consider this HTML fragment: <BR><BR><FONT face="courier new,courier">&nbsp;&nbsp;&nbsp; Blah &lt;span&gt;קֵינוֹ&lt;/span&gt; &lt;span&gt;123 ABC&lt;/span&gt; <BR></FONT><BR>Because the Hebrew text here is "stronger" than the '123', the numbers will get rendered to the left of the Hebrew text. However, if I want the numbers to be rendered on the other side of the Hebrew text, I can do this easily enough by adding a dir attribute to the Hebrew span: <BR><BR><FONT face="courier new,courier">&nbsp;&nbsp;&nbsp; Blah &lt;span dir='ltr'&gt;קֵינוֹ&lt;/span&gt; &lt;span&gt;123 ABC&lt;/span&gt; <BR></FONT><BR>Unfortunately, the equivalent XAML (inside a FlowDocument/Paragraph, anyway) seems to deviate from this. Specifically, <BR><BR><FONT face="courier new,courier">&nbsp;&nbsp;&nbsp; Blah &lt;Span&gt;קֵינוֹ&lt;/Span&gt; &lt;Span&gt;123 ABC&lt;/Span&gt; <BR></FONT><BR>renders identically to <BR><BR><FONT face="courier new,courier">&nbsp;&nbsp;&nbsp; Blah &lt;Span FlowDirection="LeftToRight"&gt;קֵינוֹ&lt;/Span&gt; &lt;Span&gt;123 ABC&lt;/Span&gt; <BR></FONT><BR>Incidentally, if you copy the text from any of these examples from IE/XAMLPad and paste them into Word 2003, the numbers always get rendered to the right of the Hebrew text. <BR><BR>So I've got two questions: <BR><BR>1) Is the XAML behavior a feature or a bug? <BR>2) Is there a workaround available so that I can put the numbers where I want them and still have logical text selection? I was able to fix the rendering issue by putting the Hebrew text in a TextBlock element, but this prevents text selection at the character level, which I would like to have available. </FONT></P></BLOCKQUOTE>
<P>Well, it is impossible to get everyone look at the behavior as a bug, since clearly all you have to do is add the notion of a higher level protocol giving some kind of directionality to the mix, and then you can consider the behavior to be conformant. </P>
<P>There is at least one regular reader who hates this notion, and I can't claim to be thrilled to death about it, either. The whole notion of trying to shove something as complex as the Unicode Bidi algorithm into any kind of markup environment where arbitrary sections of text are given a directionality that makes no sense (e.g. that LTR Hebrew span) is just weird. The WPF/Avalon behavior is both by design and a bug, in my opinion. Though no worse than pushing an popping strong directional formatting via the various Bidi Cf characters.,</P>
<P>The behavior in every case&nbsp;can be&nbsp;affected by this notion, since deciding what each case looks like&nbsp;can be&nbsp;influenced by the notion of the overall directionality going into the text. </P>
<P>Let's look to see what happens to the first two examples here in this browser, an arguably left-to-right kind of an environment here in the blog:</P>
<P>Blah <SPAN>קֵינוֹ</SPAN> <SPAN>123 ABC</SPAN></P>
<P>Blah <SPAN dir=ltr>קֵינוֹ</SPAN> <SPAN>123 ABC</SPAN></P>
<P>In each case, the logical order is actually unchanged. If one uses selection to look at that logical order:</P>
<P>&nbsp;<IMG src="http://trigeminal.fmsinc.com/images/bidi_1_1.png"><IMG src="http://trigeminal.fmsinc.com/images/bidi_1_2.png"><IMG src="http://trigeminal.fmsinc.com/images/bidi_1_3.png"><IMG src="http://trigeminal.fmsinc.com/images/bidi_1_4.png"><IMG src="http://trigeminal.fmsinc.com/images/bidi_1_5.png"></P>
<P><IMG src="http://trigeminal.fmsinc.com/images/bidi_2_1.png"><IMG src="http://trigeminal.fmsinc.com/images/bidi_2_2.png"><IMG src="http://trigeminal.fmsinc.com/images/bidi_2_3.png"><IMG src="http://trigeminal.fmsinc.com/images/bidi_2_4.png"><IMG src="http://trigeminal.fmsinc.com/images/bidi_2_5.png"><IMG src="http://trigeminal.fmsinc.com/images/bidi_2_6.png"></P>
<P>Notice how the logical order never really changed no matter what kind of games were being played with directionality? The Hebrew, which is there first logically, is always first before the numbers. That behavior kind makes sense to me (though the whole LTR Hebrew thing does not), which&nbsp;might tend to make the ones that behave differently seem like bugs. Though the text sees wrong to me anyway so what is proven here? What is the strength of preserving a logical order that has nothing to do with the visual one? Maybe it helps searching while allowing bogus displays of text, but that hardly seems like a virtue.</P>
<P>In the end, what I hate most about the Bidi algorithm is its intricate rules that are designed around weird edge cases that may or may not be valid, with very little in the way of genuine strings to prove the need to define all of the strange cases. Perhaps I am alone in feeling this way, but if one were forced to come up with actual text and a need to display it in a particular way, the whole thing would not only be simpler and easier to implement, but it would also end up seeming a lot more intuitive.</P>
<P>So the real notion of an unchanged logical order is obfuscated by all of their higher level protocol rules of spans and their directionality. To allow complex display to happen that still does not chaneg the logical order -- something that is ultimately not very intuitive.</P>
<P>That's just my opinion, I am sure there are people who will think me&nbsp;wrong in this regard.... :-)</P>
<P mce_keep="true">&nbsp;</P>
<P><FONT color=#ff00ff><EM>This post brought to you by</EM> <FONT size=5>ק</FONT> <EM>(<A class="" href="http://www.fileformat.info/info/unicode/char/05e7" mce_href="http://www.fileformat.info/info/unicode/char/05e7">U+05e7</A>, a.k.a. HEBREW LETTER QOF)</EM></FONT></P>
<hr/><div style="margin-left: 1em"><em>no comments</em></div><hr/><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2007/03/15/1890287.html" title="Killing time and brain cells at the DMV">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2007/03/15/1885864.html" title="Every character has a story #25: U+00a4 (CURRENCY SYMBOL)">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2007-03">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2007-03-15">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2007/03/15/1886714.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:38 GMT -->
</html>