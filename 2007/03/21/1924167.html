<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2007/03/21/1924167.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:38 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>Warning: when private is used in public, it can really suck</title></head><body>
<h1>Warning: when private is used in public, it can really suck</h1>
<p><em>by Michael S. Kaplan, published on 2007/03/21 03:02 -04:00, original URI: http://blogs.msdn.com/b/michkap/archive/2007/03/21/1924167.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<P>Jeffrey's question earlier today:</P>
<BLOCKQUOTE>
<P><EM><FONT face="times new roman,times">Hi experts, <BR><BR>My customer has a custom designed font with some special characters in the Private Use Area (PUA). He is having a problem when trying to paste these characters (as text) into a RichEdit control in his application. Basically the character that gets displayed in the RichEdit is not the one he pasted in even though the font in the RichEdit control is set to his font.<BR><BR>For example, if he pastes in character 0xF012 (which is an 'x' with a bar on top) from Notepad, he instead got a double-headed vertical arrow character, which we are not even convinced is from his font. A similar replacement seems to happen for most of his PUA characters.<BR><BR>This occurs on Windows XP, so RichEdit 4.1 we think.<BR><BR>Any ideas on this strange problem? </FONT></EM></P></BLOCKQUOTE>
<P>Well, I had my suspicions, but <A class="" href="http://blogs.msdn.com/murrays/" mce_href="http://blogs.msdn.com/murrays/">Murray</A> pointed out the actual problem, and it actually relates to the way that SYMBOL FONTS map to the PUA, as I have discussed <STRONG>in</STRONG> previous posts like <STRONG><A class="" href="http://archives.miloush.net/michkap/archive/2005/11/08/490495.html" mce_href="http://archives.miloush.net/michkap/archive/2005/11/08/490495.html">More than you ever wanted to know about CP_SYMBOL</A></STRONG>, <STRONG><A class="" href="http://archives.miloush.net/michkap/archive/2006/12/03/1196177.html" mce_href="http://archives.miloush.net/michkap/archive/2006/12/03/1196177.html">Strangely Symbolic font issues</A></STRONG>, and <A class="" href="http://archives.miloush.net/michkap/archive/2006/04/27/584859.html" mce_href="http://archives.miloush.net/michkap/archive/2006/04/27/584859.html"><STRONG>'Doctor, it hurts when I do this.' Well, don't do that!</STRONG></A></P>
<P>The solution for dealing this over-eager helping out that RichEdit does with the PUA code points between <A class="" href="http://www.fileformat.info/info/unicode/char/f000" mce_href="http://www.fileformat.info/info/unicode/char/f000">U+f000</A> and <A class="" href="http://www.fileformat.info/info/unicode/char/f0ff" mce_href="http://www.fileformat.info/info/unicode/char/f0ff">U+f0ff</A>&nbsp;(I would start the range at <A class="" href="http://www.fileformat.info/info/unicode/char/f020" mce_href="http://www.fileformat.info/info/unicode/char/f020">U+f020</A>&nbsp;but they apparently do this weird font behavior starting with <A class="" href="http://www.fileformat.info/info/unicode/char/f000" mce_href="http://www.fileformat.info/info/unicode/char/f000">U+f000</A>.</P>
<P>Well, avoid that small&nbsp;section of the PUA if you want to use RichEdit, because even if they take out this functionality in the future there are going to be multiple existing versions that are going to do this.</P>
<P>Now I personally find this behavior to be inexcusably <STRONG><A class="" href="http://archives.miloush.net/michkap/archive/tags/Unicode+Lame+List/default.aspx" mce_href="../../../../archive/tags/Unicode+Lame+List/default.aspx">lame</A></STRONG>, and putting in such a a public contract for use of the PRIVATE USE AREA is just really ugly....</P>
<P>But at least we know why RichEdit is doing what it is....</P>
<P mce_keep="true">&nbsp;</P>
<P><FONT color=#ff1493><FONT face=Tahoma><EM>This post brought to you by</EM> </FONT></FONT><A class="" href="http://www.fileformat.info/info/unicode/char/f020" mce_href="http://www.fileformat.info/info/unicode/char/f020"><FONT face=Tahoma>U+f020</FONT></A><FONT face=Tahoma color=#ff1493>,&nbsp;a &lt;Private Use&gt; character </FONT></P>
<hr/><div style="margin-left: 1em"><em>no comments</em></div><hr/><p><em>referenced by</em></p><div style="margin-left: 1em"><p>2007/05/21 <a href="http://archives.miloush.net/michkap/archive/2007/05/21/2782610.html">MS Word says PUA is EA/CJK? TISNF!</a></p></div><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2007/03/22/1929762.html" title="When language codes are reported that don&#39;t actually exist">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2007/03/21/1923275.html" title="Somewhat irreverent theories on the origins of the alphabet">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2007-03">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2007-03-21">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2007/03/21/1924167.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:38 GMT -->
</html>