<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2007/10/30/5774614.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:37 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>EXPECTED is in the eye of the [non-expecting type of ]expectant</title></head><body>
<h1>EXPECTED is in the eye of the [non-expecting type of ]expectant</h1>
<p><em>by Michael S. Kaplan, published on 2007/10/30 10:31 -04:00, original URI: http://blogs.msdn.com/b/michkap/archive/2007/10/30/5774614.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<P>Lori asked:</P>
<BLOCKQUOTE>
<P><FONT face="times new roman,times"><EM>I’m seeing results with VB’s StrComp function that I would not expect.&nbsp; For example:<BR><BR></EM></FONT><FONT face="times new roman,times"><EM>&nbsp;&nbsp;&nbsp; StrComp("Lee-P", "Leema", vbTextCompare)<BR><BR></EM></FONT><FONT face="times new roman,times"><EM>Returns 1, but<BR><BR></EM></FONT><FONT face="times new roman,times"><EM>&nbsp;&nbsp;&nbsp; StrComp("Lee-P", "Leema", vbBinaryCompare) <BR><BR></EM></FONT><FONT face="times new roman,times"><EM>Returns -1 as I would expect.<BR><BR></EM></FONT><FONT face="times new roman,times"><EM>Why does this first return a 1 rather than -1?&nbsp; <BR><BR></EM></FONT><FONT face="times new roman,times"><EM>PS: I see the same behavior in VB6 as well as VB.NET.</EM></FONT></P></BLOCKQUOTE>
<P>This may look familiar to regular readers, especially people who have seen <A class="" href="http://archives.miloush.net/michkap/archive/2006/11/25/1151550.html" mce_href="http://archives.miloush.net/michkap/archive/2006/11/25/1151550.html"><STRONG>Punctuation... now, isn't that SPECIAL [weights]?</STRONG></A> or the more recent <A class="" href="http://archives.miloush.net/michkap/archive/2007/09/20/5008305.html" mce_href="http://archives.miloush.net/michkap/archive/2007/09/20/5008305.html"><STRONG>A&amp;P of Sort Keys, part 9 (aka Not always transitive, but punctual and punctuating)</STRONG></A>....</P>
<P>Yes, it is good old word sorting -- VB does it too! :-)</P>
<P><EM>(The vbBinaryCompare constant is what it sounds like, and the vbTextCompare one is the default user locale)</EM></P>
<P><STRONG>Expected</STRONG> really is in the eye of the beholder, ain't it?</P>
<P>Now, we are sitting on the opposite side of an implementation that was first written over 15 years ago, though I wonder whether in retrospect it would be more intuitive to make SORT_STRINGSORT the default behavior and only do word sorting when it was explicitly asked for. There would be fewer complaints about cases that are not as intuitive since they aren't as straightforward as the <STRONG>co-op</STRONG> vs. <STRONG>coop</STRONG> case, but at the cost of a lot of less than ideal results. </P>
<P>I have gone back and forth on this one a whole bunch -- trying to make it easier on confused developers, trying to make it better for ordinary users who just wouldn't be expecting punctuation symbols to be weighed so heavily.</P>
<P>Kind of a time waster, but every time this issue comes up I walk through the alternatives again....</P>
<P>Which is better? If it were up to you, what would you have suggested as the default a decade and a half ago?</P>
<P mce_keep="true">&nbsp;</P>
<P><FONT color=#ff00ff><EM>This post brought to you by</EM><FONT size=5> - </FONT><EM>(<A class="" href="http://www.fileformat.info/info/unicode/char/002d" mce_href="http://www.fileformat.info/info/unicode/char/002d">U+002d</A>, a.k.a. HYPHEN-MINUS)</EM></FONT></P>
<hr/><p><a id="5789585" href="#5789585">#</a> <strong>John Bates</strong> on 30 Oct 2007 10:31 PM:</p><div style="margin-left: 1em"><p>I've been burnt by not-so-obvious defaults and other implicit API behaviours ... the memories still painful.</p>
<p>I would have chosen an option for both, something like vbWordCompare and vbStringCompare.</p>
<p>And I might have chosen 'Exact' (with Word and String variants) instead of 'Binary' -- I've seen people confused over this one.</p></div>
<p><a id="5797653" href="#5797653">#</a> <strong>Michael S. Kaplan</strong> on 31 Oct 2007 8:11 AM:</p><div style="margin-left: 1em"><P>Ah, no way to combine the <STRONG>binary</STRONG> with <STRONG>word</STRONG>/<STRONG>string</STRONG> sorting -- but most people find <STRONG>binary</STRONG> much less confusing than the new word first introduced in .NET -- <STRONG>ordinal</STRONG>.</P></div>
<hr/><p><em>referenced by</em></p><div style="margin-left: 1em"><p>2010/06/10 <a href="http://archives.miloush.net/michkap/archive/2010/06/10/10021417.html">WORD SORT...Why'd it have to be...WORD SORT?</a></p></div><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2007/10/31/5790802.html" title="Making things better out from under people: the story of MUI">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2007/10/30/5773071.html" title="How are *you* feeling today? And can I quote you on that?">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2007-10">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2007-10-30">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2007/10/30/5774614.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:37 GMT -->
</html>