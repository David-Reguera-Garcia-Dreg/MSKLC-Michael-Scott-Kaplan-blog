<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2007/10/24/5647711.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:37 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>Getting the preserved case of a file wHeN tHe uSeRs tYpE wHaTeVeR tHe hElL tHeY wAnT tO</title></head><body>
<h1>Getting the preserved case of a file wHeN tHe uSeRs tYpE wHaTeVeR tHe hElL tHeY wAnT tO</h1>
<p><em>by Michael S. Kaplan, published on 2007/10/24 10:16 -04:00, original URI: http://blogs.msdn.com/b/michkap/archive/2007/10/24/5647711.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<P>I&nbsp;gave&nbsp;blathered about the&nbsp;importance of preserving case and of getting the preserved case in posts like <A class="" href="http://archives.miloush.net/michkap/archive/2007/06/13/3280569.html" mce_href="http://archives.miloush.net/michkap/archive/2007/06/13/3280569.html"><STRONG>In any CASE, it is somewhat INSENSITIVE to point out to someone how well PRESERVED they are</STRONG></A> and <A class="" href="http://archives.miloush.net/michkap/archive/2007/06/18/3374502.html" mce_href="http://archives.miloush.net/michkap/archive/2007/06/18/3374502.html"><STRONG>If you don't always preserve case, you don't always preserve meaning</STRONG></A>,&nbsp;and <A class="" href="http://archives.miloush.net/michkap/archive/2007/10/02/5236576.html" mce_href="http://archives.miloush.net/michkap/archive/2007/10/02/5236576.html"><STRONG>What happens when people don't consistently preserve case? They cause bugs!</STRONG></A>. But I haven't talked much about how to get that preserved case....</P>
<P>Then by coincidence someone asked how this is done in .NET!</P>
<P>Inbar's question, which properly balances how to preserve case even in the face of user input that may not match the case of the file, was:</P>
<BLOCKQUOTE>
<P><EM><FONT face="times new roman,times">Does anyone know how to use System.IO to get the preserved case of a file-name?&nbsp; For example say the user gives me the filename “FoO.tXt” and the file on disk is stored as “foo.txt”.&nbsp; I can certainly open the file using “FoO.tXt” or “foo.txt” or any other casing I choose.&nbsp; But how do I get the original casing?</FONT></EM></P></BLOCKQUOTE>
<P>The solution can be found in a call to <A class="" href="http://msdn2.microsoft.com/library/wz42302f.aspx" mce_href="http://msdn2.microsoft.com/library/wz42302f.aspx">System.IO.Directory.GetFiles(String path, string searchPattern)</A>. </P>
<P>The return value in array of files that match the search pattern in their actual case on disk, and when the search pattern is restrictive enough (no wild cards, I mean -- just the file name itself), it will return an array containing just the one entry.</P>
<P>Of course that entry point does take wildcards, so if the filename is something provided by the user then if they include&nbsp;a wildcard the method would return multiple files -- you would want to decide what is the acceptable behavior there is -- select multiple files, give an error, whatever. It is likely that just choosing the first file only is probably a bad idea here....</P>
<P>This method will completely respect the rules of the directory being looked in when you think about issues like case, an issue I will be exploring in an upcoming post minutes from now in a post entitled <A class="" href="http://archives.miloush.net/michkap/archive/2007/10/24/5641619.html" mce_href="http://archives.miloush.net/michkap/archive/2007/10/24/5641619.html"><STRONG>In Case you have problems that you might think are ǸȦȘȚȲ</STRONG></A>. This respect becomes very important, as you'll see when you see how NASTY (or should I say ǸȦȘȚȲ?) the directory can become depending on when it was formatted and sometimes even when it was updated by CHKDSK (an issue I'll talk about a little there but will cover more fully another day).</P>
<P>Undernath it all, the various overloads of GetFiles all depend on Win32's <A class="" href="http://msdn2.microsoft.com/library/aa364418.aspx" mce_href="http://msdn2.microsoft.com/library/aa364418.aspx">FindFirstFile</A>/<A class="" href="http://msdn2.microsoft.com/library/aa364428.aspx" mce_href="http://msdn2.microsoft.com/library/aa364428.aspx">FindNextFile</A> to get their work done, which should give hints on both how the wildcard behavior will actually work and also how to accomplish the same goal in Win32.</P>
<P>Now&nbsp;file system stuff is covered here, but the entire issue does not work exactly this way in the case of URLs, a definite subject for another time....</P>
<P mce_keep="true">&nbsp;</P>
<P><FONT color=#ff00ff><EM>This post brought to you by</EM> <FONT size=5>*</FONT> <EM>(<A class="" href="http://www.fileformat.info/info/unicode/char/002a" mce_href="http://www.fileformat.info/info/unicode/char/002a">U+002a</A>, a.k.a. ASTERISK)</EM></FONT></P>
<hr/><div style="margin-left: 1em"><em>no comments</em></div><hr/><p><em>referenced by</em></p><div style="margin-left: 1em"><p>2007/10/24 <a href="http://archives.miloush.net/michkap/archive/2007/10/24/5641619.html">In Case you have problems that you might think are ǸȦȘȚȲ</a></p></div><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2007/10/25/5660239.html" title="Ding dong, the hack is gone (aka Cutting the hacked cord, too)">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2007/10/24/5641619.html" title="In Case you have problems that you might think are ǸȦȘȚȲ">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2007-10">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2007-10-24">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2007/10/24/5647711.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:37 GMT -->
</html>