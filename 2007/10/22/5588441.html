<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2007/10/22/5588441.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:37 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>Traditional to Simplified or vice-versa? According to Windows, you're on your own....</title></head><body>
<h1>Traditional to Simplified or vice-versa? According to Windows, you're on your own....</h1>
<p><em>by Michael S. Kaplan, published on 2007/10/22 10:16 -04:00, original URI: http://blogs.msdn.com/b/michkap/archive/2007/10/22/5588441.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<P>Stephen asks via the Contact link:</P>
<BLOCKQUOTE><FONT face="times new roman,times" size=2>
<P><EM>I'm making a program doing a Traditional/Simplified Chinese conversion in Delphi. However, all the web pages shown in Google search results are LCMapString. I did try using this LCMapString. LCMapString can do a mapping of 26xx characters. However, I find that it can't do a correct conversion mapping from Traditional to Simplified one.<BR><BR>I wrote a simple routine to convert a list of the 26xx Traditional Chinese Characters. Then compare the result to a list of the characters in Simplified Chinese. The LCMapString can only convert 22xx characters. Is there any document in the MSDN mentioned this bug?<BR><BR>Stephen<BR>from Hong Kong</EM></P></FONT></BLOCKQUOTE>
<P>This is not a bug.</P>
<P>Those two mappings that LCMapString provides via the LCMAP_SIMPLIFIED_CHINESE and LCMAP_TRADITIONAL_CHINESE that I discussed in <A class="" href="http://archives.miloush.net/michkap/archive/2005/06/24/432121.html" mce_href="http://archives.miloush.net/michkap/archive/2005/06/24/432121.html"><STRONG>LCMapString's *other* job</STRONG></A>:</P>
<BLOCKQUOTE>
<P><STRONG>LCMAP_SIMPLIFIED_CHINESE</STRONG> -- Maps traditional Chinese characters to simplified Chinese, passing through other characters unchanged. Thus <STRONG>樂</STRONG>&nbsp;(U+6a02) becomes <STRONG>乐</STRONG> (U+4e50). The dictionary used for this mapping is small (only 2,620 ideographs) and has not been updated since the feature was added in NT 4.0 (it was originally added at the request of people in Office, who actually ended up going with their own more sophisticated dictionary solution in Word that does a better job with the sometimes complicated mapping. Now although casing, width, and Kana mappings can all be done in place, this is not allowed for traditional-&gt;simplified Chinese mappings, even though the same restrictions (always the same length, etc.) apply here -- <EM><FONT color=#ff0000>if any NLS testers who are reading this want to put in a bug,&nbsp;someone could see about fixing that!</FONT></EM></P>
<P><STRONG>LCMAP_TRADITIONAL_CHINESE</STRONG> -- Maps simplified Chinese characters to traditional Chinese, passing through other characters unchanged. Thus <STRONG>儈</STRONG> (U+5108) becomes <STRONG>侩</STRONG> (U+4fa9). The dictionary used for this mapping is even smaller (only 2,191 ideographs) since there are many times that several traditional Chinese ideographs will map to one simplified ideograph (thus these two flags are not 100% reversible versions of each other). The table has not been updated since the LCMAP_SIMPLIFIED_CHINESE one was. Same problems with in-place update apply here -- <EM><FONT color=#ff0000>if any NLS testers who are reading this want to put in a bug,&nbsp;it will be resolved as a duplicate of the other bug I was suggesting, above!</FONT></EM></P></BLOCKQUOTE>
<P mce_keep="true">Notice those counts in there -- that is all that exists in the tables provided by Win32.</P>
<P mce_keep="true">As of Unicode 4.01 (the last time I looked in to the matter) the Unihan.txt data file provided in the <A class="" href="http://www.unicode.org/ucd/" mce_href="http://www.unicode.org/ucd/">Unicode Character Database</A> does not provide all that larger of a list (2629 simplified mappings including&nbsp;some from Extension B that Windows doesn't have and 2554 traditional mappings with analogous additional entries.</P>
<P mce_keep="true">Though clearly Microsoft has better mappings, like the ones in Microsoft Office I mentioned:</P>
<P mce_keep="true"><IMG height=532 src="http://trigeminal.fmsinc.com/images/simptrad.png" width=913></P>
<P mce_keep="true">but I don't know of any source available to programmers from Microsoft. Though people like <A class="" href="http://blogs.msdn.com/oldnewthing/archive/2005/07/11/437522.aspx" mce_href="http://blogs.msdn.com/oldnewthing/archive/2005/07/11/437522.aspx">Raymond Chen</A> have mentioned other, external&nbsp;sources for doing the conversion in the past.</P>
<P mce_keep="true">And if you look around on the web you can find lots of implementations in Perl and other languages, and some additional data tables to support the work.</P>
<P mce_keep="true">When you consider the problems that face people in relation to IDN and traditional/simplified&nbsp;mappings, it really seems like this problem should be something that Windows does better.</P>
<P mce_keep="true">A bit of trivia:</P>
<UL>
<LI>
<DIV mce_keep="true">most of the simplified&nbsp;Han used&nbsp;by these two mappings are not in <A class="" href="http://www.microsoft.com/globaldev/reference/dbcs/950.mspx" mce_href="http://www.microsoft.com/globaldev/reference/dbcs/950.mspx">Windows code page 950</A>;</DIV></LI>
<LI>
<DIV mce_keep="true">all of the simplified&nbsp;Han used&nbsp;by these two mappings are in <A class="" href="http://www.microsoft.com/globaldev/reference/dbcs/936.mspx" mce_href="http://www.microsoft.com/globaldev/reference/dbcs/936.mspx">Windows code page 936</A>;</DIV></LI>
<DIV mce_keep="true">
<LI>
<DIV mce_keep="true">most of the traditional Han used&nbsp;by these two mappings are not in <A class="" href="http://www.microsoft.com/globaldev/reference/dbcs/936.mspx" mce_href="http://www.microsoft.com/globaldev/reference/dbcs/936.mspx">Windows code page 936</A>;</DIV></LI>
<LI>
<DIV mce_keep="true">all of the traditional Han used&nbsp;by these two mappings are in <A class="" href="http://www.microsoft.com/globaldev/reference/dbcs/950.mspx" mce_href="http://www.microsoft.com/globaldev/reference/dbcs/950.mspx">Windows code page 950</A>;</DIV></LI>
<LI>LCMapStringA converts to and from Unicode using the ACP of the locale you pass in, which can only amount to <U><FONT color=#0000ff>936</FONT></U>&nbsp;<EM>or</EM>&nbsp;<U><FONT color=#0000ff>950</FONT></U> and not both.</LI></DIV></UL>
<P mce_keep="true">This makes LCMapStringA (rather than LCMapStringW)&nbsp;almost entirely useless for these two mappings, even though minimal effort to simply assume the code pages to use (<U><FONT color=#0000ff>936</FONT></U>&nbsp;or&nbsp;<U><FONT color=#0000ff>950</FONT></U>) based on the mapping direction would fix that. This problem has existed for every version of Windows since these flags have been supported, so I guess people aren't eager to make changes in this space....</P>
<P mce_keep="true">&nbsp;</P>
<P mce_keep="true"><FONT color=#ff00ff><EM>This post brought to you by</EM> <FONT size=6>傧</FONT> <EM>and</EM> <FONT size=6>儐</FONT> <EM>(<A class="" href="http://www.fileformat.info/info/unicode/char/50a7" mce_href="http://www.fileformat.info/info/unicode/char/50a7">U+50a7</A> and <A class="" href="http://www.fileformat.info/info/unicode/char/5110" mce_href="http://www.fileformat.info/info/unicode/char/5110">U+5110</A>, two Han ideographs with a relationship you can probably discern from context)</EM></FONT></P>
<hr/><p><a id="5656616" href="#5656616">#</a> <strong>Scott</strong> on 24 Oct 2007 4:45 PM:</p><div style="margin-left: 1em"><p>I think many people who are trying to find a simple function to map between simplified and traditional characters may be looking for the wrong tool for the job. &nbsp;The problem is that markets that use Traditional characters may have very different vocabulary than that used in markets that use Simplified characters. &nbsp;Even if you could deal with the many-to-one problem, in most real world cases, converting between traditional and simplified Chinese is more like translation than case mapping.</p></div>
<hr/><p><em>referenced by</em></p><div style="margin-left: 1em"><p>2007/10/22 <a href="http://archives.miloush.net/michkap/archive/2007/10/22/5590751.html">We weren't Vista heroes, but I think we were kinda heroic</a></p></div><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2007/10/22/5588865.html" title="Governments can be one of the last places to get the best keyboard layouts">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2007/10/21/5582649.html" title="&#39;Today&#39; is not a breakup song (said her favorite cylon), aka Readers here might prefer to listen to music like normal people do">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2007-10">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2007-10-22">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2007/10/22/5588441.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:37 GMT -->
</html>