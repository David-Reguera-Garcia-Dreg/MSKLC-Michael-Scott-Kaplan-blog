<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2007/12/11/6730684.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:36 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>In SQL Server, there is the rest of Unicode (aka the SiaO Incompleteness Theorem)</title></head><body>
<h1>In SQL Server, there is the rest of Unicode (aka the SiaO Incompleteness Theorem)</h1>
<p><em>by Michael S. Kaplan, published on 2007/12/11 10:01 -05:00, original URI: http://blogs.msdn.com/b/michkap/archive/2007/12/11/6730684.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<P>Previously in this series, I have talked about many things. Like how&nbsp;<A class="" href="http://archives.miloush.net/michkap/archive/2007/12/05/6660685.html" mce_href="http://archives.miloush.net/michkap/archive/2007/12/05/6660685.html"><STRONG>the distance between A and Z is wider than you might think</STRONG></A>. how&nbsp;<A class="" href="http://archives.miloush.net/michkap/archive/2007/12/06/6661053.html" mce_href="http://archives.miloush.net/michkap/archive/2007/12/06/6661053.html"><STRONG>A-Z, A-z, a-Z, and a-z may not mean the same thing</STRONG></A>, how&nbsp;<A class="" href="http://archives.miloush.net/michkap/archive/2007/12/07/6669587.html" mce_href="http://archives.miloush.net/michkap/archive/2007/12/07/6669587.html"><STRONG>the wrong range can make you seem insensitive to one's width! (aka Do my V's look fat?)</STRONG></A>, now&nbsp;<A class="" href="http://archives.miloush.net/michkap/archive/2007/12/08/6669846.html" mce_href="http://archives.miloush.net/michkap/archive/2007/12/08/6669846.html"><STRONG>your ranges also need to ACCENT-uate the positives</STRONG></A>, how&nbsp;<A class="" href="http://archives.miloush.net/michkap/archive/2007/12/09/6673424.html" mce_href="http://archives.miloush.net/michkap/archive/2007/12/09/6673424.html"><STRONG>the alphabet does not end at Z</STRONG></A>, and how <A class="" href="http://archives.miloush.net/michkap/archive/2007/12/10/6719043.html" mce_href="http://archives.miloush.net/michkap/archive/2007/12/10/6719043.html"><STRONG>different collations implies different ranges (aka Not every table has its THORN)</STRONG></A>.</P>
<P>Amazingly, I have done this all while staying within the 1,229 characters in the default table for Windows (and somewhat fewer for SQL Server).</P>
<P>With Unicode about to cross the 100,000 assigned count of code points, that really is saying something!</P>
<P>The bottom line is that there are a whole bunch of code points in Unicode representing the letters, numbers, punctuation, and symbols of other languages throughout the world, more than a few of which are used by&nbsp;one or more&nbsp;of the collations in SQL Server.</P>
<P>Now if the previous five posts have not convinced you that ranges in <A class="" href="http://msdn2.microsoft.com/library/aa933232.aspx" mce_href="http://msdn2.microsoft.com/library/aa933232.aspx">LIKE</A> expressions in SQL Server's T-SQL, then the simple fact that the many other alphabets in the world are entirely missed by these various ranges that you might come up with to try to work around the various issues....</P>
<P>Now it is true that in SQL Server 2005 you can use CLR integration to use either&nbsp;managed regular expression support (ref: <A class="" href="http://msdn.microsoft.com/msdnmag/issues/07/02/SQLRegex/default.aspx" mce_href="http://msdn.microsoft.com/msdnmag/issues/07/02/SQLRegex/default.aspx">Regular Expressions Make Pattern Matching And Data Extraction Easier</A>) or the <A class="" href="http://msdn2.microsoft.com/library/system.globalization.charunicodeinfo.aspx" mce_href="http://msdn2.microsoft.com/library/system.globalization.charunicodeinfo.aspx">CharUnicodeInfo class</A>.</P>
<P>Now&nbsp;as I pointed out in <A class="" href="http://archives.miloush.net/michkap/archive/2007/12/05/6648893.html" mce_href="http://archives.miloush.net/michkap/archive/2007/12/05/6648893.html"><STRONG>No way to get that script info I was looking for earlier</STRONG></A>, regular expressions in the CLR don't have the greatest Unicode version support story in terms of being up to the latest version, though as regular expression may be a more natural way to solve problems working with databases than writing code that would use something like the <A class="" href="http://msdn2.microsoft.com/library/system.globalization.charunicodeinfo.aspx" mce_href="http://msdn2.microsoft.com/library/system.globalization.charunicodeinfo.aspx">CharUnicodeInfo class</A>&nbsp;(which for all its flaws has the advantage of supporting Unicode 5.0!).</P>
<P>Though if you do want to go down either road, keep in kind the lessons of <A class="" href="http://archives.miloush.net/michkap/archive/2007/10/25/5686727.html" mce_href="http://archives.miloush.net/michkap/archive/2007/10/25/5686727.html"><STRONG>Not all in sync quite yet (aka SQL and the CLR and Windows and .NET)</STRONG></A> since SQL Server is not in sync with the components you will be using.</P>
<P>Plus, even if they were consistent in terms of repertoire, the fact remains that SQL Server (like Windows) tends to sport many similar things near each other even if they are conceptually further away due to their intended use.</P>
<P>So the advantage to staying in the world of T-SQL is that your results will be consistent, if not complete -- whereas these other solutions will be closer to complete, though not always consistent.</P>
<P>Sort of an <STRONG>SiaO Incompleteness Theorem</STRONG> for you to chew on!</P>
<P>Of course there are also many other problems staying in the T-SQL world that I have talked about in the past in posts like <A class="" href="http://archives.miloush.net/michkap/archive/2006/10/04/788429.html" mce_href="http://archives.miloush.net/michkap/archive/2006/10/04/788429.html"><STRONG>Wild[card] thing, You make my CHAR sing</STRONG></A> and <A class="" href="http://archives.miloush.net/michkap/archive/2007/01/15/1469885.html" mce_href="http://archives.miloush.net/michkap/archive/2007/01/15/1469885.html"><STRONG>With SQL Server (and SQL itself) comes the illogic of 'trailing spaces' (and the myth of fixed width)</STRONG></A>.</P>
<P>I guess I could easily just cop out, look at the whole mess, and tell you that you are screwed. If I were "Doctor International" I could maybe prescribe you some Valium to help you through the nervous breakdown that all of this randomosity might inspire.</P>
<P>But instead, let's just take a step back, and you can work to base what you are trying to do on the scenario, on what you want to accomplish. </P>
<P>And lay off the clever expressions to fix the bugs since (a) they aren't and (b) they won't, in the long run....</P>
<P mce_keep="true">&nbsp;</P>
<P><FONT color=#ff0099><EM>This post brought to you by </EM>&nbsp;<FONT size=6>C</FONT> </FONT><EM><FONT color=#ff0099>(</FONT><A class="" href="http://www.fileformat.info/info/unicode/char/0043" mce_href="http://www.fileformat.info/info/unicode/char/0043">U+0043</A><FONT color=#ff0099>, a.k.a. LATIN CAPITAL LETTER C)</FONT></EM></P>
<hr/><div style="margin-left: 1em"><em>no comments</em></div><hr/><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2007/12/12/6731510.html" title="ISNUMERIC ISSTUPID (and ISGONNAGETITSASSKICKED if it isn&#39;t careful)">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2007/12/11/6726647.html" title="How to get yourself imprisoned [by/for talking about Unicode]">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2007-12">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2007-12-11">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2007/12/11/6730684.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:36 GMT -->
</html>