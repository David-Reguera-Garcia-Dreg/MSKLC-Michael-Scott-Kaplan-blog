<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2007/12/05/6660685.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:37 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>In SQL Server, the distance between A and Z is wider than you might think!</title></head><body>
<h1>In SQL Server, the distance between A and Z is wider than you might think!</h1>
<p><em>by Michael S. Kaplan, published on 2007/12/05 10:16 -05:00, original URI: http://blogs.msdn.com/b/michkap/archive/2007/12/05/6660685.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<P>The other day George asked me via the Contact link:</P>
<BLOCKQUOTE>
<P><FONT face="times new roman,times">I use SQL Server quite a bit, but I just hit some confusing behavior reported by a customer. It isn't a localization problem but it does involve sorting or at least matching.<BR><BR>I think I have tracked down the problem, but I'm not sure. Is it possible that<BR><BR><FONT face="courier new,courier"><STRONG>&nbsp;&nbsp;&nbsp; LIKE '[A-Z]'<BR></STRONG></FONT><BR>and<BR><BR><FONT face="courier new,courier"><STRONG>&nbsp;&nbsp;&nbsp; LIKE '[ABCDEFGHIJKLMNOPQRSTUVWXYZ]'<BR></STRONG></FONT><BR>would return different results?<BR><BR>Do you know what is going on here?</FONT></P></BLOCKQUOTE>
<P>Indeed I do, George. And it is an internationalization problem, and a collation one, too!</P>
<P>If you look at the Windows table (which are slightly ahead of the SQL Server ones), there are about 1,229&nbsp;letters in the Latin script, all but 20 of which are between A and Z, inclusive.</P>
<P>Now if you take the SQL Server case the numbers look slightly less scary (something like 979 letters in the Latin script, all but 15 of which are between A and Z, inclusive) but either way it puts that expression with the explicit ABCDEFGHIJKLMNOPQRSTUVWXYZ to shame, doesn't it? :-)</P>
<P>Now obviously if you are not using Unicode columns then you aren't really missing out on either 1,209 or 984 characters, but even then there will be some letters missed.</P>
<P>I'll get more info some other interesting nuances about these expressions another day....</P>
<P mce_keep="true">&nbsp;</P>
<P><FONT color=#ff00ff><EM>This post brought to you by</EM><FONT size=5> Z </FONT><EM>(<A class="" href="http://www.fileformat.info/info/unicode/char/005a" mce_href="http://www.fileformat.info/info/unicode/char/005a">U+005a</A>, LATIN CAPITAL LETTER Z)</EM></FONT></P>
<hr/><p><a id="6678553" href="#6678553">#</a> <strong>Ian Hamilton</strong> on 6 Dec 2007 6:46 AM:</p><div style="margin-left: 1em"><p>I may be a bit thick but I can't see how or why [A-Z] should be different to [ABC....XYZ]. If A = Unicode U+41 and Z = Uncode U+5a, then that to me means 26 characters and it makes no sense to interpret it any other way. I am no expert but to me it just does not make any sense for it to be otherwise</p></div>
<p><a id="6679761" href="#6679761">#</a> <strong>Michael S. Kaplan</strong> on 6 Dec 2007 8:40 AM:</p><div style="margin-left: 1em"><p>It does not work by saying &quot;these discrete code units by their code points&quot; -- it works by saying &quot;everything that sorts between these letters&quot; -- and all of these letters.</p>
<p>And all of those various &quot;A&quot; like, &quot;B&quot; like, &quot;C&quot; like, and son on characters sort between.....</p>
<p>Not sure if I'd call that something that makes you thick, by any means -- but there are two different possible ways for this to work, and it works in one way and you are expecting it to work in the other. That's all. :-)</p>
</div>
<hr/><p><em>referenced by</em></p><div style="margin-left: 1em"><p>2007/12/11 <a href="http://archives.miloush.net/michkap/archive/2007/12/11/6730684.html">In SQL Server, there is the rest of Unicode (aka the SiaO Incompleteness Theorem)</a></p><p>2007/12/10 <a href="http://archives.miloush.net/michkap/archive/2007/12/10/6719043.html">In SQL Server, different collations implies different ranges (aka Not every table has its THORN)</a></p><p>2007/12/09 <a href="http://archives.miloush.net/michkap/archive/2007/12/09/6673424.html">In SQL Server, the alphabet does not end at Z!</a></p><p>2007/12/08 <a href="http://archives.miloush.net/michkap/archive/2007/12/08/6669846.html">In SQL Server, your ranges also need to ACCENT-uate the positives!</a></p><p>2007/12/07 <a href="http://archives.miloush.net/michkap/archive/2007/12/07/6669587.html">In SQL Server, the wrong range can make you seem insensitive to one's width! (aka Do my V's look fat?)</a></p><p>2007/12/06 <a href="http://archives.miloush.net/michkap/archive/2007/12/06/6661053.html">In SQL Server, A-Z, A-z, a-Z, and a-z may not mean the same thing!</a></p></div><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2007/12/05/6674157.html" title="A Strange and Sublime HASANT">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2007/12/05/6648893.html" title="No way to get that script info I was looking for earlier">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2007-12">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2007-12-05">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2007/12/05/6660685.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:37 GMT -->
</html>