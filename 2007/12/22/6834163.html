<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2007/12/22/6834163.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:36 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>Incomplete Scenarios: They don't know everything that's up with number sorting</title></head><body>
<h1>Incomplete Scenarios: They don't know everything that's up with number sorting</h1>
<p><em>by Michael S. Kaplan, published on 2007/12/22 10:16 -05:00, original URI: http://blogs.msdn.com/b/michkap/archive/2007/12/22/6834163.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<P>In just a few weeks from now, it will have been three years since I first wrote about <A class="" href="http://archives.miloush.net/michkap/archive/2005/01/05/346933.html" mce_href="http://archives.miloush.net/michkap/archive/2005/01/05/346933.html"><STRONG>What is up with number sorting?</STRONG></A>. </P>
<P>Since then, that SHLWAPI function StrCmpLogicalW has come up a few other times, like in:</P>
<UL>
<LI><A class="" href="http://archives.miloush.net/michkap/archive/2006/10/02/783066.html" mce_href="http://archives.miloush.net/michkap/archive/2006/10/02/783066.html"><STRONG>What would it mean to internationalize StrCmpLogicalW?</STRONG></A>, which from a purely theoretical standpoint explored what it would mean to "internationalize" this function, a fascinating question since there are so many different possible answers (some of which conflict with each other a lot!)</LI>
<LI><A href="http://archives.miloush.net/michkap/archive/2006/09/30/778345.html"><STRONG>StrCmp for humans? It's in there!</STRONG></A>, which hinted at the fact that some enhancements ere being made to the SHLWAPI function for Vista, and</LI>
<LI><A class="" href="http://archives.miloush.net/michkap/archive/2006/10/01/778990.html" mce_href="http://archives.miloush.net/michkap/archive/2006/10/01/778990.html"><STRONG>Logical StrCmpLogicalW changes in Vista</STRONG></A>, which explained what those changes were</LI></UL>
<P>In the meantime, the basic issue of sorting digits contained in strings as if they are TEXT vs. as if they are NUMBERS (what I have always thought of as "sort digits as numbers") has had some recent airplay in various blogs:</P>
<UL>
<LI>On December 12th, Jeff Atwood posted <A class="" href="http://www.codinghorror.com/blog/archives/001018.html" mce_href="http://www.codinghorror.com/blog/archives/001018.html">Sorting for Humans : Natural Sort Order</A>, which did an interesting review of several takes on the problem;</LI>
<LI>On December 17th, Ian Griffiths posted <A class="" href="http://www.interact-sw.co.uk/iangblog/2007/12/13/natural-sorting" mce_href="http://www.interact-sw.co.uk/iangblog/2007/12/13/natural-sorting">Natural Sorting in C#</A>, in challenge to some specific points in Jeff's post;</LI></UL>
<P>And Jeff's post actually linked to a bunch of others as well.</P>
<P>All of the different algorithms I looked at all had some basic issues in common, irregardless (!) of language or platform. The main point being that none of them did anything with LEADING ZEROES.</P>
<P><EM>(They also all had in common that none of them pointed to me except I think one regular reader from here mentioned posts here in&nbsp;a comment, but since I only raised issues and talked about a function, it kind of makes sense that posts focused on algorithms would not see the need to reference someone not providing an algorithm!)</EM></P>
<P>Many of the people involved DID talk about LEADING ZEROES. But they did so only to contrast them as a technique to get the same results (which is to say that people worried about sorting 1000, 200, 30, 4 and have them come out as 4, 30, 200, 1000 could either write a function or make the numbers 1000, 0200, 0030, and 0004).</P>
<P>Nobody talked about what their algorithms would do when comparing things like 00003, 0003, 003, 03, and 3.</P>
<P>All of them have some kind of fundamental THREE-ness about them, and unsurprisingly most of them don't tend to fare very well since they are mostly focused on whether the sections of the two strings that are numbers are of the same length and whether they are equal numerically -- and length is taken as a pretty fundamental indication of which one is bigger -- so I suppose <STRONG>size matters a lot to them</STRONG>. :-)</P>
<P>StrCmpLogicalW does&nbsp;intentionally and deterministically handle the case of leading zeroes (for what it's worth I don't like the way it does break such ties, but I am a huge fan of deterministic behavior in such cases), though to be honest StrCmpLogicalW didn't come up very much in the various posts either.</P>
<P>Though perhaps if people had been willing to look a bit closer, then&nbsp;the LEADING ZEROES issue would have been noted and more widely handled.</P>
<P>And then there are the issues I have brought up previously that complicate the idea of this kind of functionality in NLS such as dealing with file extensions (handled with <A class="" href="http://archives.miloush.net/michkap/archive/2006/10/01/778990.html" mce_href="http://archives.miloush.net/michkap/archive/2006/10/01/778990.html"><STRONG>the Vista changes</STRONG></A>), figuring out what to do with other digits in Unicode (a ton of issues there!),&nbsp;and dealing with sort keys (especially difficult to tackle efficiently whether for&nbsp;numbers of unlimited size or of an arbitrarily limited size). </P>
<P>Given that those issues are fairly blocking from my old team being able to consider the functionality, in addition to the basic need to handle LEADING ZEROES properly, I would have loved to have seen a bit more thought on the issues that people have not tackled yet on the "my algorithm is better than yours" frontier if so many different people were going to be thinking about the poblem....</P>
<P mce_keep="true">&nbsp;</P>
<P><EM>(Hat tip to <A class="" href="http://www.larkware.com/dg9/TheDailyGrind1295.aspx" mce_href="http://www.larkware.com/dg9/TheDailyGrind1295.aspx">Mike Gunderloy</A>)</EM></P>
<P mce_keep="true">&nbsp;</P>
<P mce_keep="true"><EM><FONT color=#ff00ff>All of the characters in Unicode have taken off for Grand Cayman for the Christmas holiday weekend<BR><FONT size=1>(they are staying at the Mariott Grand Cayman Beach Hotel in case you are there and are curious at all the characters hanging out by the pool!)</FONT></FONT></EM></P>
<hr/><p><a id="7011974" href="#7011974">#</a> <strong>Thomas G. Mayfield</strong> on 6 Jan 2008 9:46 PM:</p><div style="margin-left: 1em"><p>I would expect 00003, 003, 03, and 3 to sort as being equal. How would you expect them to be handled? &nbsp;Only thing I'd suggest other than being equal would be that leading 0s push it to the top, which would make the sort deterministic.</p></div>
<p><a id="7012459" href="#7012459">#</a> <strong>Michael S. Kaplan</strong> on 6 Jan 2008 10:51 PM:</p><div style="margin-left: 1em"><p>The various &quot;solutions&quot; these other people provided don't handle it -- they are purely length based for numbers, so 0003 comes after 003 since the former is longer (more importantly, 0003 comes after 004 since it is longer.</p>
<p>The Shell solution is different -- better, but still wrong in my opinion. At least it is deterministic and the results make more sense.</p>
</div>
<p><strong>Michael S. Kaplan</strong> on 10 Jan 2008 5:21 PM:</p><div style="margin-left: 1em"></div>
<hr/><p><em>referenced by</em></p><div style="margin-left: 1em"><p>2008/03/04 <a href="http://archives.miloush.net/michkap/archive/2008/03/04/8015052.html">Consistency in the Windows Shell is not overrated; it's just underobserved!</a></p></div><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2007/12/23/6841289.html" title="Now experiencing what is *almost* a pleasant exacerbation">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2007/12/22/6833199.html" title="CultureInfo subsetting attempts that suck">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2007-12">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2007-12-22">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2007/12/22/6834163.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:36 GMT -->
</html>