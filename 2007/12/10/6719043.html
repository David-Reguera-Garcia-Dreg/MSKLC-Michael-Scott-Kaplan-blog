<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2007/12/10/6719043.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:37 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>In SQL Server, different collations implies different ranges (aka Not every table has its THORN)</title></head><body>
<h1>In SQL Server, different collations implies different ranges (aka Not every table has its THORN)</h1>
<p><em>by Michael S. Kaplan, published on 2007/12/10 10:01 -05:00, original URI: http://blogs.msdn.com/b/michkap/archive/2007/12/10/6719043.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<P>Previous posts in this series:</P>
<LI><A class="" href="http://archives.miloush.net/michkap/archive/2007/12/05/6660685.html" mce_href="http://archives.miloush.net/michkap/archive/2007/12/05/6660685.html"><STRONG>In SQL Server, the distance between A and Z is wider than you might think</STRONG></A> 
<LI><A class="" href="http://archives.miloush.net/michkap/archive/2007/12/06/6661053.html" mce_href="http://archives.miloush.net/michkap/archive/2007/12/06/6661053.html"><STRONG>In SQL Server, A-Z, A-z, a-Z, and a-z may not mean the same thing</STRONG></A> 
<LI><A class="" href="http://archives.miloush.net/michkap/archive/2007/12/07/6669587.html" mce_href="http://archives.miloush.net/michkap/archive/2007/12/07/6669587.html"><STRONG>In SQL Server, the wrong range can make you seem insensitive to one's width! (aka Do my V's look fat?)</STRONG></A> 
<LI><A class="" href="http://archives.miloush.net/michkap/archive/2007/12/08/6669846.html" mce_href="http://archives.miloush.net/michkap/archive/2007/12/08/6669846.html"><STRONG>In SQL Server, your ranges also need to ACCENT-uate the positives</STRONG></A></LI>
<LI><A class="" href="http://archives.miloush.net/michkap/archive/2007/12/09/6673424.html" mce_href="http://archives.miloush.net/michkap/archive/2007/12/09/6673424.html"><STRONG>In SQL Server, the alphabet does not end at Z!</STRONG></A></LI>
<P>Thus far, I have almost entirely (well, ignoring the second post, which this one expands way beyond the&nbsp;1-2 character difference implied there) been not focusing on the fact that there are issues beyond the <STRONG>default table</STRONG>.</P>
<P>Now in&nbsp;the last post, regular reader John Cowan asked:</P>
<BLOCKQUOTE>
<P><EM><FONT face="times new roman,times">Thorn, what happened to Thorn? &nbsp;It's properly the 27th basic letter of the Latin alphabet. &nbsp;And of course Yogh should sort with G, not with Z and Ezh; the whole point of Yogh was to discriminate between the G-like and Z-like forms.</FONT></EM></P></BLOCKQUOTE>
<P>If you look at the code points cited, there are only Ezh ones there -- but in the source file it happens to be calling <A class="" href="http://www.fileformat.info/info/unicode/char/0292" mce_href="http://www.fileformat.info/info/unicode/char/0292">U+0292</A> and <A class="" href="http://www.fileformat.info/info/unicode/char/01b7" mce_href="http://www.fileformat.info/info/unicode/char/01b7">U+01b7</A> the small and capital Yogh rather than the Ezh. I didn't even look at the code points, I just quickly characterized the comments when I looked at the list.</P>
<P>And of course if you look way up higher in the order the real Yogh (small and capital appear more like where one would expect them).</P>
<P>Very weird, yes -- luckily the letters themselves are right -- as was the gadget that gave me character names and links! :-)</P>
<P>The Thorn is by default treated as being an EXPANSION and it becomes the letters "TH" or "th" -- so try not to make that the last letter of a range, unless it is run under Icelandic or something....</P>
<P>But in the end, the issue here is the way characters are added to the table. I talked about this in <A class="" href="http://archives.miloush.net/michkap/archive/2005/09/12/463483.html" mce_href="http://archives.miloush.net/michkap/archive/2005/09/12/463483.html"><STRONG>How does Microsoft assign new collation weights?</STRONG></A>, and the delicate balance between taking letters not used by the languages that use the default table between:</P>
<UL>
<LI>putting them where other languages want them</LI>
<LI>putting them where they intuitively seem like they "ought" to go</LI>
<LI>putting them at the end</LI></UL>
<P>does not really show a great deal of consistency across the last decade or so that it has been going on (in fact the only consistent rule when picking between these three choices is that if a choice does not apply it is not used!). Luckily as long as the letters are not used by locales that use the default table, this particular inconsistency won't&nbsp;ever make a difference for users (as long as the right collation is used -- if not, then a whole bunch of other stuff is broken too!).</P>
<P>The guarantees for letters that are used in the languages covered by the table they are in is much more predictable and consistent.</P>
<P>But when you think about language differences and how a whole bunch of language will take letters like <STRONG>Å</STRONG>, <STRONG>Ä</STRONG>, and <STRONG>Ö</STRONG> and place them at the end of the Latin script after <STRONG>Z</STRONG>, once again you are left with the overall foolishness of trying to to cover the alphabet with any kind of expression involving literals or a range.</P>
<P>If you ignore this one, then changing the collation will suddenly lose all kinds of characters!</P>
<P>Now I am almost ready to swoop in with the <STRONG>\w</STRONG> solution here, but I'll wait until tomorrow to do that, when I also explain why it won't work either. :-)</P>
<P mce_keep="true">&nbsp;</P>
<P><FONT color=#ff00ff><EM>This post brought to you by</EM><FONT size=5> Þ </FONT><EM>(<A class="" href="http://www.fileformat.info/info/unicode/char/00de" mce_href="http://www.fileformat.info/info/unicode/char/00de">U+00de</A>, aka LATIN CAPITAL LETTER THORN)</EM></FONT></P>
<hr/><p><strong>John Cowan</strong> on 10 Dec 2007 12:45 PM:</p><div style="margin-left: 1em"><P>An expansion? &nbsp;Eww. &nbsp;Gross. &nbsp;If you are dealing with a text that randomly veers from <STRONG>þ</STRONG> to <STRONG>th</STRONG>, you might as well just transliterate every <STRONG>þ</STRONG> to <STRONG>th</STRONG> to start with, rather than looking at a list of words with the <STRONG>þ</STRONG>s mixed in with the <STRONG>th</STRONG>'s.</P>
<P>It's not like there's any real conflict here, unlike the situation with the umlauted vowels. &nbsp;Icelandic is the only modern language that uses <STRONG>þ</STRONG> at all, and its place in that alphabet is firmly established: right after <STRONG>z</STRONG> (not at the end, actually). &nbsp;Historically both <STRONG>y</STRONG> and <STRONG>z</STRONG> were also additions to the original Latin alphabet, and they too were placed after the last existing letter, which was <STRONG>u</STRONG> at the time (the split between <STRONG>u</STRONG> and <STRONG>v</STRONG> came much later).</P>
<P>There are late mediaeval manuscripts that write <STRONG>þ</STRONG> and <STRONG>y</STRONG> exactly the same, and the convention is to transliterate it all to <STRONG>y</STRONG>, on the grounds that <STRONG>ye</STRONG> for <STRONG>the</STRONG> (as in "Ye Olde Shoppe") is much more readable than <STRONG>mþkþll</STRONG> for <STRONG>mykyll</STRONG> (modern dialect mickle 'much'). &nbsp;But transliteration rules are not the same as rules for sorting the letter <STRONG>þ</STRONG> itself.</P>
<P>(Note: &nbsp;Not having italics makes this post much less readable, I'm afraid.)</P></div>
<p><strong>Michael S. Kaplan</strong> on 10 Dec 2007 1:05 PM:</p><div style="margin-left: 1em"><P>I emboldened you, hope that helps. :-)</P>
<P>The longstanding behavior of <A class="" href="http://www.fileformat.info/info/unicode/char/00de">U+00de</A>/<A class="" href="http://www.fileformat.info/info/unicode/char/00fe">U+00fe</A> is one I would not be eager to change after all this time since it is pretty widespread, even to the point of seeing it move a bit in languages that do something special with the <STRONG>th</STRONG> (e.g. Albanian, Vietnamese, Welsh).</P>
<P>The only collation that puts it anywhere different than that is Icelandic (ICELANDIC_CS_AS in SQL Server, for example).</P>
<P>Would it be fair to say this is kind of a thorn in your side? :-)</P></div>
<hr/><p><em>referenced by</em></p><div style="margin-left: 1em"><p>2007/12/11 <a href="http://archives.miloush.net/michkap/archive/2007/12/11/6730684.html">In SQL Server, there is the rest of Unicode (aka the SiaO Incompleteness Theorem)</a></p></div><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2007/12/11/6726647.html" title="How to get yourself imprisoned [by/for talking about Unicode]">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2007/12/10/6715776.html" title="MUI is like your heartbeat; it&#39;s important and useful, whether you know about it or not">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2007-12">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2007-12-10">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2007/12/10/6719043.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:37 GMT -->
</html>