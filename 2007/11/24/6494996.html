<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2007/11/24/6494996.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:37 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>We didn't split up, because we were in Japan (aka They have an opening that you might fit)</title></head><body>
<h1>We didn't split up, because we were in Japan (aka They have an opening that you might fit)</h1>
<p><em>by Michael S. Kaplan, published on 2007/11/24 03:01 -05:00, original URI: http://blogs.msdn.com/b/michkap/archive/2007/11/24/6494996.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<P><EM><FONT color=#ff0000>No, this is not a post&nbsp;about&nbsp;a past relationship!</FONT></EM>&nbsp;</P>
<P>The question that came up yesterday was:</P>
<BLOCKQUOTE>
<BLOCKQUOTE>
<P><FONT face="times new roman,times"><EM>Hi.<BR><BR>Following lines of WSF script generate script error.&nbsp; The character in the string is Katakana letter Pe U+30DA<BR><BR></EM></FONT><FONT face="consolas,lucida console,courier new,courier"><STRONG>&nbsp;&nbsp;&nbsp; formatline = "first=ペ"<BR>&nbsp;&nbsp;&nbsp; arr1 = Split(formatline, "=", 2, 1)</STRONG></FONT></P>
<P><FONT face="times new roman,times"><EM>The error that is returned:<BR><BR></EM><FONT face="consolas,lucida console,courier new,courier"><STRONG>&nbsp;&nbsp;&nbsp; test.wsf(14, 2) Microsoft VBScript runtime error: Invalid procedure call or argument: 'Split'<BR></STRONG></FONT><BR><EM>Failing case is introduced when standards and formats on my Vista OS is Korean.<BR><BR>I suspect that this function should have used binary comparison where it does not fail:<BR><BR></EM><FONT face="consolas,lucida console,courier new,courier"><STRONG>&nbsp;&nbsp;&nbsp; arr1 = Split(formatline, "=", 2, 0)<BR></STRONG></FONT><BR><EM>Both function calls work fine when user locale is set to Japanese, matching the Language of the character.<BR><BR>Why the call with textual comparison is treated as illegal?&nbsp; What are preferences between textual and binary comparison?<BR><BR>Thanks.</EM></FONT></P></BLOCKQUOTE></BLOCKQUOTE>
<P mce_keep="true">Now the person who asked the question is someone I have worked with before. I like his instincts.</P>
<P mce_keep="true">Anyway the former script dev pointed out the basic things to consider here:</P>
<BLOCKQUOTE>
<P mce_keep="true"><EM>A possible source of the problem is the encoding of the script file. All bets are off if your WSF file is not Unicode.<BR><BR>Assuming that your script file IS Unicode:<BR><BR>Text compare uses current locale information for special text processing when you use TextCompare, so it’s not too surprising that anomalies arise when the text and the locale don’t match up.&nbsp; Using SetLocale(“ja”) may make it work as expected. Unfortunately, it looks like the code has some inconsistencies, using system locale for certain processing and the current engine locale for others, so setting the locale may not make it work. <BR><BR>It looks to me that this should work without errors, though. A bug should be filed.</EM></P></BLOCKQUOTE>
<P mce_keep="true">Both&nbsp;of then are&nbsp;basically right here!</P>
<P mce_keep="true">In this case, there are two important issues here, both of which he pointed out in his message:</P>
<OL>
<LI>
<DIV mce_keep="true">The fact that this call ever fails is a bug -- it should not be happening;</DIV></LI>
<LI>
<DIV mce_keep="true">The call should be done with a binary comparison since there is no "linguistic" sense of the equals sign that would make sense here for comparison purposes.</DIV></LI></OL>
<P mce_keep="true">So both of them are batting 1000. :-)</P>
<P mce_keep="true">It is interesting how often valid globalization bugs are found in the context of usage that is essentially incorrect.</P>
<P mce_keep="true">There is an interesting challenge to send these two messages such that people will not think you are the jerk who takes someone reporting a bug as an opportunity to slam on the person doing the reporting, if you know what I mean....</P>
<P mce_keep="true">Not so much in this case (since it was someone else's&nbsp;script bug&nbsp;and he was just the person who was tracking the down the failure found with a different language configuration on a test machine) but it is a pretty common scenario, probably more common with people reporting the error with their own code. And an important skill to master.</P>
<P mce_keep="true">This is a relevant point for you, the reader, as there is yet another opportunity for a job in my former team that deals with these kinds of issues!</P>
<P mce_keep="true">They are looking for another tester -- an SDET, to be [recise.</P>
<P mce_keep="true"><A class="" href="http://blogs.msdn.com/kierans/" mce_href="http://blogs.msdn.com/kierans/">Kieran</A>&nbsp;mentioned&nbsp;the position&nbsp;in her recent post entitled <A class="" href="http://blogs.msdn.com/kierans/archive/2007/10/12/shameless-self-promotion.aspx" mce_href="http://blogs.msdn.com/kierans/archive/2007/10/12/shameless-self-promotion.aspx">Shameless self-promotion</A>, and now that I have somewhere between 7 and 8.5 people (depending on <A class="" href="http://archives.miloush.net/michkap/archive/2007/11/22/6462768.html" mce_href="http://archives.miloush.net/michkap/archive/2007/11/22/6462768.html"><STRONG>how you count</STRONG></A>!) who have come to work for MS after reading <A class="" href="http://blogs.msdn.com/michkap" mce_href="http://blogs.msdn.com/michkap"><STRONG>this blog</STRONG></A> I have to consider the non-zero percent probability that the person who applies for and gets this job might be a regular reader. And this can be a very valuable skill to have for this position in particular. :-)</P>
<P mce_keep="true">Both Kieran's post and the job description it links to have hints about future functionality that are much broader than I would be posting here (it's their team, and that gives then a lot more leeway on such matters!), for people who like to watch that kind of thing. Some exciting stuff....</P>
<P mce_keep="true">If you end up interviewing be sure to drop me a line, maybe I could get you a Limonata or something. :-)</P>
<P mce_keep="true">&nbsp;</P>
<P mce_keep="true"><FONT color=#ff00ff><EM>This post brought to you by</EM><FONT size=5>&nbsp;= </FONT><EM>and</EM><FONT size=5> ペ </FONT><EM>(<A class="" href="http://www.fileformat.info/info/unicode/char/003d" mce_href="http://www.fileformat.info/info/unicode/char/003d">U+003d</A> and <A class="" href="http://www.fileformat.info/info/unicode/char/30da" mce_href="http://www.fileformat.info/info/unicode/char/30da">U+30da</A>, aka EQUALS SIGN and KATAKANA LETTER PE)</EM></FONT></P>
<hr/><p><strong>MSDNArchive</strong> on 28 Nov 2007 3:57 AM:</p><div style="margin-left: 1em"><p>I am the (almost former) script dev referred to in the post. The discussion on this issue was pleasing and productive on a number of levels:</p>
<p>The poster of the problem gave a minimal and complete working repro for the issue. I usually have to probe for that. He also gives the workaround - valuable for the discussion list. Using binary compare is going to be quite a bit faster, in addition to avoiding the script bug. </p>
<p>There is a third good point the poster had: that documentation on global text support in the script engine/runtime is essentially nonexistent.</p>
<p>Unlike some devs, I am pleased to get bug reports in what I own, especially as well stated as this one was. It's easier to take, because I didn't write the code in question. It is a real issue in vbscript, for which I posted Windows 7 bug 125295. I didn't debug in detail, since I don't own script anymore, except as backup for the new team that does. I winced when I looked at the underlying code to see if I could spot the problem. Smoke and junk blew by when I popped the hood, and there were some obvious loose wires. This is an old codebase, and shows it in places.</p>
<p>Lastly, Michael gave me a nice public compliment. At least, I took it that way. And he did it again here in this post (I'm not a jerk after all :-). Michael is demonstrating another skill or two worth mastering. </p>
<p>We've had occasional interactions over the years in mail, but I can't remember if we've ever met in the physical world. It's always been a pleasure working a problem with him. We should and will meet in person one of these days. </p>
<p>See you 'round, Michael.</p>
<p>-- Paul</p>
</div>
<p><strong>Michael S. Kaplan</strong> on 28 Nov 2007 10:37 AM:</p><div style="margin-left: 1em"><p>Definitely intended as compliment(s), Paul. </p>
<p>In a former lifetime (for both of us) I have a vague recollection of the Uniscribe support within VS? :-)</p>
<p>I agree with the &quot;non-existent documentation&quot; issue, though that particular issue has always seemed &quot;by design&quot; of somebody unfortunately -- that and its cousins the &quot;misleading documentation&quot; and &quot;incorrect documentation&quot;. If the docs were present and right and clear more often, I'm sure I wouldn't feel the need to blog so much....</p>
</div>
<hr/><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2007/11/24/6495908.html" title="I don&#39;t do dishes, GDI doesn&#39;t do supplementary characters">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2007/11/23/6488627.html" title="Another face of internationalization">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2007-11">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2007-11-24">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2007/11/24/6494996.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:37 GMT -->
</html>