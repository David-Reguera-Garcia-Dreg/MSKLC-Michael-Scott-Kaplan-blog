<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2010/03/10/9976075.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:35 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>They pushed out of the formatt[ing|er]</title></head><body>
<h1>They pushed out of the formatt[ing|er]</h1>
<p><em>by Michael S. Kaplan, published on 2010/03/10 07:01 -05:00, original URI: http://blogs.msdn.com/b/michkap/archive/2010/03/10/9976075.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<P>So it was less than twelve hours ago that Erez asked me via the Contact link:</P>
<BLOCKQUOTE>
<P><FONT face="times new roman,times">Hi Michael,</FONT></P>
<P><FONT face="times new roman,times">I would like to thank you for your post<BR>on Windows7 RTL bug, you actually saved<BR>us, our clients could not upgrade to Windows7 because of this bug and it was a serious problem.</FONT></P>
<P><FONT face="times new roman,times">During our testing we found out that this is not the only thing that has changed, for example the GetDateFormat API, produces different day names On WindowsXP I get "ד"<BR>On Windows7 I get "יום ד"</FONT></P>
<P><FONT face="times new roman,times">This might seem puny at first but it has major influence, everywhere we use day names (and expect a single letter like before) we have an error, all the calendar controls are now bigger and hide other controls nearby etc'</FONT></P>
<P><FONT face="times new roman,times">this is the code I have :</FONT></P>
<P><FONT face="times new roman,times">SYSTEMTIME st;<BR>GetSystemTime (&amp;st);<BR>LPWSTR buff =<BR>new WCHAR[20];<BR>int res = GetDateFormat (LOCALE_USER_DEFAULT,NULL,&amp;st,L"ddd", buff,20 );</FONT></P>
<P><FONT face="times new roman,times">I will greatly appreciate any help and guidance from you.</FONT></P>
<P><FONT face="times new roman,times">Thank you,<BR>Erez.</FONT></P></BLOCKQUOTE>
<P>Ah, another fan of <A href="http://archives.miloush.net/michkap/archive/2010/02/13/9962894.html" mce_href="http://archives.miloush.net/michkap/archive/2010/02/13/9962894.html"><STRONG>How Windows 7 broke VB6's RightToLeft property, and how to get it fixed</STRONG></A>! I don't mind pointing out that this one has proven to be very popular via several of the different people who are pointing to it....</P>
<P>Now this other issue is slightly different and has to do with a different issue: the fact that according to <A href="http://msdn.microsoft.com/library/dd317787.aspx">Day, Month, Year, and Era Format Pictures</A>, the <STRONG>ddd</STRONG> format refers to the <A href="http://msdn.microsoft.com/library/dd373831.aspx">LOCALE_SABBREVDAYNAME*</A> values, and those values have been changed in Windows 7.</P>
<P><EM>Did this change happen in Vista? I do not know but it may be the case. Does anyone know for sure?</EM></P>
<P>Now the <A href="http://msdn.microsoft.com/library/dd317787.aspx">Day, Month, Year, and Era Format Pictures</A>&nbsp;points out that:</P>
<BLOCKQUOTE>
<P><FONT face="times new roman,times"><STRONG>Windows&nbsp;Vista and later:</STRONG> If a short version of the day of the week is required, your application should use the <A href="http://msdn.microsoft.com/library/dd373890.aspx">LOCALE_SSHORTESTDAYNAME*</A> constants.</FONT></P></BLOCKQUOTE>
<P>This is why I wonder if the change is true of Vista as well.</P>
<P>Because if the folks in the subsidiary in Israel decided to move those one letter day names to&nbsp;<A href="http://msdn.microsoft.com/library/dd373890.aspx">LOCALE_SSHORTESTDAYNAME*</A> as soon&nbsp;as it started existing and then put some "slightly less short but still kind of short" names in <A href="http://msdn.microsoft.com/library/dd373831.aspx">LOCALE_SABBREVDAYNAME*</A>&nbsp;as soon as the new set of names became available, then it would explain what happened here. And even in Erez's case it isn't like actual formatting is being done - a fancy way to extract the same value as the GetLocaleInfo[Ex] call is all that the code is, in this case (since there are no genitive dates in Hebrew as I mentioned <A href="http://archives.miloush.net/michkap/archive/2008/05/14/8502723.html"><STRONG>before</STRONG></A>).</P>
<P>Though the problem here is that they did not add a format string, so to get the new shortest constants you would have to completely change to a GetLocaleInfo[Ex] call for the newer&nbsp;platforms.</P>
<P>Now this does suck a bit, though it kind of makes sense since the new constant was primarily added to support calendar-type applications rather than formatted dates. And there aren't good candidates for intuitive new format string tokens even if made sense to do (and there are bigger backcompat risks adding new tokens given the way that Windows handles tokens (something I could get into in some other post if people were interested).</P>
<P>Though they did not have to change the <A href="http://msdn.microsoft.com/library/dd373831.aspx">LOCALE_SABBREVDAYNAME*</A>&nbsp;values and break folks like Erez here.</P>
<P>I mean, knowing that locale data is subject to change does not mean changes should feel so gratuitous....</P>
<hr/><div style="margin-left: 1em"><em>no comments</em></div><hr/><p><em>referenced by</em></p><div style="margin-left: 1em"><p>2011/01/27 <a href="http://archives.miloush.net/michkap/archive/2011/01/27/10120308.html">{recycled joke here} It could have been called LOCALE_SSINGLESERVINGDAYNAME*</a></p></div><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2010/03/11/9976639.html" title="It&#39;s Iñupiaq, not Inupiaq! Could you stop removing those diacritics, please?">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2010/03/09/9975184.html" title="Coloring outside the lines in the a-ness of the Hungarian Technical Sort">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2010-03">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2010-03-10">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2010/03/10/9976075.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:35 GMT -->
</html>