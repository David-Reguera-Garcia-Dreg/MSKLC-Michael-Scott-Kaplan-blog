<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2010/07/16/10038461.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:35 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>Beauty isn't only glyph deep, even for Microsoft</title></head><body>
<h1>Beauty isn't only glyph deep, even for Microsoft</h1>
<p><em>by Michael S. Kaplan, published on 2010/07/16 07:01 -04:00, original URI: http://blogs.msdn.com/b/michkap/archive/2010/07/16/10038461.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<p>It was earlier this month that I wrote the blog entitled <a href="http://archives.miloush.net/michkap/archive/2010/07/06/10031112.html" title="Beauty isn't only glyph deep"><strong>Beauty isn't only glyph deep</strong></a>.</p>
<p>In it, I made serious&nbsp;accusation about what I consider the irresponsible behavior of the technological efforts of Google and Adobe.</p>
<p>And I stand by those accusations.</p>
<p>Not on behalf of Microsoft (who I didn't do this for)&nbsp;as a Microsoft employee (who I wasn't writing this as), but as one of the humans who depends on the quality of the work that both of these companies do. Just like almost everyone else out there, really.</p>
<p>I even pointed out how great it was that the "Save as XPS" and "Save as PDF" functionality in Microsoft Word 2007 and 2010 works around some of these shortcomings of these two companies. This was not to make people go buy copies of Word or Office, as I said -- it was to suggest that these other companies wake up and start doing their damn job.</p>
<p>I didn't mention it at the time, but it puts the whole effort Adobe put out to make Microsoft drop the "Save as PDF" functionality in the box for Office 2007 in a very different light -- like why they would fight a PDF done right in favor of their own poor quality add-in that does it wrong. Think about it for a moment, but not too long; I can get myself angry every time I think about it.</p>
<p>And when the official&nbsp;Google Blog can talk about their <a href="http://googleblog.blogspot.com/2010/07/our-commitment-to-digital-humanities.html">committment&nbsp;to the digital humanities</a> and say things like</p>
<p style="padding-left: 30px;"><em><span style="font-family: times new roman,times;">We&rsquo;re proud of our own Google Books digitization effort, having scanned over 12 million books in more than 400 languages, comprising over five billion pages and two trillion words. </span></em></p>
<p>I want to tell them to&nbsp;sit down and shut up&nbsp;until they create something in Google Books that can SEARCH in the languages in question in Unicode, since in so many cases it can't.</p>
<p>Now if you were reading here or were pointed at that <a href="http://archives.miloush.net/michkap/archive/2010/07/06/10031112.html" title="Beauty isn't only glyph deep"><strong>Beauty isn't only glyph deep</strong></a>&nbsp;blog, you saw it. A few people even pointed others to it. As blogs go it was slightly more popular than the average blog (not that I have average blogs, but you know what I mean).</p>
<p>But no one else really saw it. And no one is talking about it.</p>
<p>It&nbsp;bothers me a little&nbsp;(as I pointed out in a comment to that blog) that the "SlashGizCrunchBoy" crowd didn't jump in with opinions, and to be honest it is disappointing to me that no one seems to care when big companies treat emerging markets this way. But&nbsp;clearly they are too busy covering the latest "iPhone vs. Android" or "Apple vs. Adobe" or "When will AT&amp;T's Exclusive iPhone deal end" stories as they play out their "geek version of paparazzi" fest. The color of a Jobs-ian bowel movement after he recovered from his surgery&nbsp;would get better coverage from&nbsp;most of these sites/people&nbsp;than the fundamental flaw in almost every PDF document created&nbsp;in some parts of the world or the fact that Google is archiving books&nbsp;in a format akin to cottage cheese for much of the planet's scripts.</p>
<p>Though tat is the world I chose to live in; if I wanted the Thurrotts and Scobles&nbsp;and Foleys of the world&nbsp;to be covering me, I'd be writing about very different topics. And this would be a very different Blog.</p>
<p><strong>However</strong>, in a way I am glad that no one else cared.</p>
<p>Because it turns out that there is a bug in Microsoft's "Save as PDF" functionality, which causes some of the Unicode text in the Tagged PDF that Microsoft Word creates to be incorrect.</p>
<p>For small samples of text, everything works -- like my own documents and presentations I tested the functionality on before writing <a href="http://archives.miloush.net/michkap/archive/2010/07/06/10031112.html" title="Beauty isn't only glyph deep"><strong>Beauty isn't only glyph deep</strong></a>&nbsp;in&nbsp;the first place.</p>
<p>But then if I have a larger bit of text, the corruption sets in.</p>
<p>My friend N. Ganesan actually sent me a Word document entitled Tholkaappiyam.doc which I'm not sure but I think may be the actual Tolkāppiyam (தொல்காப்பியம்), albeit with modern Tamil rather than the ancient form of the script used when தொல்காப்பியம் was first written millenia ago.</p>
<p>And it was in converting this 19,669 word document that I first saw the problem.</p>
<p>You see, if I took the whole document then I saw a bunch of corruption, but single words were find (even when those same single words were just fine when not part of a larger document).</p>
<p>You can try it yourself, I'll give you the first paragraph to try it out with:</p>
<p style="padding-left: 30px;"><span style="font-size: large;">சிறப்புப்பாயிரம்<br />வட வேங்கடம் தென் குமரி<br />ஆயிடைத்<br />தமிழ் கூறும் நல் உலகத்து<br />வழக்கும் செய்யுளும் ஆயிரு முதலின்<br />எழுத்தும் சொல்லும் பொருளும் நாடிச்</span></p>
<p>Now if you put the first word into Word 2007 or 2010, and then save it as PDF, the PDF will</p>
<ul>
<li>display properly, and</li>
<li>be able to Copy/Paste into notepad with the text correct, and,</li>
<li>show a search in Adobe's PDF reader and others able to find the word.</li>
</ul>
<p>But if you&nbsp;take as much as the whole paragraph and do the same thing, the text still looks right as PDF but the underlying text becomes:</p>
<p style="padding-left: 30px;"><span style="font-size: large;">சிறப்புப்பாயிரம்<br />வட வவங்கடம் தென் குமரி<br />ஆயிடடத்<br />ெமிழ் கூறும் நல் உலகத்து<br />வழக்கும் தசய்யுளும் ஆயிரு முெலின்<br />எழுத்தும் தசால்லும் தபாருளும் நாடிச்</span></p>
<p>which has a somewhat baffling set of mistakes in it, as you can probably see just by looking at the visual changes and noticing the illegal sequences caused by letters improperly placed as some of the other letters were modified.</p>
<p>And if you do the entire document then the PDF has this text that is even more different:</p>
<p style="padding-left: 30px;"><span style="font-size: large;">ஓிநப்புப்தா஦ி஧ம்<br />஬ட வ஬ங்஑டம் த஡ன் கு஥ரி<br />ஆ஦ிடடத்<br />஡஥ிழ் கூறும் ஢ல் உன஑த்து<br />஬஫க்கும் தஓய்ப௅ளும் ஆ஦ிபே ப௃஡னின்<br />஋ழுத்தும் தஓால்ற௃ம் ததாபேளும் ஢ாடிச்</span></p>
<p>Now, even the first letter of that first word is wrong&nbsp;and overall there are even more problems and lots of code points that are still in the Tamil range that&nbsp;aren't even defined.</p>
<p>Summary: the bigger it gets, the worse it gets.</p>
<p>Friend Saranya helped me verify that the bug was in the PDF itself, and not a bug in either the Adobe reader I was using or the copy/paste process itself (either one of which would still have been a bug -- just a very different one). Her help here was invaluable because I needed to know who to blame to know shat to write about this time.</p>
<p>Now it was not my intent to deceive anybody with that initial blog, but now knowing that my claims gave Microsoft more credit than it (than we) deserved, I am writing this blog. And I will update the older one to include a pointer to this one.</p>
<p>Because I don't slam competitor products often but if I do so and I am to stay credible, I must be just as willing to be hard on Microsoft when they do things wrong as I am on Adobe or Google or anyone else.</p>
<p>With the bonus being&nbsp;that I can get potentially more done with people in Microsoft than I can with those other companies, since I don't have a SlashDot-esque PR nightmare to hand Adobe or&nbsp;Google (given that antennas and iPhone recall requests and store employees making fun of iPhone vs. Evo and such need to take up all the column inches. </p>
<p>But at least inside Microsoft, I have the fact that the&nbsp;engineeers who do this work know that the entire effort is undermined by bugs like this, and the people&nbsp;who do the work&nbsp;really want things to be correct. I have no proof in the case of these other companies because they have not ever reported that these problems widely exist or that a solution is in the works.</p>
<p>My only hope is that these other companies have someone just like me within them,&nbsp;someone generally considered to be T.U.T.F. who gets very stubborn about inadequate support of core scenarios that affect language quality.</p>
<p>Because frankly the whole world deserves something better than this. From all of the tech companies -- including Adobe, Google, and Microsoft....</p>
<hr/><p><strong>Daniel</strong> on 16 Jul 2010 8:03 AM:</p><div style="margin-left: 1em"><p>So in reality Mac OS X also fails miserably when taking real text rather than single characters.</p>
<p>The generated PDF on first sight looks the same but if you try to copy from it, you end up with garbage:</p>
<p>!ற#$#பா&#39;ர) வட ேவ-கட) ெத1 2ம4 ஆ&#39;ைட7 த89 :;) ந= உலக7@ வழB2) ெசDEF) ஆ&#39;G HதI1 எK7@) L=M) NGF) நாOP</p>
<p>And that same garbage is what you can search for.</p>
<p>You search for the digit 7 and it highlights த்.</p>
<p>People affected by this sure have my sympathy.</p>
</div>
<p><strong>Joe Clark</strong> on 16 Jul 2010 1:47 PM:</p><div style="margin-left: 1em"><p>Representation of scripts with conjuncts in tagged PDF is, at best, barely possible. The eternal issue of using a sequence of underlying characters that result in a single visible character (with later characters affecting previous ones) has not been resolved.</p>
<p>One tiny outpost of the PDF demimonde knows about this but has chosen to ignore it. The rest are in complete ignorance.</p>
</div>
<p><strong>Michael S. Kaplan</strong> on 16 Jul 2010 10:11 PM:</p><div style="margin-left: 1em"><p>The Microsoft Word implementation, if one ignores this one bug, is sound -- proving it is possible. But the bug proves that even when one is trying to do it right one can have problems....</p>
</div>
<p><strong>Joe Clark</strong> on 17 Jul 2010 11:00 AM:</p><div style="margin-left: 1em"><p>Yes, but not every method of producing a conjunct character (even decomposed diacritics on Latin) will work in tagged PDF.</p>
</div>
<p><strong>Michael S. Kaplan</strong> on 17 Jul 2010 11:13 AM:</p><div style="margin-left: 1em"><p>I have looked at the text stream and the glyphs and the connection between them, and while individual connections are weak in points where there is no good way to pick a &quot;place&quot; to say you are, that is just like when in the middle of a conjunct and there is no good &quot;place&quot; to put the cursor. It does not mean the text is unavailable.</p>
<p>Do you have an example where the text will not be able to be there, though?</p>
<p>Also (FWIW) the XPS text is completely available and does not have this issue. XPS may not be a PDF killer, but it is a PDF &quot;reminder that you can do better when you put forth the effort&quot; tool. :-)</p>
</div>
<p><strong>Henrik Holmegaard, technical writer</strong> on 4 Nov 2010 4:17 AM:</p><div style="margin-left: 1em"><p>&gt; My only hope is that these other companies have someone just like me within them, someone generally considered to be T.U.T.F. who gets very stubborn about inadequate support of core scenarios that affect language quality.</p>
<p>If you want comment, then it does not make much sense to censure comment at the start. If you want to talk to yourself, though, you&#39;re welcome :-).</p>
<p>/hh</p></div>
<p><strong>Michael S. Kaplan</strong> on 4 Nov 2010 5:08 AM:</p><div style="margin-left: 1em"><p>Comments are always welcome!</p>
</div>
<hr/><p><em>referenced by</em></p><div style="margin-left: 1em"><p>2010/09/29 <a href="http://archives.miloush.net/michkap/archive/2010/09/29/10069077.html">Dotting the t's and crossing the i's is more work than that, PDF edition</a></p><p>2010/09/06 <a href="http://archives.miloush.net/michkap/archive/2010/09/06/10057561.html">Acrobat PDF: the Yugo vs. the BMW vs. the Ferrari</a></p><p>2010/07/06 <a href="http://archives.miloush.net/michkap/archive/2010/07/06/10031112.html">Beauty isn't only glyph deep</a></p></div><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2010/07/17/10039409.html" title="I think of them as American Express, internationally not so much">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2010/07/16/10038421.html" title="Which form to use if the form keeps changing?">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2010-07">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2010-07-16">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2010/07/16/10038461.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:35 GMT -->
</html>