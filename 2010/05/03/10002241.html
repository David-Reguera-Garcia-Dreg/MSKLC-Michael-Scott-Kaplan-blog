<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2010/05/03/10002241.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:35 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>One product's (or person's) intended design is another product's (or person's) bug. And vice versa.</title></head><body>
<h1>One product's (or person's) intended design is another product's (or person's) bug. And vice versa.</h1>
<p><em>by Michael S. Kaplan, published on 2010/05/03 07:01 -04:00, original URI: http://blogs.msdn.com/b/michkap/archive/2010/05/03/10002241.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<P>It is interesting how often there will be two groups of people, each of whom thinks a particular behavior is expected, while another is buggy.</P>
<P>One of those group's bugs are the other's expected behavior. And vice versa.</P>
<P>The funniest part happens when one group is more right than the other, by some objective criteria like overall behavioral impact.</P>
<P>As a final plot twist, a few inconsistencies and confusing KB articles can fan the flames, as well.</P>
<P>Sound like anything you've seen before? </P>
<P>It is a common pattern.... :-)</P>
<P>I'll start with regular reader <A title="Jan Kučera" href="http://blogs.msdn.com/user/Profile.aspx?UserID=95319" target=_blank>Jan Kučera</A> from a note in the Suggestion Box:</P>
<BLOCKQUOTE>
<P><FONT face="times new roman,times"><EM>I don't know why it came so late to me, but I live in a country that is preparing for the euro. So Microsoft eventually releases an update for our culture when ..it happens.</EM></FONT></P>
<P><FONT face="times new roman,times"><EM>You mean that all existing e.g. Excel spreadsheets with currency/accounting data will show up in^H^Hwith euros instead of krowns? I can't believe there were no support calls regarding this. Unless nobody is actually using these formats. :)</EM></FONT></P>
<P><FONT face="times new roman,times"><EM>So any note on how similar transitions works, or if/how multiple currencies per region are handled, would be helpful. Thanks!</EM></FONT></P>
<P><FONT face="times new roman,times"><EM>Jan</EM></FONT></P></BLOCKQUOTE>
<P>Jan is 100% correct in his concern -- Excel's behavior here that would simply format using the Regional and Language Options formatting without regard for the fact that the intrinsic meaning of the data is changing boggles the mind as something that would quite simply corrupt currency information&nbsp;completely if someone doesn't know to ignore the currency sign completely.</P>
<P>The only time the behavior is not a complete brain-dead bug is when an Excel application is empty of data and shipped to a customer with different settings -- that would the one time that the change shouldn't retain any sense of memory of the fact that you typed in <STRONG>krowns</STRONG> for those monetary values when perhaps you wanted <STRONG>euros</STRONG>. But if you have any data in the spreadsheet, it should retain that memory of what the values were when you typed them in. Any other behavior is potentially very very bad unless you ignore the formatting -- in which case you are better off if it isn't there at all.</P>
<P>There was a scene in TV show Angel where Angel, after having won a certain ring, had earned the right to go to the home office of Hell. He went down a long elevator ride and came out where he started -- because he was already in Hell but had not noticed.</P>
<P>Imagine for a moment that the majority of the business world is run on various Excel spreadsheets.</P>
<P>Then once you snap out of it you will realize you were already in that world.</P>
<P>Because for every application a company pays some consultant to write, there are four dozen Excel spreadsheets that contain all kinds of bsuiness logic in them.</P>
<P>Imagine that just 0.1% of them hold currency values where&nbsp;a reported printed with a changed currency symbol but unchanged values could cause companies to think that THEY were now in Hell.</P>
<P>Scary thought, huh?</P>
<P>Luckily, this really is just a display issue; the symbol imparts no knowledge that would cause programs to behave differently. So beyond a few reports that print values that look to insanely large or too laughably small, the "bug" is more or less contained.</P>
<P>Unfortunately Jan, Excel has no solution here; this is their long-standing behavior.</P>
<P>You basically need to treat it as a number and ignore the currency sign, storing that knowledge elsewhere of whether you are dealing with <STRONG>dollars</STRONG> or <STRONG>euros</STRONG> or <STRONG>yen</STRONG> or whatever. Which is what people mostly do.</P>
<P>So if you look at the nature of the bug here, to fix it on the Excel side you would have had to have each field formatted as a <STRONG>currency value</STRONG> store not only that it is a currency value but also what the Regional and Language Options locale was at the time the value was added.</P>
<P>So it could always remember what it was.</P>
<P>Now as a by the way, no product does <STRONG>this</STRONG> right.</P>
<P>But a related bug (when you change the default user locale, say from en-US to ja-JP) that Excel also has -- and is very serious if you think about the way currency rates fluctuate and are sometimes so very different that you are massively changing the meaning of the numbers -- that bug does not exist in all programs.</P>
<P>If you look at Microsoft Access, it turns out that at least since Access 2.0 and probably before that&nbsp;it has been doing the very "fix" I suggested above: when you set a column's formatting to be <STRONG>Currency</STRONG> it remembers the default user locale when you put in the data. So that if you change your default user locale it does not massively change the meaning of your data.</P>
<P>If there are any Access old-timers around they could verify my recollection on this one, but it was largely through the efforts of Emma, the International Program Manager for Access from Access &lt;= 97 that&nbsp;kept this subtle data corruption bug from being added to the product.</P>
<P>It was intentional, it was by design, and has been for at least since Access 2.0 and maybe earlier.</P>
<P>But you may notice if you look at <A href="http://donnedwards.openaccess.co.za/2009/03/microsoft-access-and-ten-year-old.html" mce_href="http://donnedwards.openaccess.co.za/2009/03/microsoft-access-and-ten-year-old.html">Microsoft Access and the Ten-Year-Old Currency Bug</A> from&nbsp;a bit&nbsp;over a year ago&nbsp;that Donn Edwards (the author) not only believes the behavior of "silently" making this change to be a bug, but he blames me personally for the behavior.</P>
<P>Even though it was done before I was even doing things with Access as a <STRONG>user</STRONG> in any serious way, let alone on the Access team (and that when I was on the team years later I was not working in that area of the product).</P>
<P>Okay, I'll take one for the team here despite all that, since I have defended the behavior in the past, am defending it right now, and will continue to defend it in the future -- it is the right behavior. Though may still be some nuances for the empty database scenario -- and if there still are I'd be willing to call those bugs since the empty table case reasonably could be expected to behave differently from the case where a table contains rows of&nbsp;currency data --&nbsp;which I assume is the one I am being&nbsp;vilified for (though the rant goes on for quite a while so I tuned out; perhaps someone else can glean whether there is another complaint there).</P>
<P>To be honest it would make sense to extend the Access behavior to handle Jan's case&nbsp;where the currency within a locale is changed (e.g. from <STRONG>krowns</STRONG> to <STRONG>euros</STRONG>) and store it the same way that the locale is stored now. Because that would help with the migration of existing monetary data. I suspect that making such a change would be controversial, though if I am right everyone could be made happy with some simple changes in the next version of Access (after the one that just came out)&nbsp;to clean up any remaining issues in the empty table case (if there are any; I have not checked).</P>
<P>Then someone could also fix the crazy behavior in Excel, the one that <STRONG>does</STRONG> corrupt data unless one knows to ignore the formatting....</P>
<P>I agree that the documentation here is absent/confusing, and with some of these vicious threads the web isn't much better. Also, <A href="http://support.microsoft.com/kb/142009" mce_href="http://support.microsoft.com/kb/142009">this</A> retired KB article is wrong about the old products to which if refers. Not sure what gets done in that case. <A href="http://support.microsoft.com/kb/208596/en-us" mce_href="http://support.microsoft.com/kb/208596/en-us">This other article</A> is a more accurate description of the&nbsp;behavior.</P>
<P>And I have a lot more respect for MVP Allen Browne's <A href="http://allenbrowne.com/ser-44.html" mce_href="http://allenbrowne.com/ser-44.html">take on the issue</A>; he and I disagree, but a lot more respectfully. He at least takes the time to understand the intent and feels that the documented descriptions of the application lead one to make bad decisions since the behavior is not clear. It if for that sake that I hope Access would consider looking into&nbsp;fixing the empty table case (perhaps on Compact, Access could reset the format when there are no rows in the table, or something like that? It is more complicated than that since it would be a behavior change, but an "application deliver" process would be a new feature that could perhaps do this kind of cleanup).</P>
<P>It is interesting to find out that the Internet contained a page with such venomous indictments of me and I never knew about it at all. But I suppose that is the nature of the angry dark side of the web....</P>
<hr/><p><strong>Russ Paul-Jones</strong> on 3 May 2010 12:18 PM:</p><div style="margin-left: 1em"><p>&quot;Now as a by the way, no product does this right.&quot;</p>
<p>The now-defunct Microsoft Money came very close to doing this right. It was inherently multi-currency, so it didn't respect the current Locale as you describe, but it did remember what currency each amount represented, and it had some special-case code to handle a country's conversion of its currency.</p>
<p>-Russ Paul-Jones</p></div>
<p><strong>Michael S. Kaplan</strong> on 3 May 2010 12:24 PM:</p><div style="margin-left: 1em"><p>Ah, very true. Of course they lost in face of Quicken (who else imagined a Higjhlander-esque &quot;Quickening&quot; pun in a headline on that one -- there can be only one!)....</p>
<p>If I had thoght about that one, that would have been a theme here and the title for *this* blog. :-)</p>
</div>
<p><strong>Random832</strong> on 3 May 2010 3:27 PM:</p><div style="margin-left: 1em"><p>This article appears to be miscategorized under &quot;Unicode Lame List&quot;.</p></div>
<p><strong>Michael S. Kaplan</strong> on 3 May 2010 5:40 PM:</p><div style="margin-left: 1em"><p>With everyone claiming that some aspects of the current behavior is buggy and me myself claiming several bugs, it does not seem miscategorized to me.</p>
</div>
<p><strong>Random832</strong> on 5 May 2010 5:15 AM:</p><div style="margin-left: 1em"><p>I'm not saying it's not lame - I'm saying I can't see how it's Unicode-related. Usually posts in this category have to do with some flaw in the standard itself, or some flaw in support for it in some program.</p></div>
<p><strong>Michael S. Kaplan</strong> on 5 May 2010 5:46 AM:</p><div style="margin-left: 1em"><p>Well, it is internationalization-related....close enough for me. :-)</p>
</div>
<p><strong>Jan Kučera</strong> on 7 May 2010 2:43 AM:</p><div style="margin-left: 1em"><p>Hi all, thanks for explaining. There was this little hope that if you can actually choose the currency the Excel will use (even &quot;CZK&quot;), it does remember the choice by means of format, not of culture. Especially when we have custom cultures now and one cannot guarantee the very one used will be present on the other system.</p>
<p>However, it is true that if I am using Czech culture modified to use a dot as a decimal separator, I would still expect that data will be formatted according to the settings on the computer showing it. Interesting. (this also cancells the culture+date solution)</p>
<p>And it is true that if there were some cells in krowns ..or krowns in cells :), I would expect that entering new numbers will still use krowns, which is not what could saving the currency format per value deliver anyway.</p>
<p>Hmm..so it turns out I have no opinion how this should work, but I don't like any of the obvious ways and non-obvious would be... well not obvious, anyway.</p>
<p>What a hard work an internationalization team has to do! :)</p>
</div>
<hr/><p><em>referenced by</em></p><div style="margin-left: 1em"><p>2011/04/01 <a href="http://archives.miloush.net/michkap/archive/2011/04/01/10148569.html">One developer's supported scenario is another's awful bolt-on job...</a></p></div><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2010/05/04/10003033.html" title="The wacky world of WOW64 keyoards, un-leashed, un-locked, un-something-or-other">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2010/05/02/10005857.html" title="Kazakhstan (a country 4 times the size of Texas) has its own Windows 7 LIP!">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2010-05">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2010-05-03">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2010/05/03/10002241.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:35 GMT -->
</html>