<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2010/08/25/10053944.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:35 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>Yet another cost to not supporting Unicode?</title></head><body>
<h1>Yet another cost to not supporting Unicode?</h1>
<p><em>by Michael S. Kaplan, published on 2010/08/25 07:01 -04:00, original URI: http://blogs.msdn.com/b/michkap/archive/2010/08/25/10053944.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<p><span style="color: #ff0000;"><em>It is very hard to type when one has a sprained shoulder. Thank goodness for Dragon Dictate!&nbsp;I'm just saying....</em></span></p>
<p>Over in the Suggestion Box, Alex asked:</p>
<p style="padding-left: 60px;"><span style="font-family: times new roman,times;">Hi, Michael.</span></p>
<p style="padding-left: 60px;"><span style="font-family: times new roman,times;">I've googled through your blog, but haven't found an answer to the following question. This question is very popular (at least in Russia) &nbsp;and I was surprised that you didn't covered it yet. So, may be you can tell us a story behing it. This issue is about clipboard, text and non-unicode application. </span></p>
<p style="padding-left: 60px;"><span style="font-family: times new roman,times;">Take a old non-Unicode application (like Notepad from Win9x) and run it on new Windows (like XP), which have 2 input languages installed (like English and Russian, for example). Suppose that "Language for non-Unicode application" setting is set to Russian.</span></p>
<p style="padding-left: 60px;"><span style="font-family: times new roman,times;">In Win9x you can copy text via clipboard from any application to any other application without problem. Sure, old apps don't bother to set CF_LOCALE along with CF_TEXT, but things worked very well then, since the same code page was used by all apps (okay: almost all).</span></p>
<p style="padding-left: 60px;"><span style="font-family: times new roman,times;">Now, take a modern "Unicode" OS, like XP. You take your old app, which served you many years, copy text to clipboard, paste it in other application (like modern Notepad) and... whoa: you get question marks or gibberish. What's wrong? Heck, you forgot to _switch keyboard input to Russian_. Once you do that - everything start acting smooth again.</span></p>
<p style="padding-left: 60px;"><span style="font-family: times new roman,times;">Example: </span><a target="_new" rel="nofollow" href="http://dl.dropbox.com/u/201788/Web/552912982__krakozyb.gif"><strong><span style="font-family: times new roman,times;">dl.dropbox.com/.../552912982__krakozyb.gif</span></strong></a></p>
<p style="padding-left: 60px;"><span style="font-family: times new roman,times;">Top row: left - notepad from Win98, right - notepad from XP. Bottom row: left: notepad from XP, right - notepad from Win98. Current input language is set to "English (United states)" (like we forgot to switch it to Russian). Red lines indicate copy/paste operations via clipboard. (I took Microsoft's application to indicate that this is not a bug in particular 3rd party application).</span></p>
<p style="padding-left: 60px;"><span style="font-family: times new roman,times;">The problem (as I see it) is getting Unicode text from ANSI-text. Why Windows uses keyboard input method for that, rather than using "Language for non-Unicode applications"? </span></p>
<p style="padding-left: 60px;"><span style="font-family: times new roman,times;">This is terrible break in user experience. Most people thinks that this is a bug. I hear this complain very often (heck, I hear cursing Microsoft in almost all cases of mentioning this). It's especially painfull to explain that your application, written a many years ago, has nothing to do with this change.</span></p>
<p style="padding-left: 60px;"><span style="font-family: times new roman,times;">Can you shred a bit of the light on the background of this issue, please? Why Microsoft decided to (okay, not to break, but to) compicate lives of zillions of existing applications? If Microsoft cares a lot about backward compatibility - why was such decision made? </span></p>
<p>This sounds very familiar.</p>
<p>I can't quite put my finger on it.</p>
<p>Oh yeah, I was thinking of <a href="http://archives.miloush.net/michkap/archive/2007/03/08/1838231.html" title="Double Secret ANSI, part 1 (Somewhere between ANSI and Unicode)"><strong>Double Secret ANSI, part 1 (Somewhere between ANSI and Unicode)</strong></a> and <a href="http://archives.miloush.net/michkap/archive/2007/03/20/1917161.html" title="Double Secret ANSI, part 2 (the brokenest one yet, sorry 'bout that!)"><strong>Double Secret ANSI, part 2 (the brokenest one yet, sorry 'bout that!)</strong></a>.</p>
<p>The Win9x version of this very same feature that actually allowed a tiny bit of cross-codepage stuff to work if people tried hard enough (like Adobe did) was kind of incomplete. </p>
<p>The NT-based version of it fills in the holes, which are apparently what some people were relying on a little bit?</p>
<p>Technically the NT-based version of this feature has always been broken though. That makes fixing it kind of a tough sell, as opposed to just supporting Unicode in the apps.</p>
<p>Historically, we seem to be in the habit of breaking people who aren't using Unicode. Not because of an attempt to sabotage, but just because Unicode support gets a lot better coverage....</p>
<hr/><p><strong>yuhong2</strong> on 26 Aug 2010 1:43 PM:</p><div style="margin-left: 1em"><p>BTW, anyone here remember Apple&#39;s WorldScript?</p>
</div>
<hr/><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2010/08/26/10054522.html" title="The last of the Malays...">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2010/08/24/10053436.html" title="Ok, we all know when 6 turns out of nine. But when does 17 turn out to be 10?">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2010-08">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2010-08-25">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2010/08/25/10053944.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:35 GMT -->
</html>