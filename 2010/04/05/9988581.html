<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2010/04/05/9988581.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:35 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>MSKLC, the Numeric Keypad, Lithuanian, and laptops....especially those laptops</title></head><body>
<h1>MSKLC, the Numeric Keypad, Lithuanian, and laptops....especially those laptops</h1>
<p><em>by Michael S. Kaplan, published on 2010/04/05, original URI: http://blogs.msdn.com/b/michkap/archive/2010/04/05/9988581.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNewMonth -->
<P>Over in the Suggestion Box, <A href="http://rq.lt/" mce_href="http://rq.lt/">RQ</A> asked:</P>
<BLOCKQUOTE>
<P><FONT face="times new roman,times"><EM>Hi Michael,</EM></FONT></P>
<P><FONT face="times new roman,times"><EM>I've been using MSKLC to create an improved keyboard layout for Lithuanian, and have a question now based on the feedback I received:</EM></FONT></P>
<P><FONT face="times new roman,times"><EM>The thing is that while most notebooks allow to simulate numeric keypad by pressing the Fn-key plus certain keys on the right (e.g. JKL produces 123), most manufacturers have made this function pretty useless, because in their products, without NumLock turned on, Fn &nbsp;plus those key presses just move caret, and with NumLock on, it becomes impossible to type letters using those keys. The solution to this problem would seem to override the functions of Numpad keys to make them always generate numbers. Currently it's impossible using MSKLC. I even edited the klc file manually, and compilation failed because VK's like NUMPAD1 were not recognized.</EM></FONT></P>
<P><FONT face="times new roman,times"><EM>So the question is: is it possible to override numpad keys from a layout? If yes, then:</EM></FONT></P>
<P><FONT face="times new roman,times"><EM>1) perhaps support for this could be included in the next version of MSKLC?</EM></FONT></P>
<P><FONT face="times new roman,times"><EM>2) can I trick the current version of KLC to do this? Or maybe I could run some commands from command line to compile such layouts manually?</EM></FONT></P>
<P><FONT face="times new roman,times"><EM>Thanks,</EM></FONT></P>
<P><FONT face="times new roman,times"><EM>Rimas</EM></FONT></P></BLOCKQUOTE>
<P>This question seems to come up fairly often, all things considered. Like in all of the following blogs from this Blog:</P>
<UL>
<LI><A href="http://archives.miloush.net/michkap/archive/2006/09/14/754162.html" mce_href="http://archives.miloush.net/michkap/archive/2006/09/14/754162.html"><STRONG>Why doesn't MSKLC have a numeric keypad?</STRONG></A></LI>
<LI><A href="http://archives.miloush.net/michkap/archive/2008/08/01/8797398.html" mce_href="http://archives.miloush.net/michkap/archive/2008/08/01/8797398.html"><STRONG>How do you key your num pad without going blind?</STRONG></A></LI>
<LI><A href="http://archives.miloush.net/michkap/archive/2006/09/20/763157.html" mce_href="http://archives.miloush.net/michkap/archive/2006/09/20/763157.html"><STRONG>Variation on that theme of wanting more keys covered by MSKLC</STRONG></A></LI></UL>
<P>and so on.</P>
<P>In fact you may recall in one blog (<A href="http://archives.miloush.net/michkap/archive/2007/07/04/3690200.html" mce_href="http://archives.miloush.net/michkap/archive/2007/07/04/3690200.html"><STRONG>Pimping the numeric keypad</STRONG></A>)&nbsp;that I claimed one could update them from the command line.</P>
<P>I said that based on a text file that sits in the same place as the kbdtool.exe that Windows itself uses, that one that kbdutool.rexe was based on, which has the following information in it:</P>
<BLOCKQUOTE>
<P><STRONG><FONT size=1>Default Entries<BR>----------------<BR>Certain keys which are common to all keyboard layouts have default entries<BR>created for them by kbdtool.exe.<BR>These may be overridden by specifying them in the LAYOUT section.</FONT></STRONG></P></BLOCKQUOTE>
<P>This file, which is itself as old as the hills with very littl change since it was first written, was apparently not updated when some later change was made to the tool, as any attempt to update the NUMPAD* keys fails with an error about the scan code redefinition followed five other compiler errors right after. This happens in both the Windows one and the MSKLC one.</P>
<P>This technique works for other keys like VK_OEM8 as I have covered before, but the numbers and other keys on the numeric keypad can't be defined. Therefore, it isn't available as an option, and is really out of scope for the tool anyway (which is why no one ever noticed this).</P>
<P>But beyond that, getting to the specific scenario of the report....</P>
<P>This desire to get the "input Unicode code points" feature would still not work anyway to solve RQ's reported problem, even if there were a numeric keypad, as the FN thing can't be hacked in MSKLC. Even by the keyboard layout DLL.</P>
<P>It is done at&nbsp;a much lower level than the keyboard layout DLL (it is the way that laptop manufacturer's "hack" their keyboards to fake additional characters, and the actual scan code values underneath are modified for things to work).</P>
<P>It is (for example) the kind of trickery that lets you type CTRL+ALT+BACKSPACE to hit the login screen on a MacBookPro running Windows under Boot Camp, or all manner of other such trickery.</P>
<P>In the case of the numeric keypad, there is already a bunch of trickery happening, and what the laptops do here isn't good enough given the steps required for this input method:</P>
<BLOCKQUOTE>
<P><FONT face="times new roman,times">This method works regardless of any of your language settings, but is the most cumbersome to type.</FONT></P>
<P><FONT face="times new roman,times">1.Press and hold down the Alt key.<BR>2.Press the + (plus) key on the numeric keypad.<BR>3.Type the hexidecimal unicode value.<BR>4.Release the Alt key.<BR>Alas, this appears to require a registry setting. It was already set on my computer, but some readers report that this method didn't work for them, and this is probably why. If you don't know what the registry is, please don't try this. Under HKEY_Current_User/Control Panel/Input Method, set EnableHexNumpad to "1". If you have to add it, set the type to be REG_SZ. </FONT></P></BLOCKQUOTE>
<P>Note that I shamelessly stole this from the "Universal" method described in <A href="http://www.fileformat.info/tip/microsoft/enter_unicode.htm" mce_href="http://www.fileformat.info/tip/microsoft/enter_unicode.htm">How to enter Unicode characters in Microsoft Windows</A>. If you think about both the steps that the Fn-based laptop solution requires and steps 1-4 above you could probably guess why there might be problems here, as the Dell/HP/Toshiba trickery is trumped by the trickery in this method of input.</P>
<P>The fix for THAT problem is not a keyboard layout hack; it is those OEMs (<FONT color=#ff0000>are any of them, <STRONG>or their Microsoft TAMs</STRONG>,&nbsp;readers of this Blog?</FONT>) rethinking their NUMLOCK support on laptops, because only by allowing a completely unfettered way to get to the numeric keypad can this be not only practical but even possible!</P>
<P>I thought I'd talk about Lithuanian for a minute, since it seems to be almost a <A href="http://en.wikipedia.org/wiki/MacGuffin" mce_href="http://en.wikipedia.org/wiki/MacGuffin">MacGuffin</A> in this whole story, perhaps intended to pique my interest more than a retread of the numeric keypad issue would (I admit I had been planning to eventually talk about how to override those keys which would have made <A href="http://archives.miloush.net/michkap/archive/2007/07/04/3690200.html" mce_href="http://archives.miloush.net/michkap/archive/2007/07/04/3690200.html"><STRONG>Pimping the numeric keypad</STRONG></A>&nbsp;a choice bit of foreshadowing).</P>
<P>But then&nbsp;I&nbsp;discovered that it was not in fact possible with the unaltered tools as it seemed it would be, ruining the foreshadowing, so I figure at least I can hurt the MacGuffin's stature a bit as well. Not strictly logical as an argument, but then I am not always strictly logical as an arguer!).</P>
<P>Lithuanian holds an&nbsp;interesting place as it is the one European Latin-script based language that has attested examples (in "Old Lithuanian" documents) of characters involving mutliple&nbsp;diacritics that have no "composed" characters in Unicode and therefore require the "decomposed" form to be used. It also (incidentally) makes it yet another language that has problems with dead-key based keyboards in Windows, but note that this is not exactly due to the lack of these "composed" characters (after all both Polytonic Greek and Vietnamese have the characters and they have the problem as well). These characters eventually were defined as <A href="http://www.unicode.org/Public/UNIDATA/NamedSequences.txt" mce_href="http://www.unicode.org/Public/UNIDATA/NamedSequences.txt">named sequences</A> in Unicode to try to help folks compose themselves about the need to stay decomposed. :-)</P>
<P><STRONG>As a random,&nbsp;unrelated&nbsp;Lithuanian factoid: </STRONG>Lithuanian and Latvian have had&nbsp;their ups and downs in Windows, with changes requested in the Vista time-frame after groups of people were unhappy that letters with primary distinctions in dictionaries were treated as letters with diacritics. In the case of Latvian, however, other groups came back before Windows 7 was released complaining that a Latvian standard admitted this difference while also wanting the ability to do searches where the diacritics which were not to be treated as diacritics could nevertheless be optionally ignored in matching though perhaps not in sorting. In Lithuania we were spared this odd and unruly directive (I no longer owned sorting when that bug report came in, about a year ago, so I was spared the Latvian issue as well except as a consultant/historian who could dig up the old mail threads).</P>
<P><STRONG>As another random,&nbsp;unrelated Lithuanian factoid: </STRONG>Lithuanian's general "lumping in" to <A href="http://msdn.microsoft.com/en-us/goglobal/cc305150.aspx" mce_href="http://msdn.microsoft.com/en-us/goglobal/cc305150.aspx">code page 1257</A> (along with Latvian and Estonian) was a necessary consequence of the other code pages being too full to hold all the characters needed; it was a slightly ironic twist that caused a nameless southern hemisphere locale added years later that would have been better served by cp1257 but was instead given cp1252 as an ANSI code page since that reflects the practices of applications in the area anyway. The fact that things close to Australia are hardly "Baltic" while cp1257 *is* may also have been a minor factor, but we could have just changed the name if we needed to!</P>
<P>Getting back on topic here at the end....</P>
<P>Luckily, letters for Lithuanian can be put right on the keyboard, as well. Even those older letters, if they are needed (just not as dead keys). That would be much easier to type than putting the Unicode code points into a pseudo-numeric keypad like laptops have!</P>
<BLOCKQUOTE>
<P><FONT color=#ff0000>UPDATE 6 April:</FONT></P>
<P><FONT color=#ff0000>It is the shift that throws in the confusion there; if you have such an "Overlay" key (or if CAPS LOCK does the same thing - one of my computers did, the other two did not) then you can even get the UNICODE CHAR functionality to work:</FONT></P>
<BLOCKQUOTE>
<P><FONT color=#ff0000 face="consolas,lucida console,courier new,courier,fixed"><STRONG>&lt;fn&gt;+&lt;F6&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;----- [numlock]<BR>&lt;caps lock&gt;<BR>&lt;ALT&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;----- {hold down ALT while hitting the next 4 keystrkes}<BR>J&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;----- 1<BR>K&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;----- 2<BR>L&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;----- 3<BR>U&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;----- 4</STRONG></FONT></P></BLOCKQUOTE>
<P><FONT color=#ff0000>So if your laptop has an "overlay" key, or if capslock gives you the same functionality, you can make the NUMPAD work well enough for the input of Unicode chars via the &lt;ALT+&gt; method.....</FONT></P>
<P><FONT color=#ff0000>Thanks as usual, Marc! :-)</FONT></P></BLOCKQUOTE>
<hr/><div style="margin-left: 1em"><em>comments not archived</em></div><hr/><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2010/04/06/9989320.html" title="Arabic? English? Both? Neither?">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2010/04/04/9990218.html" title="One can&#39;t be a cutup when one is talking about cutouts">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2010-04">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2010-04-05">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2010/04/05/9988581.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:35 GMT -->
</html>