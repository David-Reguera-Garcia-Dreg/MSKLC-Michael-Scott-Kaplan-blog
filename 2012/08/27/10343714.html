<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2012/08/27/10343714.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:27 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>When functions don't do what you want them to...</title></head><body>
<h1>When functions don't do what you want them to...</h1>
<p><em>by Michael S. Kaplan, published on 2012/08/27 07:01 -04:00, original URI: http://blogs.msdn.com/b/michkap/archive/2012/08/27/10343714.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<p>So, the other day, Jon Fullerton, in a comment to <strong><a title="Cutting the cord, revisited -- and documenting how to get the job done!" href="../24/6631463.html">Cutting the cord, revisited -- and documenting how to get the job done!</a></strong>, asked:</p>
<p style="padding-left: 60px;"><em><span style="font-family: times new roman,times; font-size: medium;">Michael,</span></em></p>
<p style="padding-left: 60px;"><em><span style="font-family: times new roman,times; font-size: medium;">I'm trying to use InstallLayoutOrTip to install Tips for the current user, but they seem to only go to local machine. Can you provide a sample of the correct calling convention to have it apply to the current user. From the above discussion I'm unclear on how you use ActivateKeyboardLayout if it is not proceeded by LoadKeyboardLayout.</span></em></p>
<p style="padding-left: 60px;"><em><span style="font-family: times new roman,times; font-size: medium;">Thanks,</span></em></p>
<p>I was kind of confused at first.</p>
<p>I mean, MSKLC 1.4 creates setup packages that install a keyboard layout for the current user, and I call the&nbsp;<a title="InstallLayoutOrTip" href="http://msdn.microsoft.com/library/windows/desktop/bb847909">InstallLayoutOrTip</a>&nbsp;function from C just fine there (in the custom action DLL the installer uses).</p>
<p>It definitely doesn't install for anyone other than the current user.</p>
<p>What could be going on here?</p>
<p>Maybe he was calling it with the <strong><span style="font-family: courier new,courier;">ILOT_DEFPROFILE</span></strong> flag.</p>
<p>Or maybe even the <strong><span style="font-family: courier new,courier;">ILOT_DEFUSER4</span></strong> flag?</p>
<p>The most important flag is one I never mentioned, which the help never mentions either.</p>
<p>The <span style="font-family: courier new,courier;"><strong>ILOT_INSTALL</strong></span> flag.</p>
<p>You can define it with a value of 0x00000000.</p>
<p>Not sure why they didn't include it! Anyone looking at doc bugs want to add it to the table? :-)</p>
<p style="padding-left: 30px;"><strong><span style="font-family: courier new,courier;">#define ILOT_INSTALL 0x00000000</span></strong></p>
<p>Or maybe Jon called it right but he was running elevated and it applied it somewhere else.</p>
<p>He didn't include the code he used so I'm not sure.</p>
<p>But when he sees this blog he can clue me in on what was being tried and failed!</p>
<hr/><div style="margin-left: 1em"><em>no comments</em></div><hr/><p><em>referenced by</em></p><div style="margin-left: 1em"><p>2012/08/28 <a href="../28/10344043.html">'If it is easy, then there are samples. And if it's very easy, everyone is writing them.'</a></p></div><p><em>go to <a id="newer" href="../28/10344043.html" title="&#39;If it is easy, then there are samples. And if it&#39;s very easy, everyone is writing them.&#39;">newer</a> or <a id="older" href="../24/10343121.html" title="Keyboard driver development isn&#39;t easy">older</a> post, or back to <a href="../../../index-2.html">index</a> or <a href="../../../index-2.html#2012-08">month</a> or <a href="../../../index-2.html#2012-08-27">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2012/08/27/10343714.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:27 GMT -->
</html>