<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2012/08/16/10340297.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:30 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>In the land of the unsupported, previous blogs and tools can be king</title></head><body>
<h1>In the land of the unsupported, previous blogs and tools can be king</h1>
<p><em>by Michael S. Kaplan, published on 2012/08/16 07:01 -04:00, original URI: http://blogs.msdn.com/b/michkap/archive/2012/08/16/10340297.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<p>The note from the Suggestion Box was:<strong></strong></p>
<p style="padding-left: 60px;"><em><span style="font-family: times new roman,times; font-size: medium;">Loading keyboard dlls in a 64-bit environment using a 32-bit application</span></em></p>
<div style="padding-left: 60px;" class="post-date"><em><span style="font-family: times new roman,times; font-size: medium;">Mon, Aug 13 2012 3:51 AM</span></em></div>
<div style="padding-left: 60px;" class="post-content user-defined-markup">
<p><em><span style="font-family: times new roman,times; font-size: medium;">Hi Michael!</span></em></p>
<p><em><span style="font-family: times new roman,times; font-size: medium;">I've been enjoying you topics regarding the keyboard dlls (kbd**.dll) files and how to mess with them :)</span></em></p>
<p><em><span style="font-family: times new roman,times; font-size: medium;">Earlier I decided to create a onscreenkeyboard of my own, based on scan codes, so I could take the advantage of these existing keyboards dlls.</span></em></p>
<p><em><span style="font-family: times new roman,times; font-size: medium;">In my path of development; I did not get it to work on a 64-bit system, the pVkToWcharTable was always NULL. It only worked if I compiled a 64-bit version of my app.</span></em></p>
<p><em><span style="font-family: times new roman,times; font-size: medium;">I've written a class to actually manage 32-bit app on a 64-bit system, and it works. I've even shared it to the public, by writing an article: <a href="http://lars.werner.no/?p=870" rel="nofollow" target="_new"><strong><span style="color: #0066dd;" color="#0066dd">http://lars.werner.no/?p=870</span></strong></a></span></em></p>
<p><em><span style="font-family: times new roman,times; font-size: medium;">Since you always investigate deep, do you have any root cause of what actually fails?</span></em></p>
<p><em><span style="font-family: times new roman,times; font-size: medium;">Hope to see an article on that later on!</span></em></p>
<p><em><span style="font-family: times new roman,times; font-size: medium;">Cheers,</span></em></p>
<p><em><span style="font-family: times new roman,times; font-size: medium;">Lars Werner</span></em></p>
<p style="padding-left: 60px;"><em><span style="font-family: times new roman,times; font-size: medium;"><a href="http://lars.werner.no/" rel="nofollow" target="_new"><strong><span style="color: #0066dd;" color="#0066dd">http://lars.werner.no</span></strong></a></span></em></p>
</div>
<p>We don't actually document how to act like Windows does when it uses one of these keyboard layout DLLs.</p>
<p>Previous travails, discussed in <strong><a title="The wacky world of WOW64 keyoards, un-leashed, un-locked, un-something-or-other" href="../../../2010/05/04/10003033.html">The wacky world of WOW64 keyboards, un-leashed, un-locked, un-something-or-other</a></strong> and <strong><a title="If you just don't think you can hold it (64-bit style!)" href="../../../2006/09/28/774957.html">If you just don't think you can hold it (64-bit style!)</a></strong>, may seem relevant.</p>
<p>But they aren't -- not directly at least.</p>
<p>Yet by looking at what happens differently in 64-bit builds, one can reverse engineer the differences for 64-bit builds either directly here or indirectly by looking at kbd.h and how it defines the structure differently for the 64-bit case.</p>
<p>I'd help, but that would be a Microsoft employee doing the work to document the stuff that we decided not to document....</p>
<hr/><div style="margin-left: 1em"><em>no comments</em></div><hr/><p><em>go to <a id="newer" href="../17/10340803.html" title="No do-overs or mulligans in International!">newer</a> or <a id="older" href="../15/10339749.html" title="It may be easier to get your GEO on, instead...">older</a> post, or back to <a href="../../../index-2.html">index</a> or <a href="../../../index-2.html#2012-08">month</a> or <a href="../../../index-2.html#2012-08-16">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2012/08/16/10340297.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:30 GMT -->
</html>