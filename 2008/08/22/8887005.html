<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2008/08/22/8887005.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:36 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>What good is irony if it can't provide symmetry?</title></head><body>
<h1>What good is irony if it can't provide symmetry?</h1>
<p><em>by Michael S. Kaplan, published on 2008/08/22 03:01 -04:00, original URI: http://blogs.msdn.com/b/michkap/archive/2008/08/22/8887005.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<p>Long time readers may recall blogs from the past like <b><a href="http://archives.miloush.net/michkap/archive/2005/09/17/470413.html" mce_href="http://archives.miloush.net/michkap/archive/2005/09/17/470413.html">Is Excel CSV misusing NLS functionality?</a></b> and <b><a href="http://archives.miloush.net/michkap/archive/2007/08/15/4396922.html" mce_href="http://archives.miloush.net/michkap/archive/2007/08/15/4396922.html">Excel to Led Zeppelin -- No 'in through the out door'</a></b>.</p><p>Yet another CSV weirdness that I thought might be of interest to <b><a href="http://archives.miloush.net/michkap/" mce_href="../../../../">SiaO</a></b> readers came up the other day:</p><blockquote><p><font face="times new roman,times"><i>Hello,<br><br>I am trying to write some data that are Unicode into a CSV file, but I am running into some encoding issue, Excel cannot open the file.<br><br>I am not using any transform, I am just reading some Unicode value from an XML file and write to a file by applying the&nbsp; comma delimited file format.<br><br>I was wondering if somebody would have some experience and would know how to create a Unicode CSV file in Vbscript.<br><br>So far I can only save my file as ANSI.<br><br>Thank you very much.</i></font></p></blockquote><p>Regular <b><a href="http://archives.miloush.net/michkap/" mce_href="../../../../">SiaO</a></b> hero Paul Dempsey pointed out one suggestion for a workaround:</p><blockquote><p><font face="times new roman,times">A quick read on Scripting.FileSystemObject tells me I can do this:<br><br>Dim fso, MyFile <br>Set fso = CreateObject("Scripting.FileSystemObject") <br>Set MyFile = fso.CreateTextFile("file.csv", True, True)<br>MyFile.WriteLine "v1Ⓐ,v2Ⓑ,v3Ⓒ"<br>MyFile.Close</font></p></blockquote><p>And one of my favorite support engineers Malcolm Stewart (going back at least a decade!) pointed out the main issue that led to the original problem:</p><blockquote><p><i><font face="times new roman,times">Excel has a bug where it won't parse UNICODE CSV files that are comma delimited, though they will parse TAB delimited files. We have filed a bug with them on this before, but they have rejected the fix.&nbsp; </font></i></p></blockquote><p>Now on the one hand this bothers me, given the whole point of <b>CSV</b> is <i><b>Comma Separated Values</b></i> and all.</p><p>But then again it seems like you can't swing a cat around here without running into problems with CSV from the point of view of applications that will respect under preferences.</p><p>In such a case, the functionality limitation of a product that leads to a misuse of language such as "<b>Unicode CSV values cannot be comma separated</b>" is not only kind of amusing.</p><p>Though it is obviously that.</p><p>Perhaps even a bit ironic if one ignores past behavior -- certainly it would not be expected by most people to be the case. <br></p><p>But in its own way, this kind of bug is being consistent with the existing pattern!</p><p>After all, if we are </p><ul><li>not going to respect a user's regional/language preferences (as described in Regional Options) and </li><li>not going to respect a user's language (which requires Unicode for many people)</li></ul><p>is there a compelling precedent to respect the use of language in general? :-) <br></p><p>&nbsp;</p><p><font color="#ff00ff"><i>This blog brought to you by</i><font size="6"> U </font><i>(<a href="http://www.fileformat.info/info/unicode/char/0055" mce_href="http://www.fileformat.info/info/unicode/char/0055">U+0055</a>, aka LATIN CAPITAL LETTER U)</i></font><br></p>
<hr/><p><a id="8888060" href="#8888060">#</a> <strong>Andrew West</strong> on 22 Aug 2008 11:49 AM:</p><div style="margin-left: 1em"><p>The other lame Unicode feature of Excel 2007 that I discovered the other day is that if you have some supra-BMP data, when you edit it in the formula bar it is treated as string of 16-bit characters, so that two arrow presses are required to get past each character, and you can select and manipulate the individual high and low surrogates that make up a supra-BMP character, leaving unpaired high or low surrogates in the formula bar and on the clipboard if you are not careful.</p></div>
<p><a id="8888107" href="#8888107">#</a> <strong>Micah Dembinsky</strong> on 22 Aug 2008 12:08 PM:</p><div style="margin-left: 1em"><p>Perfect timing on the post. I had been struggling with this issue that seems to defy logic and was just about to place a call to MSDN support. </p></div>
<hr/><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2008/08/25/8893033.html" title="The Bidi Algorithm&#39;s own SEP Field">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2008/08/21/8883552.html" title="Its the End[UpdateResource] of the world we know it">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2008-08">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2008-08-22">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2008/08/22/8887005.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:36 GMT -->
</html>