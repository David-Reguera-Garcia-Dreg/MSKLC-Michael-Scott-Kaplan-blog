<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2008/02/11/7611812.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:36 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>Who assigns the VK_OEM_* values in keyboards?</title></head><body>
<h1>Who assigns the VK_OEM_* values in keyboards?</h1>
<p><em>by Michael S. Kaplan, published on 2008/02/11 10:01 -05:00, original URI: http://blogs.msdn.com/b/michkap/archive/2008/02/11/7611812.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<P>Someone named Michael who is not me asked via the Contact link:</P>
<BLOCKQUOTE>
<P><EM><FONT face="times new roman,times">Hello,<BR><BR>I was interested in the process Windows uses for converting scan codes to virtual keys. Do you know anywhere where it is described precisely? Notably, things like what determines which scan codes get assigned to VK_OEM_x for a given keyboard layout (or whether it even differs, although I assume it must, since the VK_OEM_x must move around VK_OEM_PLUS and things).<BR><BR>Thanks</FONT></EM></P></BLOCKQUOTE>
<P>The actual mapping between scan code and virtual key is arbitrary and implicit in the individual keyboard layouts, and that <A class="" href="http://archives.miloush.net/michkap/archive/2006/04/22/581107.html" mce_href="http://archives.miloush.net/michkap/archive/2006/04/22/581107.html"><STRONG>Getting all you can out of a keyboard layout</STRONG></A> series (particularly <FONT face=Tahoma>Part </FONT><A href="http://archives.miloush.net/michkap/archive/2006/03/23/558674.html"><STRONG><FONT face=Tahoma>1</FONT></STRONG></A>&nbsp;and <FONT face=Tahoma>Part </FONT><A href="http://archives.miloush.net/michkap/archive/2006/03/27/561353.html"><STRONG><FONT face=Tahoma>4</FONT></STRONG></A><FONT face=Tahoma>) goes through how that mapping was built into the sample to get the actual mappings.</FONT></P>
<P><FONT face=Tahoma>In order to reduce the complexity of things, <A class="" href="http://go.microsoft.com/fwlink/?LinkId=82315&amp;clcid=0x409" mce_href="http://go.microsoft.com/fwlink/?LinkId=82315&amp;clcid=0x409">MSKLC</A> (Microsoft Keyboard Layout Creator)&nbsp;actually goes to great effort to not allow arbitrary changes to the mapping, though by letting you load any one existing layout you can inherit the arbitrary mapping that a specific, pre-existing keyboard layout uses.</FONT></P>
<P><FONT face=Tahoma>And if you do want to specifically modify the mapping, you can open up a saved .KLC file directly, since the file's main layout table has as its first two columns the SC and VK values (which can be modified as needed). Though if one does down this road, try to avoid badnesses like duplicating SC or VK values. :-)</FONT></P>
<P><FONT face=Tahoma>But as I pointed out at the beginning of the blog, there are no real rules determining what the mapping ought to be, so there is no real pattern to determining what it will be -- though the fact that <A class="" href="http://go.microsoft.com/fwlink/?LinkId=82315&amp;clcid=0x409" mce_href="http://go.microsoft.com/fwlink/?LinkId=82315&amp;clcid=0x409">MSKLC</A> is used for the bulk of all new layouts, its limitations that try to stop random change here should have a positive impact on news layouts in future versions of Windows.</FONT></P>
<P><FONT face=Tahoma>In prior versions before <A class="" href="http://go.microsoft.com/fwlink/?LinkId=82315&amp;clcid=0x409" mce_href="http://go.microsoft.com/fwlink/?LinkId=82315&amp;clcid=0x409">MSKLC</A>&nbsp;existed, keyboard layouts were created by directly creating text files that look a lot like those .KLC files. They were mostly created by copying an existing one and changing key assignments, so the idea of VK_OEM_* values being inherited from other layouts was pretty common even back then....</FONT></P>
<P><FONT face=Tahoma></FONT>&nbsp;</P>
<P><FONT face=Tahoma><FONT color=#ff1493><EM>This post brought to you by</EM><FONT size=5> á»™ </FONT></FONT><EM><FONT color=#ff1493>(</FONT><A href="http://www.fileformat.info/info/unicode/char/1ed9">U+1ed9</A><FONT color=#ff1493>, a.k.a. LATIN SMALL LETTER O WITH CIRCUMFLEX AND DOT BELOW)</FONT></EM></FONT></P>
<hr/><div style="margin-left: 1em"><em>no comments</em></div><hr/><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2008/02/12/7632387.html" title="Behold the Table Driven Text Service, Part 9 (Will you be content if I tell you how some content can be defined?)">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2008/02/11/7588649.html" title="Behold the Table Driven Text Service, Part 8 (Configuration &#39;junk in the trunk&#39;, part 2)">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2008-02">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2008-02-11">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2008/02/11/7611812.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:36 GMT -->
</html>