<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2008/02/21/7836829.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:36 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>Why is the separator blue?</title></head><body>
<h1>Why is the separator blue?</h1>
<p><em>by Michael S. Kaplan, published on 2008/02/21 10:01 -05:00, original URI: http://blogs.msdn.com/b/michkap/archive/2008/02/21/7836829.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<P>People never ask the easy questions, now do they?</P>
<P>It starts from an early age -- why is the sky blue? Why do I have to go to school on days when nothing interesting is being taught? Why I do I like that girl? And so on....</P>
<P>And it never gets any easier. Like yesterday, when the questions went something like this:</P>
<BLOCKQUOTE>
<P><FONT face="times new roman,times"><EM>I work on&nbsp;an application and we use the digit grouping symbol set by the user.&nbsp;We&nbsp;are currently able to support digit grouping symbol one character long, whereas intl.cpl allows the user to set up to 3 character string as the digit grouping symbol. <BR><BR>Are there any languages which have 3 character digit grouping symbol and why does windows provide this support?</EM></FONT></P></BLOCKQUOTE>
<P>Like I said, people never ask the easy questions, now do they?</P>
<P>Now if you look at every shipping version of windows and every possible built-in locale that ever has been or is, there is only one locale with a LOCALE_STHOUSAND that&nbsp;has a length&nbsp;greater than one WCHAR in&nbsp;length when returned from <A class="" href="http://msdn2.microsoft.com/library/ms776270.aspx" mce_href="http://msdn2.microsoft.com/library/ms776270.aspx">GetLocaleInfoW</A>, and that is the test qps-ploc pseudo locale (LANGID value 0x0501)&nbsp;I mentioned in <A class="" href="http://archives.miloush.net/michkap/archive/2006/08/16/702877.html" mce_href="http://archives.miloush.net/michkap/archive/2006/08/16/702877.html"><STRONG>Walking off the end of the eighth bit</STRONG></A> and <A class="" href="http://archives.miloush.net/michkap/archive/2007/02/04/1596987.html" mce_href="http://archives.miloush.net/michkap/archive/2007/02/04/1596987.html"><STRONG>The name of the song is not 'ps-PS I Love You'</STRONG></A> (it's value is <STRONG>,,</STRONG> presumably just to help people test the kind of code assumptions that this application was making.</P>
<P>So the direct answer is that no locale on the system that is really there will have this problem.</P>
<P>But in the words of&nbsp;The Wolf&nbsp;in Pulp Fiction, <STRONG>Let's not go sucking </STRONG>-- er, never mind, you can watch the movie. Let's just not congratulate ourselves just yet....</P>
<P>This particular upper limit has been around Windows since at least NT4 (possibly earlier?) and I believe has been settable programmatically and in the UI all this time.<BR>&nbsp;<BR>It can be hard track down why something was done a decade ago in Windows (people have either moved up, moved on, or moved out -- of the fewer than&nbsp;10 people who have "owned" the data and 30 or so who have made changes to it, probably half of them are still at Microsoft but among their cadre are enough General Manager and Director types that a meeting of <STRONG>locale data changes checked in</STRONG> club seems unlikely!).</P>
<P>But with&nbsp;that said,&nbsp;most of the locale upper limits were based on research into future locales that might need the higher limit (for some other properties the limits had to be raised when future locales proved that the extreme choices were themselves not extreme enough -- that way lies <A class="" href="http://archives.miloush.net/michkap/archive/2005/12/27/507599.html" mce_href="http://archives.miloush.net/michkap/archive/2005/12/27/507599.html"><STRONG>When the roof got raised, and why</STRONG></A>).</P>
<P>And of course it <EM>almost</EM> goes without&nbsp;saying that &nbsp;in a custom locale/custom culture, all bets are off and it is quite likely that one of those "not [yet] added to Windows" can suddenly be on a machine.</P>
<P>Given that,&nbsp;the "why" question is probably not as interesting as it seems.&nbsp;If any user can apparently break&nbsp;your application in some way,&nbsp;that sounds serious and it should definitely be considered a bug in the application, though it likely does not happen much or people would be reporting it more -- so it can be triaged accordingly (the fact that no built in locales other than a test one designed to ferret out such applications would hit the problem would also be a good factor in the triage).</P>
<P>But given how easy it is for someone to injure anyone who makes the assumption, the bug should be triaged on the seriousness of the behavior if it does happen -- no one wants an application that can be brought to its knees with a single <A class="" href="http://msdn2.microsoft.com/library/ms776312.aspx" mce_href="http://msdn2.microsoft.com/library/ms776312.aspx">SetLocaleInfo</A> call.</P>
<P>In part we already have that -- the knowledge base is full of articles like <A class="" href="http://support.microsoft.com/kb/251005" mce_href="http://support.microsoft.com/kb/251005">Q251005</A> which point to the strange things that happen to applications when these features are changed, and the problems are not going away (even some of .NET parsing gives up if you have the decimal and thousands separators the same, to this day!).</P>
<P>But if your application can't work within the documented limits that any user&nbsp;an take advantage of, you are going to find yourself with big problems down the road....</P>
<P mce_keep="true">&nbsp;</P>
<P><FONT face=Tahoma><FONT color=#ff1493><EM>This post brought to you by</EM><FONT size=5> â‰  </FONT></FONT><EM><FONT color=#ff1493>(</FONT><A href="http://www.fileformat.info/info/unicode/char/2260">U+2260</A><FONT color=#ff1493>, a.k.a. NOT EQUAL TO)</FONT></EM></FONT></P>
<hr/><div style="margin-left: 1em"><em>no comments</em></div><hr/><p><em>referenced by</em></p><div style="margin-left: 1em"><p>2011/02/18 <a href="http://archives.miloush.net/michkap/archive/2011/02/18/10128879.html">speaking with an accent, conceptually</a></p></div><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2008/02/21/7837478.html" title="We&#39;re back and we&#39;re embarrassing ourselves? (aka Making your localizer&#39;s life easier, Part 2)">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2008/02/20/7819354.html" title="Their end-to-end scenario may not match your end-to-end scenario, though now that you brought it up what IS your end-to-end scenario?">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2008-02">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2008-02-21">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2008/02/21/7836829.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:36 GMT -->
</html>