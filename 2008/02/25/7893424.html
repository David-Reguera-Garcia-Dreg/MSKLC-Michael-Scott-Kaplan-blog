<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2008/02/25/7893424.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:36 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>What the #$!*& is a KeyboardLayoutId, anyway?</title></head><body>
<h1>What the #$!*& is a KeyboardLayoutId, anyway?</h1>
<p><em>by Michael S. Kaplan, published on 2008/02/25 10:16 -05:00, original URI: http://blogs.msdn.com/b/michkap/archive/2008/02/25/7893424.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<P>One never knows how dumb one was until one gets a little bit smarter. :-)</P>
<P>I'll explain what I mean, how I was reminded of this the other day....</P>
<P>I must admit the question that came to me was a bit more polite that the title, it was actually more like:</P>
<BLOCKQUOTE>
<P><FONT face="times new roman,times">Do you know anything about this prop?&nbsp; I checked the Japanese Keyboard and English keyboard with different locale, but it just seems to return the LCID of the corresponding Locale.&nbsp;&nbsp; Please let me know if you know any.</FONT></P></BLOCKQUOTE>
<P>And the underlying question that person had been asked was also more polite:</P>
<BLOCKQUOTE>
<P><EM><FONT face="times new roman,times">I would like to check with you if you have information about who is using this particular property and how they use it. It does not have a matching LCTYPE[ in Windows]. Any idea?</FONT></EM></P></BLOCKQUOTE>
<P>This property (in both <A class="" href="http://msdn2.microsoft.com/library/system.globalization.cultureinfo.keyboardlayoutid.aspx" mce_href="http://msdn2.microsoft.com/library/system.globalization.cultureinfo.keyboardlayoutid.aspx">CultureInfo.KeyboardLayoutId</A> and <A class="" href="http://msdn2.microsoft.com/library/system.globalization.cultureandregioninfobuilder.keyboardlayoutid.aspx" mce_href="http://msdn2.microsoft.com/library/system.globalization.cultureandregioninfobuilder.keyboardlayoutid.aspx">CultureAndRegionInfoBuilder.KeyboardLayoutId</A>) was kind of my idea because of an LCID dependency that the <A class="" href="http://msdn2.microsoft.com/library/system.windows.forms.inputlanguage.aspx" mce_href="http://msdn2.microsoft.com/library/system.windows.forms.inputlanguage.aspx">InputLanguage class</A> has in its <A class="" href="http://msdn2.microsoft.com/library/system.windows.forms.inputlanguage.fromculture.aspx" mce_href="http://msdn2.microsoft.com/library/system.windows.forms.inputlanguage.fromculture.aspx">InputLanguage.FromCulture</A> method. </P>
<P>Now in fairness that dependency was only there because the developers were looking at the Win32 <A class="" href="http://msdn2.microsoft.com/library/ms646297.aspx" mce_href="http://msdn2.microsoft.com/library/ms646297.aspx">GetKeyboardLayoutList function</A> and seeing it was the only way to enumerate loaded keyboards (which is basically all that <STRONG>FromCulture</STRONG>&nbsp;was trying to do (map loaded input languages with the passed in <STRONG>CultureInfo</STRONG>).</P>
<P>But now with custom culture, the <A class="" href="http://msdn2.microsoft.com/en-us/library/system.globalization.cultureinfo.lcid.aspx" mce_href="http://msdn2.microsoft.com/en-us/library/system.globalization.cultureinfo.lcid.aspx">CultureInfo.LCID</A> would not be a useful thing to compare; it would alway fail.</P>
<P>So this KeyboardLayoutId was added as a stopgap -- so there would be a way to specify the keyboard to load.</P>
<P>Anyway, I am not taking the credit for this idea, more like I am taking the blame. Because the view from this CLR-specific problem was too narrow!</P>
<P>Working with folks later on MSKLC, the solution mentioned in&nbsp;<A href="http://archives.miloush.net/michkap/archive/2007/05/22/2800224.html"><STRONG>Getting the language of an LCID-less keyboard</STRONG></A>&nbsp;and then documented&nbsp;in <A class="" href="http://archives.miloush.net/michkap/archive/2007/08/23/4535058.html" mce_href="http://archives.miloush.net/michkap/archive/2007/08/23/4535058.html"><STRONG>Getting the language (and more!) of an LCID-less keyboard</STRONG></A> with the apocrypha at <A class="" href="http://archives.miloush.net/michkap/archive/2007/08/25/4564548.html" mce_href="http://archives.miloush.net/michkap/archive/2007/08/25/4564548.html"><STRONG>MSKLC keyboard layout names in your own language</STRONG></A> became an obvious way to not only support custom languages to do along with custom keyboards, but a way for someone to query exactly what the custom locale name might be!</P>
<P>Of course this other property will always be there unfortunately, but now future versions have a method they can look into using to let them shed the <STRONG>LCID</STRONG> and now <STRONG>KeyboardLayoutId</STRONG> dependency!</P>
<P>I suppose there is a lesson here -- it is important to think about the whole problem rather than just the piece in front of you, if you want to come up with the best solution in the long run....</P>
<P mce_keep="true">&nbsp;</P>
<P><FONT color=#ff0080><EM>This post brought to you by</EM> <FONT size=6>ᕓ</FONT> </FONT><EM><FONT color=#ff0080>(</FONT><A href="http://www.fileformat.info/info/unicode/char/1553">U+1553</A><FONT color=#ff0080>, a.k.a. CANADIAN SYLLABICS FE)</FONT></EM></P>
<hr/><p><strong>BigScary</strong> on 28 Oct 2010 10:14 AM:</p><div style="margin-left: 1em"><p>So, what is it then? &nbsp;I&#39;m looking for the answer in your post, but I don&#39;t see it. &nbsp;I&#39;m writing a test wherein I want to create a custom culture with an invalid keyboard layout (is zero always invalid?), to confirm that my other API, which is supposed to switch to a desired keyboard layout, appropriately throws an ArgumentException when the desired keyboard layout is invalid or otherwise unavailable.</p></div>
<p><strong>Michael S. Kaplan</strong> on 28 Oct 2010 7:13 PM:</p><div style="margin-left: 1em"><p>Not sure what you are asking in this case? One should always set the property to something....</p>
</div>
<hr/><p><em>referenced by</em></p><div style="margin-left: 1em"><p>2011/03/16 <a href="http://archives.miloush.net/michkap/archive/2011/03/16/10141835.html">Reporting one casualty in the operation; luckily it was the stupidest member of the unit</a></p><p>2008/03/02 <a href="http://archives.miloush.net/michkap/archive/2008/03/02/7934470.html">On putting the cart before the horse (or the computer in front of the keyboard?)</a></p></div><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2008/02/26/7897102.html" title="Making sure to TryParseReal, rather than TryParseImaginary (if you know what I mean)">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2008/02/25/7884260.html" title="Behold the Table Driven Text Service, Part 11 (The knights who say நீ, redux, #1)">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2008-02">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2008-02-25">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2008/02/25/7893424.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:36 GMT -->
</html>