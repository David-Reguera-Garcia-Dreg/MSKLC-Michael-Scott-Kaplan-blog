<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2008/02/18/7748433.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:36 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>How to avoid that problem of never being 'up to date'</title></head><body>
<h1>How to avoid that problem of never being 'up to date'</h1>
<p><em>by Michael S. Kaplan, published on 2008/02/18 10:16 -05:00, original URI: http://blogs.msdn.com/b/michkap/archive/2008/02/18/7748433.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<P>I am never the type of superior elitist code snob who feels above people&nbsp;who&nbsp;improve on the things that I do. Or have done.</P>
<P>And even if something is <A class="" href="http://archives.miloush.net/michkap/archive/2006/07/11/662550.html" mce_href="http://archives.miloush.net/michkap/archive/2006/07/11/662550.html"><STRONG>no longer officially supported by Microsoft</STRONG></A>, I am not the sort to just ignore people who are still trying to work productively with code that I have produced in the past....</P>
<P>Like the other day over in the microsoft.public.platformsdk.mslayerforunicode newsgroup, Igor Solodovnikov wrote:</P>
<BLOCKQUOTE>
<BLOCKQUOTE>
<BLOCKQUOTE>
<P>To build your project with MSLU it is recommended&nbsp;(<A href="http://msdn.microsoft.com/msdnmag/issues/01/10/MSLU/default.aspx">http://msdn.microsoft.com/msdnmag/issues/01/10/MSLU/default.aspx</A>) to&nbsp;include following in the beginning of project's link list:<BR><BR><FONT face="consolas,lucida console,courier new,courier" size=1><STRONG>/nod:kernel32.lib /nod:advapi32.lib /nod:user32.lib /nod:gdi32.lib /nod:shell32.lib /nod:comdlg32.lib /nod:version.lib /nod:mpr.lib /nod:rasapi32.lib /nod:winmm.lib /nod:winspool.lib /nod:vfw32.lib /nod:secur32.lib /nod:oleacc.lib /nod:oledlg.lib /nod:sensapi.lib<BR>unicows.lib<BR>kernel32.lib advapi32.lib user32.lib gdi32.lib shell32.lib comdlg32.lib version.lib mpr.lib rasapi32.lib winmm.lib winspool.lib vfw32.lib secur32.lib oleacc.lib oledlg.lib sensapi.lib<BR>&lt;you own libraries&gt;<BR></STRONG></FONT><BR>There is problem when you try to use MSLU in Visual Studio 2005: if you&nbsp;add recommended list of nod's and libraries to "Linker::Input::Additional&nbsp;dependencies" option in project's property ages then every time you will&nbsp;start debug session using "Debug-&gt;Start Debugging" or build your project&nbsp;using "Build-&gt;Build myprj" you will get something like this:<BR><BR><FONT face="consolas,lucida console,courier new,courier" size=1><STRONG>&nbsp;&nbsp;&nbsp; ------ Build started: Project: myprj, Configuration: Debug Win32 ------<BR>&nbsp;&nbsp;&nbsp; Linking...<BR>&nbsp;&nbsp;&nbsp; Embedding manifest...<BR>&nbsp;&nbsp;&nbsp; Build Time 0:10<BR>&nbsp;&nbsp;&nbsp; Build log was saved at "</STRONG></FONT><A href="file:///c:/myprj/Debug/BuildLog.htm"><FONT face="courier new,courier" size=1><STRONG>file://c:\myprj\Debug\BuildLog.htm</STRONG></FONT></A><FONT size=1><FONT face="consolas,lucida console,courier new,courier"><STRONG>"<BR>&nbsp;&nbsp;&nbsp; myprj - 0 error(s), 0 warning(s)<BR>&nbsp;&nbsp;&nbsp; ========== Build: 1 succeeded, 0 failed, 0 up-to-date, 0 skipped ==========</STRONG></FONT><BR></FONT><BR>So i want to say that your project will never be in up-to-date state.&nbsp;Interestingly enough that this problem does not appear if you build&nbsp;problematic solution from command line using msbuild tool:<BR><BR><FONT face="consolas,lucida console,courier new,courier"><STRONG>&nbsp;&nbsp;&nbsp; msbuild mysolution.sln /p:Configuration=UDebug<BR></STRONG></FONT>&nbsp;<BR>This means that building solution from command line is slightly differs&nbsp;from building from IDE.<BR><BR>There is workaround for this problem:<BR>1. Include the following in "Linker::Input::Ignore Specific Library"&nbsp;option:<BR>&nbsp;&nbsp;&nbsp; <FONT face="consolas,lucida console,courier new,courier" size=1><STRONG>kernel32.lib advapi32.lib user32.lib gdi32.lib shell32.lib comdlg32.lib version.lib mpr.lib rasapi32.lib winmm.lib winspool.lib vfw32.lib secur32.lib oleacc.lib oledlg.lib sensapi.lib<BR></STRONG></FONT>2. Include the following in "Linker::Input::Additional dependencies"&nbsp;option:<BR><STRONG><FONT face="consolas,lucida console,courier new,courier" size=1>&nbsp;&nbsp;&nbsp; unicows.lib<BR>&nbsp;&nbsp;&nbsp; kernel32.lib advapi32.lib user32.lib gdi32.lib shell32.lib comdlg32.lib version.lib mpr.lib rasapi32.lib winmm.lib winspool.lib vfw32.lib secur32.lib oleacc.lib oledlg.lib sensapi.lib<BR>&nbsp;&nbsp;&nbsp; &lt;you own libraries&gt;</FONT></STRONG><BR><BR>Using such settings your project will be up-to-date when it should.</P></BLOCKQUOTE></BLOCKQUOTE></BLOCKQUOTE>
<P>That link at the beginning of what he wrote is to the article Cathy Wissink and I wrote in October 2001 (<A class="" href="http://msdn.microsoft.com/msdnmag/issues/01/10/MSLU/default.aspx" mce_href="http://msdn.microsoft.com/msdnmag/issues/01/10/MSLU/default.aspx">Develop Unicode Applications for Windows 9x Platforms with the Microsoft Layer for Unicode</A>) and although it has obviously been many years and I can forget details in co-author situations as to who added what information, I am pretty sure the linker settings were part of what I contributed (with help from others behind the scenes, of course!).</P>
<P mce_keep="true">Anyway, like I said I have no problem with people suggesting enhancements to what I do.</P>
<P mce_keep="true">The only advantage that the original plan has over Igor's enhancement is that it is slightly easier to use one setting than two, but the benefit pales wshen compared not forcing rebuilds even when no rebuild is needed. Therefore I am happy to agree that this is a better idea.</P>
<P mce_keep="true">So if you are using <A class="" href="http://go.microsoft.com/fwlink/?LinkId=14851" mce_href="http://go.microsoft.com/fwlink/?LinkId=14851">MSLU</A> and you build it in Visual Studio, feel free to avail yourself of this advice!</P>
<P mce_keep="true">&nbsp;</P>
<P mce_keep="true"><FONT color=#ff00ff><EM>This post brought to you by</EM><FONT size=5> ï½• </FONT><EM>(<A class="" href="http://www.fileformat.info/info/unicode/char/ff55" mce_href="http://www.fileformat.info/info/unicode/char/ff55">U+ff55</A>, aka FULLWIDTH LATIN SMALL LETTER U)</EM></FONT></P>
<hr/><div style="margin-left: 1em"><em>no comments</em></div><hr/><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2008/02/18/7769509.html" title="Hello pot, meet kettle (aka No, I don&#39;t want Comcast phone service, dammit!)">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2008/02/17/7747745.html" title="Not supporting Unicode doesn&#39;t necessarily make them evil; it merely suggests the lesser sins of narow-mindedness and laziness">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2008-02">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2008-02-18">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2008/02/18/7748433.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:36 GMT -->
</html>