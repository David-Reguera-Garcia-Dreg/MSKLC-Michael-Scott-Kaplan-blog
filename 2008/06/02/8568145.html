<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2008/06/02/8568145.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:36 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>One keyboard to rule them all?</title></head><body>
<h1>One keyboard to rule them all?</h1>
<p><em>by Michael S. Kaplan, published on 2008/06/02 03:01 -04:00, original URI: http://blogs.msdn.com/b/michkap/archive/2008/06/02/8568145.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<P>Mariano asks via the Contact link:</P>
<BLOCKQUOTE>
<P><EM><FONT face="times new roman,times">Hi Michael!<BR><BR>I taught myself to type Dvorak and love it. However, I have a lot of problems when I play video games. Take your typical FPS, where you use (WASD) to move. In Dvorak, this is (,AOE). Games like Crysis recognize Dvorak and reorganizes the keys accordingly, but others like Half-life 2 do not, and ends up using the real WASD keys, which in Dvorak are all over the place.<BR><BR>Now, here's the problem. If I have Dvorak as my default in Vista, and US or Spanish as alternates, Vista has a "per-window" language. If Dvorak is the default and change it to US in the language bar while focused on say, Firefox, if I switch to Outlook, it's still Dvorak.<BR><BR>So, I guess my question is: can I change the default Vista behavior so that keyboard changes can be done for the whole session, instead of per-window, (like it's done in OS X, had to say it)? Or do you have an alternate solution?<BR><BR>Thanks!<BR><BR>Mariano<BR>Mexico City</FONT></EM></P></BLOCKQUOTE>
<P>The "Vista" behavior here is actually the Windows behavior and has been for some time -- technically not "per-Window" but rather "per-thread-with-an-input-queue". There is no way to change this to be a single layout per Windows session....</P>
<P>A lot of people really don't care much for the "separate input language per input queue" model, <STRONG><FONT color=#ff0000>and I am not going to try to defend it</FONT></STRONG>.</P>
<P>While it is completely understandable, it really is not all that intuitive, and there are way too many situations where the behavior it causes is not what a person really wants.</P>
<P>Folks in Office think the same thing about the complicated nature of it all, though their efforts to simplify things have not really been all that impressive either....</P>
<P>But there are alternatives, though.</P>
<P>Like writing a small application to send a <A class="" href="http://msdn.microsoft.com/library/en-us/winui/winui/windowsuserinterface/windowing/windows/windowreference/windowmessages/wm_inputlangchangerequest.asp" mce_href="http://msdn.microsoft.com/library/en-us/winui/winui/windowsuserinterface/windowing/windows/windowreference/windowmessages/wm_inputlangchangerequest.asp">WM_INPUTLANGCHANGEREQUEST</A> to an application (as discussed in <A class="" href="http://archives.miloush.net/michkap/archive/2007/10/11/5397051.html" mce_href="http://archives.miloush.net/michkap/archive/2007/10/11/5397051.html"><STRONG>Rumor as prophecy in Win32</STRONG></A>), one that you would call after the game has been started.</P>
<P>Or even better writing a small application that could be called even before the game is started -- one that will change the default input language for new processes by calling <A class="" href="http://msdn.microsoft.com/library/ms724947.aspx" mce_href="http://msdn.microsoft.com/library/ms724947.aspx">SystemParametersInfo</A> with the SPI_SETDEFAULTINPUTLANG flag.</P>
<P>The latter method can be done non-programmatically, too -- just right-click in the language bar area to get the <STRONG>Text Services and Input Languages</STRONG> dialog, and change the Default input language there....</P>
<P>Now maybe if Office did some of that interprocess communication stuff it could mimic the OS X behavior of one input language for all of Office. They could still track changes people made, but they could apply the changes to everyone in the Office family....</P>
<P><FONT color=#ff00ff><EM>This blog brought to you by</EM><FONT size=7> à§„ </FONT><EM>(<A class="" href="http://www.fileformat.info/info/unicode/char/09c4" mce_href="http://www.fileformat.info/info/unicode/char/09c4">U+09c4</A>, aka BENGALI VOWEL SIGN VOCALIC RR)</EM></FONT></P>
<hr/><p><strong>Mariano</strong> on 13 Jun 2008 5:22 PM:</p><div style="margin-left: 1em"><p>Thanks for answering my question Michael, I just saw your post. The idea of doing a script/app to change the input language sounds like fun! I haven't used the Win32 API all that much, but it's something to think about. Cheers!</p></div>
<p><strong>Shridhara</strong> on 12 Sep 2010 10:33 PM:</p><div style="margin-left: 1em"><p>Hi Michael, I&#39;m unable to get SystemParametersInfo (with SPI_SETDEFAULTINPUTLANG) working on Win 7. The function returns a non-zero value indicating success, but the default language doesn&#39;t change. The same piece of code works fine in Win XP. Any suggestions?</p>
</div>
<hr/><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2008/06/02/8568892.html" title="Lost in [no ]translation">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2008/06/01/8567307.html" title="On passive vocabulary (aka ennui about chaos)">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2008-06">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2008-06-02">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2008/06/02/8568145.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:36 GMT -->
</html>