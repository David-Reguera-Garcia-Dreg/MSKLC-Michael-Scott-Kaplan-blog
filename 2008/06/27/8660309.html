<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2008/06/27/8660309.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:36 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>Adding keys to your layout when you don't know what they are (aka Life with a 108-key keyboard layout)</title></head><body>
<h1>Adding keys to your layout when you don't know what they are (aka Life with a 108-key keyboard layout)</h1>
<p><em>by Michael S. Kaplan, published on 2008/06/27 03:01 -04:00, original URI: http://blogs.msdn.com/b/michkap/archive/2008/06/27/8660309.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<P>Robert asked via the Contact link:</P>
<BLOCKQUOTE>
<P><FONT face="times new roman,times"><EM>Dear Mr. Kaplan,<BR><BR>I just found an interesting story on your blog, namely </EM></FONT><A href="http://archives.miloush.net/michkap/archive/2006/09/26/771554.html"><FONT face="times new roman,times"><EM>http://blogs.msdn.com/michkap/archive/2006/09/26/771554.aspx</EM></FONT></A><FONT face="times new roman,times"><EM> .<BR><BR>I own a Japanese Windows Vista laptop, it has the typical Japanese Laptop Layout of 108 keys, that is 2 Alt keys, Hiragana/Katakana/Romaji key, Half-width/Full-width/Kanji key, 2 Control keys and the usual Windows keys plus Fn key.<BR><BR>However, it features a yen sign key and a backslash key. The one next to backspace is indeed the yen sign and another one (backslash and underscore next to right shift key) has an actual backslash imprinted on it.<BR><BR>This is all very good, however, if I ever wanted to type a real yen sign in alphanumeric mode (of the Japanese IME), I would indeed be typing a backslash that looks like a yen sign only in the Japanese locale. Everywhere else it would look like a backslash!<BR><BR>I wanted to change this behavior by setting the yen sign key to use the proper Unicode value for the yen sign. I tried Microsoft Keyboard Layout Creator 1.4, but I cannot have the layout match my keyboard at all; though the keys do work in testing mode, thought they are not assignable!<BR><BR>I tried your clue and save the layout as a .klc file, and indeed and very much so I could probably add the proper support in for having a seperate yen sign key and backslash key, giving those keys their proper values according to unicode.<BR><BR>However, as the special Japanese keys don`t work in MSKLC 1.4, they are not in the file and I could not find them in winuser.h. Secondly, I checked with a precompiled Windows executable for what the keys actual keycodes are, but those change depending on what operation they are ared for, e.g. changing to/from Hiragana to Katakana, changing to/from Kana keyboard mode, changing to/from half-width, full-width etc. are all different transitions codewise.<BR><BR>Currently it seems it is always a US-Layout of sorts (what the Japanese layout is derived from...), but hence it doesn`t feature the keys for input mode changing and I did not seem to find those VK names/values anywhere for Windows.<BR><BR>Is there any way in which I can obtain a .klc with all the codes already like in the standard Japanese keyboard layout?<BR>Or if there is not, are the key codes for the VK keys at least noted somewhere with their respective transitions?<BR>Also, if I actually could find them, would I be able to compile it with MSKLC 1.4, or would it skim those settings out of the final dll?</EM></FONT></P></BLOCKQUOTE>
<P>The post that Robert saw was <A class="" href="http://archives.miloush.net/michkap/archive/2006/09/26/771554.html" mce_href="http://archives.miloush.net/michkap/archive/2006/09/26/771554.html"><STRONG>In case you have a yen to extend your keyboard (or at least want a yen?)</STRONG></A>.</P>
<P>Now MSKLC is of <EM>some</EM> use when this kind of forensic work is going on since it works to interrogate the keyboard, but it only looks up information for scan code it knows about -- and it is likely that it does not know about this key....</P>
<P>(<EM>This is kind of like what we were doing in </EM><A class="" href="http://archives.miloush.net/michkap/archive/2007/11/28/6567810.html" mce_href="http://archives.miloush.net/michkap/archive/2007/11/28/6567810.html"><STRONG><EM>Tracking down problems with the 102 key on an Acer Tablet with the UK Extended keyboard layout?</EM></STRONG></A>)</P>
<P>You can basically take code like the bit I put into <A class="" href="http://archives.miloush.net/michkap/archive/2005/12/15/504092.html" mce_href="http://archives.miloush.net/michkap/archive/2005/12/15/504092.html"><STRONG>Handling [Unicode] input in the console</STRONG></A> and use it to get the scan code value of any of the keys.</P>
<P>From there, you can look at examples like <A class="" href="http://archives.miloush.net/michkap/archive/2006/09/26/771554.html" mce_href="http://archives.miloush.net/michkap/archive/2006/09/26/771554.html"><STRONG>this one</STRONG></A> or <A class="" href="http://archives.miloush.net/michkap/archive/2006/10/07/799605.html" mce_href="http://archives.miloush.net/michkap/archive/2006/10/07/799605.html"><STRONG>this other one</STRONG></A> for the MSKLC syntax for the .KLC file, since all you need to start the line with is a scan code and a virtual key (the scab code you get from the above. the VK you just have to pick a unique one).</P>
<P>Now this key is not one you would be able to necessarily edit in MSKLC since if the tool does not know about the scan code, it can't show the key.</P>
<P>But if you have the row correct in the .KLC file, you will be able to build and use the keyboard just fine! :-)</P>
<P>If you try this out (or at least that first part where you get the scan code), let me know what that other key does -- I am very curious&nbsp;whether the keyboard hardware vendor ever worked with Microsoft to define this keystroke so that it could be used....</P>
<P mce_keep="true">&nbsp;</P>
<P><FONT color=#ff00ff><EM>This post brought to you by</EM><FONT size=7> | </FONT></FONT><EM><FONT color=#ff00ff>(</FONT><A class="" href="http://www.fileformat.info/info/unicode/char/007c" mce_href="http://www.fileformat.info/info/unicode/char/007c">U+007c</A><FONT color=#ff00ff>, a.k.a. VERTICAL LINE)</FONT></EM></P>
<hr/><p><strong>Mihai</strong> on 27 Jun 2008 12:18 PM:</p><div style="margin-left: 1em"><p>Chinese Simplified - NeiMa has a Unicode mode, and it is still present in Vista.</p></div>
<p><strong>Michael S. Kaplan</strong> on 27 Jun 2008 12:34 PM:</p><div style="margin-left: 1em"><p>I think you meant that for one of the other blogs rather than this one, right? :-)</p>
</div>
<p><strong>John Cowan</strong> on 1 Jul 2008 3:49 PM:</p><div style="margin-left: 1em"><p>It's curious that I've never thought of you as &quot;Mr. Kaplan&quot; before, but I was rereading &quot;O Kaplan! My Kaplan!&quot; the other day, and then checked this post for comments, and, well...</p>
<p><a rel="nofollow" target="_new" href="http://en.wikipedia.org/wiki/Hyman_Kaplan">http://en.wikipedia.org/wiki/Hyman_Kaplan</a></p></div>
<hr/><p><em>referenced by</em></p><div style="margin-left: 1em"><p>2008/06/27 <a href="http://archives.miloush.net/michkap/archive/2008/06/27/8661641.html">How does it work? It cheats, that's how!</a></p></div><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2008/06/27/8661641.html" title="How does it work? It cheats, that&#39;s how!">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2008/06/26/8655007.html" title="I am not engaged, everyone!">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2008-06">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2008-06-27">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2008/06/27/8660309.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:36 GMT -->
</html>