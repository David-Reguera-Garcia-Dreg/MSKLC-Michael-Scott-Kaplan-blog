<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2008/06/27/8661641.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:36 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>How does it work? It cheats, that's how!</title></head><body>
<h1>How does it work? It cheats, that's how!</h1>
<p><em>by Michael S. Kaplan, published on 2008/06/27 10:01 -04:00, original URI: http://blogs.msdn.com/b/michkap/archive/2008/06/27/8661641.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<P>The question developer Cynthia sent via the Contact link was a fun one:</P>
<BLOCKQUOTE>
<P><EM><FONT face="times new roman,times">How can I program the "Fn" key on my laptop keyboard via MSKLC?</FONT></EM></P></BLOCKQUOTE>
<P>The answer is that you really can't.</P>
<P>Because the <STRONG>Fn</STRONG> or <STRONG>Function</STRONG> key has a very special job -- its job is to cheat.</P>
<P>Laptop keyboards are smaller, and they have fewer keys on them than they claim to. They get away with that by having a key that can transform other keys, temporarily changing their identity!</P>
<P>I'll show you what I mean....</P>
<P>First we'll go to my Dell, taking that EXE from <A class="" href="http://archives.miloush.net/michkap/archive/2005/12/15/504092.html" mce_href="http://archives.miloush.net/michkap/archive/2005/12/15/504092.html"><STRONG>Handling [Unicode] input in the console</STRONG></A> to sniff out the keys like I mentioned <A class="" href="http://archives.miloush.net/michkap/archive/2008/06/27/8660309.html" mce_href="http://archives.miloush.net/michkap/archive/2008/06/27/8660309.html"><STRONG>earlier today</STRONG></A>.</P>
<P>I'll type some keys that are on the keyboard and identify them right here so you can see what that EXE tells us. It tells us <STRONG><EM>nothing</EM></STRONG> about the <STRONG>Fn</STRONG> key -- that key does not exist as far as Windows is concerned:</P>
<BLOCKQUOTE>
<P><FONT face="consolas,lucida console,courier new,courier"><STRONG>ReadConsoleInput test<BR>Ctrl-D to quit.<BR><BR>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; UC&nbsp;&nbsp;&nbsp; u/d&nbsp; VK&nbsp;&nbsp; SC&nbsp; State<BR><BR>&nbsp; 0: U+0000 down 0025 004b 0100&nbsp;&nbsp;&nbsp; <FONT color=#00ff00>&lt;-- Left Arrow</FONT><FONT color=#ff0000>&nbsp; (VK_LEFT)</FONT><BR>&nbsp; 1: U+0000&nbsp; up&nbsp; 0025 004b 0100<BR>&nbsp; 2: U+0000 down 0026 0048 0100&nbsp;&nbsp;&nbsp; <FONT color=#00ff00>&lt;--&nbsp;Up Arrow</FONT><FONT color=#ff0000>&nbsp; (VK_UP)</FONT><BR>&nbsp; 3: U+0000&nbsp; up&nbsp; 0026 0048 0100<BR>&nbsp; 4: U+0000 down 0027 004d 0100&nbsp;&nbsp;&nbsp; <FONT color=#00ff00>&lt;--&nbsp;Right Arrow</FONT><FONT color=#ff0000>&nbsp; (VK_RIGHT)</FONT><BR>&nbsp; 5: U+0000&nbsp; up&nbsp; 0027 004d 0100<BR>&nbsp; 6: U+0000 down 0028 0050 0100&nbsp;&nbsp;&nbsp; <FONT color=#00ff00>&lt;--&nbsp;Down Arrow</FONT><FONT color=#ff0000>&nbsp; (VK_DOWN)</FONT><BR>&nbsp; 7: U+0000&nbsp; up&nbsp; 0028 0050 0100<BR>&nbsp; 8: U+0000 down 0024 0047 0100&nbsp;&nbsp;&nbsp; <FONT color=#00ff00>&lt;--&nbsp;Home</FONT><FONT color=#ff0000>&nbsp; (VK_HOME)</FONT><BR>&nbsp; 9: U+0000&nbsp; up&nbsp; 0024 0047 0100<BR>&nbsp;10: U+0000 down 0021 0049 0100&nbsp;&nbsp;&nbsp; <FONT color=#00ff00>&lt;--&nbsp;Page Up</FONT><FONT color=#ff0000>&nbsp; (VK_PRIOR)</FONT><BR>&nbsp;11: U+0000&nbsp; up&nbsp; 0021 0049 0100<BR>&nbsp;12: U+0000 down 0023 004f 0100&nbsp;&nbsp;&nbsp; <FONT color=#00ff00>&lt;--&nbsp;End</FONT><FONT color=#ff0000>&nbsp; (VK_END)</FONT><BR>&nbsp;13: U+0000&nbsp; up&nbsp; 0023 004f 0100<BR>&nbsp;14: U+0000 down 0022 0051 0100&nbsp;&nbsp;&nbsp; <FONT color=#00ff00>&lt;--&nbsp;Page Down</FONT><FONT color=#ff0000>&nbsp; (VK_NEXT)</FONT><BR>&nbsp;15: U+0000&nbsp; up&nbsp; 0022 0051 0100<BR>&nbsp;16: U+0008 down 0008 000e 0000&nbsp;&nbsp;&nbsp; <FONT color=#00ff00>&lt;--&nbsp;Backspace</FONT><FONT color=#ff0000>&nbsp; (VK_BACK)</FONT><BR>&nbsp;17: U+0008&nbsp; up&nbsp; 0008 000e 0000<BR>&nbsp;18: U+0000 down 002e 0053 0100&nbsp;&nbsp;&nbsp; <FONT color=#00ff00>&lt;--&nbsp;Delete</FONT><FONT color=#ff0000>&nbsp; (VK_DELETE)</FONT><BR>&nbsp;19: U+0000&nbsp; up&nbsp; 002e 0053 0100</STRONG></FONT></P></BLOCKQUOTE>
<P>Now of these 10 keys, note that half of them do not exist as dedicated keys on my MacBook Pro.</P>
<P>What's a guy who likes his Mac to do?</P>
<P>No worries, because I can use my <STRONG>Fn</STRONG> key!</P>
<P>Here is the same output on the Mac Book Pro (booted into Vista 64 bit and humming along quite happily):</P>
<BLOCKQUOTE>
<P><FONT face="consolas,lucida console,courier new,courier"><STRONG>ReadConsoleInput test<BR>Ctrl-D to quit.<BR><BR>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; UC&nbsp;&nbsp;&nbsp; u/d&nbsp; VK&nbsp;&nbsp; SC&nbsp; State<BR><BR>&nbsp; 0: U+0000 down 0025 004b 0100&nbsp;&nbsp;&nbsp; <FONT color=#00ff00>&lt;-- Left Arrow</FONT><FONT color=#ff0000>&nbsp; (VK_LEFT)</FONT><BR>&nbsp; 1: U+0000&nbsp; up&nbsp; 0025 004b 0100<BR>&nbsp; 2: U+0000 down 0026 0048 0100&nbsp;&nbsp;&nbsp; <FONT color=#00ff00>&lt;--&nbsp;Up Arrow</FONT><FONT color=#ff0000>&nbsp; (VK_UP)</FONT><BR>&nbsp; 3: U+0000&nbsp; up&nbsp; 0026 0048 0100<BR>&nbsp; 4: U+0000 down 0027 004d 0100&nbsp;&nbsp;&nbsp; <FONT color=#00ff00>&lt;--&nbsp;Right Arrow</FONT><FONT color=#ff0000>&nbsp; (VK_RIGHT)</FONT><BR>&nbsp; 5: U+0000&nbsp; up&nbsp; 0027 004d 0100<BR>&nbsp; 6: U+0000 down 0028 0050 0100&nbsp;&nbsp;&nbsp; <FONT color=#00ff00>&lt;--&nbsp;Down Arrow</FONT><FONT color=#ff0000>&nbsp; (VK_DOWN)</FONT><BR>&nbsp; 7: U+0000&nbsp; up&nbsp; 0028 0050 0100<BR>&nbsp; 8: U+0000 down 0024 0047 0100&nbsp;&nbsp;&nbsp; <FONT color=#00ff00>&lt;--&nbsp;Fn + Left Arrow</FONT><FONT color=#ff0000>&nbsp; (VK_HOME)</FONT><BR>&nbsp; 9: U+0000&nbsp; up&nbsp; 0024 0047 0100<BR>&nbsp;10: U+0000 down 0021 0049 0100&nbsp;&nbsp;&nbsp; <FONT color=#00ff00>&lt;--&nbsp;Fn + Up&nbsp;Arrow</FONT><FONT color=#ff0000>&nbsp; (VK_PRIOR)</FONT><BR>&nbsp;11: U+0000&nbsp; up&nbsp; 0021 0049 0100<BR>&nbsp;12: U+0000 down 0023 004f 0100&nbsp;&nbsp;&nbsp; <FONT color=#00ff00>&lt;--&nbsp;Fn + Right Arrow</FONT><FONT color=#ff0000>&nbsp; (VK_END)</FONT><BR>&nbsp;13: U+0000&nbsp; up&nbsp; 0023 004f 0100<BR>&nbsp;14: U+0000 down 0022 0051 0100&nbsp;&nbsp;&nbsp; <FONT color=#00ff00>&lt;--&nbsp;Fn + Down Arrow</FONT><FONT color=#ff0000>&nbsp; (VK_NEXT)</FONT><BR>&nbsp;15: U+0000&nbsp; up&nbsp; 0022 0051 0100<BR>&nbsp;16: U+0008 down 0008 000e 0000&nbsp;&nbsp;&nbsp; <FONT color=#00ff00>&lt;--&nbsp;Backspace (<EM>Delete</EM>)</FONT><FONT color=#ff0000>&nbsp; (VK_BACK)</FONT><BR>&nbsp;17: U+0008&nbsp; up&nbsp; 0008 000e 0000<BR>&nbsp;18: U+0000 down 002e 0053 0100&nbsp;&nbsp;&nbsp; <FONT color=#00ff00>&lt;--&nbsp;Fn + Backspace (<EM>Delete</EM>)</FONT><FONT color=#ff0000>&nbsp; (VK_DELETE)</FONT><BR>&nbsp;19: U+0000&nbsp; up&nbsp; 002e 0053 0100</STRONG></FONT></P></BLOCKQUOTE>
<P>Pretty clever, huh? even though Windows can't see the <STRONG>Fn</STRONG> key, the keyboard can. And the hardware can fake out and make Windows think that one key is another, as needed.</P>
<P>As far as Windows knows, that key identity is indistinguishable from it being that totally different key....</P>
<P>Now if they could just use the <STRONG>Fn</STRONG> key to fix up the whole&nbsp;<FONT face=Tahoma> <STRONG>|</STRONG> (</FONT><A href="http://www.fileformat.info/info/unicode/char/007c"><FONT face=Tahoma>U+007c</FONT></A><FONT face=Tahoma>, a.k.a. VERTICAL LINE) yet printed upon the face of the key is <STRONG>¦</STRONG> (</FONT><A href="http://www.fileformat.info/info/unicode/char/00a6"><FONT face=Tahoma>U+00a6</FONT></A><FONT face=Tahoma>, a.k.a. BROKEN BAR) issue!</FONT></P>
<P mce_keep="true">&nbsp;</P>
<P><FONT color=#ff00ff><EM>This post brought to you by</EM><FONT size=5> ¦ </FONT></FONT><EM><FONT color=#ff00ff>(</FONT><A class="" href="http://www.fileformat.info/info/unicode/char/00a6" mce_href="http://www.fileformat.info/info/unicode/char/00a6">U+00a6</A><FONT color=#ff00ff>, a.k.a. VERTICAL LINE)</FONT></EM></P>
<hr/><p><strong>Programmerman</strong> on 27 Jun 2008 2:19 PM:</p><div style="margin-left: 1em"><p>I've scoped out my three keyboards and they're two-for-three on having it right (two vertical lines, one broken bar).</p></div>
<p><strong>Zooba</strong> on 27 Jun 2008 7:42 PM:</p><div style="margin-left: 1em"><p>Wow. A sponsor with a split personality (or who has committed identify theft). Very appropriate :-)</p></div>
<p><strong>Michael S. Kaplan</strong> on 27 Jun 2008 7:50 PM:</p><div style="margin-left: 1em"><p>I was wondering who was going to notice that one and how long before anyone said anything! :-)</p>
</div>
<p><strong>Maurits [MSFT]</strong> on 27 Jun 2008 9:03 PM:</p><div style="margin-left: 1em"><p>I suppose one could argue that the &quot;solid&quot; bar looks too much like a capital &quot;I&quot; in the font used to physically keyboards.</p></div>
<p><strong>Mike Dimmick</strong> on 30 Jun 2008 6:25 AM:</p><div style="margin-left: 1em"><p>My Dell UK keyboard has | in the lower-left, as shift+\, while it has &#166; marked as the AltGr+` state (the UK keyboard has &#172; as shift+`).</p>
<p>The console 8 wide/12 high raster font on Windows XP shows &#166; for both codepoints. The other raster fonts appear to be similarly afflicted.</p>
<p>Putting the command prompt in full-screen mode, in CP 850 the glyphs produced are correct; in 437 the &#166; key-chord produces a blob (one of the line-drawing characters, perhaps?)</p>
<p>However, in DOS 6.22 with the UK keyboard installed and codepage 850 selected, the characters are swapped, which I think matches what used to be inscribed on the keys. I think a lot of UK DOS users used CP437, though, as that was the default. I don't recall having to press AltGr+` to get a 'pipe' to pipe output from one command into another. Tested in Virtual PC 2007 SP1 (with older Additions as the VPC team seem to have encoded the Additions ISO with lower-case characters in filenames, which DOS has a problem with!)</p></div>
<hr/><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2008/06/28/8663280.html" title="Sorting it all Out a forgery?, aka Cretan or cretan?">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2008/06/27/8660309.html" title="Adding keys to your layout when you don&#39;t know what they are (aka Life with a 108-key keyboard layout)">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2008-06">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2008-06-27">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2008/06/27/8661641.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:36 GMT -->
</html>