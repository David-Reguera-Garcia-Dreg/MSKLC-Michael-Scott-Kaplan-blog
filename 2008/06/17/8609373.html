<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2008/06/17/8609373.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:36 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>Questions: 7, Question Marks: 0 (aka The Zeroeth post about Dialog Units)</title></head><body>
<h1>Questions: 7, Question Marks: 0 (aka The Zeroeth post about Dialog Units)</h1>
<p><em>by Michael S. Kaplan, published on 2008/06/17 03:01 -04:00, original URI: http://blogs.msdn.com/b/michkap/archive/2008/06/17/8609373.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<P>Ian Boyd asked over in the Suggestion Box:</P>
<BLOCKQUOTE>
<P><FONT face="times new roman,times"><EM>Dialog Units.<BR><BR>What they were designed to do. Where they would have hopefully worked. How it is they originally did work. When they began to break down. The workaround used to try to keep them working. How they no longer work for their original purpose. Technique to try to roll your own.</EM></FONT></P></BLOCKQUOTE>
<P>If you think about, Ian has managed to&nbsp;pose&nbsp;seven&nbsp;inquiries without asking a single question <STRONG>as</STRONG> a question!</P>
<P>Quite an accomplishment, when you think about it.... :-)</P>
<P>Now covering all of this is almost the topic for a book chapter, so I couldn't really cover all seven topics in depth here is this one little old blog.</P>
<P>But I'll try to give a quick answer for each (when possible) and reserve some of the more complicated issues in each for another day.</P>
<P>So, here we go, with one initial question added that should likely have been there, and with each of them reworded to be questions (I am not being scientific here, these are all of the cuff and any I get into deeper I will be a bit more formal about.</P>
<P>The nitpickers should have a field day here!</P>
<BLOCKQUOTE>
<P><STRONG>What is a Dialog Unit?</STRONG></P></BLOCKQUOTE>
<BLOCKQUOTE>
<BLOCKQUOTE>
<P>If you take&nbsp;an "average character" (by convention, Win32 decided long ago that the <STRONG>letter x</STRONG> made a nice average character), a dialog unit is&nbsp;1/4 of the width of that character (think TEXTMETRIC.tmAveCharWidth) and 1/8 of the height of not the average character but of the normal character height (think TEXTMETRIC.tmHeight). Obviously these two metrics will vary depending on the font you use, so the Dialog Unit is based on the specific dialog font for the Windows session.-- which is itself a choice based on both DPI settings and language.</P></BLOCKQUOTE></BLOCKQUOTE>
<BLOCKQUOTE>
<P><STRONG>What were Dialog Units designed to do?</STRONG></P>
<BLOCKQUOTE>
<P>In the world where the default font itself might have different sizes (which implies the text would have different sizes) and the DPI would cause more such weirdnesses, the&nbsp;way to make sure that by default the dialog would resize when these other factors changed was to make the size of the dialogs change when these other things did.</P></BLOCKQUOTE></BLOCKQUOTE>
<BLOCKQUOTE>
<P><STRONG>Where would&nbsp;Dialog Units&nbsp;have hopefully worked?</STRONG></P>
<BLOCKQUOTE>
<P>The place where they would have hopefully worked is when you wanted your dialogs to scale even as these various settings changed.</P></BLOCKQUOTE></BLOCKQUOTE>
<BLOCKQUOTE>
<P><STRONG>How it is&nbsp;that Dialog Units&nbsp;originally did work?</STRONG></P>
<BLOCKQUOTE>
<P>How they originally did work is the one place the still do work -- when your dialogs use regular old Win32 USER/GDI and the text in your dialogs uses the default dialog font face and size and weight. When you do all of this, then changing the language/font/DPI settings should&nbsp;allow the dialog to scale so that text that fit in one case will continue to fit in the other cases.</P></BLOCKQUOTE></BLOCKQUOTE>
<BLOCKQUOTE>
<P><STRONG>When&nbsp;did Dialog Units&nbsp;began to break down?</STRONG></P>
<BLOCKQUOTE>
<P>There are lots of changes that happened over time that caused this ideal to break down; I'll list a few here:</P>
<UL>
<LI>Some dialogs would use other font faces, weights, and/or sizes with very different metrics from that default dialog font;</LI>
<LI>Some dialogs would use multiple fonts, with not all of them having the same metrics&nbsp;as that default dialog font;</LI>
<LI>In situations where the language changed, the size of the translated text would also change in many cases;</LI>
<LI>Other technologies came along that used different scaling systems (e.g. pixels, twips, etc.) to avoid the confusion that the scaling and perceived lack of predictability thereof&nbsp;that the Dialog Unit&nbsp;system often led to.</LI></UL>
<P>Because more and more reasons for the scaling system to not work out kept happening, the system became more and more arcane appearing and less and less relevant to what people actually wanted for their dialogs.</P></BLOCKQUOTE></BLOCKQUOTE>
<BLOCKQUOTE>
<P><STRONG>What&nbsp;workaround was used to try to keep&nbsp;Dialog Units&nbsp;working?</STRONG></P>
<BLOCKQUOTE>
<P>No specific "workaround" was architected as a workaround -- these other technologies had other ways to define things and tried to solve the problem different ways. They just chugged along and tried to do their job.</P></BLOCKQUOTE></BLOCKQUOTE>
<BLOCKQUOTE>
<P><STRONG>How&nbsp;do Dialog Units&nbsp;no longer work for their original purpose?</STRONG></P>
<BLOCKQUOTE>
<P>These new technologies were still using GDI to create the fonts and USER to create the windows, which meant that these separate technologies occasionally affected by the good old fashioned Dialog Unit scaling -- an interesting problem for Visual Basic &lt;= 6.0 (for example) where people would work out sizes perfectly that suddenly would not work well on another system.</P></BLOCKQUOTE></BLOCKQUOTE>
<BLOCKQUOTE>
<P><STRONG>What technique can one use to&nbsp;try to roll&nbsp;one's&nbsp;own solutions for the problems that Dialog Units were originally intended to solve?</STRONG></P>
<BLOCKQUOTE>
<P>This one I am going to hold off on for a bit because a deeper and more formal look at the consequences of all of the above issues will perhaps make Ian and others&nbsp;believe that as bad as the original solution may or may not have been, the things that have come later have not really distinguished themselves as much as they might have liked, and that rolling one's own solutions is likely to cause more problems rather than solve the ones that are there.</P></BLOCKQUOTE></BLOCKQUOTE>
<P>And there we go. Obviously I'll becoming back to some of these topics another day. :-)</P>
<P><FONT color=#ff00ff><EM>This blog brought to you by</EM><FONT size=7> Í¾ </FONT><EM>(<A class="" href="http://www.fileformat.info/info/unicode/char/037e" mce_href="http://www.fileformat.info/info/unicode/char/037e">U+037e</A>, aka GREEK QUESTION MARK)</EM></FONT></P>
<hr/><p><strong>Igor Levicki</strong> on 17 Jun 2008 10:05 PM:</p><div style="margin-left: 1em"><p>Michael, there is a question I would like to ask -- why it is not possible in windows xp to change the size of system dialog font to something other than 8pt (say 9pt for example)?</p>
<p>I have noticed that for example menus catch the change but window text in applications and in system dialogs and message boxes does not.</p>
<p>Is this perhaps a consequence of dialog units?</p></div>
<p><strong>Michael S. Kaplan</strong> on 18 Jun 2008 12:17 AM:</p><div style="margin-left: 1em"><p>There are specific shell settings for some of those font faces and sizes -- in particular message boxes. In other cases the fonts are application-specified....</p>
<p>This is &nbsp;topic I will be picking up in an upcoming post, soon.</p>
</div>
<hr/><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2008/06/17/8611290.html" title="It isn&#39;t Unicode yet?">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2008/06/16/8603560.html" title="I Didn&#39;t Start Something">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2008-06">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2008-06-17">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2008/06/17/8609373.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:36 GMT -->
</html>