<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2008/09/16/8953564.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:35 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>Vérité (add MUI support in a service pack) ou oser (tell me whether returning 'vrai' was intentional)?</title></head><body>
<h1>Vérité (add MUI support in a service pack) ou oser (tell me whether returning 'vrai' was intentional)?</h1>
<p><em>by Michael S. Kaplan, published on 2008/09/16 10:01 -04:00, original URI: http://blogs.msdn.com/b/michkap/archive/2008/09/16/8953564.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<p><font color="#ff0000"><i>Do French teenagers play "Truth or Dare" while growing up in France? Or is that just an American thing?</i></font><br></p><p>The actual question seemed innocuous enough. It wasn't:<br></p><blockquote><p><i><font face="times new roman,times">We are noticing that on non-us XPSP3 system, when "Regional and Language Settings" (first tab) -&gt;Set standards and formats is set to English, setting HTML input element value to true, still sets it to localized string “Vrai”.<br><br>We found that this happens because with XPSP3, there is a new folder (fr-fr on my French OS) under system32, where the vbscript.dll.mui is present which causes the localization of the string. If I remove this folder, the issue doesn’t happen. I am wondering if this was an intended change for XPSP3. However, the fact that this is inconsistent with how jscript behaves(although there is a jscript.dll.mui as well) and how this doesn’t happen with local variables, leads me to believe that this is a bug.</font></i> </p></blockquote><p>Boy, that takes me back.</p><p>It took me back to that software project with the bug in it -- <b><a href="http://archives.miloush.net/michkap/archive/2005/03/03/384392.html" mce_href="http://archives.miloush.net/michkap/archive/2005/03/03/384392.html">this one</a></b>.</p><p>Lest anyone doubt that this has indeed been the VB/VBA behavior for so very long, let me personally guarantee that it was.</p><p>Now I was busy being somewhere else getting ready to talk about Tamil, so luckily Paul Dempsey was around to explain what was going on, and why it is new behavior in XP SP3:</p><blockquote><p><font face="times new roman,times">In XPSP3, all of scripting shifted to using a MUI-style model for localized resources, instead of the old satellite DLLs.<br><br>JScript and VBScript, being different languages, use different rules for the conversion between VARIANT_BOOL values and strings. JScript follows its ECMA standard (locale-invariant), and VBScript follows the in the longstanding VB tradition of a localized result. This explains the difference between jscript and vbscript.<br><br>vbscript UI strings follow the system User Interface language, not the conversion locale (Standards and Formats setting). Conversion locale will affect money, date, and time conversions to/from strings. UI locale is used for types and error messages. This explains your other observation.<br><br>By deleting the file with the localized resources, you trigger the internal fallback to English resources. On pre-XPSP3 systems, you would achieve the same effect by deleting the vbsfr.dll (the old satellite equivalent of the .mui file).<br><br>As far as I can tell, what you’re seeing is all by design.<br></font></p></blockquote><p>Very interesting!</p><p>And essentially true, especially given the goal in VBScript of having it be as VB/VBA-like as possible. He did clarify the timing issue, why it was new behavior in XP SP3:</p><blockquote><p><font face="times new roman,times">This is a side effect of fixing
something different. In fact, we were enabling MUI more broadly. This
specific behavior change was not intentional.</font> <br></p></blockquote><p>And obviously this one is an interestingly tough call -- if you think of the old behavior as a bug, then this was just a long awaited (if not entirely anticipated) bug fix. Though it confirms that the design is sound that you get what is overall the expected behavior (even if individual cases were not realized beforehand).</p><p>But it makes for an interesting twist the <a href="http://www.google.com/search?hl=en&amp;q=site%3Ablogs.msdn.com%2Fmichkap+correctness+compatibility" mce_href="http://www.google.com/search?hl=en&amp;q=site%3Ablogs.msdn.com%2Fmichkap+correctness+compatibility">correctness/compatibility</a> debate I go back and forth on here -- and a great attempt to confuse me by putting an internationalization and MUI issue in there too!<br></p><p>Now I am a huge fan of MUI, and of international support. </p><p>But given my history with this particular behavior and how big a fan I am of backcompat, I'm going to side with treating this one as a bug....</p><p>And I'll admit that somewhere between 15% and 20% of the reason there is personal. :-)</p><p>&nbsp;</p><p><font color="#ff00ff"><i>This blog brought to you by</i><font size="6"> é </font><i>(<a href="http://www.fileformat.info/info/unicode/char/00e9" mce_href="http://www.fileformat.info/info/unicode/char/00e9">U+00e9</a>, aka LATIN SMALL LETTER E WITH ACUTE)</i></font> <br></p>
<hr/><p><strong>Pascal Craponne</strong> on 16 Sep 2008 4:00 PM:</p><div style="margin-left: 1em"><p>&quot;Action ou v&#233;rit&#233;&quot; (with two e acute): yes, french kids sometimes do.</p>
<p>:)</p></div>
<p><strong>Michael S. Kaplan</strong> on 16 Sep 2008 11:27 PM:</p><div style="margin-left: 1em"><p>You could probably tell my French came from a web site looking at each word. :-)</p>
</div>
<hr/><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2008/09/17/8954874.html" title="About the people who work for companies, and *their* fonts">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2008/09/16/8953434.html" title="Is the flaw is in the constructs, or in the one who constructs? (aka I shoulda schwa that one coming)">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2008-09">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2008-09-16">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2008/09/16/8953564.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:35 GMT -->
</html>