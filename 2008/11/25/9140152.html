<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2008/11/25/9140152.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:35 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>Azeri serious bug for non-Unicode SQL Server columns?</title></head><body>
<h1>Azeri serious bug for non-Unicode SQL Server columns?</h1>
<p><em>by Michael S. Kaplan, published on 2008/11/25 10:01 -05:00, original URI: http://blogs.msdn.com/b/michkap/archive/2008/11/25/9140152.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<p>So it all started in a conversation with some of the folks from the SQL Server team when I was at PASS.</p>

<p><i>What did they expect? Send 600 Microsoft employees to an event and you are bound to run into some of them just in the act of walking around!</i></p>

<p>They were telling me about an interesting bug in a couple collations in SQL Server 2008 -- bugs that only impact non-Unicode columns for those couple of collations.</p>

<p>Apparently they got a couple code page values wrong. <br></p>

<p>This was "Azeri Serious Bug".</p>

<p>Once I was back in front of my computer, I ran the following query:</p>

<blockquote>
<p><font face="consolas,lucida console,courier new,courier">SELECT <br>&nbsp; name, <br>&nbsp; COLLATIONPROPERTY(name, 'CodePage') As CodePage, <br>&nbsp; CONVERT(binary(4), COLLATIONPROPERTY(name, 'LCID')) As LCID, <br>&nbsp; CONVERT(binary(4), COLLATIONPROPERTY(name, 'ComparisonStyle')) As ComparisonStyle, <br>&nbsp; description <br>FROM <br>&nbsp; ::fn_helpcollations() <br>WHERE <br>&nbsp; name LIKE '%Azer%' OR name LIKE '%Turki%'</font></p>
</blockquote>

<p>in SQL Server 2005:</p>

<blockquote>
<p><font size="1" face="consolas,lucida console,courier new,courier">Azeri_Cyrillic_90_BIN&nbsp;&nbsp;&nbsp; 1251&nbsp;&nbsp;&nbsp; 0x0000082C&nbsp;&nbsp;&nbsp; 0x00000000&nbsp;&nbsp;&nbsp; Azeri-Cyrillic-90, binary sort<br>Azeri_Cyrillic_90_BIN2&nbsp;&nbsp;&nbsp; 1251&nbsp;&nbsp;&nbsp; 0x0000082C&nbsp;&nbsp;&nbsp; 0x00000000&nbsp;&nbsp;&nbsp; Azeri-Cyrillic-90, binary code point comparison sort<br>Azeri_Cyrillic_90_CI_AI&nbsp;&nbsp;&nbsp; 1251&nbsp;&nbsp;&nbsp; 0x0000082C&nbsp;&nbsp;&nbsp; 0x00030003&nbsp;&nbsp;&nbsp; Azeri-Cyrillic-90, case-insensitive, accent-insensitive, kanatype-insensitive, width-insensitive<br>Azeri_Cyrillic_90_CI_AI_WS&nbsp;&nbsp;&nbsp; 1251&nbsp;&nbsp;&nbsp; 0x0000082C&nbsp;&nbsp;&nbsp; 0x00010003&nbsp;&nbsp;&nbsp; Azeri-Cyrillic-90, case-insensitive, accent-insensitive, kanatype-insensitive, width-sensitive<br>Azeri_Cyrillic_90_CI_AI_KS&nbsp;&nbsp;&nbsp; 1251&nbsp;&nbsp;&nbsp; 0x0000082C&nbsp;&nbsp;&nbsp; 0x00020003&nbsp;&nbsp;&nbsp; Azeri-Cyrillic-90, case-insensitive, accent-insensitive, kanatype-sensitive, width-insensitive<br>Azeri_Cyrillic_90_CI_AI_KS_WS&nbsp;&nbsp;&nbsp; 1251&nbsp;&nbsp;&nbsp; 0x0000082C&nbsp;&nbsp;&nbsp; 0x00000003&nbsp;&nbsp;&nbsp; Azeri-Cyrillic-90, case-insensitive, accent-insensitive, kanatype-sensitive, width-sensitive<br>Azeri_Cyrillic_90_CI_AS&nbsp;&nbsp;&nbsp; 1251&nbsp;&nbsp;&nbsp; 0x0000082C&nbsp;&nbsp;&nbsp; 0x00030001&nbsp;&nbsp;&nbsp; Azeri-Cyrillic-90, case-insensitive, accent-sensitive, kanatype-insensitive, width-insensitive<br>Azeri_Cyrillic_90_CI_AS_WS&nbsp;&nbsp;&nbsp; 1251&nbsp;&nbsp;&nbsp; 0x0000082C&nbsp;&nbsp;&nbsp; 0x00010001&nbsp;&nbsp;&nbsp; Azeri-Cyrillic-90, case-insensitive, accent-sensitive, kanatype-insensitive, width-sensitive<br>Azeri_Cyrillic_90_CI_AS_KS&nbsp;&nbsp;&nbsp; 1251&nbsp;&nbsp;&nbsp; 0x0000082C&nbsp;&nbsp;&nbsp; 0x00020001&nbsp;&nbsp;&nbsp; Azeri-Cyrillic-90, case-insensitive, accent-sensitive, kanatype-sensitive, width-insensitive<br>Azeri_Cyrillic_90_CI_AS_KS_WS&nbsp;&nbsp;&nbsp; 1251&nbsp;&nbsp;&nbsp; 0x0000082C&nbsp;&nbsp;&nbsp; 0x00000001&nbsp;&nbsp;&nbsp; Azeri-Cyrillic-90, case-insensitive, accent-sensitive, kanatype-sensitive, width-sensitive<br>Azeri_Cyrillic_90_CS_AI&nbsp;&nbsp;&nbsp; 1251&nbsp;&nbsp;&nbsp; 0x0000082C&nbsp;&nbsp;&nbsp; 0x00030002&nbsp;&nbsp;&nbsp; Azeri-Cyrillic-90, case-sensitive, accent-insensitive, kanatype-insensitive, width-insensitive<br>Azeri_Cyrillic_90_CS_AI_WS&nbsp;&nbsp;&nbsp; 1251&nbsp;&nbsp;&nbsp; 0x0000082C&nbsp;&nbsp;&nbsp; 0x00010002&nbsp;&nbsp;&nbsp; Azeri-Cyrillic-90, case-sensitive, accent-insensitive, kanatype-insensitive, width-sensitive<br>Azeri_Cyrillic_90_CS_AI_KS&nbsp;&nbsp;&nbsp; 1251&nbsp;&nbsp;&nbsp; 0x0000082C&nbsp;&nbsp;&nbsp; 0x00020002&nbsp;&nbsp;&nbsp; Azeri-Cyrillic-90, case-sensitive, accent-insensitive, kanatype-sensitive, width-insensitive<br>Azeri_Cyrillic_90_CS_AI_KS_WS&nbsp;&nbsp;&nbsp; 1251&nbsp;&nbsp;&nbsp; 0x0000082C&nbsp;&nbsp;&nbsp; 0x00000002&nbsp;&nbsp;&nbsp; Azeri-Cyrillic-90, case-sensitive, accent-insensitive, kanatype-sensitive, width-sensitive<br>Azeri_Cyrillic_90_CS_AS&nbsp;&nbsp;&nbsp; 1251&nbsp;&nbsp;&nbsp; 0x0000082C&nbsp;&nbsp;&nbsp; 0x00030000&nbsp;&nbsp;&nbsp; Azeri-Cyrillic-90, case-sensitive, accent-sensitive, kanatype-insensitive, width-insensitive<br>Azeri_Cyrillic_90_CS_AS_WS&nbsp;&nbsp;&nbsp; 1251&nbsp;&nbsp;&nbsp; 0x0000082C&nbsp;&nbsp;&nbsp; 0x00010000&nbsp;&nbsp;&nbsp; Azeri-Cyrillic-90, case-sensitive, accent-sensitive, kanatype-insensitive, width-sensitive<br>Azeri_Cyrillic_90_CS_AS_KS&nbsp;&nbsp;&nbsp; 1251&nbsp;&nbsp;&nbsp; 0x0000082C&nbsp;&nbsp;&nbsp; 0x00020000&nbsp;&nbsp;&nbsp; Azeri-Cyrillic-90, case-sensitive, accent-sensitive, kanatype-sensitive, width-insensitive<br>Azeri_Cyrillic_90_CS_AS_KS_WS&nbsp;&nbsp;&nbsp; 1251&nbsp;&nbsp;&nbsp; 0x0000082C&nbsp;&nbsp;&nbsp; 0x00000000&nbsp;&nbsp;&nbsp; Azeri-Cyrillic-90, case-sensitive, accent-sensitive, kanatype-sensitive, width-sensitive<br>Azeri_Latin_90_BIN&nbsp;&nbsp;&nbsp; 1254&nbsp;&nbsp;&nbsp; 0x0000042C&nbsp;&nbsp;&nbsp; 0x00000000&nbsp;&nbsp;&nbsp; Azeri-Latin-90, binary sort<br>Azeri_Latin_90_BIN2&nbsp;&nbsp;&nbsp; 1254&nbsp;&nbsp;&nbsp; 0x0000042C&nbsp;&nbsp;&nbsp; 0x00000000&nbsp;&nbsp;&nbsp; Azeri-Latin-90, binary code point comparison sort<br>Azeri_Latin_90_CI_AI&nbsp;&nbsp;&nbsp; 1254&nbsp;&nbsp;&nbsp; 0x0000042C&nbsp;&nbsp;&nbsp; 0x00030003&nbsp;&nbsp;&nbsp; Azeri-Latin-90, case-insensitive, accent-insensitive, kanatype-insensitive, width-insensitive<br>Azeri_Latin_90_CI_AI_WS&nbsp;&nbsp;&nbsp; 1254&nbsp;&nbsp;&nbsp; 0x0000042C&nbsp;&nbsp;&nbsp; 0x00010003&nbsp;&nbsp;&nbsp; Azeri-Latin-90, case-insensitive, accent-insensitive, kanatype-insensitive, width-sensitive<br>Azeri_Latin_90_CI_AI_KS&nbsp;&nbsp;&nbsp; 1254&nbsp;&nbsp;&nbsp; 0x0000042C&nbsp;&nbsp;&nbsp; 0x00020003&nbsp;&nbsp;&nbsp; Azeri-Latin-90, case-insensitive, accent-insensitive, kanatype-sensitive, width-insensitive<br>Azeri_Latin_90_CI_AI_KS_WS&nbsp;&nbsp;&nbsp; 1254&nbsp;&nbsp;&nbsp; 0x0000042C&nbsp;&nbsp;&nbsp; 0x00000003&nbsp;&nbsp;&nbsp; Azeri-Latin-90, case-insensitive, accent-insensitive, kanatype-sensitive, width-sensitive<br>Azeri_Latin_90_CI_AS&nbsp;&nbsp;&nbsp; 1254&nbsp;&nbsp;&nbsp; 0x0000042C&nbsp;&nbsp;&nbsp; 0x00030001&nbsp;&nbsp;&nbsp; Azeri-Latin-90, case-insensitive, accent-sensitive, kanatype-insensitive, width-insensitive<br>Azeri_Latin_90_CI_AS_WS&nbsp;&nbsp;&nbsp; 1254&nbsp;&nbsp;&nbsp; 0x0000042C&nbsp;&nbsp;&nbsp; 0x00010001&nbsp;&nbsp;&nbsp; Azeri-Latin-90, case-insensitive, accent-sensitive, kanatype-insensitive, width-sensitive<br>Azeri_Latin_90_CI_AS_KS&nbsp;&nbsp;&nbsp; 1254&nbsp;&nbsp;&nbsp; 0x0000042C&nbsp;&nbsp;&nbsp; 0x00020001&nbsp;&nbsp;&nbsp; Azeri-Latin-90, case-insensitive, accent-sensitive, kanatype-sensitive, width-insensitive<br>Azeri_Latin_90_CI_AS_KS_WS&nbsp;&nbsp;&nbsp; 1254&nbsp;&nbsp;&nbsp; 0x0000042C&nbsp;&nbsp;&nbsp; 0x00000001&nbsp;&nbsp;&nbsp; Azeri-Latin-90, case-insensitive, accent-sensitive, kanatype-sensitive, width-sensitive<br>Azeri_Latin_90_CS_AI&nbsp;&nbsp;&nbsp; 1254&nbsp;&nbsp;&nbsp; 0x0000042C&nbsp;&nbsp;&nbsp; 0x00030002&nbsp;&nbsp;&nbsp; Azeri-Latin-90, case-sensitive, accent-insensitive, kanatype-insensitive, width-insensitive<br>Azeri_Latin_90_CS_AI_WS&nbsp;&nbsp;&nbsp; 1254&nbsp;&nbsp;&nbsp; 0x0000042C&nbsp;&nbsp;&nbsp; 0x00010002&nbsp;&nbsp;&nbsp; Azeri-Latin-90, case-sensitive, accent-insensitive, kanatype-insensitive, width-sensitive<br>Azeri_Latin_90_CS_AI_KS&nbsp;&nbsp;&nbsp; 1254&nbsp;&nbsp;&nbsp; 0x0000042C&nbsp;&nbsp;&nbsp; 0x00020002&nbsp;&nbsp;&nbsp; Azeri-Latin-90, case-sensitive, accent-insensitive, kanatype-sensitive, width-insensitive<br>Azeri_Latin_90_CS_AI_KS_WS&nbsp;&nbsp;&nbsp; 1254&nbsp;&nbsp;&nbsp; 0x0000042C&nbsp;&nbsp;&nbsp; 0x00000002&nbsp;&nbsp;&nbsp; Azeri-Latin-90, case-sensitive, accent-insensitive, kanatype-sensitive, width-sensitive<br>Azeri_Latin_90_CS_AS&nbsp;&nbsp;&nbsp; 1254&nbsp;&nbsp;&nbsp; 0x0000042C&nbsp;&nbsp;&nbsp; 0x00030000&nbsp;&nbsp;&nbsp; Azeri-Latin-90, case-sensitive, accent-sensitive, kanatype-insensitive, width-insensitive<br>Azeri_Latin_90_CS_AS_WS&nbsp;&nbsp;&nbsp; 1254&nbsp;&nbsp;&nbsp; 0x0000042C&nbsp;&nbsp;&nbsp; 0x00010000&nbsp;&nbsp;&nbsp; Azeri-Latin-90, case-sensitive, accent-sensitive, kanatype-insensitive, width-sensitive<br>Azeri_Latin_90_CS_AS_KS&nbsp;&nbsp;&nbsp; 1254&nbsp;&nbsp;&nbsp; 0x0000042C&nbsp;&nbsp;&nbsp; 0x00020000&nbsp;&nbsp;&nbsp; Azeri-Latin-90, case-sensitive, accent-sensitive, kanatype-sensitive, width-insensitive<br>Azeri_Latin_90_CS_AS_KS_WS&nbsp;&nbsp;&nbsp; 1254&nbsp;&nbsp;&nbsp; 0x0000042C&nbsp;&nbsp;&nbsp; 0x00000000&nbsp;&nbsp;&nbsp; Azeri-Latin-90, case-sensitive, accent-sensitive, kanatype-sensitive, width-sensitive<br>Turkish_BIN&nbsp;&nbsp;&nbsp; 1254&nbsp;&nbsp;&nbsp; 0x0000041F&nbsp;&nbsp;&nbsp; 0x00000000&nbsp;&nbsp;&nbsp; Turkish, binary sort<br>Turkish_BIN2&nbsp;&nbsp;&nbsp; 1254&nbsp;&nbsp;&nbsp; 0x0000041F&nbsp;&nbsp;&nbsp; 0x00000000&nbsp;&nbsp;&nbsp; Turkish, binary code point comparison sort<br>Turkish_CI_AI&nbsp;&nbsp;&nbsp; 1254&nbsp;&nbsp;&nbsp; 0x0000041F&nbsp;&nbsp;&nbsp; 0x00030003&nbsp;&nbsp;&nbsp; Turkish, case-insensitive, accent-insensitive, kanatype-insensitive, width-insensitive<br>Turkish_CI_AI_WS&nbsp;&nbsp;&nbsp; 1254&nbsp;&nbsp;&nbsp; 0x0000041F&nbsp;&nbsp;&nbsp; 0x00010003&nbsp;&nbsp;&nbsp; Turkish, case-insensitive, accent-insensitive, kanatype-insensitive, width-sensitive<br>Turkish_CI_AI_KS&nbsp;&nbsp;&nbsp; 1254&nbsp;&nbsp;&nbsp; 0x0000041F&nbsp;&nbsp;&nbsp; 0x00020003&nbsp;&nbsp;&nbsp; Turkish, case-insensitive, accent-insensitive, kanatype-sensitive, width-insensitive<br>Turkish_CI_AI_KS_WS&nbsp;&nbsp;&nbsp; 1254&nbsp;&nbsp;&nbsp; 0x0000041F&nbsp;&nbsp;&nbsp; 0x00000003&nbsp;&nbsp;&nbsp; Turkish, case-insensitive, accent-insensitive, kanatype-sensitive, width-sensitive<br>Turkish_CI_AS&nbsp;&nbsp;&nbsp; 1254&nbsp;&nbsp;&nbsp; 0x0000041F&nbsp;&nbsp;&nbsp; 0x00030001&nbsp;&nbsp;&nbsp; Turkish, case-insensitive, accent-sensitive, kanatype-insensitive, width-insensitive<br>Turkish_CI_AS_WS&nbsp;&nbsp;&nbsp; 1254&nbsp;&nbsp;&nbsp; 0x0000041F&nbsp;&nbsp;&nbsp; 0x00010001&nbsp;&nbsp;&nbsp; Turkish, case-insensitive, accent-sensitive, kanatype-insensitive, width-sensitive<br>Turkish_CI_AS_KS&nbsp;&nbsp;&nbsp; 1254&nbsp;&nbsp;&nbsp; 0x0000041F&nbsp;&nbsp;&nbsp; 0x00020001&nbsp;&nbsp;&nbsp; Turkish, case-insensitive, accent-sensitive, kanatype-sensitive, width-insensitive<br>Turkish_CI_AS_KS_WS&nbsp;&nbsp;&nbsp; 1254&nbsp;&nbsp;&nbsp; 0x0000041F&nbsp;&nbsp;&nbsp; 0x00000001&nbsp;&nbsp;&nbsp; Turkish, case-insensitive, accent-sensitive, kanatype-sensitive, width-sensitive<br>Turkish_CS_AI&nbsp;&nbsp;&nbsp; 1254&nbsp;&nbsp;&nbsp; 0x0000041F&nbsp;&nbsp;&nbsp; 0x00030002&nbsp;&nbsp;&nbsp; Turkish, case-sensitive, accent-insensitive, kanatype-insensitive, width-insensitive<br>Turkish_CS_AI_WS&nbsp;&nbsp;&nbsp; 1254&nbsp;&nbsp;&nbsp; 0x0000041F&nbsp;&nbsp;&nbsp; 0x00010002&nbsp;&nbsp;&nbsp; Turkish, case-sensitive, accent-insensitive, kanatype-insensitive, width-sensitive<br>Turkish_CS_AI_KS&nbsp;&nbsp;&nbsp; 1254&nbsp;&nbsp;&nbsp; 0x0000041F&nbsp;&nbsp;&nbsp; 0x00020002&nbsp;&nbsp;&nbsp; Turkish, case-sensitive, accent-insensitive, kanatype-sensitive, width-insensitive<br>Turkish_CS_AI_KS_WS&nbsp;&nbsp;&nbsp; 1254&nbsp;&nbsp;&nbsp; 0x0000041F&nbsp;&nbsp;&nbsp; 0x00000002&nbsp;&nbsp;&nbsp; Turkish, case-sensitive, accent-insensitive, kanatype-sensitive, width-sensitive<br>Turkish_CS_AS&nbsp;&nbsp;&nbsp; 1254&nbsp;&nbsp;&nbsp; 0x0000041F&nbsp;&nbsp;&nbsp; 0x00030000&nbsp;&nbsp;&nbsp; Turkish, case-sensitive, accent-sensitive, kanatype-insensitive, width-insensitive<br>Turkish_CS_AS_WS&nbsp;&nbsp;&nbsp; 1254&nbsp;&nbsp;&nbsp; 0x0000041F&nbsp;&nbsp;&nbsp; 0x00010000&nbsp;&nbsp;&nbsp; Turkish, case-sensitive, accent-sensitive, kanatype-insensitive, width-sensitive<br>Turkish_CS_AS_KS&nbsp;&nbsp;&nbsp; 1254&nbsp;&nbsp;&nbsp; 0x0000041F&nbsp;&nbsp;&nbsp; 0x00020000&nbsp;&nbsp;&nbsp; Turkish, case-sensitive, accent-sensitive, kanatype-sensitive, width-insensitive<br>Turkish_CS_AS_KS_WS&nbsp;&nbsp;&nbsp; 1254&nbsp;&nbsp;&nbsp; 0x0000041F&nbsp;&nbsp;&nbsp; 0x00000000&nbsp;&nbsp;&nbsp; Turkish, case-sensitive, accent-sensitive, kanatype-sensitive, width-sensitive</font><br></p>
</blockquote>

<p>and in SQL Server 2008:</p>

<blockquote>
<p><font size="1" face="consolas,lucida console,courier new,courier">Azeri_Cyrillic_100_BIN&nbsp;&nbsp;&nbsp; 1251&nbsp;&nbsp;&nbsp; 0x0000082C&nbsp;&nbsp;&nbsp; 0x00000000&nbsp;&nbsp;&nbsp; Azeri-Cyrillic-100, binary sort<br>Azeri_Cyrillic_100_BIN2&nbsp;&nbsp;&nbsp; 1251&nbsp;&nbsp;&nbsp; 0x0000082C&nbsp;&nbsp;&nbsp; 0x00000000&nbsp;&nbsp;&nbsp; Azeri-Cyrillic-100, binary code point comparison sort<br>Azeri_Cyrillic_100_CI_AI&nbsp;&nbsp;&nbsp; 1251&nbsp;&nbsp;&nbsp; 0x0000082C&nbsp;&nbsp;&nbsp; 0x00030003&nbsp;&nbsp;&nbsp; Azeri-Cyrillic-100, case-insensitive, accent-insensitive, kanatype-insensitive, width-insensitive<br>Azeri_Cyrillic_100_CI_AI_WS&nbsp;&nbsp;&nbsp; 1251&nbsp;&nbsp;&nbsp; 0x0000082C&nbsp;&nbsp;&nbsp; 0x00010003&nbsp;&nbsp;&nbsp; Azeri-Cyrillic-100, case-insensitive, accent-insensitive, kanatype-insensitive, width-sensitive<br>Azeri_Cyrillic_100_CI_AI_KS&nbsp;&nbsp;&nbsp; 1251&nbsp;&nbsp;&nbsp; 0x0000082C&nbsp;&nbsp;&nbsp; 0x00020003&nbsp;&nbsp;&nbsp; Azeri-Cyrillic-100, case-insensitive, accent-insensitive, kanatype-sensitive, width-insensitive<br>Azeri_Cyrillic_100_CI_AI_KS_WS&nbsp;&nbsp;&nbsp; 1251&nbsp;&nbsp;&nbsp; 0x0000082C&nbsp;&nbsp;&nbsp; 0x00000003&nbsp;&nbsp;&nbsp; Azeri-Cyrillic-100, case-insensitive, accent-insensitive, kanatype-sensitive, width-sensitive<br>Azeri_Cyrillic_100_CI_AS&nbsp;&nbsp;&nbsp; 1251&nbsp;&nbsp;&nbsp; 0x0000082C&nbsp;&nbsp;&nbsp; 0x00030001&nbsp;&nbsp;&nbsp; Azeri-Cyrillic-100, case-insensitive, accent-sensitive, kanatype-insensitive, width-insensitive<br>Azeri_Cyrillic_100_CI_AS_WS&nbsp;&nbsp;&nbsp; 1251&nbsp;&nbsp;&nbsp; 0x0000082C&nbsp;&nbsp;&nbsp; 0x00010001&nbsp;&nbsp;&nbsp; Azeri-Cyrillic-100, case-insensitive, accent-sensitive, kanatype-insensitive, width-sensitive<br>Azeri_Cyrillic_100_CI_AS_KS&nbsp;&nbsp;&nbsp; 1251&nbsp;&nbsp;&nbsp; 0x0000082C&nbsp;&nbsp;&nbsp; 0x00020001&nbsp;&nbsp;&nbsp; Azeri-Cyrillic-100, case-insensitive, accent-sensitive, kanatype-sensitive, width-insensitive<br>Azeri_Cyrillic_100_CI_AS_KS_WS&nbsp;&nbsp;&nbsp; 1251&nbsp;&nbsp;&nbsp; 0x0000082C&nbsp;&nbsp;&nbsp; 0x00000001&nbsp;&nbsp;&nbsp; Azeri-Cyrillic-100, case-insensitive, accent-sensitive, kanatype-sensitive, width-sensitive<br>Azeri_Cyrillic_100_CS_AI&nbsp;&nbsp;&nbsp; 1251&nbsp;&nbsp;&nbsp; 0x0000082C&nbsp;&nbsp;&nbsp; 0x00030002&nbsp;&nbsp;&nbsp; Azeri-Cyrillic-100, case-sensitive, accent-insensitive, kanatype-insensitive, width-insensitive<br>Azeri_Cyrillic_100_CS_AI_WS&nbsp;&nbsp;&nbsp; 1251&nbsp;&nbsp;&nbsp; 0x0000082C&nbsp;&nbsp;&nbsp; 0x00010002&nbsp;&nbsp;&nbsp; Azeri-Cyrillic-100, case-sensitive, accent-insensitive, kanatype-insensitive, width-sensitive<br>Azeri_Cyrillic_100_CS_AI_KS&nbsp;&nbsp;&nbsp; 1251&nbsp;&nbsp;&nbsp; 0x0000082C&nbsp;&nbsp;&nbsp; 0x00020002&nbsp;&nbsp;&nbsp; Azeri-Cyrillic-100, case-sensitive, accent-insensitive, kanatype-sensitive, width-insensitive<br>Azeri_Cyrillic_100_CS_AI_KS_WS&nbsp;&nbsp;&nbsp; 1251&nbsp;&nbsp;&nbsp; 0x0000082C&nbsp;&nbsp;&nbsp; 0x00000002&nbsp;&nbsp;&nbsp; Azeri-Cyrillic-100, case-sensitive, accent-insensitive, kanatype-sensitive, width-sensitive<br>Azeri_Cyrillic_100_CS_AS&nbsp;&nbsp;&nbsp; 1251&nbsp;&nbsp;&nbsp; 0x0000082C&nbsp;&nbsp;&nbsp; 0x00030000&nbsp;&nbsp;&nbsp; Azeri-Cyrillic-100, case-sensitive, accent-sensitive, kanatype-insensitive, width-insensitive<br>Azeri_Cyrillic_100_CS_AS_WS&nbsp;&nbsp;&nbsp; 1251&nbsp;&nbsp;&nbsp; 0x0000082C&nbsp;&nbsp;&nbsp; 0x00010000&nbsp;&nbsp;&nbsp; Azeri-Cyrillic-100, case-sensitive, accent-sensitive, kanatype-insensitive, width-sensitive<br>Azeri_Cyrillic_100_CS_AS_KS&nbsp;&nbsp;&nbsp; 1251&nbsp;&nbsp;&nbsp; 0x0000082C&nbsp;&nbsp;&nbsp; 0x00020000&nbsp;&nbsp;&nbsp; Azeri-Cyrillic-100, case-sensitive, accent-sensitive, kanatype-sensitive, width-insensitive<br>Azeri_Cyrillic_100_CS_AS_KS_WS&nbsp;&nbsp;&nbsp; 1251&nbsp;&nbsp;&nbsp; 0x0000082C&nbsp;&nbsp;&nbsp; 0x00000000&nbsp;&nbsp;&nbsp; Azeri-Cyrillic-100, case-sensitive, accent-sensitive, kanatype-sensitive, width-sensitive<br>Azeri_Latin_100_BIN&nbsp;&nbsp;&nbsp; 1254&nbsp;&nbsp;&nbsp; 0x0000042C&nbsp;&nbsp;&nbsp; 0x00000000&nbsp;&nbsp;&nbsp; Azeri-Latin-100, binary sort<br>Azeri_Latin_100_BIN2&nbsp;&nbsp;&nbsp; 1254&nbsp;&nbsp;&nbsp; 0x0000042C&nbsp;&nbsp;&nbsp; 0x00000000&nbsp;&nbsp;&nbsp; Azeri-Latin-100, binary code point comparison sort<br>Azeri_Latin_100_CI_AI&nbsp;&nbsp;&nbsp; 1254&nbsp;&nbsp;&nbsp; 0x0000042C&nbsp;&nbsp;&nbsp; 0x00030003&nbsp;&nbsp;&nbsp; Azeri-Latin-100, case-insensitive, accent-insensitive, kanatype-insensitive, width-insensitive<br>Azeri_Latin_100_CI_AI_WS&nbsp;&nbsp;&nbsp; 1254&nbsp;&nbsp;&nbsp; 0x0000042C&nbsp;&nbsp;&nbsp; 0x00010003&nbsp;&nbsp;&nbsp; Azeri-Latin-100, case-insensitive, accent-insensitive, kanatype-insensitive, width-sensitive<br>Azeri_Latin_100_CI_AI_KS&nbsp;&nbsp;&nbsp; 1254&nbsp;&nbsp;&nbsp; 0x0000042C&nbsp;&nbsp;&nbsp; 0x00020003&nbsp;&nbsp;&nbsp; Azeri-Latin-100, case-insensitive, accent-insensitive, kanatype-sensitive, width-insensitive<br>Azeri_Latin_100_CI_AI_KS_WS&nbsp;&nbsp;&nbsp; 1254&nbsp;&nbsp;&nbsp; 0x0000042C&nbsp;&nbsp;&nbsp; 0x00000003&nbsp;&nbsp;&nbsp; Azeri-Latin-100, case-insensitive, accent-insensitive, kanatype-sensitive, width-sensitive<br>Azeri_Latin_100_CI_AS&nbsp;&nbsp;&nbsp; 1254&nbsp;&nbsp;&nbsp; 0x0000042C&nbsp;&nbsp;&nbsp; 0x00030001&nbsp;&nbsp;&nbsp; Azeri-Latin-100, case-insensitive, accent-sensitive, kanatype-insensitive, width-insensitive<br>Azeri_Latin_100_CI_AS_WS&nbsp;&nbsp;&nbsp; 1254&nbsp;&nbsp;&nbsp; 0x0000042C&nbsp;&nbsp;&nbsp; 0x00010001&nbsp;&nbsp;&nbsp; Azeri-Latin-100, case-insensitive, accent-sensitive, kanatype-insensitive, width-sensitive<br>Azeri_Latin_100_CI_AS_KS&nbsp;&nbsp;&nbsp; 1254&nbsp;&nbsp;&nbsp; 0x0000042C&nbsp;&nbsp;&nbsp; 0x00020001&nbsp;&nbsp;&nbsp; Azeri-Latin-100, case-insensitive, accent-sensitive, kanatype-sensitive, width-insensitive<br>Azeri_Latin_100_CI_AS_KS_WS&nbsp;&nbsp;&nbsp; 1254&nbsp;&nbsp;&nbsp; 0x0000042C&nbsp;&nbsp;&nbsp; 0x00000001&nbsp;&nbsp;&nbsp; Azeri-Latin-100, case-insensitive, accent-sensitive, kanatype-sensitive, width-sensitive<br>Azeri_Latin_100_CS_AI&nbsp;&nbsp;&nbsp; 1254&nbsp;&nbsp;&nbsp; 0x0000042C&nbsp;&nbsp;&nbsp; 0x00030002&nbsp;&nbsp;&nbsp; Azeri-Latin-100, case-sensitive, accent-insensitive, kanatype-insensitive, width-insensitive<br>Azeri_Latin_100_CS_AI_WS&nbsp;&nbsp;&nbsp; 1254&nbsp;&nbsp;&nbsp; 0x0000042C&nbsp;&nbsp;&nbsp; 0x00010002&nbsp;&nbsp;&nbsp; Azeri-Latin-100, case-sensitive, accent-insensitive, kanatype-insensitive, width-sensitive<br>Azeri_Latin_100_CS_AI_KS&nbsp;&nbsp;&nbsp; 1254&nbsp;&nbsp;&nbsp; 0x0000042C&nbsp;&nbsp;&nbsp; 0x00020002&nbsp;&nbsp;&nbsp; Azeri-Latin-100, case-sensitive, accent-insensitive, kanatype-sensitive, width-insensitive<br>Azeri_Latin_100_CS_AI_KS_WS&nbsp;&nbsp;&nbsp; 1254&nbsp;&nbsp;&nbsp; 0x0000042C&nbsp;&nbsp;&nbsp; 0x00000002&nbsp;&nbsp;&nbsp; Azeri-Latin-100, case-sensitive, accent-insensitive, kanatype-sensitive, width-sensitive<br>Azeri_Latin_100_CS_AS&nbsp;&nbsp;&nbsp; 1254&nbsp;&nbsp;&nbsp; 0x0000042C&nbsp;&nbsp;&nbsp; 0x00030000&nbsp;&nbsp;&nbsp; Azeri-Latin-100, case-sensitive, accent-sensitive, kanatype-insensitive, width-insensitive<br>Azeri_Latin_100_CS_AS_WS&nbsp;&nbsp;&nbsp; 1254&nbsp;&nbsp;&nbsp; 0x0000042C&nbsp;&nbsp;&nbsp; 0x00010000&nbsp;&nbsp;&nbsp; Azeri-Latin-100, case-sensitive, accent-sensitive, kanatype-insensitive, width-sensitive<br>Azeri_Latin_100_CS_AS_KS&nbsp;&nbsp;&nbsp; 1254&nbsp;&nbsp;&nbsp; 0x0000042C&nbsp;&nbsp;&nbsp; 0x00020000&nbsp;&nbsp;&nbsp; Azeri-Latin-100, case-sensitive, accent-sensitive, kanatype-sensitive, width-insensitive<br>Azeri_Latin_100_CS_AS_KS_WS&nbsp;&nbsp;&nbsp; 1254&nbsp;&nbsp;&nbsp; 0x0000042C&nbsp;&nbsp;&nbsp; 0x00000000&nbsp;&nbsp;&nbsp; Azeri-Latin-100, case-sensitive, accent-sensitive, kanatype-sensitive, width-sensitive<br>Turkish_BIN&nbsp;&nbsp;&nbsp; 1254&nbsp;&nbsp;&nbsp; 0x0000041F&nbsp;&nbsp;&nbsp; 0x00000000&nbsp;&nbsp;&nbsp; Turkish, binary sort<br>Turkish_BIN2&nbsp;&nbsp;&nbsp; 1254&nbsp;&nbsp;&nbsp; 0x0000041F&nbsp;&nbsp;&nbsp; 0x00000000&nbsp;&nbsp;&nbsp; Turkish, binary code point comparison sort<br>Turkish_CI_AI&nbsp;&nbsp;&nbsp; 1254&nbsp;&nbsp;&nbsp; 0x0000041F&nbsp;&nbsp;&nbsp; 0x00030003&nbsp;&nbsp;&nbsp; Turkish, case-insensitive, accent-insensitive, kanatype-insensitive, width-insensitive<br>Turkish_CI_AI_WS&nbsp;&nbsp;&nbsp; 1254&nbsp;&nbsp;&nbsp; 0x0000041F&nbsp;&nbsp;&nbsp; 0x00010003&nbsp;&nbsp;&nbsp; Turkish, case-insensitive, accent-insensitive, kanatype-insensitive, width-sensitive<br>Turkish_CI_AI_KS&nbsp;&nbsp;&nbsp; 1254&nbsp;&nbsp;&nbsp; 0x0000041F&nbsp;&nbsp;&nbsp; 0x00020003&nbsp;&nbsp;&nbsp; Turkish, case-insensitive, accent-insensitive, kanatype-sensitive, width-insensitive<br>Turkish_CI_AI_KS_WS&nbsp;&nbsp;&nbsp; 1254&nbsp;&nbsp;&nbsp; 0x0000041F&nbsp;&nbsp;&nbsp; 0x00000003&nbsp;&nbsp;&nbsp; Turkish, case-insensitive, accent-insensitive, kanatype-sensitive, width-sensitive<br>Turkish_CI_AS&nbsp;&nbsp;&nbsp; 1254&nbsp;&nbsp;&nbsp; 0x0000041F&nbsp;&nbsp;&nbsp; 0x00030001&nbsp;&nbsp;&nbsp; Turkish, case-insensitive, accent-sensitive, kanatype-insensitive, width-insensitive<br>Turkish_CI_AS_WS&nbsp;&nbsp;&nbsp; 1254&nbsp;&nbsp;&nbsp; 0x0000041F&nbsp;&nbsp;&nbsp; 0x00010001&nbsp;&nbsp;&nbsp; Turkish, case-insensitive, accent-sensitive, kanatype-insensitive, width-sensitive<br>Turkish_CI_AS_KS&nbsp;&nbsp;&nbsp; 1254&nbsp;&nbsp;&nbsp; 0x0000041F&nbsp;&nbsp;&nbsp; 0x00020001&nbsp;&nbsp;&nbsp; Turkish, case-insensitive, accent-sensitive, kanatype-sensitive, width-insensitive<br>Turkish_CI_AS_KS_WS&nbsp;&nbsp;&nbsp; 1254&nbsp;&nbsp;&nbsp; 0x0000041F&nbsp;&nbsp;&nbsp; 0x00000001&nbsp;&nbsp;&nbsp; Turkish, case-insensitive, accent-sensitive, kanatype-sensitive, width-sensitive<br>Turkish_CS_AI&nbsp;&nbsp;&nbsp; 1254&nbsp;&nbsp;&nbsp; 0x0000041F&nbsp;&nbsp;&nbsp; 0x00030002&nbsp;&nbsp;&nbsp; Turkish, case-sensitive, accent-insensitive, kanatype-insensitive, width-insensitive<br>Turkish_CS_AI_WS&nbsp;&nbsp;&nbsp; 1254&nbsp;&nbsp;&nbsp; 0x0000041F&nbsp;&nbsp;&nbsp; 0x00010002&nbsp;&nbsp;&nbsp; Turkish, case-sensitive, accent-insensitive, kanatype-insensitive, width-sensitive<br>Turkish_CS_AI_KS&nbsp;&nbsp;&nbsp; 1254&nbsp;&nbsp;&nbsp; 0x0000041F&nbsp;&nbsp;&nbsp; 0x00020002&nbsp;&nbsp;&nbsp; Turkish, case-sensitive, accent-insensitive, kanatype-sensitive, width-insensitive<br>Turkish_CS_AI_KS_WS&nbsp;&nbsp;&nbsp; 1254&nbsp;&nbsp;&nbsp; 0x0000041F&nbsp;&nbsp;&nbsp; 0x00000002&nbsp;&nbsp;&nbsp; Turkish, case-sensitive, accent-insensitive, kanatype-sensitive, width-sensitive<br>Turkish_CS_AS&nbsp;&nbsp;&nbsp; 1254&nbsp;&nbsp;&nbsp; 0x0000041F&nbsp;&nbsp;&nbsp; 0x00030000&nbsp;&nbsp;&nbsp; Turkish, case-sensitive, accent-sensitive, kanatype-insensitive, width-insensitive<br>Turkish_CS_AS_WS&nbsp;&nbsp;&nbsp; 1254&nbsp;&nbsp;&nbsp; 0x0000041F&nbsp;&nbsp;&nbsp; 0x00010000&nbsp;&nbsp;&nbsp; Turkish, case-sensitive, accent-sensitive, kanatype-insensitive, width-sensitive<br>Turkish_CS_AS_KS&nbsp;&nbsp;&nbsp; 1254&nbsp;&nbsp;&nbsp; 0x0000041F&nbsp;&nbsp;&nbsp; 0x00020000&nbsp;&nbsp;&nbsp; Turkish, case-sensitive, accent-sensitive, kanatype-sensitive, width-insensitive<br>Turkish_CS_AS_KS_WS&nbsp;&nbsp;&nbsp; 1254&nbsp;&nbsp;&nbsp; 0x0000041F&nbsp;&nbsp;&nbsp; 0x00000000&nbsp;&nbsp;&nbsp; Turkish, case-sensitive, accent-sensitive, kanatype-sensitive, width-sensitive<br>Turkish_100_BIN&nbsp;&nbsp;&nbsp; 1254&nbsp;&nbsp;&nbsp; 0x0000041F&nbsp;&nbsp;&nbsp; 0x00000000&nbsp;&nbsp;&nbsp; Turkish-100, binary sort<br>Turkish_100_BIN2&nbsp;&nbsp;&nbsp; 1254&nbsp;&nbsp;&nbsp; 0x0000041F&nbsp;&nbsp;&nbsp; 0x00000000&nbsp;&nbsp;&nbsp; Turkish-100, binary code point comparison sort<br>Turkish_100_CI_AI&nbsp;&nbsp;&nbsp; 1254&nbsp;&nbsp;&nbsp; 0x0000041F&nbsp;&nbsp;&nbsp; 0x00030003&nbsp;&nbsp;&nbsp; Turkish-100, case-insensitive, accent-insensitive, kanatype-insensitive, width-insensitive<br>Turkish_100_CI_AI_WS&nbsp;&nbsp;&nbsp; 1254&nbsp;&nbsp;&nbsp; 0x0000041F&nbsp;&nbsp;&nbsp; 0x00010003&nbsp;&nbsp;&nbsp; Turkish-100, case-insensitive, accent-insensitive, kanatype-insensitive, width-sensitive<br>Turkish_100_CI_AI_KS&nbsp;&nbsp;&nbsp; 1254&nbsp;&nbsp;&nbsp; 0x0000041F&nbsp;&nbsp;&nbsp; 0x00020003&nbsp;&nbsp;&nbsp; Turkish-100, case-insensitive, accent-insensitive, kanatype-sensitive, width-insensitive<br>Turkish_100_CI_AI_KS_WS&nbsp;&nbsp;&nbsp; 1254&nbsp;&nbsp;&nbsp; 0x0000041F&nbsp;&nbsp;&nbsp; 0x00000003&nbsp;&nbsp;&nbsp; Turkish-100, case-insensitive, accent-insensitive, kanatype-sensitive, width-sensitive<br>Turkish_100_CI_AS&nbsp;&nbsp;&nbsp; 1254&nbsp;&nbsp;&nbsp; 0x0000041F&nbsp;&nbsp;&nbsp; 0x00030001&nbsp;&nbsp;&nbsp; Turkish-100, case-insensitive, accent-sensitive, kanatype-insensitive, width-insensitive<br>Turkish_100_CI_AS_WS&nbsp;&nbsp;&nbsp; 1254&nbsp;&nbsp;&nbsp; 0x0000041F&nbsp;&nbsp;&nbsp; 0x00010001&nbsp;&nbsp;&nbsp; Turkish-100, case-insensitive, accent-sensitive, kanatype-insensitive, width-sensitive<br>Turkish_100_CI_AS_KS&nbsp;&nbsp;&nbsp; 1254&nbsp;&nbsp;&nbsp; 0x0000041F&nbsp;&nbsp;&nbsp; 0x00020001&nbsp;&nbsp;&nbsp; Turkish-100, case-insensitive, accent-sensitive, kanatype-sensitive, width-insensitive<br>Turkish_100_CI_AS_KS_WS&nbsp;&nbsp;&nbsp; 1254&nbsp;&nbsp;&nbsp; 0x0000041F&nbsp;&nbsp;&nbsp; 0x00000001&nbsp;&nbsp;&nbsp; Turkish-100, case-insensitive, accent-sensitive, kanatype-sensitive, width-sensitive<br>Turkish_100_CS_AI&nbsp;&nbsp;&nbsp; 1254&nbsp;&nbsp;&nbsp; 0x0000041F&nbsp;&nbsp;&nbsp; 0x00030002&nbsp;&nbsp;&nbsp; Turkish-100, case-sensitive, accent-insensitive, kanatype-insensitive, width-insensitive<br>Turkish_100_CS_AI_WS&nbsp;&nbsp;&nbsp; 1254&nbsp;&nbsp;&nbsp; 0x0000041F&nbsp;&nbsp;&nbsp; 0x00010002&nbsp;&nbsp;&nbsp; Turkish-100, case-sensitive, accent-insensitive, kanatype-insensitive, width-sensitive<br>Turkish_100_CS_AI_KS&nbsp;&nbsp;&nbsp; 1254&nbsp;&nbsp;&nbsp; 0x0000041F&nbsp;&nbsp;&nbsp; 0x00020002&nbsp;&nbsp;&nbsp; Turkish-100, case-sensitive, accent-insensitive, kanatype-sensitive, width-insensitive<br>Turkish_100_CS_AI_KS_WS&nbsp;&nbsp;&nbsp; 1254&nbsp;&nbsp;&nbsp; 0x0000041F&nbsp;&nbsp;&nbsp; 0x00000002&nbsp;&nbsp;&nbsp; Turkish-100, case-sensitive, accent-insensitive, kanatype-sensitive, width-sensitive<br>Turkish_100_CS_AS&nbsp;&nbsp;&nbsp; 1254&nbsp;&nbsp;&nbsp; 0x0000041F&nbsp;&nbsp;&nbsp; 0x00030000&nbsp;&nbsp;&nbsp; Turkish-100, case-sensitive, accent-sensitive, kanatype-insensitive, width-insensitive<br>Turkish_100_CS_AS_WS&nbsp;&nbsp;&nbsp; 1254&nbsp;&nbsp;&nbsp; 0x0000041F&nbsp;&nbsp;&nbsp; 0x00010000&nbsp;&nbsp;&nbsp; Turkish-100, case-sensitive, accent-sensitive, kanatype-insensitive, width-sensitive<br>Turkish_100_CS_AS_KS&nbsp;&nbsp;&nbsp; 1254&nbsp;&nbsp;&nbsp; 0x0000041F&nbsp;&nbsp;&nbsp; 0x00020000&nbsp;&nbsp;&nbsp; Turkish-100, case-sensitive, accent-sensitive, kanatype-sensitive, width-insensitive<br>Turkish_100_CS_AS_KS_WS&nbsp;&nbsp;&nbsp; 1254&nbsp;&nbsp;&nbsp; 0x0000041F&nbsp;&nbsp;&nbsp; 0x00000000&nbsp;&nbsp;&nbsp; Turkish-100, case-sensitive, accent-sensitive, kanatype-sensitive, width-sensitive</font><br></p>
</blockquote>

<p>but all of the code page values looked right!</p>

<p>Hmmm.</p>

<p>I went back and asked for more information, and then I got the clues I should have seen the first time:</p>

<ul>
<li>They called it a regression;<br></li>

<li>The collations in the two lists were mutually exclusive.</li>
</ul>

<p>And with this information I stumbled on a fact that I did not realize even though it was right in front of me.</p>

<p>The <a href="http://msdn.microsoft.com/en-us/library/ms187963(sql.90).aspx" mce_href="http://msdn.microsoft.com/en-us/library/ms187963(sql.90).aspx">fn_helpcollations</a> function wasn't returning deprecated collations!</p>

<p>It would have helped for me to look at the <a href="http://msdn.microsoft.com/en-us/library/ms187963.aspx" mce_href="http://msdn.microsoft.com/en-us/library/ms187963.aspx">SQL Server 2008 version of the topic</a>, which had the following note:</p>

<blockquote>
<p><i>Deprecated collations that are no longer supported or installed in SQL Server 2008 cannot be queried with fn_helpcollations.</i></p>
</blockquote>

<p>Aha! </p>

<p>though the older collation is actually still there; you just can't enumerate it. I was able to use it in T-SQL just fine for several operations.</p>

<p>And then I ran the following query:</p>

<blockquote>
<p><b><font face="consolas,lucida console,courier new,courier">SELECT <br>&nbsp; Name,&nbsp; <br>&nbsp; COLLATIONPROPERTY(Name, 'CodePage') As CodePage,<br>&nbsp; CONVERT(binary(4), COLLATIONPROPERTY(Name, 'LCID')) As LCID<br>FROM <br>&nbsp; (VALUES ('Azeri_Latin_90_BIN'), <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ('Azeri_Latin_100_BIN'), <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ('Azeri_Cyrillic_90_BIN'), <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ('Azeri_Cyrillic_100_BIN'), <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ('Turkish_BIN'), <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ('Turkish_100_BIN')<br>&nbsp; ) AS Collations(Name);</font></b></p>
</blockquote>

<p>which returned the following results (incorrect ones that do not match the SQL Server 2005 values in <b><font color="#ff0000">red</font></b>):</p>

<blockquote>
<p><b><font face="courier new,courier">Azeri_Latin_90_BIN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <font color="#ff0000">1251</font>&nbsp;&nbsp;&nbsp; 0x0000042C<br>Azeri_Latin_100_BIN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1254&nbsp;&nbsp;&nbsp; 0x0000042C<br>Azeri_Cyrillic_90_BIN&nbsp;&nbsp;&nbsp;&nbsp; <font color="#ff0000">1254</font>&nbsp;&nbsp;&nbsp; 0x0000082C<br>Azeri_Cyrillic_100_BIN&nbsp;&nbsp;&nbsp; 1251&nbsp;&nbsp;&nbsp; 0x0000082C<br>Turkish_BIN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1254&nbsp;&nbsp;&nbsp; 0x0000041F<br>Turkish_100_BIN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1254&nbsp;&nbsp;&nbsp; 0x0000041F</font></b><br></p>
</blockquote>

<p>And there's the bug they were talking about.</p><p>Well, that and the documentation bug that claims that these deprecated collations aren't installed. I think what they were trying to say was that they were not available in setup to choose as the default collation, and it is just bbeing described in a weird way -- since clearly the old ones are still round (and would have to be or no database using them could be upgraded properly!).</p><p>and if you use Unicode columns then this bug won't matter.</p><p>But if you use CHAR, VARCHAR, or TEXT columns with this collation, your results will be wrong -- very very wrong.... </p><p>Let's look at the code pages themselves to see how wrong, and where. First code page 1254:<br></p><p><a href="http://www.microsoft.com/globaldev/reference/sbcs/1254.mspx" mce_href="http://www.microsoft.com/globaldev/reference/sbcs/1254.mspx"><img src="http://trigeminal.fmsinc.com/images/1254.gif" title="Windows code page 1254" alt="Windows code page 1254" mce_src="http://trigeminal.fmsinc.com/images/1254.gif" width="596" border="0" height="562"></a>&nbsp;</p><p>and then code page 1251:</p><p><a href="http://www.microsoft.com/globaldev/reference/sbcs/1251.mspx" mce_href="http://www.microsoft.com/globaldev/reference/sbcs/1251.mspx"><img src="http://trigeminal.fmsinc.com/images/1251.gif" title="Windows Code Page 1251" alt="Windows Code Page 1251" mce_src="http://trigeminal.fmsinc.com/images/1251.gif" width="596" border="0" height="562"></a> </p><p>and you can see that while the Latin Azeri will be missing some characters, the Cyrillic Azeri will be missing pretty much all the ones you need.</p><p>Okay, a serious bug -- one that has to be fixed.</p><p>The easy fix is to change to the newer Azeri collations, but this can be complicated by anything that tries to map the characters through Unicode first since the data they have on the mappings is wrong here!</p><p>Not to mention users who notice the problem and just use the wrong collation that works correctly -- fixing the bug could even break a few people....<br></p><p>Now you may (if you are a regular reader) remember <b><a href="http://archives.miloush.net/michkap/archive/2005/11/23/495193.html" mce_href="http://archives.miloush.net/michkap/archive/2005/11/23/495193.html">100% roundtrip ASCII? 100% roundtrip ANSI?</a></b>, which talks about missing characters in the two code pages. </p><p>In this case, code page 1254 is missing seven bytes:</p><blockquote><p>0x81&nbsp; 0x8D&nbsp; 0x8E&nbsp; 0x8F&nbsp; 0x90&nbsp; 0x9D&nbsp; 0x9E</p></blockquote><p>which if they were on the Cyrillic code page would be:</p><blockquote><ul><li><a href="http://www.fileformat.info/info/unicode/char/0403" mce_href="http://www.fileformat.info/info/unicode/char/0403">U+0403</a> -- Ѓ (aka CYRILLIC CAPITAL LETTER GJE)<br></li><li><a href="http://www.fileformat.info/info/unicode/char/040c" mce_href="http://www.fileformat.info/info/unicode/char/040c">U+040c</a> -- Ќ (aka CYRILLIC CAPITAL LETTER KJE)<br></li><li><a href="http://www.fileformat.info/info/unicode/char/040b" mce_href="http://www.fileformat.info/info/unicode/char/040b">U+040b</a> -- Ћ (aka CYRILLIC CAPITAL LETTER TSHE)<br></li><li><a href="http://www.fileformat.info/info/unicode/char/040f" mce_href="http://www.fileformat.info/info/unicode/char/040f">U+040f</a> -- Џ (aka CYRILLIC CAPITAL LETTER DZHE)<br></li><li><a href="http://www.fileformat.info/info/unicode/char/0452" mce_href="http://www.fileformat.info/info/unicode/char/0452">U+0452</a> -- ђ (aka CYRILLIC SMALL LETTER DJE)<br></li><li><a href="http://www.fileformat.info/info/unicode/char/045c" mce_href="http://www.fileformat.info/info/unicode/char/045c">U+045c</a> -- ќ (aka CYRILLIC SMALL LETTER KJE)<br></li><li><a href="http://www.fileformat.info/info/unicode/char/045b" mce_href="http://www.fileformat.info/info/unicode/char/045b">U+045b</a> -- ћ (aka CYRILLIC SMALL LETTER TSHE)<br></li></ul></blockquote><p>While code page 1251 is just missing one byte:</p><blockquote><p>0x98</p></blockquote><p>which if they were in the Latin code page would be:</p><blockquote><ul><li><a href="http://www.fileformat.info/info/unicode/char/02dc" mce_href="http://www.fileformat.info/info/unicode/char/02dc">U+02dc</a> -- ˜ (aka SMALL TILDE)<br></li></ul></blockquote><p>Once again, it is indeed the Cyrillic code page that suffers the most, though in the case of improperly stored data it might have been the easiest to detect being on the wrong code page, if these letters were being used in Cyrillic Azeri (which according to pages like <a href="http://en.wikipedia.org/wiki/Azerbaijani_alphabet" mce_href="http://en.wikipedia.org/wiki/Azerbaijani_alphabet">this one</a> they don't really seem to be!).</p><p>In the end, this bug becomes just another incident where due to the fact that Unicode is what is being emphasized, bugs in non-Unicode code paths slip through.</p><p>This might be another good reson to support Unicode, everyone!</p><p><i>I'll probably talk more about deprecation here, another day. This was an interesting and not-wrong (in my opinion) design direction that deserves some real understanding and elucidation....</i><br></p><p>&nbsp;</p><p><font color="#ff00ff"><i>This blog brought to you by the eight above mentioned non-Azeri Unicode characters that have been pulled into some degree of Azeriness...</i></font><br></p>
<hr/><p><a id="9143014" href="#9143014">#</a> <strong>Michael Ratanapintha</strong> on 25 Nov 2008 7:27 PM:</p><div style="margin-left: 1em"><p>I guess I am being a bit stupid here, but I was wondering what the &quot;::&quot; operator in your T-SQL code does. &nbsp;Is it some kind of scope resolution operator, as the C++ analogy indicates? &nbsp;Or does it do some other function?</p></div>
<p><a id="9143145" href="#9143145">#</a> <strong>Michael S. Kaplan</strong> on 25 Nov 2008 9:40 PM:</p><div style="margin-left: 1em"><p>I don't think that makes you stupid. :-)</p>
<p>This is something I was in the first UDF sample and have just used ever since, I assume it is an analogous scope resolution operator. I just seem to do it out of habit....</p></div>
<hr/><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2008/11/25/9140376.html" title="y? Because it&#39;s documented that way!">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2008/11/24/9135043.html" title="From I SCOOT to IBOT, #5 of ?? (sometimes it is phase 3 that is ????)">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2008-11">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2008-11-25">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2008/11/25/9140152.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:35 GMT -->
</html>