<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2008/11/11/9059132.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:35 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>On blowing a font cache, and overwhelming a Fonts folder with the raw power of typography</title></head><body>
<h1>On blowing a font cache, and overwhelming a Fonts folder with the raw power of typography</h1>
<p><em>by Michael S. Kaplan, published on 2008/11/11 03:51 -05:00, original URI: http://blogs.msdn.com/b/michkap/archive/2008/11/11/9059132.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<p>&nbsp;In response to <b><a href="http://archives.miloush.net/michkap/archive/2006/08/27/726378.html" mce_href="http://archives.miloush.net/michkap/archive/2006/08/27/726378.html">About the Fonts folder in Windows, Part 3 (aka What changes in Vista?)</a></b>, Shaun asked in a <a href="http://archives.miloush.net/michkap/archive/2006/08/27/726378.html#9056636" mce_href="http://archives.miloush.net/michkap/archive/2006/08/27/726378.html#9056636">comment</a>:</p><blockquote><p><font face="times new roman,times">I unzipped a large number of font folders into my Windows/Fonts folder and now the unzipped folders are not showing up… my Fonts folder is only showing about 4,500 fonts and there are 65,000 fonts in there somewhere but they can’t be viewed and they’re not installed, just sucking up space and invisible. My “show hidden folders” option is enabled in Folder Options, and I can see the folders when I go into “Install Fonts”, but I can’t delete them!<br><br>Any ideas on how to access these folders that are obviously there, but unaccesible?</font></p></blockquote><p>This comment took me back. </p><p>Way back, in fact.</p><p>To the Spring and Summer of 2000.</p><p>I was in the final stages of a book.</p><p>This book:</p><p><img src="http://trigeminal.fmsinc.com/images/thebook3_small.jpg" title="Internationalization with Visual Basic" alt="Internationalization with Visual Basic" mce_src="http://trigeminal.fmsinc.com/images/thebook3_small.jpg" width="125" border="1" height="155"></p><p>Now most of the production was done in Microsoft Word for Windows, and the machines they were running it on were almost all running Microsoft Windows NT 4.0.</p><p>And the folks doing the production work were having problems.</p><p>It seemed like every chapter would have some characters missing. They would exit programs, log off, and reboot. The symptoms changed each time as the exact characters missing would vary, but invariably something would go wrong.</p><p>They were desperate.</p><p>Folks were getting more frantic in Indiana (where Sams was located), and the stress was being transferred to Redmond (where I was). <br></p><p>So we had a nice long conversation where we wnt through the issue with the fragile font cache in NT 4.0 and how easy it was to blow by having too many fonts. And the large number of fonts that the book needed were more than enough to blow the font cache. and blow it huge.</p><p>In Windows 2000, a huge push to fix these problems was very successful, but switching the production machines was just not an option -- the IT staff was just not set up to doing this. Even if they were, the results in Word were not the same between NT 4.0 and Windows 2000, and I was working on NT 4.0 for the book. Moving to a new platform would mean major reformatting work for the whole book. So if it seemed like there was a competition between them and I to decide who would drag their heels the most on the idea of a Win2000 upgrade, then the appearance probably wasn't far from reality.</p><p>So my suggestion was to strip down the fonts to the absolute bare minimum, then add just the necessary fonts for each chapter and take them off the machine when done. And reboot in between each chapter, just in case.</p><p>It mostly worked just fine (I say mostly because there were some problems in Chapter 3 that were not caught prior to print), and I swore to move all of my machines to Windows 2000 as soon as the book was completely done.</p><p>Now like I said the problem was largely fixed in Windows 2000.</p><p>But just because things don't blow up as easily as they did in NT 4.0 doesn't mean that GDI and the Fonts folder are prepared to scale beyond 65,000 -- or even 4,500 -- fonts! :-(</p><p>In the words of the folks from <i>In Living Color</i>, <b>Homey don't play that</b>.</p><p>But the deleton of the extra fonts is easy enough via an elevated CMD prompt. Which should allow the deletion to happen for all of the extraneous font files.</p><p>Obviously the situation with my book was what at the time thought of as quite an extreme case of a machine <i>being overwhelmed by the raw power of typography</i>, but all things considered I am pretty sure that 65,000 fonts would probably top that on any version fo Windows (as the folder itself obviously has its own problems scaling to that quantity, beyond whatever problems the underlying infrastructure hits!).</p><p>What are the scenarios that one would really need 65,000 fonts installed?</p><p>How many fonts do <b>you</b> have on your machine, and in what version of Windows?</p><p>when I think about Windows 7 and Long Zheng's <a href="http://www.istartedsomething.com/20081030/improvements-to-fonts-in-windows-7/" mce_href="http://www.istartedsomething.com/20081030/improvements-to-fonts-in-windows-7/">Improvements to fonts in Windows 7</a> over in <a href="http://www.istartedsomething.com/" mce_href="http://www.istartedsomething.com/">I Started Something</a>, I can't help wondering if the new Fonts folder in Windows 7 will scale up to 65,000 fonts. I realized three things:</p><ul><li>The mere fact that I ask the question here does not really make it a meaningful one, and</li><li>The mere fact that I ask the question here probably does mean someone will have to try it out if they aren't doing so already -- to have a description of the behavior in the future KB article, if nothing else, and</li><li>The behavior between now in the Windows 7 PDC build and in the final release of Windows 7 might be improved if this scenario wasn't already being tested....</li></ul>There is a class of bug that if someone finds it you kind of have to do something about it; this scenario might qualify. So I apologize to whoever is tasked to look further into things. :-)<br><p>&nbsp;</p><p><font color="#ff00ff"><i>This blog brought to you by</i><font size="6"> T </font><i>(<a href="http://www.fileformat.info/info/unicode/char/0054" mce_href="http://www.fileformat.info/info/unicode/char/0054">U+0054</a>, aka LATIN CAPITAL LETTER T)</i></font> <br></p>
<hr/><p><a id="9063501" href="#9063501">#</a> <strong>Mihai</strong> on 12 Nov 2008 12:44 PM:</p><div style="margin-left: 1em"><p>700 OTF/TTF fonts here (Vista SP1).</p>
<p>This is a relatively fresh install, and I add fonts as needed. But I don't think I have ever passed 1000.</p></div>
<p><a id="9088973" href="#9088973">#</a> <strong>Yuhong Bao</strong> on 15 Nov 2008 2:09 AM:</p><div style="margin-left: 1em"><p>BTW, have you encountered a similar situation with Vista? I am referring to this:</p>
<p>&quot;In Windows 2000, a huge push to fix these problems was very successful, but switching the production machines was just not an option -- the IT staff was just not set up to doing this.&quot;</p></div>
<hr/><p><em>referenced by</em></p><div style="margin-left: 1em"><p>2008/11/17 <a href="http://archives.miloush.net/michkap/archive/2008/11/17/9111437.html">In or out of the default, no way to win, really</a></p></div><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2008/11/12/9061211.html" title="You can either be intuitive and completely inconsistent, or consistent and completely unintuitive!">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2008/11/11/9056745.html" title="Trying to ignore the small stuff is harder, if you&#39;re Arabic">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2008-11">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2008-11-11">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2008/11/11/9059132.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:35 GMT -->
</html>