<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2008/11/06/9046784.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:35 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>Being smart, by not trying to be clever</title></head><body>
<h1>Being smart, by not trying to be clever</h1>
<p><em>by Michael S. Kaplan, published on 2008/11/06 10:01 -05:00, original URI: http://blogs.msdn.com/b/michkap/archive/2008/11/06/9046784.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<p>&nbsp;</p><p>There are times that Microsoft Word is too smart for its own good<br></p>
<p>The message I received via the Contact link was:</p>
<blockquote>
<p><i><font face="times new roman,times">Dear Michael,<br><br>First, I would like to thank you for your great BLOG!&nbsp; Well done!&nbsp; I've spent many hours reading and studying various articles and have found all of them helpful AND entertaining as well.&nbsp; And it's hard to do both of those things at once!<br><br>Although I've worked in the Java world for years, I'm new to Windows programming.&nbsp; So please forgive my ignorance!<br><br>The app that I'm building involves using 2 new keyboard layouts.&nbsp; So I built them using MSKLC.&nbsp; Everything was fine except they did not quite work in Microsoft Word 2007 running on XP.&nbsp; Most of the keyboard worked just fine.&nbsp; In particular the Devanagari layout didn't quite work in Word although it works fine in Notepad, Wordpad, and Excel 2007!&nbsp; It turns out that when I use a dead key to obtain some of the cerebral consonants in a glyph they don't combine!&nbsp; And it only happens when the dead key letter is in second position!<br><br>Let me explain more clearly with an example.<br><br>Here is what is supposed to happen (see the Devanagari Unicode table):<br><br>Let + be short for the words "followed by" in the example below<br><br>0938 + 094d + 0925<br><br>This sort of thing works just fine in MOST cases.&nbsp; The 2 letters are combined into a glyph &amp; are properly rendered on-screen<br><br>However, if the last code point in the example is created by using a dead key (dead key + someKeystroke), the 2 letters do NOT combine into a new glyph as they do all the other times.&nbsp; If you then move the cursor backwards on the screen to select the letters of the word, then the glyph fixes itself and properly renders!<br><br>So I've found a way around this by simply not using dead keys but it makes for a less convenient keyboard mapping.<br><br>What's happening here?&nbsp; I saw an article where one of your readers said something about Rich Edit causing something like this.&nbsp; It was a small and somewhat vague remark.&nbsp; Could this be the case here?&nbsp; I don't mean for you to spend a lot of time on this.&nbsp; If you could just point me in the right direction to understand what is happening, I'd be grateful.<br><br>Thanks again Michael.&nbsp; Tell your boss that I said you're doing a great job!<br><br>Dharma</font></i><br></p>
</blockquote>
<p>Well that was quite a nice note to get!</p>
<p>I thank you Dharma, for all the kind words. I won't go so far as to say it's why I'm here, though I will say it makes the time here nicer!<br></p>
<p>I'll forward the note on to my manager as per that last sentence, though of course since this a personal blog it is unknown how much it will impress since this isn't my actual job that you're talking about. But it can't hurt, at least. :-)</p>
<p>Now to the actual technical question....</p>
<p>In this example, we are taking a consonant<br></p>
<blockquote>
<p><font size="6">स </font><a href="http://www.fileformat.info/info/unicode/char/0938" mce_href="http://www.fileformat.info/info/unicode/char/0938">U+0938</a>, aka DEVANAGARI LETTER SA<br></p>
</blockquote>
<p>and combining it with another consonant</p>
<blockquote>
<p><font size="6">थ </font><a href="http://www.fileformat.info/info/unicode/char/0925" mce_href="http://www.fileformat.info/info/unicode/char/0925">U+0925</a>, aka DEVANAGARI LETTER THA</p>
</blockquote>
<p>and making a conjunct with a bit of Unicode-esque Virama glue, so it will look like this:</p>
<p><font size="6">स्थ </font><a href="http://www.fileformat.info/info/unicode/char/0938" mce_href="http://www.fileformat.info/info/unicode/char/0938">U+0938</a> <a href="http://www.fileformat.info/info/unicode/char/094d" mce_href="http://www.fileformat.info/info/unicode/char/094d">U+094d</a> <a href="http://www.fileformat.info/info/unicode/char/0925" mce_href="http://www.fileformat.info/info/unicode/char/0925">U+0925</a><br></p>
<p>Or maybe if you wanted to see a visible VIRAMA in there you'd add the ZWNJ, like so:</p>
<p><font size="6">स्‌थ </font><a href="http://www.fileformat.info/info/unicode/char/0938" mce_href="http://www.fileformat.info/info/unicode/char/0938">U+0938</a> <a href="http://www.fileformat.info/info/unicode/char/094d" mce_href="http://www.fileformat.info/info/unicode/char/094d">U+094d</a> <a href="http://www.fileformat.info/info/unicode/char/200c" mce_href="http://www.fileformat.info/info/unicode/char/200c">U+200c</a> <a href="http://www.fileformat.info/info/unicode/char/0925" mce_href="http://www.fileformat.info/info/unicode/char/0925">U+0925</a></p>
<p>Anyway, you get the idea.</p>
<p>Now at the very beginning I talked about how some times that Word is too smart for its own good.</p>
<p>This would be one of those times.</p>
<p>You see, Word tries its best to be helpful, something that folks have at times even made fun of, e.g.</p>
<p><a href="http://www.visar.com/AssistedSuicide.html"><img src="http://www.visar.com/AssistedSuicide.gif" border="0"></a></p>
<p>but even the most diehard of Microsoft critics will admit that Word really is trying be helpful -- this is why Word's competitor try to do the same kind of thing!</p><p>But there are times when its attempts to pay attention to what you are doing, in this case how you are entering the text, actually seem to do more harm than good.</p><p>You could perhaps try the advice in <b><a href="http://archives.miloush.net/michkap/archive/2007/03/05/1807683.html" mce_href="http://archives.miloush.net/michkap/archive/2007/03/05/1807683.html">You're not the one out of sequence, and that's the Word</a></b> (turn off the sequence checking) to see if that helps, though I don't think it will here. This is actually Word interupting its own Uniscribe layer since "there aren't any keyboards that would ever do this kind of thing" and it is saving some processing time trying to shape things that need no shaping.</p><p>Thus it isn't changing what you've input like the sequence checking can do in its artificial-intelligence-style-autocorrect attempts (you mentioned yourself that moving the cursor back over the letters and selecting them will "fix them up". And actually saving, closing, and re-opening it seems to fix the text up, as dies scrolling text way off the screen and then scrolling back to it.</p><p>In this case, Word's being so smart is mostly for its own benefit, not yours. </p><p>Which makes it all the more unfortunate that there isn't a way to give Word some hints here on what is going on.</p><p>Though the fact that it is not hurting the text being stored in the document gives you two potential workarounds, one of which seemed to work for me all the time and the other of which sometimes worked:<br></p><ol><li>You can ignore the problem and it will go away in the future when Word has to render the text when it is not watching you type it, or</li><li>You can try to build in AutoCorrect sequences that replace the string with itself</li></ol><p>The third workaround (don't do the dead key on the "shaping" character) is one implied in the original description, but since that changes how the keyboard itself is trying to do its work, it's not one I would suggest.</p><p>Perhaps if Word was not trying so hard to be clever, it could be smarter here? </p><p>Though obviously the Word folks would triage the importance of this bug by how common it is -- and of course this kind of keyboard would be pretty uncommon (sorry, Dharma!). But I'll forward it on, either way....<br></p><p><br></p><p><font color="#ff00ff"><i>This blog brought to you by</i><font size="7"> स </font><i>(<a href="http://www.fileformat.info/info/unicode/char/0938" mce_href="http://www.fileformat.info/info/unicode/char/0938">U+0938</a>, aka DEVANAGARI LETTER SA)</i></font></p>
<hr/><div style="margin-left: 1em"><em>no comments</em></div><hr/><p><em>referenced by</em></p><div style="margin-left: 1em"><p>2009/07/22 <a href="http://archives.miloush.net/michkap/archive/2009/07/22/9844827.html">The Letter Police can EAT MY SHORTS!</a></p></div><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2008/11/07/9049213.html" title="Helping partners -- small steps can be a big deal">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2008/11/06/9046130.html" title="I think we&#39;re taking the wrong approach, mostly">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2008-11">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2008-11-06">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2008/11/06/9046784.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:35 GMT -->
</html>