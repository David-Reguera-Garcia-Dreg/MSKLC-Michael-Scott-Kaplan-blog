<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2008/05/23/8537281.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:36 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>When the LANGID in the LOWORD of the KLID doesn't match the LANGID you want keyboard under?</title></head><body>
<h1>When the LANGID in the LOWORD of the KLID doesn't match the LANGID you want keyboard under?</h1>
<p><em>by Michael S. Kaplan, published on 2008/05/23 03:01 -04:00, original URI: http://blogs.msdn.com/b/michkap/archive/2008/05/23/8537281.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<P>Joost van Doorn asks (via the Contact link):</P>
<BLOCKQUOTE>
<P><FONT face="times new roman,times"><EM>Hello Michael,<BR><BR>Since your name appears in a lot of MSDN questions on International application programming, I ask my question directly to you. I'm working on an application that supports various languages. It is a C++ (Borland Builder) application. One of the aspects involved is the addition of extra keyboard. I use the API function LoadKeyboardLayout and I can add, for example, French with a french keyboard. However our PCs are always sold with a US-International keyboard. So I would like to, for example, French with a US-Internal keyboard.<BR>I have tried two approaches:<BR><BR>1. Use the LoadKeyboardLayout function: This does not work. I always get the return value "04090409" (I run XP - English).<BR>2. Changing the registry: Changing the HKCU\Leyboard layout properties is no problem but getting the new settings active - without rebooting - is a problem.<BR><BR>I have posted some question into the MSDN newsgroups but up to now no answers. This is really important to me so could you please help me.<BR><BR>Best regards,</EM></FONT></P></BLOCKQUOTE>
<P>The registry mucking is a truly bad idea -- I highly recommend against that approach.</P>
<P>It is true that <A class="" href="http://msdn2.microsoft.com/library/ms646305.aspx" mce_href="http://msdn2.microsoft.com/library/ms646305.aspx">LoadKeyboardLayout</A> won't work here -- it only works for loading a specific keyboard when the language it is to be under matches. Having the LANGID in the LOWORD of the keyboard's KLID not match the language the keyboard is under? <A class="" href="http://msdn2.microsoft.com/library/ms646305.aspx" mce_href="http://msdn2.microsoft.com/library/ms646305.aspx">LoadKeyboardLayout</A>&nbsp;isn't able to help. :-(</P>
<P>Though as I mentioned in <A class="" href="http://archives.miloush.net/michkap/archive/2007/12/01/6631463.html" mce_href="http://archives.miloush.net/michkap/archive/2007/12/01/6631463.html"><STRONG>Cutting the cord, revisited -- and documenting how to get the job done!</STRONG></A>, there is now a documented method for getting this done: the <A class="" href="http://msdn2.microsoft.com/library/bb847909.aspx" mce_href="http://msdn2.microsoft.com/library/bb847909.aspx">InstallLayoutOrTip</A>&nbsp;function in input.dll. This is new in Vista and supports these "mixed language" scenarios.</P>
<P>Though some have read <A class="" href="http://archives.miloush.net/michkap/archive/2007/06/12/3259081.html" mce_href="http://archives.miloush.net/michkap/archive/2007/06/12/3259081.html"><STRONG>Not exactly reverse engineering...</STRONG></A> and been intrigued by those&nbsp;[NONAME] exports, all I can say is that this new Vista function is not one of them -- so that isn't the most productive line to pursue. For earlier versions there is really just one answer that is documented/supported - the InputLocale keyword in&nbsp;an intl.cpl unattend call describead in <A class="" href="http://support.microsoft.com/default.aspx?scid=kb;en-us;289125" mce_href="http://support.microsoft.com/default.aspx?scid=kb;en-us;289125">KB289125</A>&nbsp;(mentioned in blogs like <A class="" href="http://archives.miloush.net/michkap/archive/2006/05/20/602745.html" mce_href="http://archives.miloush.net/michkap/archive/2006/05/20/602745.html"><STRONG>this one</STRONG></A>,&nbsp;previously)&nbsp;-- note that the first value is LANGID of the language for the Language Bar, and the second is for the KLID representing the keyboard.</P>
<P mce_keep="true">&nbsp;</P>
<P><FONT color=#ff00ff><EM>This post brought to you by</EM><FONT size=5> à²Š </FONT></FONT><EM><FONT color=#ff00ff>(</FONT><A class="" href="http://www.fileformat.info/info/unicode/char/0c8a" mce_href="http://www.fileformat.info/info/unicode/char/0c8a">U+0c8a</A><FONT color=#ff00ff>, aka KANNADA LETTER UU)</FONT></EM></P>
<hr/><p><strong>Joostmsdn</strong> on 27 May 2008 4:20 AM:</p><div style="margin-left: 1em"><p>Hello Michael,</p>
<p>Thanks for providing the input. I have now solved the problem.</p>
<p>Best regards,</p>
<p>Joost</p></div>
<hr/><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2008/05/24/8536965.html" title="What the hell is wrong with WC_NATIVEFONTCTL?">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2008/05/23/8536649.html" title="SQL vs. Windows collations: the tricycle versus the Porsche">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2008-05">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2008-05-23">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2008/05/23/8537281.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:36 GMT -->
</html>