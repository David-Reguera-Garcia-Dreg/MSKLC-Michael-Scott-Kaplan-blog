<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2008/05/12/8490406.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:36 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>What happens when you involve an unenabled Uniscribe with vertical text, given that Uniscribe doesn't handle vertical text?</title></head><body>
<h1>What happens when you involve an unenabled Uniscribe with vertical text, given that Uniscribe doesn't handle vertical text?</h1>
<p><em>by Michael S. Kaplan, published on 2008/05/12 10:01 -04:00, original URI: http://blogs.msdn.com/b/michkap/archive/2008/05/12/8490406.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<P>So I got email from a developer colleague the other day.</P>
<P>It was that same developer who had previously impressed me -- as described in <A class="" href="http://archives.miloush.net/michkap/archive/2008/01/17/7141157.html" mce_href="http://archives.miloush.net/michkap/archive/2008/01/17/7141157.html"><STRONG>Expertise isn't always everything (aka When the one who is learning teaches us something important)</STRONG></A> -- and kept me from embarrassing myself by unknowingly repeating the same topic again&nbsp;-- as described in <A class="" href="http://archives.miloush.net/michkap/archive/2008/02/28/7934894.html" mce_href="http://archives.miloush.net/michkap/archive/2008/02/28/7934894.html"><STRONG>Font size scaling -- GDI vs. GDI+</STRONG></A>.</P>
<P>Due to the positive nature of these two interactions (and several later ones by other members of her team), I like to pay attention when one of those mails hits my inbox. You know, just in case....</P>
<P>And this mail turned to be no exception. :-)</P>
<P>The mail read:</P>
<BLOCKQUOTE>
<P><FONT face="times new roman,times"><EM>Hello Michael,<BR><BR>We are running into a problem with vertical text and I am hoping you might be able to shed some light on it.&nbsp; Please take a look at the attached files – the pdf file is what we expect to see in terms of content, the TIF file is what we get. <BR><BR>The TIF file was generated on a Window 2003 server with Office 12 installed. The problem is caused by </EM></FONT><FONT face="times new roman,times"><EM>@</EM></FONT><FONT face="times new roman,times"><EM> in front of font family. The font used&nbsp; in this case is Tahoma but the problem repro’s with other fonts too. <BR><BR>The interesting part is that we&nbsp; don’t have this problem on other computers. I tried on Vista, XP and even on another Windows 2003 server too. It works just fine. I compared the versions of GDI and Uniscribe dll’s on the two Windows 2003 servers and they are the same.<BR><BR>The ScriptShape and ScriptPlace methods succeed and the glyphs and their widths look good. It suspect this is more of a drawing problem.<BR><BR>Any clue what might go wrong here? Any system settings that I should compare between the two computers?<BR><BR>Thank you,</EM></FONT></P></BLOCKQUOTE>
<P>The&nbsp; PDF file looked something like this (shown here as a somewhat reduced&nbsp;image of what it looked like):</P>
<P><IMG src="http://trigeminal.fmsinc.com/images/vertical01.png"></P>
<P>And the image file looked really different:</P>
<P mce_keep="true">&nbsp;</P>
<P mce_keep="true"><IMG src="http://trigeminal.fmsinc.com/images/vertical02.png"></P>
<P mce_keep="true">Ick.</P>
<P mce_keep="true">I was at a loss for a moment -- it isn't like I had ever seen that kind of a problem before.</P>
<P mce_keep="true">But then I thought about the lesson learned from&nbsp;<A class="" href="http://archives.miloush.net/michkap/archive/2008/01/17/7141157.html" mce_href="http://archives.miloush.net/michkap/archive/2008/01/17/7141157.html"><STRONG>Expertise isn't always everything</STRONG></A> and the fact that they were pushing past the traditional boundaries of vertical text where people had previously been comfortable.</P>
<P mce_keep="true">My response was understated. I reasoned that it worked on one machine and not another, yet file versions all looked the same, and so:</P>
<BLOCKQUOTE>
<P mce_keep="true"><FONT face="times new roman,times">Hey, long time no mail! :-)<BR><BR></FONT><FONT face="times new roman,times">The biggest thing I'd check would be whether Complex Script support was turned on or not -- when it is not, the binaries for Uniscribe are still around but the hooks so GDI call back into them don't happen.</FONT></P></BLOCKQUOTE>
<P mce_keep="true">I admit that at the time I was stalling a bit, as I wanted to look into this with some people also but I didn't want to suggest nothing at alln the meantime.</P>
<P mce_keep="true">To be honest, I did not suspect that this would actually help, but I knew&nbsp;it was vaguely possible that it might (for the reason given -- the world of calling Uniscribe directly and sometimes indirectly has strange behavior when complex script support is turned off and most indirect hooks from GDI to Uniscribe are not doing anything).</P>
<P mce_keep="true"><STRONG>Turns out that it fixed the problem!</STRONG></P>
<P mce_keep="true">Now for the follow-up we talked about a bunch of other issues like whether thy should always make sure the support is enabled, what that checkbox actually does in the way of settings, and so on. She realized it would make sense to understand more about the interaction between GDI and Uniscribe.</P>
<P mce_keep="true"><EM>I will follow-up on this topic in the future -- lots of other people would also like to understand this area better, beyond this one team that is finding issues no one ever even imagined that must nevertheless be figured out and&nbsp;in many cases&nbsp;documented&nbsp;and in some cases fixed when bugs are&nbsp;found&nbsp;(these are Destry bugs of the highest order!).</EM></P>
<P mce_keep="true">Especially in this weird case -- where vertical text does not traditionally go through Uniscribe, and the only Uniscribe connection here is that they were technically calling through&nbsp;the low-level Uniscribe APIs to get the work done.</P>
<P mce_keep="true">Explaining how it ended up solving the problem?</P>
<P mce_keep="true">That one&nbsp;managed to stump everyone I asked.</P>
<P mce_keep="true">Though no one was truly surprised that it worked.</P>
<P mce_keep="true">Which I guess just goes to show you how complicated the interaction in the text stack is.</P>
<P mce_keep="true">Especially when running non-complex vertical (and thus GDI-handled) text through Uniscribe when complex script support (and thus GDI to Uniscribe connection via LPK) is turned off.</P>
<P mce_keep="true">Yet another reason to be thankful that this support is always turned on now, starting in Vista? :-)</P>
<P mce_keep="true"><FONT color=#ff00ff><EM>This blog brought to you by</EM><FONT size=7> ឣ </FONT><EM>(<A class="" href="http://www.fileformat.info/info/unicode/char/17a3" mce_href="http://www.fileformat.info/info/unicode/char/17a3">U+17a3</A>, aka KHMER INDEPENDENT VOWEL QAQ)</EM></FONT></P>
<hr/><div style="margin-left: 1em"><em>no comments</em></div><hr/><p><em>referenced by</em></p><div style="margin-left: 1em"><p>2011/08/31 <a href="http://archives.miloush.net/michkap/archive/2011/08/31/10203390.html">And then, the unrelated KB article fixes the problem...</a></p><p>2010/09/22 <a href="http://archives.miloush.net/michkap/archive/2010/09/22/10066037.html">Looking at life a bit more vertically, for a moment...</a></p><p>2008/12/02 <a href="http://archives.miloush.net/michkap/archive/2008/12/02/9163572.html">IsCrAndLfComplex or what?</a></p></div><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2008/05/13/8498184.html" title="WinZip, the [long awaited] Unicode edition!!!">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2008/05/12/8486796.html" title="İn tıtlıng thıs ınclusıon ın re: the ınterests of Turkısh İSVs, am İ just tryıng to buıld İ&#39;s and ı&#39;s ınto the tıtle of thıs daıly contrıbutıon to SİAO (SıaO), amıgo?">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2008-05">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2008-05-12">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2008/05/12/8490406.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:36 GMT -->
</html>