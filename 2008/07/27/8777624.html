<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2008/07/27/8777624.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:36 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>Doing virtual simulationary keyboard stuff, only for real</title></head><body>
<h1>Doing virtual simulationary keyboard stuff, only for real</h1>
<p><em>by Michael S. Kaplan, published on 2008/07/27 03:01 -04:00, original URI: http://blogs.msdn.com/b/michkap/archive/2008/07/27/8777624.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<P>Reader Barney asks:</P>
<BLOCKQUOTE>
<P><FONT face="times new roman,times">Hi,<BR><BR>I've been reading your blog for a while and using all the good bits, but I have a problem I can't find the answer to.<BR><BR>I have created an on screen keyboard, and the user can enter some text that will be typed by the keyboard.<BR><BR>When parsing and typing the string to the target application (essentially a VB SendKeys replacement) I'm using VkKeyScan to determine how to send the key.&nbsp; However, as you note in some earlier posts, this does not return dead keys.<BR><BR>How do I determine which dead key(s) I need to type to print a character (for example á on a Portuguese (Portugal) layout)?<BR><BR>Many thanks,<BR>Barney</FONT></P></BLOCKQUOTE>
<P>He is right, VkKeyScan/VkKeyScanEx aren't going to do the trick.</P>
<P>But there is a lot of other stuff missing from those functions, too -- it is best just ignored for any genuine need.</P>
<P>The only real, supported&nbsp;answer for code running in user mode is the solution that just asks the keyboard for all of the information and stores it for you to use as you need it....</P>
<P>This is code I have actually written twice in my life:</P>
<UL>
<LI>for MSKLC, the Microsoft Keyboard Layout Creator, and</LI>
<LI>for the <A class="" href="http://archives.miloush.net/michkap/archive/2006/04/22/581107.html" mce_href="http://archives.miloush.net/michkap/archive/2006/04/22/581107.html"><STRONG>Getting all you can out of a keyboard layout</STRONG></A> series here in this blog.</LI></UL>
<P>Now the first one is a bit more challenging to get to (I suppose it could be eventually puzzled out via Reflector?), but it is the code that supports the "test surface" in MSKLC that lets you test out the layout as you are developing it.</P>
<P>The latter's source, however,&nbsp;is right there in the series. It is written in C# but it is mainly Win32 code written in C# for easy conversion to other languages.</P>
<P>By storing the information on what the keystrokes do, you can simulate their effects later on....</P>
<P mce_keep="true">&nbsp;</P>
<P><FONT color=#ff00ff><EM>This blog brought to you by</EM><FONT size=6> ಘ </FONT><EM>(<A class="" href="http://www.fileformat.info/info/unicode/char/0c98" mce_href="http://www.fileformat.info/info/unicode/char/0c98">U+0c98</A>, aka KANNADA LETTER GHA)</EM></FONT></P>
<hr/><div style="margin-left: 1em"><em>no comments</em></div><hr/><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2008/07/27/8781762.html" title="And you think finding presidential candidates is hard? Try getting the Vista IME candidate list!">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2008/07/26/8776572.html" title="Don&#39;t sneak a BOM in on someone who promises to ignore free space">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2008-07">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2008-07-27">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2008/07/27/8777624.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:36 GMT -->
</html>