<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2008/07/05/8694052.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:36 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>Show me the money? How?</title></head><body>
<h1>Show me the money? How?</h1>
<p><em>by Michael S. Kaplan, published on 2008/07/05 13:29 -04:00, original URI: http://blogs.msdn.com/b/michkap/archive/2008/07/05/8694052.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<P>Regular reader Jan Kučera's latest attempt to thwart my fantasy of emptying the Suggestion Box went something like this:</P>
<BLOCKQUOTE>
<P><FONT face="times new roman,times">Hello again,<BR><BR>I'm trying to display prices, in a currency the user chooses. I've abolised keeping my own formatting info for each currency, and decided to assign a culture to the currency, and let the .NET to format the price using its data (I hope this is a good decision :)), so the list of available currencies is like USD -&gt; en-US, GBP -&gt; en-GB etc.<BR><BR>Now the question, what culture should I choose to format the price in euros? Are the formatting rules the same for whole union and I can just randomly choose one country?<BR><BR>Or is there any IFormatProvider for whole EU?<BR><BR>Thanks!<BR>Jan<BR><BR>PS. Well by checking all cultures which has € as a currency symbol I see that every country formats the currency in a different way, so this is not going to work. So is the suggested way to use the USD/GBP strings and format the price as a number using user's culture?</FONT></P></BLOCKQUOTE>
<P>It is funny that the question of formatting is so prominent here -- isn't the big problem the actual conversion? The formatting seems like the easiest issue....</P>
<P><EM>As I mentioned in </EM><A class="" href="http://archives.miloush.net/michkap/archive/2005/07/22/441633.html" mce_href="http://archives.miloush.net/michkap/archive/2005/07/22/441633.html"><STRONG><EM>Show me the [small]money!</EM></STRONG></A><EM>, I am quite fond of <A class="" href="http://www.cloanto.com/" mce_href="http://www.cloanto.com/">Cloanto Currency Server</A> for the actual conversion.</EM></P>
<P>For the formatting, I would take the NumberFormatInfo of the user's culture, and change the currency symbol, but leave everything else exactly as is. Because a user's expectations of the way numbers work does not change just because they convert, and although some would understand the differences in formatting, others wouldn't. And the ones who wouldn't could easily end up misunderstanding the data they are seeing....</P>
<P>But taking a step back, it is really not such a big deal here.</P>
<P>At least for most situations.</P>
<P>You might be wondering why I say that if I talk about the potential for confusion and such?</P>
<P>Well, it is true that I might misunderstand the currency value if things like decimal places change</P>
<P>But think about the scenario for a moment:</P>
<BLOCKQUOTE>
<P><EM><FONT face="times new roman,times">I'm trying to display prices, in a currency the user chooses. </FONT></EM></P></BLOCKQUOTE>
<P>This kind of implies the typical online commerce scenario, when most commonly one is converting from some unknown currency into their own. And in this case, for the desired target of everything being in a user's own currency with their own formatting, they will be getting the same final results either way.</P>
<P>In short, the difference between "formatting with user preferences" and "formatting with the currency's preferences" disappears when dealing with the user's own currency.</P>
<P>And of course as I mentioned in <A class="" href="http://archives.miloush.net/michkap/archive/2005/07/22/441633.html" mce_href="http://archives.miloush.net/michkap/archive/2005/07/22/441633.html"><STRONG>Show me the [small]money!</STRONG></A>, a method to get the culture from the currency doesn't exist in the .NET Framework or Windows, so unless you deal with a third party product or do all of the work yourself, the whole "formatting with the currency's preferences" is hardly going to be all that easy to do anyway.</P>
<P><EM>This may be why Jan was doing it himself, in fact!</EM></P>
<P>So now I will take yet another step back and suggest finding some component that does all of the work here. Money gets one into all kinds of regulatory rules and laws about commerce. It is much better to find a component that can help indemnify you if they screw it up, rather than being ruined if one makes a mistake.</P>
<P>Strange advice coming from someone who works for a company with such a huge "let's develop everything here" bent on things, but (a) Microsoft has the time and money to spend on such a plan as wellas money to pay for their mistakes when they make them, and (b)&nbsp;there are several&nbsp;cases where I think they are wrong in this approach....</P>
<P mce_keep="true">&nbsp;</P>
<P><FONT color=#ff00ff><EM>This blog brought to you by</EM><FONT size=6> $ </FONT><EM>(<A class="" href="http://www.fileformat.info/info/unicode/char/0024" mce_href="http://www.fileformat.info/info/unicode/char/0024">U+0024</A>, aka DOLLAR SIGN)</EM></FONT></P>
<hr/><p><a id="8708740" href="#8708740">#</a> <strong>Mihai</strong> on 8 Jul 2008 11:59 AM:</p><div style="margin-left: 1em"><p>&lt;&lt;In short, the difference between &quot;formatting with user preferences&quot; and &quot;formatting with the currency's preferences&quot; disappears when dealing with the user's own currency.&gt;&gt;&gt;</p>
<p>I don't get this.</p>
<p>The fact that I prefer to use Euro tells nothing if I want the currency formatted by French, Swiss, or German rules.</p></div>
<p><a id="8708966" href="#8708966">#</a> <strong>Michael S. Kaplan</strong> on 8 Jul 2008 12:53 PM:</p><div style="margin-left: 1em"><P>If you select French then you probably won't customize the formatting (since most people don't!) -- and then what we have as your currency preference and what we have as the currency's preference match. </P>
<P>Voilà, for the common cases. :-)</P></div>
<p><a id="8709025" href="#8709025">#</a> <strong>Jan Kučera</strong> on 8 Jul 2008 1:11 PM:</p><div style="margin-left: 1em"><p>Hi Michael, I'm very sorry I've vitiated your efforts! (yet still I can't figure out how the 'thwart' thing is pronounced.. :-))</p>
<p>As you have guessed, this is an online commerce scenario. Well I understand that user is more friendly with numbers formatted using their own culture, but in the web world, this is a bit problem, as -being on the server- you have no idea what his culture is. Yes I know there is accept-language hint, but I am not very comfortable relying on it. Then, the user is free to change the language on the web site besides this.</p>
<p>What I've tried is to check the language the user was fallbacked to (or has chosen). If the corresponding culture has euro as a currency, I go ahead and use it for formatting. If not, I search through the accept-languages and if any of them represents culture with euro, I use it to format the value. If not, I use the InvariantCulture and replace the &#164; with EUR . It works well, but as I'm reading your post, maybe I'm making the problem more complicated than it is. I just wanted to use national currency symbols and make it right, but this probably just isn't possible on the web.</p>
<p>The user has chosen the language, why not just use its formatting if it is a user's choice? Well, if the web is say in Czech and English US, and you come from England, than you would probably be happy enough with the English US version. But I do sell in british pounds, so you choose to display pounds. Now, should I format the number as a currency in en-US and replace the CurrencySymbol with &#163;?</p>
<p>After reading your reply, I think I should.</p>
<p>I did not wanted to touch the exchange rates, this is why I have not mentioned anything about commerce or web. Actually our banks provide current and past rates online in XML, so this is not that big issue for me.</p>
<p>And last thing you have mentioned as well, I prefer to make things on my own, if not available from Microsoft, and really don't go into &quot;3rd party&quot; labeled things until you know.... I don't know, I have never had to yet. I just don't trust 3rd parties. As extra points I can learn lot of things by trying it myself (and vaste lot of time, I know).</p>
<p>Maybe I'm just too young.</p>
<p>Thank you for your time and reply, and good luck with the suggestion box fantasies!</p></div>
<hr/><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2008/07/06/8694239.html" title="You must have heard wrong, Jesse\ I don&#39;t know about tailoring\ But about the algorithm Jesse\ That is used by Microsoft...">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2008/07/05/8689658.html" title="They weren&#39;t on crack; they were just on a new, unknown track!">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2008-07">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2008-07-05">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2008/07/05/8694052.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:36 GMT -->
</html>