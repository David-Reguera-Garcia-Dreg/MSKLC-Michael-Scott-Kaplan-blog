<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2008/07/11/8720555.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:36 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>On installing and removing fonts, Part 4: The easiest part is the addition!</title></head><body>
<h1>On installing and removing fonts, Part 4: The easiest part is the addition!</h1>
<p><em>by Michael S. Kaplan, published on 2008/07/11 10:01 -04:00, original URI: http://blogs.msdn.com/b/michkap/archive/2008/07/11/8720555.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<P>Previous blogs in this series:</P>
<UL>
<LI><A class="" href="http://archives.miloush.net/michkap/archive/2008/07/02/8681646.html" mce_href="http://archives.miloush.net/michkap/archive/2008/07/02/8681646.html"><STRONG>0: A long journey begins with the zeroeth step</STRONG></A> 
<LI><A class="" href="http://archives.miloush.net/michkap/archive/2008/07/03/8682763.html" mce_href="http://archives.miloush.net/michkap/archive/2008/07/03/8682763.html"><STRONG>1: Do I know you, or some version of you at least?</STRONG></A> 
<LI><A class="" href="http://archives.miloush.net/michkap/archive/2008/07/07/8699735.html" mce_href="http://archives.miloush.net/michkap/archive/2008/07/07/8699735.html"><STRONG>2: Are you done using me yet?</STRONG></A></LI>
<LI><A class="" href="http://archives.miloush.net/michkap/archive/2008/07/08/8706789.html" mce_href="http://archives.miloush.net/michkap/archive/2008/07/08/8706789.html"><STRONG>3: I'll love you forever, or at least for this session.</STRONG></A></LI></UL>
<P>So far in this series I have glossed over the actual installation and uninstallation tasks that have to happen.</P>
<P>This blog will talk about the installation half.</P>
<P>Basically there are two main groups of steps:</P>
<P><STRONG>First of all</STRONG>, the font has to be placed in a nice shared location everyone/thing else on the machine can get to, and an <A class="" href="http://msdn.microsoft.com/library/ms534231.aspx" mce_href="http://msdn.microsoft.com/library/ms534231.aspx">AddFontResource</A> function call has to be made on the font so that the font is available to everyone, and the <A class="" href="http://msdn.microsoft.com/library/ms533930.aspx" mce_href="http://msdn.microsoft.com/library/ms533930.aspx">WM_FONTCHANGE</A> message should be sent around so that others within the session will know about it.</P>
<P><STRONG>This takes care of the HERE and&nbsp;NOW</STRONG>.</P>
<P><EM>For the moment we will ignore all the problems I talked about related to replacing existing fonts in </EM><A class="" href="http://archives.miloush.net/michkap/archive/2008/07/07/8699735.html" mce_href="http://archives.miloush.net/michkap/archive/2008/07/07/8699735.html"><STRONG><EM>Part 2</EM></STRONG></A><EM>&nbsp;and with folks running on the machine outside the scope of the current session and security level that made up so much of </EM><A class="" href="http://archives.miloush.net/michkap/archive/2008/07/08/8706789.html" mce_href="http://archives.miloush.net/michkap/archive/2008/07/08/8706789.html"><STRONG><EM>Part 3</EM></STRONG></A><EM>. We'll talk more about them later.</EM></P>
<P><STRONG>Second of all</STRONG>, the font has to be listed in the appropriate registry key so that future sessions can pick up the font. The system will then call <A class="" href="http://msdn.microsoft.com/library/ms534231.aspx" mce_href="http://msdn.microsoft.com/library/ms534231.aspx">AddFontResource</A> for all of sessions created in the future and they will all wok and everyone can be happy and joyful.</P>
<P><STRONG>This takes care of the EVERYWHERE and LATER</STRONG>.</P>
<P>The registry location is:</P>
<BLOCKQUOTE>
<P><STRONG><FONT face=Consolas>HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Fonts</FONT></STRONG></P></BLOCKQUOTE>
<P>on NT-based platforms, and</P>
<BLOCKQUOTE>
<P><STRONG><FONT face=Consolas>HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Fonts</FONT></STRONG></P></BLOCKQUOTE>
<P>on Win9x-based ones.</P>
<P><EM>And a pox on the crops of whoever decided to make these two keys different. :-)</EM></P>
<P>Once upon a time, the best practices for what to put in the registry was something like this:</P>
<BLOCKQUOTE>
<P><FONT face="times new roman,times">The registry key will look like this for Arial Bold “Arial Bold (TrueType) = arialbd.ttf’.&nbsp; In the font, the face and style may be localized and that localized name is what should be used on a system with that given locale. When determining what string to use the setup program should look at the locale id of the system was localized to. The system function to get the system locale and user locale are changeable on a system. The actual locale stamped into gdi32.dll or another system component should be used to determine what language name string to use.</FONT></P></BLOCKQUOTE>
<P>Though of course the issues of localized font names are much simpler now, as I mentioned in blogs like&nbsp;<A class="" href="http://archives.miloush.net/michkap/archive/2005/02/26/380867.html" mce_href="http://archives.miloush.net/michkap/archive/2005/02/26/380867.html"><STRONG>East Asian Font Names</STRONG></A>&nbsp;and&nbsp;<A class="" href="http://archives.miloush.net/michkap/archive/2006/02/13/530814.html" mce_href="http://archives.miloush.net/michkap/archive/2006/02/13/530814.html"><STRONG>Getting all of the localized names of a font</STRONG></A>&nbsp;and <A class="" href="http://archives.miloush.net/michkap/archive/2006/10/21/852382.html" mce_href="http://archives.miloush.net/michkap/archive/2006/10/21/852382.html"><STRONG>Is Font.FontFamily localized?</STRONG></A>&nbsp;and <A class="" href="http://archives.miloush.net/michkap/archive/2007/01/22/1505420.html" mce_href="http://archives.miloush.net/michkap/archive/2007/01/22/1505420.html"><STRONG>Getting all of the localized names of a font[.NET]</STRONG></A>. You no longer have to care as much about the name you put in the registry, as GDI now does the extra work to register multiple versions of the font under he different language names in the fonts themselves.</P>
<P>At this point, starting with Windows 2000, the name in the registry is not nearly as important as just having the font file name in there correctly.</P>
<P><EM>Remember this point, we are going to talk about this later when we start looking into solutions in future blogs in this series....</EM></P>
<P>Anyway, install that simple.</P>
<P>To the extent that the above is simple?</P>
<P>It certainly seems much less troubling than earlier parts of the series!</P>
<P mce_keep="true">&nbsp;</P>
<P><FONT color=#ff00ff><EM>This blog brought to you by</EM><FONT size=6> Ѳ </FONT><EM>(<A class="" href="http://www.fileformat.info/info/unicode/char/0472" mce_href="http://www.fileformat.info/info/unicode/char/0472">U+0472</A>, aka CYRILLIC CAPITAL LETTER FITA)</EM></FONT></P>
<hr/><div style="margin-left: 1em"><em>no comments</em></div><hr/><p><em>referenced by</em></p><div style="margin-left: 1em"><p>2008/09/08 <a href="http://archives.miloush.net/michkap/archive/2008/09/08/8932366.html">On installing and removing fonts, Part 8: Sometimes being selfish makes you more trustworthy</a></p><p>2008/07/30 <a href="http://archives.miloush.net/michkap/archive/2008/07/30/8791285.html">On installing and removing fonts, Part 7: What was the question, exactly?</a></p><p>2008/07/15 <a href="http://archives.miloush.net/michkap/archive/2008/07/15/8732674.html">On installing and removing fonts, Part 6: That's your name? What's your real name? Nah. What was it before you changed it?</a></p><p>2008/07/14 <a href="http://archives.miloush.net/michkap/archive/2008/07/14/8730741.html">On installing and removing fonts, Part 5: The takeaway from that is...</a></p></div><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2008/07/13/8727207.html" title="Developers are really not generally ones for spontanenous make-out sessions (aka Code jocks can talk themselves out of anything)">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2008/07/11/8720420.html" title="What kind of English were you looking for? We only seem to have one in stock....">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2008-07">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2008-07-11">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2008/07/11/8720555.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:36 GMT -->
</html>