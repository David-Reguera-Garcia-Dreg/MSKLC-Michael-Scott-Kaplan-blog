<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2008/03/26/8337198.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:36 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>Vietnamese still ain't quite right</title></head><body>
<h1>Vietnamese still ain't quite right</h1>
<p><em>by Michael S. Kaplan, published on 2008/03/26 10:01 -04:00, original URI: http://blogs.msdn.com/b/michkap/archive/2008/03/26/8337198.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<P><A class="" href="http://blogs.msdn.com/michkap" mce_href="http://blogs.msdn.com/michkap"><EM><FONT size=1>Michael Kaplan's personal blog</FONT></EM></A><EM><FONT color=#ff0000 size=1> not approved by Microsoft (see </FONT></EM><A class="" href="http://archives.miloush.net/michkap/archive/2008/02/28/7934999.html" mce_href="http://archives.miloush.net/michkap/archive/2008/02/28/7934999.html"><EM><FONT size=1>disclaimer</FONT></EM></A><EM><FONT color=#ff0000 size=1>)!</FONT></EM>&nbsp;</P>
<P>You may have read <A class="" href="http://archives.miloush.net/michkap/archive/2005/08/27/457224.html" mce_href="http://archives.miloush.net/michkap/archive/2005/08/27/457224.html"><STRONG>Vietnamese is a complex language on Windows</STRONG></A>, which discusses some fixes that were put in for Vietnamese in Vista.</P>
<P>The nature of the bug and the fixes that were put in was discussed there, as well -- it amounted to some characters used in the language but not included&nbsp;in the Vietnamese exception table -- characters also missing from the keyboard and the code page, and a few inconsistencies in weights found.</P>
<P>Anyway, recently the person who&nbsp;originally reported the bug commented on the Vista behavior:</P>
<BLOCKQUOTE>
<BLOCKQUOTE>
<P><FONT face="times new roman,times"><EM>Hi Michael,<BR><BR>Not until today, I got a chance to test the new collation on Vista. It seems that those bugs have been fixed for the Unicode composite format but not for the precomposed. Moreover, the fixes seem to have introduced new bugs. The list below includes the Vietnamese characters in question.</EM></FONT><BR><BR><FONT face="courier new,courier"><STRONG>&nbsp;Reference&nbsp; : </STRONG></FONT>aAàÀảẢãÃáÁạẠăĂằẰẳẲẵẴắẮặẶâÂầẦẩẨẫẪấẤậẬiIìÌỉỈĩĨíÍịỊoOòÒỏỎõÕóÓọỌyYỳỲỷỶỹỸýÝỵỴ<BR><BR><FONT face="courier new,courier"><STRONG>&nbsp;Composite&nbsp; : </STRONG></FONT>aAàÀảẢãÃáÁạẠâÂầẦẩẨẫăĂẪằấẤẰẳậẲẬẵẴắẮặẶiIìÌỉỈĩĨíÍịỊoOòÒỏỎõÕóÓọỌyYỳỲỷỶỹỸýÝỵỴ<BR><BR><FONT face="courier new,courier"><STRONG>&nbsp;Precomposed: </STRONG></FONT>aAàÀảẢáÁạẠãÃăĂằẰẳẲẵẴắẮặẶâÂầẦẩẨẫẪấẤậẬiIỉỈĩĨíÍịỊìÌoOỏỎóÓọỌòÒõÕyYỳỲỷỶỹỸỵỴýÝ<BR><BR><FONT face="times new roman,times"><EM>Given the latest environment (in terms of OS, .NET framework), how can I get the correct sort?<BR><BR>Quan</EM></FONT></P></BLOCKQUOTE></BLOCKQUOTE>
<P>Let's take a closer look at the values he gave, marking the one that do not match the reference in red (blowing them up and putting the reference in the middle to make visual comparisons easier):</P>
<BLOCKQUOTE>
<P><FONT face="courier new,courier"><STRONG>&nbsp;Composite&nbsp; : </STRONG></FONT><FONT size=4>aAàÀảẢãÃáÁạẠ<FONT color=#ff0000>âÂầẦẩẨẫăĂẪằấẤẰẳậẲẬẵẴắẮặẶ</FONT>iIìÌỉỈĩĨíÍịỊoOòÒỏỎõÕóÓọỌyYỳỲỷỶỹỸýÝỵỴ<BR></FONT><BR><FONT face="courier new,courier"><STRONG>&nbsp;Reference&nbsp; : </STRONG></FONT><FONT size=4>aAàÀảẢãÃáÁạẠăĂằẰẳẲẵẴắẮặẶâÂầẦẩẨẫẪấẤậẬiIìÌỉỈĩĨíÍịỊoOòÒỏỎõÕóÓọỌyYỳỲỷỶỹỸýÝỵỴ<BR></FONT><BR><FONT face="courier new,courier"><STRONG>&nbsp;Precomposed: </STRONG></FONT><FONT size=4>aAàÀảẢ<FONT color=#ff0000>áÁạẠãÃ</FONT>ăĂằẰẳẲẵẴắẮặẶâÂầẦẩẨẫẪấẤậẬiI<FONT color=#ff0000>ỉỈĩĨíÍịỊìÌ</FONT>oO<FONT color=#ff0000>ỏỎóÓọỌòÒõÕ</FONT>yYỳỲỷỶỹỸ<FONT color=#ff0000>ỵỴýÝ</FONT><BR></FONT></P></BLOCKQUOTE>
<P mce_keep="true">The information here is useful in the sense of repirting that therereporting&nbsp;are problems, but ultimately not in resolving the problems.</P>
<P mce_keep="true">Perhaps I should explain what I mean by that. :-)</P>
<UL>
<LI>
<DIV mce_keep="true">Some of the ones marked "incorrect" are done so in the absolute sense but relatively speaking some are correct -- but none of this is marked (in the end only a few of the last row entries are wrong in the relative sense);</DIV></LI>
<LI>
<DIV mce_keep="true">None of the ones on the composite row use the composite forms, meaning you cannot reproduce the same reported issue with these strings for the composite characters;</DIV></LI>
<LI>
<DIV mce_keep="true">None of the <A class="" href="http://archives.miloush.net/michkap/archive/2005/07/09/437063.html" mce_href="http://archives.miloush.net/michkap/archive/2005/07/09/437063.html"><STRONG>intermediate forms</STRONG></A> that&nbsp;sit somewhere&nbsp;between normalization forms C and D&nbsp;are represented in the composite row, either;</DIV></LI>
<LI>
<DIV mce_keep="true">These rows of characters are not entirely useful since they do not distinguish between primary, secondary, tertiary, and quaternary&nbsp;differences;</DIV></LI>
<LI>
<DIV mce_keep="true">None of the <STRONG>E</STRONG> or <STRONG>U</STRONG> characters are included in there, which suggests as minimum of&nbsp;46 missing vowels -- and given the problem that happened by not looking at the full set, anything less than the full set is ultimately insufficient;</DIV></LI>
<LI>
<DIV mce_keep="true">Other letters like đĐ are also not in there, which lead to the same kind of potential problem;</DIV></LI>
<LI>
<DIV mce_keep="true">No references to dictionaries or government standards are given, which mean any actual contemplated fix would require that kind of supporting information.</DIV></LI></UL>
<P mce_keep="true">Now ignoring all that for a moment and explaining a bit about the actual differences noted....</P>
<P mce_keep="true">The nature of the problem here is twofold:</P>
<UL>
<LI>
<DIV mce_keep="true">There are still some letters that are being identified&nbsp;as being Vietnamese that are not in the Vietnamese exception/compression tables -- they are put in where they are in the default table, which is in a few cases incorrect.</DIV></LI>
<LI>
<DIV mce_keep="true">The identified diacritic marks were also "moved" in accordance with the expected weight results, even though some of the letters they combine with may not have been, given the above point (this causes the composite case to be better for the targeted letters though worse for some of the others.</DIV></LI></UL>
<P mce_keep="true">As a rule, characters that are not used in a language do not tend to get moved along with the ones that are, but this particular discontinuity means that when such letters are sorted, their results may not be a 100% match for the precomposed/composite forms, which is why there is a difference between the two forms (the default table does match them, as do the identified Vietnamese letters; but when the moved diacritics combine with letters not in the known set, they will be moved out of matching their analogous precomposed forms).</P>
<P mce_keep="true">This is a problem that cannot be fixed without a major version change, for Vietnamese,&nbsp;which would means a new version of Windows -- as I pointed out&nbsp;in <A class="" href="http://archives.miloush.net/michkap/archive/2007/09/08/4831056.html" mce_href="http://archives.miloush.net/michkap/archive/2007/09/08/4831056.html"><STRONG>2001, a Correctness Odyssey (aka What's the matter with Ü?)</STRONG></A>, it has been decided this kind of change cannot be done in a service pack....</P>
<P mce_keep="true">So in any case, someone over in NLS has some&nbsp;investigation to do, for both repertoire and order, for a future version of Windows.</P>
<P mce_keep="true">&nbsp;</P>
<P mce_keep="true"><FONT color=#ff00ff><EM>This blog brought to you by</EM><FONT size=5> Đ </FONT><EM>(<A class="" href="http://www.fileformat.info/info/unicode/char/0110" mce_href="http://www.fileformat.info/info/unicode/char/0110">U+0110</A>, aka LATIN CAPITAL LETTER D WITH STROKE)</EM></FONT></P>
<hr/><p><a id="8343705" href="#8343705">#</a> <strong>Quan Nguyen</strong> on 29 Mar 2008 4:01 PM:</p><div style="margin-left: 1em"><p>The &quot;Composite&quot; line is the precomposed (NFC) result of sorting the decomposed (NFD) characters. I should have left it in its original format when reporting.</p>
<p>Out of curiosity, does .NET API support conversion from NFC or NFD to the intermediate forms?</p>
<p>After gazing the discrepancies awhile under your recast light, I discern that the composite got one half of the sort correct while the precomposed got the other half correct. One may start thinking that somehow by combining the sort results with the two forms, one could get the sort wholly correct, but it could get complicated, if feasible at all.</p>
<p>And even if that task could be accomplished, the contractions that are still in the table would throw another monkey wrench in the process -- causing, for instance, &quot;co&quot; is listed before &quot;cho&quot;, which is correct for Vietnamese traditional but not for the current modern collation.</p>
<p>Come to think of it, shouldn't the .NET API include support for a rule-based collation that can be defined by developers? That way if there are issues with the Windows collation tables (like Vietnamese and the German phonebook sorting order) or needs for different sort orders for the same language, people do not have to wait for many years for the next releases of Windows (and hope that things will be fixed correctly then). That would be a much more flexible and viable solution.</p></div>
<p><a id="8343713" href="#8343713">#</a> <strong>Michael S. Kaplan</strong> on 29 Mar 2008 4:11 PM:</p><div style="margin-left: 1em"><P><EM>Out of curiosity, does .NET API support conversion from NFC or NFD to the intermediate forms?</EM></P>
<P>No, sorry -- that was the point of the other posts on the subject, to show how there is no direct way to get to the intermediate forms, or the forms that would be removed based on not being in the proper canonical form.</P>
<P><EM>Come to think of it, shouldn't the .NET API include support for a rule-based collation that can be defined by developers?</EM></P>
<P>Developers, by and large, are not linguists, and the road toward custom collations is one that is not likely to start in .NET (which is clearly moving if not out of the business of providing support outside the OS at least not deeper in).</P></div>
<hr/><p><em>referenced by</em></p><div style="margin-left: 1em"><p>2010/03/09 <a href="http://archives.miloush.net/michkap/archive/2010/03/09/9975184.html">Coloring outside the lines in the a-ness of the Hungarian Technical Sort</a></p></div><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2008/03/27/8332472.html" title="Hebrew Vistas (aka And that&#39;s where I found Vista, was on the way to Jerusalem)">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2008/03/26/8332951.html" title="Cleaning up the water (globally) and hoping to get around better">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2008-03">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2008-03-26">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2008/03/26/8337198.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:36 GMT -->
</html>