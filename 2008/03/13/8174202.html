<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2008/03/13/8174202.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:36 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>More than one kind of "alphabetical" order</title></head><body>
<h1>More than one kind of "alphabetical" order</h1>
<p><em>by Michael S. Kaplan, published on 2008/03/13 09:01 -04:00, original URI: http://blogs.msdn.com/b/michkap/archive/2008/03/13/8174202.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<P><FONT color=#ff0000 size=1><EM>Please read </EM></FONT><A class="" href="http://archives.miloush.net/michkap/archive/2008/02/28/7934999.html" mce_href="http://archives.miloush.net/michkap/archive/2008/02/28/7934999.html"><EM><FONT size=1>disclaimer</FONT></EM></A><EM><FONT color=#ff0000 size=1>; content of <A class="" href="http://blogs.msdn.com/michkap" mce_href="http://blogs.msdn.com/michkap">Michael Kaplan's blog</A> not approved by Microsoft!</FONT></EM></P>
<P>You may remember seeing <A class="" href="http://archives.miloush.net/michkap/archive/2008/03/04/8015052.html" mce_href="http://archives.miloush.net/michkap/archive/2008/03/04/8015052.html"><STRONG>Consistency in the Windows Shell is not overrated; it's just underobserved!</STRONG></A> if you are a regular reader (it was just over a week ago!).</P>
<P>In that post I asked if people wanted to point out other examples. Dean Harding was the only one who did in a <A class="" href="http://archives.miloush.net/michkap/archive/2008/03/04/8015052.html#8037038" mce_href="http://archives.miloush.net/michkap/archive/2008/03/04/8015052.html#8037038">comment</A>:</P>
<BLOCKQUOTE>
<P><FONT face="times new roman,times">It also doesn't sort "normally" when displaying files in a menu (for example, the "Send To" menu, the quicklaunch menu, etc). See:<BR><BR><IMG src="http://trigeminal.fmsinc.com/images/unintuitive-sort-1.png"><BR><BR></FONT>from (<A href="http://www.trigeminal.com/images/unintuitive-sort-1.png" target=_new rel=nofollow><FONT face="times new roman,times">http://codeka.com/blogs/media/unintuitive-sort-1.png</FONT></A>)<BR><BR><FONT face="times new roman,times">and<BR><BR><IMG src="http://trigeminal.fmsinc.com/images/unintuitive-sort-2.png"><BR><BR></FONT>(from <A href="http://codeka.com/blogs/media/unintuitive-sort-2.png" target=_new rel=nofollow><FONT face="times new roman,times">http://codeka.com/blogs/media/unintuitive-sort-2.png</FONT></A>)</P></BLOCKQUOTE>
<P><EM>NOTE: There are other things going on here in addition to not using </EM><A class="" href="http://msdn2.microsoft.com/library/bb759947.aspx" mce_href="http://msdn2.microsoft.com/library/bb759947.aspx"><EM>StrCmpLogicalW</EM></A><EM>&nbsp;that I will talk about in a moment, for now you can just pretend I plan to stsy on topic.</EM> :-)</P>
<P>But several others pointed out examples of this behavior, like Developer Tanya who pointed out Regedit:</P>
<BLOCKQUOTE>
<P><IMG height=926 src="http://trigeminal.fmsinc.com/images/regedit01.png" width=1075></P></BLOCKQUOTE>
<P>Now you may recall that Regedit has a lightly different problem, one I pointed out&nbsp;nearly a year ago in <A class="" href="http://archives.miloush.net/michkap/archive/2007/03/24/1941034.html" mce_href="http://archives.miloush.net/michkap/archive/2007/03/24/1941034.html"><STRONG>It was déjà vu, man. Pure déjà vu....</STRONG></A>, where the alphabetical order in Regedit has nothing to do with the actual order an enumeration registry function call would give you, so you can add the "less than intuitive sort to the list" also!</P>
<P>Another example came from Santhosh Pillai, who pointed out how&nbsp;entries from the Global Address List in Outlook/Exchange, like the following (alias and owner nae obscured for obvious reasons!):</P>
<P><IMG src="http://trigeminal.fmsinc.com/images/exchangeaddress01.png"></P>
<P>Boy, both cases could benefit from a little <A class="" href="http://msdn2.microsoft.com/library/bb759947.aspx" mce_href="http://msdn2.microsoft.com/library/bb759947.aspx">StrCmpLogicalW</A> love too, huh? Though obviously for that later case the potential performance cost could be of real concern for distribution lists with a ton of members on them....</P>
<P>There was another example that was pointed out to me, came from developer Rick Nostrum, who pointed out an interesting Vista desktop example if you sort by name:</P>
<P><IMG src="http://trigeminal.fmsinc.com/images/vistadesktop02.png"></P>
<P>As seen here, when I elect to show even hidden and system files/directories:</P>
<P><IMG src="http://trigeminal.fmsinc.com/images/vistadesktop01.png"></P>
<P>This is not the numeric issue, but he pointed out how there were two seemingly identically names files and an order that was anything but alphabetical....</P>
<P>Actually though, it <STRONG>is</STRONG> alphabetical. There are just two interesting external factors happening here.</P>
<P>The first issue is with the <STRONG>Recycle Bin</STRONG>, which as a special system folder gets put at the very top of the list. Well, it may also be done to remind you to recycle. :-)</P>
<P>This issue is also the reason that Dean's examples also have anomalies -- the "special" ordering of "special" folders is a force to be, if not&nbsp;reckoned with, then at least to be kept in mind.</P>
<P>The second issue is due to the fact that the desktop folder&nbsp;is actually a virtual view that combines <STRONG>two different folders</STRONG>:</P>
<UL>
<LI>The user's <STRONG>Desktop</STRONG> folder</LI>
<LI>The shared <STRONG>Desktop</STRONG> folder for all users</LI></UL>
<P>The information in each folder is provided sorted in alphabetical order, which in this case amounts to two alphabetized lists, one after the other.</P>
<P>Now you might only notice this issue if you have items in both folders, like I do. But it also will probably happen in Explorer as well, if you look at the main <STRONG>Desktop</STRONG> folder (not the specific ones, as they should only show the items in that one actual folder).</P>
<P>Fixing that issue would require a little bit of work, but the time required to combine two sorted lists is not a huge one. Hell, I have actually gotten that question before <A class="" href="http://archives.miloush.net/michkap/archive/2005/02/23/378975.html" mce_href="http://archives.miloush.net/michkap/archive/2005/02/23/378975.html"><STRONG>in Microsoft interviews</STRONG></A>!</P>
<P>This last example showed a trend that lots of people started working with, pointing other interesting sorting anomalies on Windows. I'll cover some more of those in an upcoming post....</P>
<P><BR><FONT color=#ff00ff><EM>This blog brought to you by</EM><FONT size=5> ໂ </FONT></FONT><EM><FONT color=#ff00ff>(</FONT><A class="" href="http://www.fileformat.info/info/unicode/char/0ec2" mce_href="http://www.fileformat.info/info/unicode/char/0ec2">U+0ec2</A><FONT color=#ff00ff>, aka LAO VOWEL SIGN O)</FONT></EM></P>
<hr/><p><a id="8194861" href="#8194861">#</a> <strong>Igor Levicki</strong> on 14 Mar 2008 12:43 AM:</p><div style="margin-left: 1em"><p>In my opinion the main problem with sorting filenames is that they have to be unique because they are used as an access key to the underlying filesystem. If you could have more files with the same name (say birthday_cake, birthday_cake, and birthday_cake which are three different photos of your birthday cake) there would be less of a problem to sort them, you would recognize them by the preview just like you do in real life and most usefull sort would be by date and time, not by some arbitrary number we are now forced to append to those names. It is sad that after 50 years, filenames are still the key instead of some 128-bit GUID and that the content recognition relies on file extension instead of MIME metadata tag.</p></div>
<p><a id="8205335" href="#8205335">#</a> <strong>Maurits [MSFT]</strong> on 14 Mar 2008 11:51 AM:</p><div style="margin-left: 1em"><p>Hmmm... so we should make the filename internally a GUID, generated randomly at file-creation time (or copy time). &nbsp;We wouldn't display this GUID in the explorer view, of course; we should show a &quot;title&quot; which would be stored in the file's metadata (along with the MIME type.)</p>
<p>As an added bonus we would, for the first time, be able to include these characters in file names:</p>
<p>\ / : * ? &lt; &gt; |</p>
<p>Sure, it would be a painful transition, but so was the 8.3 to &quot;long filename&quot; transition.</p></div>
<p><a id="8208757" href="#8208757">#</a> <strong>Michael S. Kaplan</strong> on 14 Mar 2008 2:56 PM:</p><div style="margin-left: 1em"><p>Across all possible file systems? And all possible versions of them that Windows connects to remotely? Hmmm....</p>
</div>
<p><strong>Michael S. Kaplan</strong> on 16 Mar 2008 7:10 PM:</p><div style="margin-left: 1em"></div>
<hr/><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2008/03/14/8195405.html" title="The shuffle? Be afraid. Be very afraid...">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2008/03/13/8170697.html" title="Yet another face to irony">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2008-03">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2008-03-13">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2008/03/13/8174202.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:36 GMT -->
</html>