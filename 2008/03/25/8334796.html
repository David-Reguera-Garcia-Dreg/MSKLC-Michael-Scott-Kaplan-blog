<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2008/03/25/8334796.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:36 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>Bush might've still hid the facts, but he can't hide them from Vista SP1/Server 2008 Notepad!</title></head><body>
<h1>Bush might've still hid the facts, but he can't hide them from Vista SP1/Server 2008 Notepad!</h1>
<p><em>by Michael S. Kaplan, published on 2008/03/25 03:01 -04:00, original URI: http://blogs.msdn.com/b/michkap/archive/2008/03/25/8334796.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<P><EM><FONT color=#ff0000 size=1>Content of </FONT></EM><A class="" href="http://blogs.msdn.com/michkap" mce_href="http://blogs.msdn.com/michkap"><EM><FONT size=1>Michael Kaplan's personal blog</FONT></EM></A><EM><FONT color=#ff0000 size=1> not approved by Microsoft (see </FONT></EM><A class="" href="http://archives.miloush.net/michkap/archive/2008/02/28/7934999.html" mce_href="http://archives.miloush.net/michkap/archive/2008/02/28/7934999.html"><EM><FONT size=1>disclaimer</FONT></EM></A><EM><FONT color=#ff0000 size=1>)!</FONT></EM>&nbsp;</P>
<P>My&nbsp;blog <A class="" href="http://archives.miloush.net/michkap/archive/2006/06/14/631016.html" mce_href="http://archives.miloush.net/michkap/archive/2006/06/14/631016.html"><STRONG>Behind 'How to break Windows Notepad'</STRONG></A> was a pretty popular one, as were its follow-up posts -- <A class="" href="http://archives.miloush.net/michkap/archive/2006/07/11/662342.html" mce_href="http://archives.miloush.net/michkap/archive/2006/07/11/662342.html"><STRONG>More on that which breaks Windows Notepad</STRONG></A> and <A class="" href="http://archives.miloush.net/michkap/archive/2007/04/22/2239345.html" mce_href="http://archives.miloush.net/michkap/archive/2007/04/22/2239345.html"><STRONG>The Notepad encoding detection issues keep coming up</STRONG></A>.</P>
<P>Someone suggested to me that it was because they spent more time explaining why it was happening then composing fun sentences like <STRONG>Bush hid the facts</STRONG> and such. a popular pastime, to be sure, but not one that gets very far after that unless you&nbsp;know Chinese and manage to construct a string that is funny in both languages.</P>
<P><EM>As a by the way, <STRONG>that</STRONG> would impress me very much if someone was able to come up with it! It is like Numerology on steroids to take the ASCII values for English letters and map them in one's ,ind to the Unicode code point values for Chinese in a way that you come up with such a word!</EM></P>
<P>But that is not the subject of today's blog post. I just can't help saying that I am practically willing to fly to the person who comes up with this and buy them a glass full of whatever they are drinking! :-)</P>
<P>Today is about Erzengel's comment to the original post yesterday, <A class="" href="http://archives.miloush.net/michkap/archive/2006/06/14/631016.html#8334493" mce_href="http://archives.miloush.net/michkap/archive/2006/06/14/631016.html#8334493">here</A>:</P>
<BLOCKQUOTE>
<P><EM><FONT face="times new roman,times">I can't repro in Vista. Fixed?</FONT></EM></P></BLOCKQUOTE>
<P>Well, that simply indicates that Erzengel has SP1 installed on his Vista machine. Because in Vista SP1 and Server 2008 have indeed taken steps to mitigate this issue (in other words, fix this bug!).</P>
<P>Now for the record this was not a change in the <A class="" href="http://msdn2.microsoft.com/library/ms776445.aspx" mce_href="http://msdn2.microsoft.com/library/ms776445.aspx">IsTextUnicode</A> function, it was a change to Notepad, which now uses a slightly modified version of the algorithm I mentioned in <A class="" href="http://archives.miloush.net/michkap/archive/2007/04/22/2239345.html" mce_href="http://archives.miloush.net/michkap/archive/2007/04/22/2239345.html"><STRONG>The Notepad encoding detection issues keep coming up</STRONG></A>, one that is a bit more skeptical of the results of <A class="" href="http://msdn2.microsoft.com/library/ms776445.aspx" mce_href="http://msdn2.microsoft.com/library/ms776445.aspx">IsTextUnicode</A> when its only basis for returning TRUE is IS_TEXT_UNICODE_STATISTICS and it has one of these kinds of strings</P>
<P>I might have argued that it should have been fixed in the function, but for most uses I think the <A class="" href="http://msdn2.microsoft.com/library/ms776445.aspx" mce_href="http://msdn2.microsoft.com/library/ms776445.aspx">IsTextUnicode</A>&nbsp;results are no worse than&nbsp;problems behind the reasons&nbsp;that <A class="" href="http://archives.miloush.net/michkap/archive/2005/01/30/363308.html" mce_href="http://archives.miloush.net/michkap/archive/2005/01/30/363308.html"><STRONG>I don't like IsTextUnicode</STRONG></A>&nbsp;anyway. So in the end this probably okay to take the public concerns out of the problem.</P>
<P>And it is cheaper than fixing the freaking function <A class="" href="http://archives.miloush.net/michkap/archive/2005/01/30/363308.html" mce_href="http://archives.miloush.net/michkap/archive/2005/01/30/363308.html"><STRONG>I don't like</STRONG></A>, which no one felt like jumping up to do. I get tempted to do it myself, though to be honest I am most tempted to just try to get a development intern who would be given this job -- rehabilitating <A class="" href="http://msdn2.microsoft.com/library/ms776445.aspx" mce_href="http://msdn2.microsoft.com/library/ms776445.aspx">IsTextUnicode</A>'s functionality to make it a worthwhile function I'd be proud to not make fun of one day. Though maybe the PTB wouldn't want to assign resources that way, I think it would be a fun project if I were an intern. :-)</P>
<P>Anyway, the summary -- <STRONG>starting in Vista SP1/Server 2008</STRONG>, only <A class="" href="http://msdn2.microsoft.com/library/ms776445.aspx" mce_href="http://msdn2.microsoft.com/library/ms776445.aspx">IsTextUnicode</A>&nbsp;thinks that <STRONG>Bush hid the facts</STRONG>. :-)</P>
<P mce_keep="true">&nbsp;</P>
<P><FONT color=#ff00ff><EM>This post brought to you by</EM> <FONT size=6>ï¿½</FONT> <EM>(<A class="" href="http://www.fileformat.info/info/unicode/char/fffd" mce_href="http://www.fileformat.info/info/unicode/char/fffd">U+fffd</A>, a.k.a. REPLACEMENT CHARACTER)</EM></FONT></P>
<hr/><p><strong>Mihai</strong> on 26 Mar 2008 12:55 PM:</p><div style="margin-left: 1em"><p>&quot;Because in Vista SP1 and Server 2008 have indeed taken steps to mitigate this issue (in other words, fix this bug!).&quot;</p>
<p>Crap!</p>
<p>Vista SP1 is taking away all the fun!</p>
<p>:-)</p></div>
<hr/><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2008/03/26/8332951.html" title="Cleaning up the water (globally) and hoping to get around better">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2008/03/25/8333961.html" title="Yet another reason to avoid the shuffle">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2008-03">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2008-03-25">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2008/03/25/8334796.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:36 GMT -->
</html>