<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2008/04/30/8440675.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:36 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>Why WC2MB needs a CP, chaver sheli!</title></head><body>
<h1>Why WC2MB needs a CP, chaver sheli!</h1>
<p><em>by Michael S. Kaplan, published on 2008/04/30 10:01 -04:00, original URI: http://blogs.msdn.com/b/michkap/archive/2008/04/30/8440675.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<P>Dmitry asked via the Contact link:</P>
<BLOCKQUOTE>
<P><FONT face="times new roman,times"><EM>Hello Michael!<BR><BR>As far as I understand, some wide char can be in only one of Unicode subranges listed e.g. at </EM></FONT><A href="http://msdn2.microsoft.com/en-us/library/ms776439(VS.85).aspx"><FONT face="times new roman,times"><EM>http://msdn2.microsoft.com/en-us/library/ms776439(VS.85).aspx</EM></FONT></A><FONT face="times new roman,times"><EM>, so its value determines its code page. But then why does WideCharToMultiByte needs the codepage parameter?!<BR><BR>The question comes from practice: if I get some wide char string from somewhere with unknown codepage, how do I get MBCS analog for it? Even more, the string may contain chars from different codepages..<BR><BR>It makes me thinking that Unicode (or its implementation in WinAPI) is not so universal if Unicode chars are not self-descriptive and need additional information about them..<BR><BR>Thanks.<BR>Dmitry.</EM></FONT></P></BLOCKQUOTE>
<P>Sorry Dmitry, you are confusing apples and earmuffs on this one -- the <A class="" href="http://msdn.microsoft.com/library/ms776439.aspx" mce_href="http://msdn.microsoft.com/library/ms776439.aspx">Unicode Subset Bitfields</A> are not connected to the <A class="" href="http://www.microsoft.com/globaldev/reference/cphome.mspx" mce_href="http://www.microsoft.com/globaldev/reference/cphome.mspx">Code Pages supported by Windows</A>, at all really.</P>
<P>They really serve two different purposes -- the <A class="" href="http://msdn.microsoft.com/library/ms776439.aspx" mce_href="http://msdn.microsoft.com/library/ms776439.aspx">Unicode Subset Bitfields</A>&nbsp;are a way that typography can use to group Unicode characters together based on <A class="" href="http://www.unicode.org/charts/" mce_href="http://www.unicode.org/charts/">Unicode subranges</A>. Each character in Unicode is in one and only one of those subranges,&nbsp;and if you will note the definition of the various&nbsp;<A class="" href="http://msdn.microsoft.com/library/ms776439.aspx" mce_href="http://msdn.microsoft.com/library/ms776439.aspx">Unicode Subset Bitfields</A>, some actually contain more than one of the <A class="" href="http://www.unicode.org/charts/" mce_href="http://www.unicode.org/charts/">Unicode subranges</A>. This is very good since the OS/2 table of the font that contains those same Unicode range bits is <A class="" href="http://archives.miloush.net/michkap/archive/2006/12/24/1359264.html" mce_href="http://archives.miloush.net/michkap/archive/2006/12/24/1359264.html"><STRONG>Running a bit short on space</STRONG></A> and all. :-)</P>
<P>The <A class="" href="http://www.microsoft.com/globaldev/reference/cphome.mspx" mce_href="http://www.microsoft.com/globaldev/reference/cphome.mspx">Code Pages supported by Windows</A>, on the other hand, are various subsets -- small groupings of characters that are each targeting a particular market or markets. They each define various mappings to Unicode, and Unicode characters can appear in more than one code page (e.g. all of the characters in ASCII are supported on most of them, and many of the letters in Greek are supported on code pages <A class="" href="http://www.microsoft.com/globaldev/reference/sbcs/1253.mspx" mce_href="http://www.microsoft.com/globaldev/reference/sbcs/1253.mspx">1253</A>, <A class="" href="http://www.microsoft.com/globaldev/reference/oem/737.mspx" mce_href="http://www.microsoft.com/globaldev/reference/oem/737.mspx">737</A>, <A class="" href="http://www.microsoft.com/globaldev/reference/iso/28597.mspx" mce_href="http://www.microsoft.com/globaldev/reference/iso/28597.mspx">28597</A>, and <A class="" href="http://www.microsoft.com/globaldev/reference/dbcs/932.mspx" mce_href="http://www.microsoft.com/globaldev/reference/dbcs/932.mspx">932</A>&nbsp;under the "<A class="" href="http://www.microsoft.com/globaldev/reference/dbcs/932/932_83.mspx" mce_href="http://www.microsoft.com/globaldev/reference/dbcs/932/932_83.mspx">83</A>" lead byte, among others. So there is no way to know what code page to use for the mapping!</P>
<P>Now if one was looking to find out the script(s) of various strings, I have mentioned the &gt;= Vista <A class="" href="http://msdn.microsoft.com/library/ms776368.aspx" mce_href="http://msdn.microsoft.com/library/ms776368.aspx">GetStringScripts</A> and the &lt; Vista <A class="" href="http://msdn.microsoft.com/library/ms776347.aspx" mce_href="http://msdn.microsoft.com/library/ms776347.aspx">DownlevelGetStringScripts</A> functions in the past in relation to the <A class="" href="http://archives.miloush.net/michkap/archive/2005/08/20/454144.html" mce_href="http://archives.miloush.net/michkap/archive/2005/08/20/454144.html"><STRONG>Mitigation tools for IDN security problems</STRONG></A>. But that isn't about the <A class="" href="http://www.microsoft.com/globaldev/reference/cphome.mspx" mce_href="http://www.microsoft.com/globaldev/reference/cphome.mspx">Code Pages supported by Windows</A>,&nbsp;or strictly speaking the <A class="" href="http://msdn.microsoft.com/library/ms776439.aspx" mce_href="http://msdn.microsoft.com/library/ms776439.aspx">Unicode Subset Bitfields</A>, either.</P>
<P>Thus the apples vs. earmuffs contrast. :-)</P>
<P>In the middle&nbsp;of Dmitry's note, one line in particular caught my eye:</P>
<BLOCKQUOTE>
<P><EM><FONT face="times new roman,times">Even more, the string may contain chars from different codepages.</FONT></EM></P></BLOCKQUOTE>
<P mce_keep="true">Too true, that! But that is an argument in favor of the fact that <A class="" href="http://archives.miloush.net/michkap/archive/2005/03/01/382289.html" mce_href="http://archives.miloush.net/michkap/archive/2005/03/01/382289.html"><STRONG>code pages are really not enough</STRONG></A> -- Unicode is actually doing just fine here!</P>
<P mce_keep="true">&nbsp;</P>
<P mce_keep="true"><FONT color=#ff00ff><EM>This blog brought to you by</EM><FONT size=5> Α </FONT><EM>(<A class="" href="http://www.fileformat.info/info/unicode/char/0391" mce_href="http://www.fileformat.info/info/unicode/char/0391">U+0391</A>, aka GREEK CAPITAL LETTER ALPHA, a letter of&nbsp;several code pages)</EM></FONT></P>
<hr/><p><strong>Michael S. Kaplan</strong> on 30 Apr 2008 4:42 PM:</p><div style="margin-left: 1em"><p>For the curious, the end of the title is Hebrew for &quot;my friend&quot; and is pronounced chah-vear shell-ee (חבר שלי). So I have that same sound throughout the title with the items ending with that &quot;ee&quot; sound. :-)</p>
</div>
<hr/><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2008/05/01/8446346.html" title="The font folder, like the party, never seems to get smaller">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2008/04/30/8440308.html" title="Unicode -- making a difference">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2008-04">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2008-04-30">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2008/04/30/8440675.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:36 GMT -->
</html>