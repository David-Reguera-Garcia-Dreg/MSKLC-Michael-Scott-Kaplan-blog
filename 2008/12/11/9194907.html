<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2008/12/11/9194907.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:35 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>On why it's a bad thing to choose font information by name only</title></head><body>
<h1>On why it's a bad thing to choose font information by name only</h1>
<p><em>by Michael S. Kaplan, published on 2008/12/11 10:01 -05:00, original URI: http://blogs.msdn.com/b/michkap/archive/2008/12/11/9194907.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<p>Looking back at the my blog <b><a href="http://archives.miloush.net/michkap/archive/2008/10/28/9020410.html" mce_href="http://archives.miloush.net/michkap/archive/2008/10/28/9020410.html">Ready... set... Reboot Redux, part Deux!</a></b>, in order tp get the link to help answer someone's question, I realized something very important.</p><p>That blog does not give the solution, it really only states the problem.</p><p>A problem that, while MUI becomes more and more popular at the same time that it's user interface language can remain so easily out of sync with the default system locale, that localizations can find themselves quite easily broken.</p><p>But I did not talk about solutions, or even more directly about the nature of the exact problem that a developer needs to be looking at to be in the frame of mind to think about solutions.</p><p>Today that is what I am going to do. :-)</p><p>Now there are two common reasons that the problem can be happening in an application that a developer might believe to be quite <b><a href="http://archives.miloush.net/michkap/archive/2005/09/09/462862.html" mce_href="http://archives.miloush.net/michkap/archive/2005/09/09/462862.html">localizable</a></b>:<br></p><ul><li>The application might have the font name and size in a string table, with font attributes either included in the name string by default (eg <b>Tahoma Bold</b>)&nbsp; added by the localizer later (eg <b>Tahoma Gras</b>);</li><li>The application might have the font name and size in a DIALOG or DIALOGEX resource, again with font attributes either included in the name string by default (eg <b>Tahoma Bold</b>)&nbsp; added by the localizer later (eg <b>Tahoma Gras</b>).</li></ul><p>Now the core issue here in both cases is that the attribute has to be kept out of the name.</p><p><i>This all applies to italics as well, but that is a single Boolean parameter (<a href="http://msdn.microsoft.com/library/ms533931.aspx" mce_href="http://msdn.microsoft.com/library/ms533931.aspx">LOGFONT</a>.lfItalic), so it easier to store elsewhere if it it needs to be exposed, which it usually doesn't...</i> </p><p>When the name is in a string table, all you really have is the name -- the attribute is most often not stored in a string table as anything but a string with the name. </p><p>To make that first case localizable, you have to store the <a href="http://msdn.microsoft.com/library/ms533931.aspx" mce_href="http://msdn.microsoft.com/library/ms533931.aspx">LOGFONT</a>.lfWeight value there too -- 700 (FW_BOLD) or 800 (FW_ULTRABOLD), generally, if you want it to be bold.</p><p>And of course make siure there is a comment for the localizer to understand what the numbers are -- because that is very unwieldy and hard to understand, otherwise.</p><p>Of course by the time you add four strings to a string table (the face name, the size, the weight, and whether it was italic, you may wish you had put the information in a resource directly.</p><p>Which brings us to the other option.</p><p>If you have the face name in a DIALOG resource, then get it the hell out of there. The FONT keyword in a <a href="http://msdn.microsoft.com/library/aa381003.aspx" mce_href="http://msdn.microsoft.com/library/aa381003.aspx">DIALOG resource</a> only exposes the size and the name. So it leaves you back where you started. Use a DIALOGEX resource instead.</p><p>And then if you are using a <a href="http://msdn.microsoft.com/library/aa381002.aspx" mce_href="http://msdn.microsoft.com/library/aa381002.aspx">DIALOGEX resource</a>, then you can specify the font name, size, weight, and italic settings explicitly in a way that is not subject to localization strangeness -- and all of which is nevertheless exposed to localizers.</p><p><i>In case you are wondering why you can't just do the bold/italic stuff yourself always and just not expose those attributes to localization, <b><a href="http://archives.miloush.net/michkap/archive/2006/08/22/708503.html" mce_href="http://archives.miloush.net/michkap/archive/2006/08/22/708503.html">this other blog</a></b> explains it -- these attributes should be localizable.</i></p><p>And there you go -- the solution for the problem that was previously described.</p><p>Localizability can be hard and the bugs an be subtle -- especially in cases like this where incorrect localizability work can cause the act of localization to break an application.... </p><p>&nbsp;</p><p><font><font color="#ff1493"><i>This post brought to you by</i><font size="7"> </font><font size="7"><b>à²¬</b> </font><i>(<a href="http://www.fileformat.info/info/unicode/char/0cac">U+0cac</a>, KANNADA 
LETTER BA)</i></font></font></p>
<hr/><p><a id="9218115" href="#9218115">#</a> <strong>Pavanaja U B</strong> on 15 Dec 2008 12:07 AM:</p><div style="margin-left: 1em"><p>In Word 2003 and prior, there was an option "not to display the font name in that font". This was very useful while using hacked non-English TTF fonts which were using the ASCII codes meant for English for chars/glyphs other than English. This featture is not found in Word 2007. Is there some way to do that in Word 2007?</p>
<p>TIA.</p>
<p>-Pavanaja</p></div>
<p><a id="9220191" href="#9220191">#</a> <strong>Michael S. Kaplan</strong> on 15 Dec 2008 6:35 AM:</p><div style="margin-left: 1em"><p>This sounds like one for the Suggestion Box? ;-)</p>
</div>
<hr/><p><em>referenced by</em></p><div style="margin-left: 1em"><p>2011/05/26 <a href="http://archives.miloush.net/michkap/archive/2011/05/26/10167955.html">To True Boldly Go Where No Font...(yada yada yada)</a></p></div><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2008/12/12/9202471.html" title="From I SCOOT to IBOT, #9 of ??: You&#39;re not stoned if you see me in Seattle at a 50 degree or a 130 degree angle">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2008/12/11/9193846.html" title="Bunny? He&#39;s no bunny. He&#39;s a goddamn RABBIT!">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2008-12">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2008-12-11">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2008/12/11/9194907.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:35 GMT -->
</html>