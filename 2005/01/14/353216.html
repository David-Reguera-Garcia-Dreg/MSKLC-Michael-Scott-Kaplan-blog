<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2005/01/14/353216.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:42 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>Calendars on Win32 -- just there for show....</title></head><body>
<h1>Calendars on Win32 -- just there for show....</h1>
<p><em>by Michael S. Kaplan, published on 2005/01/14 14:32 -05:00, original URI: http://blogs.msdn.com/b/michkap/archive/2005/01/14/353216.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<P>Obviously to some, claiming that calendars are just there for show may be a grating&nbsp;overstatement. But if you think about it, there are only four major purposes for the OS to support calendars:</P>
<P>1) Feed data for date formatting APIs so that dates that use a calendar can be properly formatted.</P>
<P>2) Provide data for the calendar itself so you could actually build a calendar if you wanted to.</P>
<P>3) Provide parsing capabilities so that you can take a formatted date string in a calendar and get the original date back for use in code.</P>
<P>4) Allow conversion so that dates that are in one calendar can be converted to another.</P>
<P>It is fairly obvious that if you have #1 and #3 then you have #4 anyway (since if you could format using any calendar and parse the string to get the date back, you can obviously "convert" between any of them. So you can think of these as user scenarios more than discrete features.</P>
<P>But the reason that I claim that calendars in Win32 are "just there for show" is that showing stuff us all you can really do with them. Only #1 and #2 are supported! To add insult to injury, even those two operations&nbsp;work for calendars that are supported within the context of the current user locale.</P>
<P>There is no support for either parsing or conversion. So make sure that the formatting operation is the last operation you do with a date before displaying it, since it is really the last thing you can do.</P>
<P>Side note: In fact, we found a synchronization bug in our code a few years back,&nbsp;related to constant user locale/calendar changing.&nbsp;It was reported by&nbsp;the Outlook team, who would be continuously changing the user locale to get calendar information from the NLS APIs for their "second calendar" functionality. It was kind of funny that we told them that they were misusing our functionality and they had to patiently tell to us that it was only to work around our functionality limitations. Oops!</P>
<P>There are other limitations to calendars&nbsp;on Win32, and there are&nbsp;of course the calendars on the .NET Framework that have a slightly better story, and I will talk about both items another time....</P>
<P>&nbsp;</P>
<P><FONT color=#800080><EM>This post brought to you by </EM>"€ù"<EM> (<A href="http://www.fileformat.info/info/unicode/char/06dd/index.htm">U+06dd</A>, ARABIC END OF AYAH)</EM></FONT></P>
<hr/><p><a id="354024" href="#354024">#</a> <strong>Douglas Husemann</strong> on 16 Jan 2005 10:44 AM:</p><div style="margin-left: 1em">Finally an advocate on the inside for this weekness within the OS. ??<br><br>One of my favorite pass times is Genealogy. In very short order I run into the issue that.<br><br>1.)the lack of support for more than one calendar on the system at the same time. <br><br>2.)the lack of localization on documents. (for example. words insistance of suggesting October when working on a German documetn Oktober)<br><br>Personally I work in 3 different recent calendars on a daily basis.<br><br>Gregorian of course. Julian <a title="Calendar" href="http://msdn.microsoft.com/library/en-us/cpref/html/frlrfsystemglobalizationcalendarclasstopic.asp" target="_blank">Calendar</a> (with Russian months) and the French Revolutionary.<br><br>I have been told that LH still won't have support for multiple calendars which would be a shame. I even recommended a side by side format (called a historical date mapping) that allowed for a common date with a decent api that would allow for conversion.  (of course that was related to the weekness that would come with WinFS and for show calendar system in the NT OS as it is now) <br><br>I do look forward to what you have to say. and yes .net does a little to help but needs to go much much further. <br><br>douglas</div>
<p><a id="354032" href="#354032">#</a> <strong>Michael Kaplan</strong> on 16 Jan 2005 11:05 AM:</p><div style="margin-left: 1em">Ah, Julian has separate problems for Windows, since in the Windows model calendars only work within the context of a locale (and AFAIK no one really uses the Julian calendar like that these days).<br><br>Same for the French revolutionary, but even moreso!<br><br>Calendars are in their own way much harder than keyboards (which have <a title="MSKLC" href="http://www.microsoft.com/globaldev/tools/msklc.mspx" target="_blank">MSKLC</a>) and locales/cultures (for which Whidbey will have custom cultures and Longhorn will have solutions). Because both of those technologies require only data. <br><br>Calendars, on the other hand, require data plus an algorithm -- which makes it a lot harder to build a model to support, especially given the current architectures (which a lot of both Windows and .NET depend on). Especially given the limitations that the current architetures have which I mentioned some of in these couple of posts!<br><br>I can promise you that people are thinking about the problem, but this particular stew is messy enough that it will take a long time to cook....</div>
<p><a id="354059" href="#354059">#</a> <strong>Douglas Husemann</strong> on 16 Jan 2005 12:28 PM:</p><div style="margin-left: 1em">I have talked to a few. and agree in some areas. <br><br>The context for calendars even get more sticky if you take into account Location awareness and account for the change in the calendar systems over history.<br><br>Julian calendars are used in Orthadox Religions even today. although the dates are usually transposed to the Gregorian calendar for political reasons.  Most of your Russian observation for christian Holidays are reflected in that for exxample. Christmas is Jan 7 I believe this year. The year 2000 was one of the years that the Julian calendar gained a day in leap year. <br><br>You only have to go back 80 some odd years and you do run into Julian calendars.<br><br>I guess the main need I have is this.<br><br>While in day to day life a Locale is an OK thing, I need the ability to override that Locale in the documents that I deal with on a daily basis.<br><br>I deal in sources that can come from anywhere in the world and as far back as 100 B.C. currently.  <br><br>It would be nice in a document store that it could be marked at a German Document in 1400's (unfortantly even the unicode standard hasn't fully encoded all the germanic charicars to accomedate that) but one can always hope.<br><br>I believe if MS put out a Real Genealogy program based on the needs of research and document storage over the last 2000 years most of those issues would have a way to get fixed.:) (I was starting with WinFS to look at that problem but unfortanly will have to wait a bit longer:(<br><br><br>thanks douglas</div>
<p><a id="354066" href="#354066">#</a> <strong>Michael Kaplan</strong> on 16 Jan 2005 12:53 PM:</p><div style="margin-left: 1em">There is definitely a real scenario here, and I think people recognize that -- but it will take some serious thinking to decide what to do here (it is worth noting that the current model was based on sober thought about the specific scenarios in question, rather than some of the other scenarios to support in the future!).<br><br>Hang in there, though -- it would be unfortunate to work with data going back hundreds (even thousands) of years, yet worry about a few years for the proper representation and support!<br><br>:-)</div>
<hr/><p><em>referenced by</em></p><div style="margin-left: 1em"><p>2010/03/31 <a href="http://archives.miloush.net/michkap/archive/2010/03/31/9986458.html">OS level support for non-Gregorian calendars?</a></p><p>2010/02/22 <a href="http://archives.miloush.net/michkap/archive/2010/02/22/9967111.html">Will someone take up the job of Calendar support in .Net, please?</a></p><p>2008/01/09 <a href="http://archives.miloush.net/michkap/archive/2008/01/09/7012965.html">Oh (Saka to me, Saka to me, Saka to me, Saka to me) Whoa Babe (Just a little bit) A little respect (just a little bit)</a></p><p>2007/12/17 <a href="http://archives.miloush.net/michkap/archive/2007/12/17/6779614.html">No good way to get one's Jalalis playing with calendars in Windows or .NET, really</a></p><p>2007/07/06 <a href="http://archives.miloush.net/michkap/archive/2007/07/06/3720057.html">Upgrading the rank of the people we talk about calendars with</a></p><p>2005/12/02 <a href="http://archives.miloush.net/michkap/archive/2005/12/02/498876.html">Calendars in other languages</a></p><p>2005/10/20 <a href="http://archives.miloush.net/michkap/archive/2005/10/20/482896.html">Behold the PersianCalendar class</a></p><p>2005/08/18 <a href="http://archives.miloush.net/michkap/archive/2005/08/18/453373.html">GetDateFormat is Gregorian based</a></p><p>2005/03/28 <a href="http://archives.miloush.net/michkap/archive/2005/03/28/402839.html">The WinForms DateTimePicker and MonthCalendar do not support culture settings</a></p><p>2005/02/23 <a href="http://archives.miloush.net/michkap/archive/2005/02/23/378804.html">Calendars.NET -- new platform, new issues</a></p></div><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2005/01/14/353347.html" title="Calendars on Win32 -- Not all there yet">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2005/01/14/352802.html" title="CharNext(ch) != ch+1, a lot of the time">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2005-01">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2005-01-14">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2005/01/14/353216.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:42 GMT -->
</html>