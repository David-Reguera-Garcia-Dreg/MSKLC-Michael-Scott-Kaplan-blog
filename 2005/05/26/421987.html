<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2005/05/26/421987.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:41 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>The last word on the FINAL SIGMA</title></head><body>
<h1>The last word on the FINAL SIGMA</h1>
<p><em>by Michael S. Kaplan, published on 2005/05/26 00:01 -07:00, original URI: http://blogs.msdn.com/michkap/archive/2005/05/26/421987.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostOld -->
<P><FONT face=Tahoma>Back in the beginning of April, I explained about the one scenario where <a href="http://archives.miloush.net/michkap/archive/2005/04/04/405174.html">casing does not need to roundtrip in .NET</A> -- the Greek final sigma.</FONT></P>
<P><FONT face=Tahoma>Anyway, the day before yesterday I got an email from someone who had been reading my blog and was looking at all of the one-way mappings that are in the linguistic tables (accessed with the LCMAP_LINGUISTIC_CASING flag, which I have discussed <a href="http://archives.miloush.net/michkap/archive/2004/12/11/279942.html">previously</A>). He was wondering why that FINAL SIGMA could not be put into the linguistic tables since it is a one-way mapping.</FONT></P>
<P><FONT face=Tahoma>A fair question, one I thought worthy of a post. :-)</FONT></P>
<P><FONT face=Tahoma>If you are a native speaker of Greek, then you know that both&nbsp;<STRONG>ς</STRONG> (<A href="http://www.fileformat.info/info/unicode/char/03c2/index.htm">U+03c2</A>, a.k.a. GREEK SMALL LETTER FINAL SIGMA) and <STRONG>σ</STRONG> (<A href="http://www.fileformat.info/info/unicode/char/03c3/index.htm">U+03c3</A>, a.k.a. GREEK SMALL LETTER SIGMA) do indeed uppercase to <STRONG>Σ</STRONG> (<A href="http://www.fileformat.info/info/unicode/char/03a3/index.htm">U+03a3</A>, a.k.a. GREEK CAPITAL LETTER SIGMA). But if we added this character to the linguistic table, then it suddenly&nbsp;<STRONG>ς</STRONG> would never work in the <A href="http://msdn.microsoft.com/library/en-us/winui/winui/windowsuserinterface/resources/strings/stringreference/stringfunctions/charupper.asp">CharUpper</A>/<A href="http://msdn.microsoft.com/library/en-us/winui/winui/windowsuserinterface/resources/strings/stringreference/stringfunctions/charupperbuff.asp">CharUpperBuff</A> functions and would not work in the default call to LCMapString with the <A href="http://msdn.microsoft.com/library/en-us/intl/nls_5s2v.asp">LCMapString</A> function with the LCMAP_UPPERCASE flag.</FONT></P>
<P><FONT face=Tahoma>Obviously that would not be a good thing.</FONT></P>
<P><FONT face=Tahoma>Try to imagine how you would feel if attempting to uppercase the string&nbsp;<STRONG>hello</STRONG>&nbsp;would come out as <STRONG>HELLo</STRONG>. Wouldn't you consider it a bug? Especially is it used to come out with the <STRONG>HELLO</STRONG> you were expecting? You might be thinking about telling the platform <STRONG>GooDBYE</STRONG>, if you know what I mean.</FONT></P>
<P><FONT face=Tahoma>Of course ideally the functions would notice whether the <STRONG>Σ</STRONG>&nbsp;was at the end of a word and then decide whether to use&nbsp;<STRONG>ς</STRONG> or <STRONG>σ</STRONG>, depending. But LCMapString does not really look beyond the character level here, so until it does that would not really be an option. </FONT></P>
<P><FONT face=Tahoma>Though of course a more sophisticated application might work to provide results beyond the character boundary. Though I do not envy such programs; the boundary for them becomes quite fuzzy if you have non-Greek characters after the <STRONG>ς</STRONG>. Does that count as a new word or doesn't it? That is the kind of question where an API can never win -- no matter which way it goes, there will be some people who do not like the answer.</FONT></P>
<P><FONT face=Tahoma>Anyway, that is why <STRONG>ς</STRONG>&nbsp;is not uppercased only in the linguistic table. Because there are too many cases where the results simply don't make sense, at least not as things are implemented currently....</FONT></P>
<P><FONT face=Tahoma></FONT>&nbsp;</P>
<P><FONT face=Tahoma><FONT color=#ff0000><EM>This post brought to you by</EM>&nbsp;"ς" <EM>(<A href="http://www.fileformat.info/info/unicode/char/03c2/index.htm">U+03c2</A>, a.k.a. GREEK SMALL LETTER FINAL SIGMA)<BR><FONT size=1>A character that wonders whether Unicode would have been simpler if it did not exist as an independent entity, and fionts could then decide whether to make it a "final" form or not....</FONT></EM></FONT></FONT></P>
<hr/><p><a id="422216" href="#422216">#</a> <strong>Maurits</strong> on Thursday, May 26, 2005 1:42 PM:</p><div style="margin-left: 1em">I suppose English has the same problem with medial s's?</div>
<p><a id="422256" href="#422256">#</a> <strong>Michael S. Kaplan</strong> on Thursday, May 26, 2005 3:27 PM:</p><div style="margin-left: 1em">Well, we don't sort or case those differently...</div>
<p><a id="422272" href="#422272">#</a> <strong>Maurits</strong> on Thursday, May 26, 2005 3:53 PM:</p><div style="margin-left: 1em">Sorry, I meant &quot;ſ&quot;<br>LATIN SMALL LETTER LONG S<br><a rel="nofollow" target="_new" href="http://www.fileformat.info/info/unicode/char/017f/index.htm">http://www.fileformat.info/info/unicode/char/017f/index.htm</a><br><br>AKA &quot;medial s&quot;<br><br>Looks like Greek and German both have problems with multiple &quot;s&quot;-es - luckily English abandoned the long s prior to computers becoming popular.</div>
<p><a id="422275" href="#422275">#</a> <strong>Michael S. Kaplan</strong> on Thursday, May 26, 2005 3:59 PM:</p><div style="margin-left: 1em">Ah yes, *that* character.<br><br>In Windows today, we do not case it at all. In Windows tomorrow there are interesting conversations about whether to put it into the linguistic table or not. Admittedly these conversations have more heat and less light, but we are working toward a conclusion....</div>
<p><a id="422300" href="#422300">#</a> <strong>Maurits</strong> on Thursday, May 26, 2005 5:10 PM:</p><div style="margin-left: 1em">From a mathematical point of view (if I may...)<br>Define U to be the ToUpper operator.<br>Define L to be the ToLower operator.<br><br>The naive expectation of a typical user is that UL and LU will be the identity operator.  As far as I can make out, this is unfixably broken (or at least made much more difficult) by such things as ligatures and medial forms.  So I find it reasonable to expect that UL != LU for these problem characters.<br><br>However, I would like to count on U == ULU for everything... and L == LUL for everything.  In other words, though U and L are not strictly inverses, it would be nice if they were at least stable.<br><br>In particular, I would like to see L(U(&quot;ſ&quot;)) = &quot;s&quot;, and L(U(&quot;&#223;&quot;)) = &quot;ss&quot; - or perhaps &quot;sz&quot;.  I suppose I'm asking for a way to escape the problem cases by pushing things through a s.LowerCase().UpperCase() operator...<br><br>Is this sensible?</div>
<p><a id="422306" href="#422306">#</a> <strong>Michael S. Kaplan</strong> on Thursday, May 26, 2005 5:18 PM:</p><div style="margin-left: 1em">Well, I won't say your expectations are not sensible. But they do not match the current behavior, which does only imple Unicode casing with no extra context rules.</div>
<p><a id="422307" href="#422307">#</a> <strong>Michael S. Kaplan</strong> on Thursday, May 26, 2005 5:19 PM:</p><div style="margin-left: 1em">Replace imple with simple. :-)</div>
<p><a id="422313" href="#422313">#</a> <strong>Michael S. Kaplan</strong> on Thursday, May 26, 2005 5:33 PM:</p><div style="margin-left: 1em">Oh, I do slightly disagree that a user who is sophisticated enough to call an API is one who we would class as &quot;naive&quot; :-)</div>
<p><a id="422343" href="#422343">#</a> <strong>Maurits</strong> on Thursday, May 26, 2005 7:26 PM:</p><div style="margin-left: 1em">I think we're at cross purposes over the term &quot;user&quot;.<br><br>I meant &quot;user&quot; as in someone who:<br>* Installs an application I write<br>* Puts text in a box<br>* Chooses Format | Case | UPPERCASE<br>* Thinks &quot;Hmmm, no, I don't like that&quot;<br>* Chooses Format | Case | lowercase<br>* Thinks &quot;Hey, what happened to my capital D in Donald&quot; or &quot;Hey, what happened to my &#223; in stra&#223;e&quot; or ...<br>* Immediately calls me to inform me that my application corrupted their data<br><br>I probably shouldn't have used the word &quot;user&quot; - as an API writer, you probably hear &quot;user&quot; and think &quot;application developer.&quot;  I meant to say &quot;end user&quot;. :)</div>
<p><a id="422349" href="#422349">#</a> <strong>Michael S. Kaplan</strong> on Thursday, May 26, 2005 7:45 PM:</p><div style="margin-left: 1em">Unfortunately, the answer is the same there -- the API does not handle either of those cases. Certainly we have no way of supporting proper casing anyway, but we do not currently handle strings that would increase the size of the buffer....<br><br>If you need support like that, you have to build it yourself -- we are very low tech here. :-)</div>
<p><a id="422706" href="#422706">#</a> <strong>Maurits</strong> on Friday, May 27, 2005 4:41 PM:</p><div style="margin-left: 1em">On this capitalization note, I'd like you to know that I've created an Evil Small-Caps Test for browsers:<br><a rel="nofollow" target="_new" href="http://www.geocities.com/mvaneerde/small-caps.html">http://www.geocities.com/mvaneerde/small-caps.html</a><br>(The &quot;evil&quot; is a nod to Ian Hickson's &quot;evil&quot; CSS test)</div>
<hr/><p><em>referenced by</em></p><div style="margin-left: 1em"><p>2009/07/30 <a href="http://archives.miloush.net/michkap/archive/2009/07/30/9853370.html">I know I'll Never say Never... again, at least</a></p><p>2008/06/25 <a href="http://archives.miloush.net/michkap/archive/2008/06/25/8652525.html">Seeing the tears, my heart went out to her as I asked her "Why the Long S?"</a></p><p>2007/09/14 <a href="http://archives.miloush.net/michkap/archive/2007/09/14/4900107.html">How do I feel about lstrcmpi? I think it blows....</a></p><p>2007/06/12 <a href="http://archives.miloush.net/michkap/archive/2007/06/12/3251648.html">The difference between 'Dangeous Characters' and 'Dangerous Minds' is the lack of Michelle Pfeiffer</a></p><p>2005/06/24 <a href="http://archives.miloush.net/michkap/archive/2005/06/24/432121.html">LCMapString's *other* job</a></p></div><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2005/05/27/422458.html" title="What isn&#39;t in the default install for NLS">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2005/05/25/421828.html" title="You may want to rethink your choice of UTF, #3 (Platform?)">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2005-05">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2005-05-26">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2005/05/26/421987.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:41 GMT -->
</html>