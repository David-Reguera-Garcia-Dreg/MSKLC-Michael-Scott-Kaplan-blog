<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2005/05/02/413880.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:41 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>Virtual PC needs international thought about its keyboard support</title></head><body>
<h1>Virtual PC needs international thought about its keyboard support</h1>
<p><em>by Michael S. Kaplan, published on 2005/05/02 00:01 -07:00, original URI: http://blogs.msdn.com/michkap/archive/2005/05/02/413880.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostOld -->
<P><FONT face=Tahoma>I will start by saying that Virtual PC 2004 rocks. It truly does.</FONT></P>
<P><FONT face=Tahoma>I spent a bunch of time yesterday building interesting Virtual Machines based on my simple Windows 2000, XP, and Server 2003 VMs that I keep around and the fact that it really rocks as a product was never to far from my mind.</FONT></P>
<P><FONT face=Tahoma>Well, until I was&nbsp;chaging the default keyboard layouts&nbsp;of the guest machines in the VMs and my host machine for some demos I will be using them for. As a product, Virtual&nbsp;PC did fall a tiny little bit in my otherwise high opinion of it....</FONT></P>
<P><FONT face=Tahoma>To start with, it is not so great with its default behavior used to switch out of the guest machine and move to the host machine -- it uses the Right Alt key. This has two problems, one not really international and one really so:</FONT></P>
<OL>
<LI><FONT face=Tahoma>Not all keyboards <STRONG>have</STRONG> a Right Alt key; there are many laptops, for example, that do not (I admit that they themselves kind of stink internationally for reason #2!).</FONT> 
<LI><FONT face=Tahoma>Almost every language keyboard used in Europe and India and several keyboards used other places need that key to sensibly reach the <a href="http://archives.miloush.net/michkap/archive/2004/12/28/333168.html">AltGR shift state</A>.</FONT></LI></OL>
<P><FONT face=Tahoma>Take for example the German keyboard layout's base and AltGR shift states (cribbed screen shots of the GlobalDev <A href="http://www.microsoft.com/globaldev/reference/keyboards.aspx">Windows keyboard layouts</A> page:</FONT></P>
<P><IMG src="http://trigeminal.fmsinc.com/images/GermanBase.jpg">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <IMG height=179 src="http://trigeminal.fmsinc.com/images/GermanAltGr.jpg" width=357></P>
<P><FONT face=Tahoma color=#ff0000><EM><STRONG>By the way, who thinks GlobalDev ought to have an RSS feed? I do! Russ, are you reading this post? :-)</STRONG></EM></FONT></P>
<P><FONT face=Tahoma>Now generally, the&nbsp;keyboard does not have a good way to get to the AltGR functionality without that key (Ctrl+Alt is unwieldy for ordinary typing). German is a minor example, with a mere twelve assigned keystrokes (though someone who wanted to type a&nbsp;Euro sign might take exception at calling it a "mere" anything!), some of those other keyboards have many more assigned, and a few even have Shift+AltGR assignments as well.</FONT></P>
<P><FONT face=Tahoma>Now of course there is a way to change the keystroke assignment here&nbsp;(item #9 in the <STRONG>Keyboard functionality, troubleshooting</STRONG> topic):</FONT></P>
<BLOCKQUOTE dir=ltr>
<P dir=ltr><FONT face=Tahoma color=#000000><U><STRONG>When the right ALT key is configured to be the host key, navigating through menus using only the keyboard does not work.</STRONG></U></FONT></P>
<BLOCKQUOTE dir=ltr>
<P class=expand><FONT face=Tahoma><B>Cause:&nbsp;&nbsp;</B>On some keyboards, when the host key is the right ALT key, the Host key + ALT + menu accelerator does not work to access menus.</FONT></P>
<P class=expand><FONT face=Tahoma><B>Solution:</B>&nbsp;&nbsp;You must change the host key to be something other than ALT or CTRL. For more information see, </FONT><FONT face=Tahoma><EM>To change the host key used for Virtual&nbsp;PC</EM></FONT><FONT face=Tahoma>.</FONT></P></BLOCKQUOTE></BLOCKQUOTE>
<P class=expand><FONT face=Tahoma>And then <EM>that</EM> topic has the actual instructions:</FONT></P><FONT face=Tahoma>
<BLOCKQUOTE dir=ltr>
<P class=proclabel><U><STRONG>To change the host key used for Virtual&nbsp;PC</STRONG></U></P>
<BLOCKQUOTE>
<OL>
<LI>Open <B>Virtual&nbsp;PC Console</B>. 
<LI>On the <B>File</B> menu, click <B>Options</B>. 
<LI>Click <B>Keyboard</B>. 
<LI>In the <B>Current host key</B> box, click the key name to select it, and then, on the keyboard, press the key that you want to use as the host key. 
<P>The name of the new host key is displayed in the <B>Current host key</B> box.</P></LI></OL>
<P class=note><IMG class=alert src="http://archives.miloush.net/michkap/archive/2005/05/02/ms-its:c:/program files/microsoft virtual pc/documentation/english/VPC.chm::/note.gif"> Notes</P>
<UL>
<LI>To open <B>Virtual&nbsp;PC Console</B>, on the host operating system, click <B>Start</B>, point to <B>All Programs</B> or <B>Programs</B>, and then click <B>Microsoft Virtual&nbsp;PC</B>. 
<LI>The host key is used for several functions, including mouse control and providing CTRL key functionality in menu shortcuts. </LI></UL></BLOCKQUOTE></BLOCKQUOTE></FONT>
<P class=expand><FONT face=Tahoma>Now we will ignore the tortuous nature of the instructions for a moment. Let us remember for a moment&nbsp;that up to 60% of Microsoft's market is outside of the US and that 70-100% of that majority do not want to use English a significant percentage of the time (numbers that will only get worse for English as products like&nbsp;<A href="http://www.microsoft.com/globaldev/tools/msklc.mspx">MSKLC</A>, <a href="http://archives.miloush.net/michkap/archive/2005/01/26/360685.html">ELKs</A>, <a href="http://archives.miloush.net/michkap/archive/2005/02/10/370460.html">LIPs</A>, and <A href="http://www.microsoft.com/presspass/press/2004/aug04/08-11WinXPStarterPilotPR.asp">XP Starter Edition</A>&nbsp;help to further expand the ability of people to read and write in their native language. In such an environment, is using the Right Alt key as a default setting here&nbsp;when large parts of the market for Microsoft products (most or all of which do not have a localized versions of Virtual PC 2004!) a smart choice?</FONT></P>
<P class=expand><FONT face=Tahoma>I just checked, there is not an International&nbsp;English version of it, at present. I do see a note in a <A href="http://www.microsoft.com/windowsserversystem/virtualserver/evaluation/trial/evalkitfaq.mspx">Virtual Server 2005 Evaluation&nbsp;FAQ</A> about this:</FONT></P>
<BLOCKQUOTE dir=ltr>
<P><FONT face=Tahoma><STRONG>Q. Is the Virtual Server 2005 Evaluation Kit available in languages other than English?</STRONG></FONT></P>
<P><FONT face=Tahoma>A. Localized versions of the Evaluation Kit may be available in some locales. We will release information about non-English versions of the Kit as it becomes available. However, until then, you are welcome to order the English-language version through this site.</FONT></P></BLOCKQUOTE>
<P class=expand><FONT face=Tahoma>There is also a note in the <A href="http://www.microsoft.com/windowsserversystem/virtualserver/evaluation/virtualizationfaq.mspx">Virtual Server 2005 FAQ</A> about this:</FONT></P>
<BLOCKQUOTE dir=ltr>
<P class=expand><FONT face=Tahoma><STRONG>Q. Will localized versions of Virtual Server 2005 be made available? </STRONG></FONT></P>
<P class=expand><FONT face=Tahoma>A. Virtual Server 2005 will be available in English and Japanese.&nbsp; </FONT></P></BLOCKQUOTE>
<P class=expand><FONT face=Tahoma>And it is true -- there is a localized Japanese version of Virtual Server 2005 (though not of Virtual PC 2004). Japanese thankfully does not have most of these problems though I believe I have seen a few Japanese laptops over the last few years that (hard pressed to fit the Hiragana/Katakana, English/Japanese, and Fullwidth/Halfwidth buttons) did not have a Right Alt key? :-)</FONT></P>
<P class=expand><FONT face=Tahoma>Beyond having a better default being chosen, some work to try to detect the situation (on either end) and offer other options, such as altering the setting. Maybe allowing a shifted keystroke would also be a helpful option (currently you can only pick any one key). There are a lot of things that could be done here to make the situation better for the English version if additional localized versions are not planned, or in all versions if they are.</FONT></P>
<P class=expand><FONT face=Tahoma>....</FONT></P>
<P class=expand><FONT face=Tahoma>The other problem that comes up is the potential difference in layouts between the host and guest machine, and dealing with that difference in a way that is as intuitive as possible for users. This is of course a problem that Terminal Services has long had to deal with, and is not an easy one, either in the logon screen where options are admittedly more limited or once one is logged on, where they could potentially have interesting solutions they could architect. </FONT></P>
<P class=expand><FONT face=Tahoma>But the Virtual PC solution is not the most original or intuitive of possible options. It is in item #7 in the <STRONG>Keyboard functionality, troubleshooting</STRONG> topic:</FONT></P>
<BLOCKQUOTE dir=ltr>
<P class=expand><FONT face=Tahoma color=#000000><STRONG><U>My keyboard supports multiple languages but certain characters are not working in a virtual machine.</U></STRONG></FONT></P>
<BLOCKQUOTE dir=ltr>
<DIV class=expand>
<P><FONT face=Tahoma><B>Cause:&nbsp;&nbsp;</B>The guest operating system must be configured to support the language that contains the characters you want to use.</FONT></P>
<P><FONT face=Tahoma><B>Solution:</B>&nbsp;&nbsp;Refer to the documentation for the guest operating system to configure support for the language you want to use.</FONT></P></DIV></BLOCKQUOTE></BLOCKQUOTE>
<P class=expand><FONT face=Tahoma>Yikes! I guess that is a solution. But I can't help wondering if more could be done here. Now obviously Virtual PC is casting a much wider net than Terminal Services (I am sure we will see clients for Linux long before we&nbsp;would see servers!) but it seems like there might be some things that could be done if it is running a Windows OS, couldn't there be? Or maybe an explanation that there could not and more help on how to deal with the problem then one semi-hidden help question in an FAQ. :-(</FONT></P>
<P class=expand><FONT face=Tahoma>Now I will keep on using Virtual PC, because frankly it still&nbsp;does rock, and a lot of the above can be explained by the fact that it is a product that Microsoft first picked up through acquiring another company, and perhaps future versions will work harder to help solve the issues now that the company that owns the product does have that larger focus.</FONT></P>
<P class=expand><FONT face=Tahoma>But it definitely has some work to do in its next major version on the international front. :-)</FONT></P>
<P class=expand><FONT face=Tahoma>And in the meantime it can serve to help application developers out there think hard about what they do with keyboard issues in their own applications, to avoid similar issues of greater or lesser scale....</FONT></P>
<P class=expand><FONT face=Tahoma></FONT>&nbsp;</P>
<P class=expand><FONT face=Tahoma><FONT color=#ff0000><EM>This post is brought to you by</EM> "V" <EM>(<A href="http://www.fileformat.info/info/unicode/char/0056/index.htm">U+0056</A>, a.k.a. LATIN CAPITAL LETTER V)</EM></FONT></FONT></P>
<hr/><p><a id="413912" href="#413912">#</a> <strong>bahes$</strong> on Monday, May 02, 2005 3:32 AM:</p><div style="margin-left: 1em">It does rock because it is simpler than any other VM. But it is not on Wmware level at all... I had memory problems throught test period and switched back to Wmware. Every time I started it VPC bugged me about lack of memory...strange problem even thought I have 512 Mb of RAM.<br>I hope VPC will get better :)</div>
<p><a id="413915" href="#413915">#</a> <strong>MOO</strong> on Monday, May 02, 2005 3:55 AM:</p><div style="margin-left: 1em">VMWare is the only real option for virtualisation. VPC is a toy.</div>
<p><a id="413929" href="#413929">#</a> <strong>Michael S. Kaplan</strong> on Monday, May 02, 2005 8:17 AM:</p><div style="margin-left: 1em">And how does VMWare handle the situation discussed in this artcle? Is it better, or worse?</div>
<p><a id="413932" href="#413932">#</a> <strong>Kiliman</strong> on Monday, May 02, 2005 8:42 AM:</p><div style="margin-left: 1em">I haven't used international features in VMWare and I have to admit, that I've never used VPC, so maybe I'm not the best person to respond to your question.<br><br>However, with VMWare, once you install the VMWare tools in the guest OS, you can switch in and out of guest/host just by moving the mouse. If the mouse is in the guest window, then it has control. All keystrokes (except for Ctrl+Alt+Del) go to the guest OS. Move the mouse out of the window, and host has control.<br><br>I'm not sure if VPC has a similar feature.<br><br>Kiliman</div>
<p><a id="413950" href="#413950">#</a> <strong>Michael Kohne</strong> on Monday, May 02, 2005 10:03 AM:</p><div style="margin-left: 1em">I'd rather they not get TOO clever. I think this product is one where MS shouldn't implement something that 'just works' to deal with the difference between host and virtual system - as a developer, I think I'd want to be able to be able to get into some wierd situations using this thing, and if you make it 'just work', you will likely take away some of the power.<br><br>Just a thought.</div>
<p><a id="413963" href="#413963">#</a> <strong>Michael S. Kaplan</strong> on Monday, May 02, 2005 10:34 AM:</p><div style="margin-left: 1em">Well, I do agree with *that* -- no matter what they would do, there are three things that any feature would need: <br><br>1) The ability to configure what they are doing. <br>2) A way to send feedback on usage scenarios they might have missed <br>3) A WAY TO TURN IT OFF! <br><br>But as long as they have at least #3, then I would fully support them being as clever as they like here. <br><br>Its like FrontPage -- they used to kind suck in my opinion. But once they added a &quot;don't screw with my HTML&quot; setting, they were much cooler. :-)</div>
<p><a id="413965" href="#413965">#</a> <strong>Heath Stewart</strong> on Monday, May 02, 2005 10:47 AM:</p><div style="margin-left: 1em">Did you consider throwing on host integration so you don't even have to worry about the Right Alt key? I think it has more ups than downs - just make sure you know where your mouse is before performing some action.<br><br>VPC does rock, though - that's for certain! I love the ability to set up a pristine install, copy the VHD file (the &quot;hard drive&quot; for the uninitiated) and be able to &quot;wipe&quot; my machine at any time and just copy the backup VHD file.</div>
<p><a id="413972" href="#413972">#</a> <strong>Michael S. Kaplan</strong> on Monday, May 02, 2005 11:05 AM:</p><div style="margin-left: 1em">Well, I have a *lot* of different images, it would be a pain to do it on all of them. Though in fairness I would have mentioned it as a workaround if I had noticed it changed the behavior on the guest machines where I had installed it!<br><br>Or even better if those help topics had mentioned this fact. :-)<br><br>Cool tip in any case, thanks Heath!</div>
<p><a id="413979" href="#413979">#</a> <strong>VMWare memory hack</strong> on Monday, May 02, 2005 11:15 AM:</p><div style="margin-left: 1em">VMWare Workstation 5 does a memory hack to get more performance increases if you check the used memory, its 512 or whatever you set it to and its normal usage as to be expected BUT if you check the memory GRAPH, its much much less, what gives?<br><br>Whats the trick?  Whatever it is its sure increasing perf majorly.</div>
<p><a id="414104" href="#414104">#</a> <strong>Mihai</strong> on Monday, May 02, 2005 5:07 PM:</p><div style="margin-left: 1em">I add my vote for this one:<br>&quot;By the way, who thinks GlobalDev ought to have an RSS feed? I do! Russ, are you reading this post? :-)&quot;</div>
<p><a id="415643" href="#415643">#</a> <strong>Flavio</strong> on Monday, May 09, 2005 4:55 AM:</p><div style="margin-left: 1em">On Italian keyboards, you need the right Alt key to type @, #, [ and ], not to mention € of course. Not exactly a minor nuisance then.<br><br>By the way, VMware allows you to configure the key(s) used to get out of the VM as any combination of Ctrl, Shift and Alt. The default is Ctrl+Alt, but I prefer all three of them because Ctrl+Alt+F1 is useful to switch from X to a virtual console in Linux.</div>
<p><a id="422566" href="#422566">#</a> <strong>krishna</strong> on Friday, May 27, 2005 9:52 AM:</p><div style="margin-left: 1em">how do i make my alt gr key work like my alt key; i m using windows 2000 professional os</div>
<p><a id="422581" href="#422581">#</a> <strong>Michael S. Kaplan</strong> on Friday, May 27, 2005 10:33 AM:</p><div style="margin-left: 1em">Not really related, right?<br><br>You can't, unless you have a keyboard that does not define the shift state, like the US keyboard.</div>
<p><a id="5803727" href="#5803727">#</a> <strong>Pikku orava</strong> on Wednesday, October 31, 2007 4:09 PM:</p><div style="margin-left: 1em"><p>There is a work around:</p>
<p> Just use ASCII -kodes you get from number keys on the right side of keyboard. Example: chareacter &quot; \ &quot; comes from left Alt + 047.</p>
<p>I hope this helped. It helped me around the problem</p></div>
<p><a id="5803841" href="#5803841">#</a> <strong>Pikku orava</strong> on Wednesday, October 31, 2007 4:18 PM:</p><div style="margin-left: 1em"><p>oops, the right code for \ is Left Alt + 092</p></div>
<p><a id="8351891" href="#8351891">#</a> <strong>healthinfo</strong> on Wednesday, April 02, 2008 1:06 PM:</p><div style="margin-left: 1em"><P>Old post, still valid. Thanks, solved my trouble today, I couldn't connect to \\server\ since I couldn't type the char '\'.lol</P></div>
<hr/><p><em>referenced by</em></p><div style="margin-left: 1em"><p>2008/01/17 <a href="http://archives.miloush.net/michkap/archive/2008/01/17/7126999.html">Virtual PC + Word 2007 ≠ AltGr support?</a></p></div><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2005/05/03/414161.html" title="The Architect (apologies to &#39;The Matrix Reloaded&#39;)">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2005/05/01/413886.html" title="Some more Windows acronyms explained">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2005-05">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2005-05-02">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2005/05/02/413880.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:41 GMT -->
</html>