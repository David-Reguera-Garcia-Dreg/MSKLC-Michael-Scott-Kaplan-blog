<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2005/05/12/416761.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:41 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>Why doesn't GetDateFormat take a CALID?</title></head><body>
<h1>Why doesn't GetDateFormat take a CALID?</h1>
<p><em>by Michael S. Kaplan, published on 2005/05/12 03:21 -04:00, original URI: http://blogs.msdn.com/b/michkap/archive/2005/05/12/416761.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<P><FONT face=Tahoma><A href="http://www.meikel.com/">Meikel Weber</A> posted (in the suggestion box):</FONT></P>
<BLOCKQUOTE dir=ltr>
<P><FONT face=Tahoma size=2><EM>Hi, </EM></FONT></P>
<P><FONT face=Tahoma size=2><EM>Your article today reminds me of an old question. Why is there no "GetDateFormat" API that takes a CALID as parameter? </EM></FONT></P>
<P><FONT face=Tahoma size=2><EM>Thank you for this really cool blog!!!</EM></FONT></P></BLOCKQUOTE>
<P><FONT face=Tahoma>Well, thanks for the kind words. :-)</FONT></P>
<P><FONT face=Tahoma>Some questions are good. In my opinion, this question is excellent. Now r</FONT><FONT face=Tahoma>ather than letting Meikel and I share a private joke, I will explain....</FONT></P>
<P><FONT face=Tahoma>In the NLS API set, there is an <A href="http://msdn.microsoft.com/library/en-us/intl/nls_5ucz.asp">EnumDateFormats</A> function. However, this only allows you to look at the date formats for the currently selected calendar, so an <A href="http://msdn.microsoft.com/library/en-us/intl/nls_4h14.asp">EnumDateFormatsEx</A> function was added. This function will return the formats that apply to not only the default calendar but to all posible alternate calendars.</FONT></P>
<P><FONT face=Tahoma>And then to use the date formats, there is a <A href="http://msdn.microsoft.com/library/en-us/intl/nls_5w6s.asp">GetDateFormat</A>&nbsp;function, which like <A href="http://msdn.microsoft.com/library/en-us/intl/nls_5ucz.asp">EnumDateFormats</A>&nbsp;is very much centered on the currently selected calendar. Now there is some minor concession to the notion of alternatives, with a DATE_USE_ALT_CALENDAR flag. But there are many limitations to this flag, as the Platform SDK topic describes:</FONT></P>
<BLOCKQUOTE dir=ltr>
<P><FONT face=Tahoma size=2>If this flag is set, the function uses the default format for that alternate calendar, rather than using any user overrides. The user overrides will be used only in the event that there is no default format for the specified alternate calendar.</FONT></P></BLOCKQUOTE>
<P><FONT face=Tahoma>An then it goes on in remarks to give more advice on ways to do lots of work to figure things out:</FONT></P>
<BLOCKQUOTE dir=ltr>
<P><FONT face=Tahoma size=2>To obtain the default short and long date format without performing any actual formatting, use the <A href="http://msdn.microsoft.com/library/en-us/intl/nls_34rz.asp">GetLocaleInfo</A> function with the LOCALE_SSHORTDATE or LOCALE_SLONGDATE parameter. To get the date format for an alternate calendar, use <A href="http://msdn.microsoft.com/library/en-us/intl/nls_34rz.asp">GetLocaleInfo</A> with the LOCALE_IOPTIONALCALENDAR parameter. To get the date format for a particular calendar, use <A href="http://msdn.microsoft.com/library/en-us/intl/nls_3hf3.asp">GetCalendarInfo</A>. Also, to return all of the date formats for a particular calendar, you can use <A href="http://msdn.microsoft.com/library/en-us/intl/nls_4zn3.asp">EnumCalendarInfo</A><STRONG> </STRONG>or<STRONG> </STRONG><A href="http://msdn.microsoft.com/library/en-us/intl/nls_4h14.asp">EnumDateFormatsEx</A>.</FONT></P></BLOCKQUOTE>
<P><FONT face=Tahoma>If all of this sounds like apologetic posturing to try to avoid having to explain that there is no GetDateFormatEx function that takes a CALID parameter, then you have proven the truth in the concept behing Ronan Keating's new song (follow up to "<EM>You Say It Best When You Say Nothing&nbsp;At All</EM>"), tentatively entitled&nbsp;"<EM>NLS Says It Best When It Says Everything But</EM>". Congratulations!</FONT></P>
<P><FONT face=Tahoma>Obviously both <A href="http://msdn.microsoft.com/library/en-us/intl/nls_34rz.asp">GetLocaleInfo</A>/LOCALE_IOPTIONALCALENDAR and <A href="http://msdn.microsoft.com/library/en-us/intl/nls_5w6s.asp">GetDateFormat</A>/DATE_USE_ALT_CALENDAR are pretty incomplete as workarounds, since the latter&nbsp;has many limitations related to overrides and&nbsp;both assume that there is at most one alternate calendar (which is not always true). And the rest of the suggestions will work, but they do have a serious "do it yourself, some assembly required" factor. </FONT></P>
<P><FONT face=Tahoma>In a future post, maybe I could write one up that would do this sort of thing. :-)</FONT></P>
<P><FONT face=Tahoma>Incidentally, this fact has been noticed by lots of people both inside and outside of Microsoft, and assisting with the limitation is under consideration for future versions of Windows (to be triaged along with other issues in locale APIs).</FONT></P>
<P><FONT face=Tahoma>Again, excellent question!</FONT></P>
<P><FONT face=Tahoma></FONT>&nbsp;</P>
<P><FONT face=Tahoma><FONT color=#ff0000><EM>This post brought to you by</EM> "<FONT size=3>ิน</FONT>" <EM>(<A href="http://www.fileformat.info/info/unicode/char/0539/index.htm">U+0539</A>, ARMENIAN CAPITAL LETTER TO)</EM></FONT></FONT></P>
<hr/><p><a id="417398" href="#417398">#</a> <strong>Bill</strong> on 13 May 2005 9:58 PM:</p><div style="margin-left: 1em">I was wondering how to make GetDateFormat work with other calendars. Any chance of this problem getting fixed?</div>
<p><a id="417408" href="#417408">#</a> <strong>Michael S. Kaplan</strong> on 13 May 2005 11:00 PM:</p><div style="margin-left: 1em">Hi Bill!<br><br>Well, like I said, many people have noticed this lack before, both inside and outside of Microsoft. It is definitely on the list of things to consider in the future. At this point, there is no way to say when exactly that will be, though. But hang in there....</div>
<p><a id="417567" href="#417567">#</a> <strong>Qflash</strong> on 15 May 2005 2:39 AM:</p><div style="margin-left: 1em">RePost:<br><a rel="nofollow" target="_new" href="http://www.yeyan.cn/SoftwareEngineering/GetDateFormatCALID.aspx">http://www.yeyan.cn/SoftwareEngineering/GetDateFormatCALID.aspx</a></div>
<hr/><p><em>referenced by</em></p><div style="margin-left: 1em"><p>2006/10/15 <a href="http://archives.miloush.net/michkap/archive/2006/10/15/827944.html">Not everything you might want out of a GetDateFormatEx, but think of it as a fixer-upper</a></p></div><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2005/05/13/417060.html" title="What code page does MSLU convert with?">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2005/05/12/416735.html" title="Thinking beyond the BMP of Unicode">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2005-05">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2005-05-12">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2005/05/12/416761.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:41 GMT -->
</html>