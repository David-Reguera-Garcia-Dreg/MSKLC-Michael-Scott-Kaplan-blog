<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2005/05/28/422808.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:41 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>Time zones and locations and keyboards, oh my!</title></head><body>
<h1>Time zones and locations and keyboards, oh my!</h1>
<p><em>by Michael S. Kaplan, published on 2005/05/28 02:03 -04:00, original URI: http://blogs.msdn.com/b/michkap/archive/2005/05/28/422808.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<FONT face=Tahoma>
<P><FONT face=Tahoma>Yesterday, Manip post a rant about the fact that the three settings in the title of my post today are <a href="http://blogs.msdn.com/larryosterman/archive/2005/05/27/422583.aspx#422663">not integrated well</A> (in response to a post by&nbsp;<a href="http://blogs.msdn.com/larryosterman/">Larry Osterman</A>, who gets good comments even to his non-posts!). The rant:</FONT></P>
<BLOCKQUOTE dir=ltr>
<P><EM>I'm using this misc story to post a rant about Windows Setup. <BR><BR>Why oh why are countries and time zones + keyboard layouts not cross linked? <BR><BR>First Windows Setup asks me my nationality, I respond 'United Kindon'... Setup is *SO* smart that it doesn't change the default time zone to GMT &amp; UK Keyboard Layout; instead I have to manually select all three. <BR><BR>Now I absolutely agree that not *ALL* people who select UK will want to use GMT and a UK keyboard layout but it could at least make those the defaults for the vast majority of the people that do each time... </EM></P></BLOCKQUOTE>
<P><FONT face=Tahoma>In case you were thinking that this is proof that you should <a href="http://archives.miloush.net/michkap/archive/2005/02/19/376848.html">read the comments</A> in people's posts, this probably wouldn't do the trick, because Larry sent me email about this before I had a chance to look at it. :-)</FONT></P>
<P>Now let's talk about this rant for a bit. :-)</FONT></P>
<P><FONT face=Tahoma>Now starting in Windows XP and continuing into&nbsp;Windows Server 2003, a user locale setting will give you a keyboard, automatically. You can choose to add more if you like, or even remove ones automatically added, and with the exception of a single bug that we may hear about in a comment to this very post it all works quite well. Note that in prior versions this feature did not exist, so for Windows 2000 you would actually have to complain about four non-integrated settings!</FONT></P>
<P><FONT face=Tahoma>However, the time zone setting and the location setting are not integrated with that user locale/keyboard choice. </FONT></P>
<P><FONT face=Tahoma>I have spoken in the past (like in <a href="http://archives.miloush.net/michkap/archive/2005/02/04/366922.html">GEOID -- The LCIDs maligned little brother....</A>) about the fact that the location and user locale settings are not well integrated, and the fact that not enough people are using the location setting anyway. And the inertia that keeps developers from making such changes is not helped by the fact that the GEO API does not exist on Windows 2000, either. But eventually, with the help of that eager PM I talked about the cited GEO post, I am sure that issue will work itself out.</FONT></P>
<P><FONT face=Tahoma>And once upon a time, there was some effort to integrate the time zones and user locales as well, but that particular integration no longer really happens -- and it would honestly be better if it integrated with the GEO settings anyway. Especially since there is no documented, queryable mapping between locales and time zones, but a call to the <A href="http://msdn.microsoft.com/library/en-us/intl/nls_6bqn.asp">GetGeoInfo</A> function with a <A href="http://msdn.microsoft.com/library/en-us/intl/nls_7d2d.asp">SYSGEOTYPE</A> of GEO_TIMEZONES will return an array of all&nbsp;of the time zones in the selected location.</FONT></P>
<P><FONT face=Tahoma>Note that there are many locations that span multiple time zones, so there will still have to be some tweaking done, but that is not unreasonable (I am sure there are both people who would demand that Microsoft integrate GPS tracking to pinpoint the location and people who would decry such an "evil Microsoft conspiracy" to track users as immoral; I will not give my opinion either way!).</FONT></P>
<P><FONT face=Tahoma>So&nbsp;in summary, not only can the LOCALE/GEO and GEO/TIMEZONE connections can be made, but there are people actively trying to get them made. If Manip can wait until we get all of our ducks in a row, then the integration that the&nbsp;rant truly pines for will happen. Hang in there! :-)</FONT></P>
<P><FONT face=Tahoma></FONT>&nbsp;</P>
<P><FONT face=Tahoma><FONT color=#ff0000><EM>This post brought to you by</EM> "Â±" <EM>(<A href="http://www.fileformat.info/info/unicode/char/00b1/index.htm">U+00b1</A>, a.k.a. PLUS-MINUS SIGN)</EM></FONT></FONT></P>
<hr/><p><a id="422873" href="#422873">#</a> <strong>Mike Dimmick</strong> on 28 May 2005 9:42 AM:</p><div style="margin-left: 1em">I can think of two bugs from a UK user's perspective: 1, the Keyboard Layout dialog tells you you can't remove the automatically-added US layout because it's in use. Setup should switch to using the UK layout straight away and allow the US to be removed, or even do so automatically.<br><br>2, the culture/location options are prompted for before the time zone. So why are the date and time selectors for setting the time still using US formats, not the UK formats I just told you to use?<br><br>I have the feeling I've posted this comment before, but a little reinforcement can't hurt ;-)</div>
<p><a id="422894" href="#422894">#</a> <strong>Michael S. Kaplan</strong> on 28 May 2005 11:21 AM:</p><div style="margin-left: 1em">Yes, the first issue you meant is the one I had in mind. The second one is also one I vaguely knew of but I had forgotten about it in the context of the current discussion.<br><br>But does the UI pick up the setting in other contexts? I thought it never did, for some reason....</div>
<p><a id="423153" href="#423153">#</a> <strong>Mihai</strong> on 30 May 2005 1:26 AM:</p><div style="margin-left: 1em">&quot;a call to the GetGeoInfo function with a SYSGEOTYPE of GEO_TIMEZONES will return an array of all of the time zones in the selected location.&quot;<br><br>Has anyone seen this working?<br>Everything works fine except for GEO_OFFICIALLANGUAGES &amp; GEO_TIMEZONES .<br>Tried it on XP SP2, 2003, Longhorn 5048, compiled with C++ from .NET 2003 and .NET 2005 beta 2. Nothing.<br><br>The easyest way to check it:<br>GetGeoInfo( 244, GEO_TIMEZONES, NULL, 0, NULL );<br>Returns 0 and GetLastError also 0.<br>It should return the size needed.<br><br>I have also tried providing a huge buffer, and I have tried with all GEOIDs (enumerated).<br><br>Thanks :-)</div>
<p><a id="423179" href="#423179">#</a> <strong>Michael S. Kaplan</strong> on 30 May 2005 5:08 AM:</p><div style="margin-left: 1em">Hey Mihai, this one deserves its own post. I'll write about what is going on, soon.</div>
<p><a id="423184" href="#423184">#</a> <strong>Manip</strong> on 30 May 2005 6:23 AM:</p><div style="margin-left: 1em">Thanks for the response to my post. I hope it is fixed in the near future (maybe next release?)... <br><br>It is just one of those issues that you sit back and say &quot;I know this is going to be fixed in their next release&quot; but that wasn't true for W2K or XP. <br><br>If you guys can't get all the bugs sorted out and have to pull it can you at least make a last minute hack for the longhorn setup (database with each country, has time/keyboard settings).</div>
<p><a id="423185" href="#423185">#</a> <strong>Michael S. Kaplan</strong> on 30 May 2005 7:02 AM:</p><div style="margin-left: 1em">Like I said Manip, the keyboard is already hooked up to the user locale. The future steps are to see what can be done to hook in the other two settings (time zones and locations).<br><br>It is too early to promise when it will happen, but I can promise you that people are looking at the issue, and that it is an important one to several people here.</div>
<hr/><p><em>referenced by</em></p><div style="margin-left: 1em"><p>2005/10/12 <a href="http://archives.miloush.net/michkap/archive/2005/10/12/479817.html">Some of GetGeoInfo is sorta broken</a></p><p>2005/06/01 <a href="http://archives.miloush.net/michkap/archive/2005/06/01/424067.html">It's not quite done yet</a></p></div><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2005/05/28/422958.html" title="Second time&#39;s a charm!">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2005/05/28/422806.html" title="When do time zones and cultural settings get updated?">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2005-05">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2005-05-28">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2005/05/28/422808.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:41 GMT -->
</html>