<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2005/07/15/439395.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:41 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>Don't roll your own CompareString... uh... never mind</title></head><body>
<h1>Don't roll your own CompareString... uh... never mind</h1>
<p><em>by Michael S. Kaplan, published on 2005/07/15 16:01 -04:00, original URI: http://blogs.msdn.com/b/michkap/archive/2005/07/15/439395.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<P><FONT face=Tahoma size=2><EM>(more experimentations with pre-recorded messages!)</EM></FONT></P>
<P><FONT face=Tahoma>Earlier today I&nbsp;told everyone <a href="http://archives.miloush.net/michkap/archive/2005/07/15/439223.html">Don't roll your own GetDateFormat</A>&nbsp;and even showed an example consequence of doing so, when Microsoft Office would fail to pick up the right support for genitive dates, an important functionality in several locales.</FONT></P>
<P><FONT face=Tahoma>Everyone knows that collation is what I like best, so I wanted to write that you should not try to do the same sort of thing with <A href="http://msdn.microsoft.com/library/en-us/winui/winui/windowsuserinterface/resources/strings/stringreference/stringfunctions/comparestring.asp">CompareString</A>. But then I realized that whether one is thinking about the C Runtime, the Shell Lightweight API (shlwapi), or the .NET Framework, people like to roll their own functions and wrappers for this stuff, and show no signs of slowing down how many are added from version to version. I have been covering the differences for some time now in a variety of posts....</FONT></P>
<P><FONT face=Tahoma>The arguments to not do such things simply do not pull the same weight as they do in the GetDateFormat case, since any time you claim a feature is missing or broken by their wrapper, it is trivial to claim that the feature is not needed for callers of the new function. If they do need it, then they write a new wrapper!</FONT></P>
<P><FONT face=Tahoma>But this precedent does not require <STRONG>you</STRONG>, the customer, to do the same thing. The wrapper idea is a dangerous one. Not usually for the one who writes the wrapper at the time they write it (since <EM>hopefully</EM> flags will have been carefully thought out and planned). But if you use the same function later on, or if someone else sees it and decides to use it, then it becomes more and more difficult to determine whether the usage is correct, and what the side effects may be.</FONT></P>
<P><FONT face=Tahoma>Someone over in the world of .NET was explaining to me why the fact that macros were not included in C# was a good thing. Now I do not completely buy the agruments about obfuscation of functionality and such, but if someone does buy the argument, then don't wrapper methods and functions violate the same gudielines of code library transparency?</FONT></P>
<P><FONT face=Tahoma>I am <STRIKE><FONT color=#808080>probably</FONT></STRIKE>obviously losing this particular battle in many of the libraries that Microsoft ships (and removing methods is a worse problem than the one I am arguing here!), but I still have hope that customers will not fall into this same trap (or at least minimize the amount of falling that they do!). The basic methods are not that hard to use, so why not give them a try? :-)</FONT></P>
<P><FONT face=Tahoma></FONT>&nbsp;</P>
<P><FONT face=Tahoma color=#ff0000><EM>This post brought to you by</EM> "<FONT size=3>à²”</FONT>" <EM>(<A href="http://www.fileformat.info/info/unicode/char/0c94/index.htm">U+0c94</A>, a.k.a. KANNADA KETTER AU)</EM></FONT></P>
<hr/><div style="margin-left: 1em"><em>no comments</em></div><hr/><p><em>referenced by</em></p><div style="margin-left: 1em"><p>2006/12/13 <a href="http://archives.miloush.net/michkap/archive/2006/12/13/1275292.html">Sometimes what a person really wants is a LACK of size</a></p><p>2006/06/16 <a href="http://archives.miloush.net/michkap/archive/2006/06/16/634124.html">Neither GDI nor Uniscribe solve the ultimate font problem completely, either</a></p></div><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2005/07/15/439513.html" title="Disabilities in the workplace">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2005/07/15/439223.html" title="Don&#39;t roll your own GetDateFormat">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2005-07">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2005-07-15">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2005/07/15/439395.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:41 GMT -->
</html>