<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2005/07/15/439223.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:41 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>Don't roll your own GetDateFormat</title></head><body>
<h1>Don't roll your own GetDateFormat</h1>
<p><em>by Michael S. Kaplan, published on 2005/07/15 06:51 -04:00, original URI: http://blogs.msdn.com/b/michkap/archive/2005/07/15/439223.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<P><FONT face=Tahoma>A few days ago, Daniel asked (in the microsoft.public.win32.programmer.international newsgroup):</FONT></P>
<BLOCKQUOTE dir=ltr style="MARGIN-RIGHT: 0px">
<P>This issue is happening with MS Windows XP (all patches and updates) and MS Word XP (also all updates installed).<BR><BR>Until now, I thought that, when using the "Insert date and time" command from MS Word, it would take the month's name for the long date format from the Windows Regional Settings.<BR><BR>My belief, however must be wrong because, when I try to insert a long date format date in Latvian, the month name I get is different from the one I see in the Regional Settings.<BR><BR>This is what I get:<BR><BR>MS Word: when use the "Insert" -&gt; "Date and Time" command to insert a long format date in Latvian, the date shown is "svetdiena, 2005. gada 10. julijs" (I have transliterated special baltic characters in case your reader does not support baltic characters).<BR><BR>MS Windows: Control Panel -&gt; Regional and Language Settings -&gt; "Latvian" as the language for "Standards and Formats". The long date displayed is "svetdiena, 2005. gada 10. julija" (again, baltic characters transliterated).<BR><BR>Both forms of the month's name (ending in "js" and in "ja" are correct, using one or another is a matter of style.<BR><BR>What puzzles me, however is: why isn't word using the same format as Windows? It seems that it has its own list of month's names. Where are they stored?<BR><BR>What I would like to achieve is that, when using "Insert date and time" from MS Word, the user gets the month's name with the "ja" ending instead of the "js" ending. Is there an easy way to achieve this?<BR><BR>Thanks in advance for your help!</P></BLOCKQUOTE>
<P><FONT face=Tahoma>Here are the strings for today, with the appropriate diacritics:</FONT></P>
<BLOCKQUOTE dir=ltr style="MARGIN-RIGHT: 0px">
<P><FONT face=Tahoma><STRONG><FONT face="Courier New">Word:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT>piektdiena, 2005. gada 15. jūlijs</STRONG></FONT></P>
<P><FONT face=Tahoma><STRONG><FONT face="Courier New">Windows:&nbsp;&nbsp;&nbsp;</FONT>piektdiena, 2005. gada 15. jūlijā</STRONG></FONT></P></BLOCKQUOTE>
<P><FONT face=Tahoma>Now some of the long-time readers here will immediately think back to my post <a href="http://archives.miloush.net/michkap/archive/2004/12/25/332259.html"><STRONG>What the %$#! are genitive dates?</STRONG></A> from December 25, 2004. And they will realize that the GetDateFormat function returns the second string. Which makes one wonder why Word 2002 (this problem also repros in Word 2003) is returning the wrong value.</FONT></P>
<P><FONT face=Tahoma>The problem comes from rolling your own NLS functionality, rather than using the NLS functionality provided by Windows. Oops!</FONT></P>
<P><FONT face=Tahoma>The NLS functions are able to handle a lot more complexities than they get credit for; in situations like this, they really shine. Of course, you do have to actually <STRONG>use</STRONG> the functions to get these benefits....</FONT></P>
<P><FONT face=Tahoma></FONT>&nbsp;</P>
<P><FONT face=Tahoma color=#ff0000><EM>This post brought to you by</EM> "<FONT size=3>჻</FONT>" <EM>(<A href="http://www.fileformat.info/info/unicode/char/10fb/index.htm">U+10fb</A>, a.k.a. GEORGIAN PARAGRAPH SEPARATOR)</EM></FONT></P>
<hr/><div style="margin-left: 1em"><em>no comments</em></div><hr/><p><em>referenced by</em></p><div style="margin-left: 1em"><p>2010/09/09 <a href="http://archives.miloush.net/michkap/archive/2010/09/09/10059644.html">Latvian. Genitive. Oops.</a></p><p>2008/05/14 <a href="http://archives.miloush.net/michkap/archive/2008/05/14/8502723.html">Windows is too busy being consistent with the user to be consistent with itself!</a></p><p>2007/08/04 <a href="http://archives.miloush.net/michkap/archive/2007/08/04/4218583.html">A re-genitive post</a></p><p>2005/07/15 <a href="http://archives.miloush.net/michkap/archive/2005/07/15/439395.html">Don't roll your own CompareString... uh... never mind</a></p></div><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2005/07/15/439395.html" title="Don&#39;t roll your own CompareString... uh... never mind">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2005/07/14/438813.html" title="Ignore this blog (and this post)">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2005-07">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2005-07-15">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2005/07/15/439223.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:41 GMT -->
</html>