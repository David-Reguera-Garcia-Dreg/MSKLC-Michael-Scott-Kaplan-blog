<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2005/07/24/442720.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:41 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>When other teams lock down your implementation....</title></head><body>
<h1>When other teams lock down your implementation....</h1>
<p><em>by Michael S. Kaplan, published on 2005/07/24 14:59 -04:00, original URI: http://blogs.msdn.com/b/michkap/archive/2005/07/24/442720.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<P><FONT face=Tahoma>The other day someone was talking about how we could maybe think about not using the registry for some of our NLS support configuration. It was an interesting thought, and I am not completely against the concept of breaking people who insist on doing unsupported things with undocumented registry keys. After all, that is why certain things are not documented!</FONT></P>
<P><FONT face=Tahoma>But then yesterday I was looking through MSDN and stumbled acroos the Host Integration Server 2000 documentation (it was hard to miss, under&nbsp;a main&nbsp;topic like <STRONG>NLS (National Language Support)</STRONG>, of course!). There are the <A href="http://msdn.microsoft.com/library/en-us/his/htm/_sna_snanls_api_functions_nls.asp">SNANLS API Functions</A>, and in particular <A href="http://msdn.microsoft.com/library/en-us/his/htm/_sna_opennlsregistry_nls.asp">OpenNlsRegistry</A>&nbsp;which opens up the key that we were under the (apparently mistaken) impression was internal and undocumented. Darn.</FONT></P>
<P><FONT face=Tahoma>Many of of their other&nbsp;functions (like <A href="http://msdn.microsoft.com/library/en-us/his/htm/_sna_snanlsinit_nls.asp">SnaNlsinit</A>) do similar things. Double darn. And it's probably too late to call it a typo. :-(</FONT></P>
<P><FONT face=Tahoma>Now if you start looking around their APIs to see if there is anything you might want to use,&nbsp;note that their <A href="http://msdn.microsoft.com/library/en-us/his/htm/_sna_snanlsmapstring_nls.asp">SnaNlsMapString</A>&nbsp;has nothing to do with our NLS <A href="http://msdn.microsoft.com/library/en-us/intl/nls_5s2v.asp">LCMapString</A>; they are mapping between code pages, while we do a whole bunch of other mappings, like I describe <a href="http://archives.miloush.net/michkap/archive/2005/06/24/432121.html">here</A>. They would be doing the equivalent of combining <A href="http://msdn.microsoft.com/library/en-us/intl/unicode_17si.asp">MultiByteToWideChar</A> and <A href="http://msdn.microsoft.com/library/en-us/intl/unicode_2bj9.asp">WideCharToMultiByte</A> calls to get the work done in this function....</FONT></P>
<P><FONT face=Tahoma color=#ff0000><EM>This post brought to you by</EM> "<FONT size=6>Â«</FONT>" <EM>(<A href="http://www.fileformat.info/info/unicode/char/00ab/index.htm">U+00ab</A>, a.k.a. LEFT-POINTING DOUBLE ANGLE QUOTATION MARK)</EM></FONT></P>
<hr/><p><a id="442830" href="#442830">#</a> <strong>Troy Phillips</strong> on 24 Jul 2005 9:36 PM:</p><div style="margin-left: 1em">I suppose that either you sre stuck with your current implementation, or you have to thunk the now published APIs into your new implementation.<br><br>My question (as the devils advocate) is if the APIs were &quot;internal and undocumented&quot; then how did the Host Integration Server team find out about them?  Shouldn't they be only using the APIs that are listed in MSDN like all the rest of us :)</div>
<p><a id="442898" href="#442898">#</a> <strong>Michael S. Kaplan</strong> on 25 Jul 2005 4:41 AM:</p><div style="margin-left: 1em">Hi Troy, Well, there are no Base NLS APIs that will check this functionality on remote machines, which is the basic reason most of them exist....</div>
<p><a id="442995" href="#442995">#</a> <strong>Maurits [MSFT]</strong> on 25 Jul 2005 11:26 AM:</p><div style="margin-left: 1em">Perhaps if you were to prefix not-for-public-release thingamajiggers with &quot;ms&quot;?  MsOpenNlsRegistry<br><br>That way every team (and customer!) would know what was public and what was private.</div>
<p><a id="442998" href="#442998">#</a> <strong>Michael S. Kaplan</strong> on 25 Jul 2005 11:30 AM:</p><div style="margin-left: 1em">Good thought, but these are not API functions we are talking about, they are registry keys and values (that function I quoted was their wrapper, not our registry key). And they were all designed a decade ago with a lot of dependencies that are valid, so changing them would be hard even if people were not making them &quot;public&quot; as happened here. But random registry config. keys under HKLM that are not documented? I don't know of anyone who would assume that was public info.... :-)</div>
<hr/><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2005/07/24/442773.html" title="Fixing the .NET Framework 1.0 and 1.1 SP install errors">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2005/07/23/442422.html" title="Does MS pull new locales out of their [insert stronger language here]?">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2005-07">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2005-07-24">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2005/07/24/442720.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:41 GMT -->
</html>