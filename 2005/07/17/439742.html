<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2005/07/17/439742.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:41 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>A Microsoft convention for compressions in sorting</title></head><body>
<h1>A Microsoft convention for compressions in sorting</h1>
<p><em>by Michael S. Kaplan, published on 2005/07/17 11:25 -04:00, original URI: http://blogs.msdn.com/b/michkap/archive/2005/07/17/439742.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<P><FONT face=Tahoma>The other day, a developer named Stephanie sent me an email about compressions (these are used in collation when two or more characters are given a single sort weight -- the Unicode Collation Algorithm calls their analagous construction a contraction, in part to avoid confusion with other meanings of the term compression that are described in Unicode). She had just read Dr. International's description of the difference between Traditional and Modern Spanish <A href="http://www.microsoft.com/globaldev/drintl/columns/017/default.mspx#Q4">here</A>, and asked:</FONT></P>
<BLOCKQUOTE dir=ltr style="MARGIN-RIGHT: 0px">
<P><EM><FONT size=2>I did some experimentation and found that I saw the described results for CH, Ch, and ch, although the article only mentions CH. In any case, cH is not included. Can you explain these two discrepencies?</FONT></EM></P>
<P><EM><FONT size=2>Also, why wouldn't one of these be an alternate sort?</FONT></EM></P></BLOCKQUOTE>
<P><FONT face=Tahoma>Stephanie, you are right -- every compression we define for a cased script we handle the UU, UL, and&nbsp;LL forms, but we skip the LU form.</FONT></P>
<P><FONT face=Tahoma>This was originally a point of confusion for me as well, but Cathy Wissink set my straight back in the early days when she pointed out to me that words may be <STRONG>ALL CAPS</STRONG> or they may be <STRONG>all lowercase</STRONG> and they may be <STRONG>Initial caps</STRONG>, but there is in most languages not a pattern that has capital letters in the middle of text that is not capitalized. The convention we use for compressions is designed to take this reality into account and handle the expected cases while discarding the one that is unexpected.</FONT></P>
<P><FONT face=Tahoma>The Dr. International article isn't wrong here, though. I will often speak of a compression by just naming the one form when I mean all three forms; it is just a convenient way to express what compressions exist for a language, or a particular sort within a language.</FONT></P>
<P><FONT face=Tahoma>As to your final concern, I agree with you -- there ought to be an alternate sort used&nbsp;here. I actually even pointed this out in the past (described <a href="http://archives.miloush.net/michkap/archive/2005/02/12/371650.html">here</A>). The truth is that alternate sorts did not exist then. They were added specifically in the postmortem over handling this issue with Spanish!</FONT></P>
<P><FONT face=Tahoma></FONT>&nbsp;</P>
<P><FONT face=Tahoma color=#ff0000><EM>This post brought to you by</EM> "×©" <EM>(<A href="http://www.fileformat.info/info/unicode/char/05e9/index.htm">U+05e9</A>, a.k.a. HEBREW LETTER SHIN)</EM></FONT></P>
<hr/><p><a id="440060" href="#440060">#</a> <strong>Maurits [MSFT]</strong> on 18 Jul 2005 3:08 PM:</p><div style="margin-left: 1em">&quot;there is in most languages not a pattern that has capital letters in the middle of text that is not capitalized&quot;<br><br>I can think of two counter-examples off-the-cuff...<br><br>1. Ronald McDonald &lt;-- cD<br>2. random-capitalization for password complexification<br><br>The first is not much of a problem as combining characters that happen to meet in this fashion should probably *not* be combined as they are from separate semantic objects.<br><br>The second is more of a problem but is mitigated somewhat by the &quot;why would you need to sort passwords anyway&quot; question.  Unless you're writing a crypt() function.</div>
<p><a id="440065" href="#440065">#</a> <strong>Michael S. Kaplan</strong> on 18 Jul 2005 3:15 PM:</p><div style="margin-left: 1em">ah, the #2 case is not meaningful for us, and the #1 case I would argue that the intent was not to treat the two chars as a sort element (if there were a CD compression, that is; no one has one now).<br><br>Now if some language wanted it, we could always add it for that language. We just don't have any right now.... :-)</div>
<p><a id="440971" href="#440971">#</a> <strong>Maurits [MSFT]</strong> on 20 Jul 2005 12:40 PM:</p><div style="margin-left: 1em">Suppose I was a developer in Spain, tasked with creating a phone directory.  In .NET, of course.  I use the CompareString culture options to implement a Spanish-sensitive sort, in particular sorting ch as a unique element between c and d.<br><br>CA CB ... CE CF CG CI CJ CK ... CZ<br>CH<br>D<br><br>cA cB ... cE cF cG cH cI cJ cK ... cZ<br>d<br><br>Fine.  I complete the work and go on my merry way.<br><br>After I'm long gone, a shipment of Scottish soldiers arrives at the UK's port of Gibraltar.  This ship is full of people with last names like McHenry, McTavish, McDonald, ...<br><br>Some of these lads decide to leave Gibraltar and intermingle with the native se&#241;oritas, marrying and starting families.  And getting phone numbers, and listings in the directory I created.<br><br>All very well and good.  My algorithm even sorts McHenry correctly between McDonald and McTavish!<br><br>But then one day someone decides to uppercase all the data...<br><br>Pobre Sra. McHenry!  She now sorts differently...<br><br>McDonald<br>McHenry<br>McTavish<br><br>vs.<br><br>MCDONALD<br>MCTAVISH<br>MCHENRY<br><br>&#161;Ay, dios mio!</div>
<p><a id="441044" href="#441044">#</a> <strong>Michael S. Kaplan</strong> on 20 Jul 2005 2:20 PM:</p><div style="margin-left: 1em">Well, this was indeed a colorful spelling out of the underlying scenario. :-)</div>
<hr/><p><em>referenced by</em></p><div style="margin-left: 1em"><p>2010/03/09 <a href="http://archives.miloush.net/michkap/archive/2010/03/09/9975184.html">Coloring outside the lines in the a-ness of the Hungarian Technical Sort</a></p><p>2008/01/25 <a href="http://archives.miloush.net/michkap/archive/2008/01/25/7228941.html">On reversing the irreversible (grabbing the data, part I)</a></p><p>2007/09/16 <a href="http://archives.miloush.net/michkap/archive/2007/09/16/4937196.html">A&P of Sort Keys, part 6 (aka Relax, be calm, and deCOMPRESS if you are feeling out of sorts)</a></p><p>2007/06/18 <a href="http://archives.miloush.net/michkap/archive/2007/06/18/3374502.html">If you don't always preserve case, you don't always preserve meaning</a></p><p>2007/01/06 <a href="http://archives.miloush.net/michkap/archive/2007/01/06/1420754.html">Sorting The Old New Thing All Out</a></p><p>2006/05/26 <a href="http://archives.miloush.net/michkap/archive/2006/05/26/607881.html">Custom Case Mappings?</a></p><p>2006/04/27 <a href="http://archives.miloush.net/michkap/archive/2006/04/27/584439.html">The disunification of Norwegian and Danish sorting</a></p><p>2005/11/26 <a href="http://archives.miloush.net/michkap/archive/2005/11/26/495072.html">Technically it *is* a hungarian sort</a></p></div><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2005/07/17/439783.html" title="For crying out loud, Spazzo is gone">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2005/07/17/439733.html" title="Suggest a Topic (17 July 2005)">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2005-07">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2005-07-17">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2005/07/17/439742.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:41 GMT -->
</html>