<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2005/07/27/444101.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:41 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>There is no such thing as a surrogate character (dammit!)</title></head><body>
<h1>There is no such thing as a surrogate character (dammit!)</h1>
<p><em>by Michael S. Kaplan, published on 2005/07/27 19:47 -04:00, original URI: http://blogs.msdn.com/b/michkap/archive/2005/07/27/444101.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<P><FONT face=Tahoma>The title of this post, including the parenthetical note, is something that people associated with <A href="http://www.unicode.org/">the Unicode Standard</A> have to tell people all the time (of course generally people only say that parenthetical note to themselves, and really only because they have to say it so many times!).</FONT></P>
<P><FONT face=Tahoma>The issue is clear in both the <A href="http://www.unicode.org/glossary/index.html">Unicode Glossary</A>:</FONT></P>
<BLOCKQUOTE dir=ltr style="MARGIN-RIGHT: 0px">
<P><A name=surrogate_character><EM>Surrogate Character</EM></A>. A misnomer. It would be an encoded character having a surrogate code point, which is impossible. Do not use this term.</P></BLOCKQUOTE>
<P><FONT face=Tahoma>and the <A href="http://www.unicode.org/faq/basic_q.html#22">Unicode FAQ</A>:</FONT></P><FONT face=Tahoma>
<BLOCKQUOTE dir=ltr style="MARGIN-RIGHT: 0px">
<P class=q><A name=22></A><EM><STRONG><FONT size=2>Q: Are surrogate characters the same as supplementary characters?</FONT></STRONG></EM></P>
<BLOCKQUOTE dir=ltr style="MARGIN-RIGHT: 0px">
<P class=a><EM><FONT size=2>A: This question shows a common confusion. It is very important to distinguish surrogate code points (in the range U+D800..U+DFFF) from supplementary code points (in the completely different range, U+10000..U+10FFFF). Surrogate code points are reserved for use, <STRONG>in pairs</STRONG>, in representing supplementary code points in UTF-16.</FONT></EM></P>
<P class=a><EM><FONT size=2>There are supplementary characters (i.e. encoded characters represented with a single supplementary code point), but there are not and will never be <STRONG>surrogate characters</STRONG> (i.e. encoded characters represented with a single surrogate code point).</FONT></EM></P></BLOCKQUOTE></BLOCKQUOTE></FONT>
<P><FONT face=Tahoma>In fact, if you look to the <A href="http://www.unicode.org/roadmaps/">Unicode Roadmap</A>, each plane has its own name:</FONT></P>
<UL>
<LI><FONT face=Tahoma>Plane 0: <A href="http://www.unicode.org/roadmaps/bmp/">BMP</A> (Basic Multilingual Plane)</FONT> 
<LI><FONT face=Tahoma>Plane 1: <A href="http://www.unicode.org/roadmaps/smp/">SMP</A> (Supplementary Multilingual Plane)</FONT> 
<LI><FONT face=Tahoma>Plane 2: <A href="http://www.unicode.org/roadmaps/sip/">SIP</A>&nbsp;(Supplementary Ideographic Plane)</FONT> 
<LI><FONT face=Tahoma>Plane 14: <A href="http://www.unicode.org/roadmaps/ssp/">SSP</A> (Supplementary Special-Use Plane)</FONT></LI></UL>
<P><FONT face=Tahoma>They are supplementary characters, one and all. They are <STRONG>not</STRONG> surrogate characters. Truly.</FONT></P>
<P><FONT face=Tahoma>This is easy, right?</FONT></P>
<P><FONT face=Tahoma>Of course even the clearest intention will not always find itself communicated properly, which is why the <A href="http://msdn.microsoft.com/library/en-us/cpref/html/frlrfsystemcharclassissurrogatetopic.asp">Char.IsSurrogate</A>&nbsp;method will have text like "<FONT face="Times New Roman">Indicates whether a Unicode character is categorized as a surrogate character</FONT>" or when the Windows CE docs say "<EM><FONT face="Times New Roman" size=2>For sorting, all surrogate pairs are treated as two Unicode code points. Surrogates are sorted after other Unicode code points, but before the PUA (private user area). Sorting for a standalone surrogate character (that is, either the high or low character is missing) is not supported.</FONT></EM>". I do mind the not-entirely-accurate statement about the collation, but I will talk about that another day!</FONT></P>
<P><FONT face=Tahoma>I do not mind the surrogate character usage like that in the previous paragraph so much, as it is a more benign error -- when people say surrogate character in this context, they mean to say surrogate code point. Harmless error and it even shows up as a NULL glyph as if it were a character of some sort, and we can just the documentationl language at some point (hopefully soon, but I will not lose sleep if they do not).</FONT></P>
<P><FONT face=Tahoma>The real problem case is when they try to equate the term surrogate character with the term surrogate pair. If they compound it by the naming the method that way, like the <A href="http://msdn2.microsoft.com/library/zd2k6h4f(en-us,vs.80).aspx">XmlWriter.WriteSurrogateCharEntity</A>&nbsp;method, which in addition the evil method name, say things like:</FONT></P>
<BLOCKQUOTE dir=ltr style="MARGIN-RIGHT: 0px">
<P><EM>When overridden in a derived class, generates and writes the surrogate character entity for the surrogate character pair.</EM></P></BLOCKQUOTE>
<P><FONT face=Tahoma>This is a bit harder to fix (not the doc. portion, but the method name, which obviously cannot be removed.</FONT></P>
<P><FONT face=Tahoma>But we'll figure something out. Eventually.</FONT></P>
<P><FONT face=Tahoma>Until then, please remember what the title of this post is telling you -- <STRONG>there is no such thing as a surrogate character!</STRONG></FONT></P>
<P><FONT face=Tahoma></FONT>&nbsp;</P>
<P><FONT face=Tahoma><FONT color=#ff0000><EM>This post brought to you by</EM> <EM>U+D800, the first surrogate code point -- <STRONG>not</STRONG> a surrogate character!<BR><FONT size=1>(This code point has come to terms with his lack of character-ness, but has mentioned that the fact that no one else has may put him into therapy)</FONT></EM></FONT></FONT></P>
<hr/><p><a id="444824" href="#444824">#</a> <strong>Michael</strong> on 29 Jul 2005 3:43 AM:</p><div style="margin-left: 1em">The evil like Char.IsSurrogate comes from the fact that Char managed type, as well as wchar_t (under Windows) really represent just two bytes in Utf16 encoding, not the Unicode character. I always mentally translate it, and then Utf16CodePoint.IsSurrogate does makes sense :)</div>
<p><a id="444940" href="#444940">#</a> <strong>Michael S. Kaplan</strong> on 29 Jul 2005 11:13 AM:</p><div style="margin-left: 1em">Well, that is the slightly more benign use (IMHO) -- both types are defined for MS platforms as using UTF-16, an it is just asking if the thing in the Char or WCHAR is a surrogate....</div>
<p><a id="444948" href="#444948">#</a> <strong>Ben Bryant</strong> on 29 Jul 2005 11:37 AM:</p><div style="margin-left: 1em">Well put. I'll try to always keep this in mind. But looking at XmlWriter WriteSurrogateCharEntity it seems to be named to be consistent with WriteCharEntity which I think is actually incorrect in the first place -- it is a &quot;Numeric Character Reference&quot;, not an &quot;Entity Reference&quot; and certainly leaving off the term &quot;Reference&quot; or at least &quot;Ref&quot; is bad usage; it should be WriteCharRef and WriteSupplementaryCharRef for use with UTF-16. They also have WriteEntityRef which is actually an &quot;Entity Reference,&quot; so they apparently thought leaving the &quot;Ref&quot; part off would make it a Numeric Character Reference! This whole API shows a real confusion in terms, in particular a craziness around the term &quot;Entity.&quot; Dare Obasanjo oversaw this right? He should explain it. But coming back to your point, the Char in the method name may be intending to refer to the output (which is actually a supplementary character) and not the surrogate pair that is input judging from the correlation with WriteCharEntity.<br></div>
<hr/><p><em>referenced by</em></p><div style="margin-left: 1em"><p>2007/11/12 <a href="http://archives.miloush.net/michkap/archive/2007/11/12/6139309.html">I'm simply saying that life^H^H^H^Hcharacters, uh... find a way</a></p><p>2007/10/23 <a href="http://archives.miloush.net/michkap/archive/2007/10/23/5623838.html">If you would wait till I *FINISHED* what I was trying to say, you punk... (aka Premature validation)</a></p><p>2007/10/03 <a href="http://archives.miloush.net/michkap/archive/2007/10/03/5259246.html">If it ain't UTF-16 then it ain't having no surrogate pairs, baby!</a></p><p>2006/02/06 <a href="http://archives.miloush.net/michkap/archive/2006/02/06/525486.html">Maybe there is such a thing as a surrogateS character (dammit!)</a></p><p>2005/09/24 <a href="http://archives.miloush.net/michkap/archive/2005/09/24/472543.html">The basics of supplementary</a></p><p>2005/07/31 <a href="http://archives.miloush.net/michkap/archive/2005/07/31/445838.html">Why my syndication links were broken....</a></p></div><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2005/07/27/444171.html" title="Disagreeing with minimsft again">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2005/07/27/443953.html" title="Windows Vista Beta 1 is released!">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2005-07">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2005-07-27">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2005/07/27/444101.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:41 GMT -->
</html>