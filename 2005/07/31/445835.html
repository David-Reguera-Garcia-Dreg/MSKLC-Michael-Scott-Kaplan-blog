<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2005/07/31/445835.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:41 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>What's wrong with the SortKey class?</title></head><body>
<h1>What's wrong with the SortKey class?</h1>
<p><em>by Michael S. Kaplan, published on 2005/07/31 20:10 -04:00, original URI: http://blogs.msdn.com/b/michkap/archive/2005/07/31/445835.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<P><FONT face=Tahoma>You may be wondering what I am talking about here....</FONT></P>
<P><FONT face=Tahoma>Well, it is about the <A href="http://msdn.microsoft.com/library/en-us/cpref/html/frlrfsystemglobalizationsortkeyclasstopic.asp">SortKey class</A>&nbsp;in the .NET Framework, which you get to by calling the <A href="http://msdn.microsoft.com/library/en-us/cpref/html/frlrfsystemglobalizationcompareinfoclassgetsortkeytopic.asp">GetSortKey</A> method of the&nbsp;<A href="http://msdn.microsoft.com/library/en-us/cpref/html/frlrfsystemglobalizationcompareinfoclasstopic.asp">CompareInfo class</A>.</FONT></P>
<P><FONT face=Tahoma>The class contains everything you need -- the source string and&nbsp;the binary sort key. So what could be missing?</FONT></P>
<P><FONT face=Tahoma>Well, for starters the flags used to create the instance. The original string is avaiable as is the final result, but there is no way to know how you move between the two. Now I am not saying that this is necessary, but it is a little odd given that an object happens to be there.</FONT></P><FONT face=Tahoma>
<P><FONT face=Tahoma>In practice, it is hard to know when you would ever need the string -- wouldn't you know what the string is, and thus not need to have another copy of it stored? It seems kind of wateful to me....</FONT></P>
<P>Now there is a Compare method that you can use to compare two sort keys, and that is great. But that means if you want to use the functionality to create sort key to build a database index, that you are on your own unless you either (a) serialize the class and thus duplicate the string and the indexing, or (b) take care of the binary comparison yourself. I do not mind (b) and that is easy to do, but wouldn't it better to have a static method to do the work for me? I don't see the serialization here to be a realistic implementation option.</P>
<P>So, these are things that are (in my opinion) wrong with the SortKey class. The real people using it pretty much need to grab out the sort key and then throw it away, since it does not really provide anything else that is needed. I'd be happy if there were just a comparison method available for the byte arrays that make up the sort key data....</FONT></P>
<hr/><div style="margin-left: 1em"><em>no comments</em></div><hr/><p><em>referenced by</em></p><div style="margin-left: 1em"><p>2006/01/12 <a href="http://archives.miloush.net/michkap/archive/2006/01/12/511884.html">The creation of sort keys does not always make sense</a></p></div><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2005/07/31/445838.html" title="Why my syndication links were broken....">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2005/07/31/445819.html" title="New in Vista Beta 1: FindNLSString (an &#39;internationalized&#39; strstr)">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2005-07">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2005-07-31">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2005/07/31/445835.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:41 GMT -->
</html>