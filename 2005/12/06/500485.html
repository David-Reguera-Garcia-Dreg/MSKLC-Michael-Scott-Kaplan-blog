<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2005/12/06/500485.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:40 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>The lack of Uniscribe samples</title></head><body>
<h1>The lack of Uniscribe samples</h1>
<p><em>by Michael S. Kaplan, published on 2005/12/06 11:31 -08:00, original URI: http://blogs.msdn.com/michkap/archive/2005/12/06/500485.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostOld -->
<P><FONT face=Tahoma>A while ago (way back in March of 2005), Ian Treleaven asked in the suggestion box:</FONT></P>
<BLOCKQUOTE dir=ltr style="MARGIN-RIGHT: 0px">
<P><FONT size=2><EM>There seem to be very few, possibly only one sample application showing how to use </EM></FONT><A title=Uniscribe href="http://msdn.microsoft.com/library/en-us/intl/uniscrib_35k5.asp" target=_blank><FONT size=2><EM>Uniscribe</EM></FONT></A><FONT size=2><EM> and its set of APIs. The 1060 page book, Developing International Software (MS Press) has only six high-level pages on the topic.</EM></FONT></P>
<P><FONT size=2><EM>Do you have any experience with this API and any hints on how to use it? Any insight would be great.</EM></FONT></P></BLOCKQUOTE>
<P><FONT face=Tahoma>Ian is correct, in general there are really only two&nbsp;samples I know of:</FONT></P>
<UL>
<LI><FONT face=Tahoma>The sample attached to the 1998 article <A href="http://www.microsoft.com/msj/1198/multilang/multilang.htm"><STRONG>Supporting Multilanguage Text Layout and Complex Scripts with Windows 2000</STRONG></A> by F. Avery Bishop, David C. Brown, and David M. Meltzer.</FONT> 
<LI><FONT face=Tahoma>The VB sample of a Unicode TextBox I did&nbsp;for </FONT><A href="http://i18nwithvb.com/"><FONT face=Tahoma>Internationalization with Visual Basic</FONT></A><FONT face=Tahoma> that was based on a sample from Matt Curland's </FONT><A href="http://www.amazon.com/exec/obidos/ASIN/0201707128/" target=prod1><B><FONT face=Tahoma>Advanced Visual Basic 6: Power Techniques for Everyday Programs</FONT></B></A><FONT face=Tahoma>&nbsp;(adding owner draw, Uniscribe, and Unicode clipboard support).</FONT></LI></UL>
<P><FONT face=Tahoma>Beyond that, samples seem to be pretty scarce.</FONT></P>
<P><FONT face=Tahoma>It used to trouble me a lot more than it does now, but this has more to do with the fact that almost nobody really needs to deal with the complexity of Uniscribe in their daily development work; they just need language support to simply work, the way it does when you use the regular Win32 API to build applications and it hooks into Uniscribe for you rather than forcing you to do the complex work to render the text.</FONT></P>
<P><FONT face=Tahoma>Of course there are exceptions to this rule -- the people who work on the GIFT team to create new shaping engines for scripts to be supported obviously need that understanding, and the work done in Crystal Reports and in the Visual Studio environment is very impressive and without that work the script support in these applications would be much poorer for it.</FONT></P>
<P><FONT face=Tahoma>Just this last month, Lloyd Dupont asked in the newsgroups:</FONT></P>
<BLOCKQUOTE dir=ltr style="MARGIN-RIGHT: 0px">
<P><EM><FONT size=2>I have written m own "RichTextView" using Uniscribe. Now I see there is a new text rendering class: SWF.TextRenderer.</FONT></EM></P>
<P><EM><FONT size=2>I haven't tested it out yet but it seems interesting.</FONT></EM></P>
<P><EM><FONT size=2>However I see a couple of issues with it:</FONT></EM></P>
<OL>
<LI><EM><FONT size=2>It doesn't gives me bidi "run" layout information so I have to call uniscribe to get that</FONT></EM> 
<LI><EM><FONT size=2>It only gives me string width, if I want to wrap my text around some boundary I have either to call MeasureText repitively or I have to use Uniscribe again</FONT></EM> 
<LI><EM><FONT size=2>It doesn't gives me cluster boundary for caret placement</FONT></EM> 
<LI><EM><FONT size=2>If I render unsuported char/glyph I don't know which kind of font fall back mechanism it uses so I'm not sure my measurement (which I should do with Uniscribe for reason 1,2,3) will fit the new drawing.</FONT></EM></LI></OL>
<P><EM><FONT size=2>Is there any plan to improve these issues?</FONT></EM></P></BLOCKQUOTE>
<P><FONT face=Tahoma>Clearly there is no specific reason to add full Uniscribe support in the TextRenderer class since its intent is not to provide such support, and if someone already has a Uniscribe wrapper then they should definitely use it.</FONT></P>
<P><FONT face=Tahoma>I am sure some of the people who read this blog may also be exceptions to this rule, but I will push back to the extent of wanting more scenario-based questions rather than open-ended requests for samples. Since most people don't need to directly do complex script processing, it only makes sense to be sure that this is a road that needs to be travelled....</FONT></P>
<P><FONT face=Tahoma></FONT>&nbsp;</P>
<P><FONT face=Tahoma color=#ff1493><EM>This post brought to you by</EM> "â‰ˆ" <EM>(<A href="http://www.fileformat.info/info/unicode/char/2248">U+2248</A>, a.k.a. ALMOST EQUAL TO)</EM></FONT></P>
<hr/><p><a id="500643" href="#500643">#</a> <strong>Mike</strong> on Tuesday, December 06, 2005 2:33 PM:</p><div style="margin-left: 1em">How about a deep dive session on Uniscribe at the GDDC 2006? (i.e not just Powerpoint slides but real technical walkthoughs)</div>
<p><a id="500673" href="#500673">#</a> <strong>Michael S. Kaplan</strong> on Tuesday, December 06, 2005 3:29 PM:</p><div style="margin-left: 1em">Ah, but that takes the conversation the same way -- technical walkthroughs that do what, exactly? If there are no sensible scenarios to base things on, then there is nothing to present on that will hold interest....</div>
<p><a id="500722" href="#500722">#</a> <strong>Lonnie McCullough</strong> on Tuesday, December 06, 2005 5:20 PM:</p><div style="margin-left: 1em">I actually used the first sample you mentioned to implement full Uniscribe support in one of our applications.  Our situation is a little different because our company implements full screen UIs on top of Direct3D and it doesn't have any good layout support in its font classes so we rolled our own.  The first sample contains everything you need to implement Uniscribe in your apps and to do so robustly.  I imlpemented the solution in C# so it was doubly difficult, but ultimately worth it.</div>
<p><a id="500843" href="#500843">#</a> <strong>Mike</strong> on Tuesday, December 06, 2005 11:15 PM:</p><div style="margin-left: 1em">Technical walkthroughs that do what - well, I'll leave that up to someone who actually knows how to use Uniscribe.  <br><br>I think that's the main problem - we hear often in the newsgroups - don't use GetCharacterPlacement, use Uniscribe.  Or don't do xxxxx, use Uniscribe.  Every question that you can answer with &quot;use Uniscribe instead&quot; would make a good technical walkthrough.</div>
<p><a id="501677" href="#501677">#</a> <strong>Simon Cooke</strong> on Thursday, December 08, 2005 2:20 PM:</p><div style="margin-left: 1em">What I'd like to see is a simple example of an editor, where you can type a few rows of text and mark some of that text as bold.<br><br>The biggest issues I've seen so far with Uniscribe is:<br>1. How do you safely break text into runs of different styles, and wrap that text across lines?<br><br>2. Do you have to reflow everything at the paragraph level? Or can you do it at the run level after it has been broken?<br><br>3. How do you safely break lines when you need to wrap them?</div>
<p><a id="501712" href="#501712">#</a> <strong>Michael S. Kaplan</strong> on Thursday, December 08, 2005 3:16 PM:</p><div style="margin-left: 1em">Of course a sample like that can be huge (look at how big the Wordpad sample on MSDN is -- it is nearly impossible to suss out individual function usage techniques from such samples!).</div>
<p><a id="502113" href="#502113">#</a> <strong>Simon Cooke</strong> on Friday, December 09, 2005 2:09 PM:</p><div style="margin-left: 1em">True, but the thing is, without such a sample, Uniscribe is useless to developers unless they're writing single-line, single-format, single-font text. For which you may as well use a static text control, as it does it all for you.<br><br>I'm trying to write script-editing software that handles all languages, not just latin ones. If I wasn't hell-bent on doing it the right way, I could just force ASCII on everyone and say screw it.<br><br>Heck, I'd settle for simple examples of things like:<br><br>What do you do when you have to break a line because someone typed over a line's worth of random characters?<br><br>You know, edge cases like that.<br><br>Or even just simple answers to the second two questions.</div>
<p><a id="502726" href="#502726">#</a> <strong>Michael S. Kaplan</strong> on Monday, December 12, 2005 10:26 AM:</p><div style="margin-left: 1em">Hmmm..... well, the existing sample covers a great deal of that sort of thing, right?</div>
<p><a id="505674" href="#505674">#</a> <strong>Stephanie Legault</strong> on Monday, December 19, 2005 6:06 PM:</p><div style="margin-left: 1em">I think more Uniscribe samples are an excellent idea.  For one, I didn't even *know* about Uniscribe until one of my co-workers told me about it.  And even then, at first we didn't realize that it could provide the functionality that we needed.<br><br>I have to write a UI for doing spell checking in multiple types of editors in our product.  We support multiple spell check languages (through Proximity).  This requires complex, multi-lingual word break functionality (to parse words, to spell check them.)  Because I played around with the CRichEditCtrl to start, I've found that the FindWordBreak() functionality does not provide the control and information I need.  <br><br>To whit, I need an API to provide detailed information on individual characters (are they word breaks, line breaks, etc.)  The Uniscribe library seems to provide this through ScriptBreak().  I'm still in the process of trying out the APIs because these APIs are complicated to call.  Thus the need for examples.  You have to pass in outputs of other functions, sometimes multiple structures, etc.  Fairly complex.  An example would have saved me what will probably take several hours to produce, and I'll probably end up with 10 lines of code, at most.<br><br>I don't need a full text editor as an example.  I just wish that each function had an associated example of how to call the function and maybe how to use its output.<br><br>My two cents.<br></div>
<p><a id="5516480" href="#5516480">#</a> <strong>John Daggett</strong> on Thursday, October 18, 2007 9:31 PM:</p><div style="margin-left: 1em"><p>Buried in the bowels of Mozilla code is code that handles complex script rendering code using Uniscribe:</p>
<p><a rel="nofollow" target="_new" href="http://lxr.mozilla.org/seamonkey/source/gfx/thebes/src/gfxWindowsFonts.cpp#1566">http://lxr.mozilla.org/seamonkey/source/gfx/thebes/src/gfxWindowsFonts.cpp#1566</a></p>
<p>There's also additional code that scans the list of fonts in the system and reads the cmap tables of each font:</p>
<p><a rel="nofollow" target="_new" href="http://lxr.mozilla.org/seamonkey/source/gfx/thebes/src/gfxWindowsPlatform.cpp">http://lxr.mozilla.org/seamonkey/source/gfx/thebes/src/gfxWindowsPlatform.cpp</a></p>
<p>Should be fairly useful to someone looking at how Uniscribe is used in practice.</p>
<p>The &quot;CVS Blame&quot; link at the top of the page provides a way to see the checkin history per-line. &nbsp;Hovering over the checkin number will show the bug number related to the change. &nbsp;Looking through these bugs can also provide a lot of insight into specific problems encountered, especially obscure problems with complex scripts.</p></div>
<hr/><p><em>referenced by</em></p><div style="margin-left: 1em"><p>2008/08/28 <a href="http://archives.miloush.net/michkap/archive/2008/08/28/8902084.html">A technology is worth: $0; A sample showing how to use it: $0; A debug-able sample: Priceless!</a></p><p>2007/07/05 <a href="http://archives.miloush.net/michkap/archive/2007/07/05/3696290.html">Those Uniscribe samples from 'the hardest working ISV in complex scripts'</a></p><p>2007/03/30 <a href="http://archives.miloush.net/michkap/archive/2007/03/30/1997518.html">Determining if a font is gonna get it done</a></p><p>2006/03/11 <a href="http://archives.miloush.net/michkap/archive/2006/03/11/549657.html">Was someone still looking for Uniscribe samples?</a></p><p>2006/02/15 <a href="http://archives.miloush.net/michkap/archive/2006/02/15/531653.html">Mixing MLang and Uniscribe</a></p></div><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2005/12/06/500690.html" title="Sample usage of the FindNLSString function">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2005/12/06/500475.html" title="Questions about the unit and record separators">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2005-12">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2005-12-06">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2005/12/06/500485.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:40 GMT -->
</html>