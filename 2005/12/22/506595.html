<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2005/12/22/506595.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:40 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>New in Windows Vista: OrdinalIgnoreCase for Win32</title></head><body>
<h1>New in Windows Vista: OrdinalIgnoreCase for Win32</h1>
<p><em>by Michael S. Kaplan, published on 2005/12/22 10:01 -05:00, original URI: http://blogs.msdn.com/b/michkap/archive/2005/12/22/506595.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<P><FONT face=Tahoma>I have talked many times in the past about Ordinal and OrdinalIgnoreCase sorting behavior and when you might want to use it (such as <a href="http://archives.miloush.net/michkap/archive/2004/12/29/344136.html">here</A> and <a href="http://archives.miloush.net/michkap/archive/2005/04/13/407823.html">here</A> and especially <a href="http://archives.miloush.net/michkap/archive/2005/07/05/435709.html">here</A>, for example).</FONT></P>
<P><FONT face=Tahoma>I went to great lengths to point how the reason that the managed 'OrdinalIgnoreCase' functionality was important to help mimic the OS behavior with regard to symbolic identifiers.</FONT></P>
<P><FONT face=Tahoma>Of course there was one problem: no Win32 function exists that allows support for this type of comparison. So the actual platform that needed the behavior required some extra work to actually happen.</FONT></P>
<P><FONT face=Tahoma>Now it isn't much work, but still...</FONT></P>
<P><FONT face=Tahoma>Anyway, that all changes in Vista, with the new <A href="http://msdn.microsoft.com/library/en-us/intl/nls_CompareStringOrdinal.asp">CompareStringOrdinal</A> function we have added to the NLS API.</FONT></P>
<P><FONT face=Tahoma>The documentation notes all of the various linguistic types of comparisons that the function does NOT handle, so that people can work to get the behavior they want, depending on what they are trying to do.</FONT></P>
<P><FONT face=Tahoma>So now that we can get the answer for Windows and the .NET Framework, all we need is a&nbsp;faster way to make the SQL Server binary collations have this&nbsp;admittedly un-natural&nbsp;comaprison&nbsp;behavior as well!</FONT></P>
<P><FONT face=Tahoma></FONT>&nbsp;</P>
<P><FONT face=Tahoma><FONT color=#ff1493><EM>This post brought to you by</EM> "<FONT face="Arial Unicode MS" size=3>Æ©</FONT>" <EM>(<A href="http://www.fileformat.info/info/unicode/char/01a9">U+01a9</A>, a.k.a. LATIN CAPITAL LETTER ESH)</EM></FONT></FONT></P>
<hr/><p><a id="506798" href="#506798">#</a> <strong>Mihai</strong> on 22 Dec 2005 12:59 PM:</p><div style="margin-left: 1em">Correction for the CompareStringOrdinal documentation (following the link in your post):<br>&quot;it will it will test all code points&quot;<br></div>
<p><a id="506805" href="#506805">#</a> <strong>Michael S. Kaplan</strong> on 22 Dec 2005 1:12 PM:</p><div style="margin-left: 1em">Yes, hypothetically that should be 'code units' though the fact that almost no one outside the world of Unicode geekdom would understand what that is (and the number of people who would understand it correctly outnumber the group who would not!).</div>
<p><a id="506817" href="#506817">#</a> <strong>Michael S. Kaplan</strong> on 22 Dec 2005 1:45 PM:</p><div style="margin-left: 1em">In case people were wondering, this function is indeed a wrapper around the RtlCompareUnicodeString function I have mentioned before. :-)</div>
<p><a id="506824" href="#506824">#</a> <strong>kevinowen</strong> on 22 Dec 2005 2:05 PM:</p><div style="margin-left: 1em">I think Mihai was referring to the fact that &quot;it will&quot; appears twice...</div>
<p><a id="506832" href="#506832">#</a> <strong>Michael S. Kaplan</strong> on 22 Dec 2005 2:19 PM:</p><div style="margin-left: 1em">Yikes, I missed that one entirely (the one I mentioned had been a discussion point, so I immediately assumed that was it)!<br><br>Ah well, good report, thanks to both of you. :-)</div>
<hr/><p><em>referenced by</em></p><div style="margin-left: 1em"><p>2007/10/12 <a href="http://archives.miloush.net/michkap/archive/2007/10/12/5396685.html">That function is always faster! (well, except for that one case when it can actually be slower...)</a></p><p>2006/05/24 <a href="http://archives.miloush.net/michkap/archive/2006/05/24/605599.html">Invariant vs. Ordinal, the third</a></p><p>2006/05/12 <a href="http://archives.miloush.net/michkap/archive/2006/05/12/595861.html">Don't use lstrcmp if you don't need it</a></p><p>2006/03/02 <a href="http://archives.miloush.net/michkap/archive/2006/03/02/542395.html">CompareString ignores case by lowercasing....</a></p></div><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2005/12/23/506887.html" title="What Unicode version do you support?">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2005/12/22/506590.html" title="We can&#39;t win when it comes to those pesky standards, can we?">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2005-12">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2005-12-22">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2005/12/22/506595.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:40 GMT -->
</html>