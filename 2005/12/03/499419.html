<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2005/12/03/499419.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:40 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>When even the bugs seem cool</title></head><body>
<h1>When even the bugs seem cool</h1>
<p><em>by Michael S. Kaplan, published on 2005/12/03 03:01 -05:00, original URI: http://blogs.msdn.com/b/michkap/archive/2005/12/03/499419.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<P><FONT face=Tahoma>Back in the July 2005 post entitled <STRONG><a href="http://archives.miloush.net/michkap/archive/2005/07/09/437063.html">Getting Intermediate Forms</A></STRONG>, I talked about these middle forms that are not quite Unicode normalization Form C and not quite Form D.</FONT></P>
<P><FONT face=Tahoma>By the rules of Unicode it should not matter -- all three have a canonical equivalence, which means that all of them must be treated as if they were the same string.</FONT></P>
<P><FONT face=Tahoma>Of course as I pointed out in my <STRONG><a href="http://archives.miloush.net/michkap/archive/2005/11/15/492301.html">Sorting It All Out to Search Engines</A></STRONG> post in November 2005, not everyone seems to be following those rules just yet -- I'd say that Google is probably the worst offender given that it is the de facto web search engine in so many people's minds, but Microsoft is a good runner-up as the worst offender since it is trying to make&nbsp;a name for itself here, too.</FONT></P>
<P><FONT face=Tahoma>Note that they are both <A href="http://www.unicode.org/consortium/memblogo.html">members of the Unicode Consortium</A>, though currently Google is only an Associate member so perhaps they do not feel as invested in using the Unicode Standard just yet. :-)</FONT></P>
<P><FONT face=Tahoma>(But anyway, that is a topic for another day. And believe me when I say it is for the Microsoft search folks -- their bug is not the cool one, here!)</FONT></P>
<P><FONT face=Tahoma>Now </FONT><FONT face=Tahoma>Microsoft supports Unicode normalization in Whidbey (as I pointed out in January 2005 in&nbsp;the <a href="http://archives.miloush.net/michkap/archive/2005/01/31/363701.html"><STRONG>FoldString.NET</STRONG></A> post). And it is also supported in unmanaged code, both in <A href="http://msdn.microsoft.com/library/en-us/intl/nls_Normalization.asp">Vista</A> and in the <a href="http://archives.miloush.net/michkap/archive/2005/08/20/454144.html"><STRONG>Internationalized Domain Names Mitigation APIs</STRONG></A> package.</FONT></P>
<P><FONT face=Tahoma>(So the tools exist for the MS Search folks to support this requirement!)</FONT></P>
<P><FONT face=Tahoma>And it has 100% respect for the Unicode rules about canonically equivalent strings and doing that complete conversion without the intermediate forms between normalization forms C and D.</FONT></P>
<P><FONT face=Tahoma>Though a minor hiccup was reported with the compatibility equivalences that affects normalization form KC.... and that minor hiccup comes into play when you think about <a href="http://archives.miloush.net/michkap/archive/2005/09/14/463569.html"><STRONG>the four forms of Korean encoded into the Unicode Standard</STRONG></A>.</FONT></P>
<P><FONT face=Tahoma>So let us take for example the two Unicode characters ㄱㅏ&nbsp;(<A href="http://www.fileformat.info/info/unicode/char/3131">U+3131</A> <A href="http://www.fileformat.info/info/unicode/char/314f">U+314f</A>).</FONT></P>
<P><FONT face=Tahoma><A href="http://www.fileformat.info/info/unicode/char/3131">U+3131</A> (ㄱ, HANGUL LETTER KIYEOK) has a compatibility equivalence&nbsp;to <A href="http://www.fileformat.info/info/unicode/char/1100">U+1100</A> (<FONT face="Times New Roman">ᄀ</FONT>, HANGUL CHOSEONG KIYEOK).</FONT></P>
<P><FONT face=Tahoma><A href="http://www.fileformat.info/info/unicode/char/314f">U+314f</A> (ㅏ, HANGUL LETTER A) has a compatibility equivalance to <A href="http://www.fileformat.info/info/unicode/char/1161">U+1161</A> (<FONT face="Times New Roman">ᅡ</FONT>, HANGUL JUNGSEONG A).</FONT></P>
<P><FONT face=Tahoma>And <FONT face="Times New Roman">가</FONT>&nbsp;(<A href="http://www.fileformat.info/info/unicode/char/1100">U+1100</A> <A href="http://www.fileformat.info/info/unicode/char/1161">U+1161</A>), if converted to normalization form C, becomes 가 (<A href="http://www.fileformat.info/info/unicode/char/ac00">U+ac00</A>, the first precomposed Hangul syllable).</FONT></P>
<P><FONT face=Tahoma>Now if you convert <A href="http://www.fileformat.info/info/unicode/char/3131">U+3131</A> <A href="http://www.fileformat.info/info/unicode/char/314f">U+314f</A>&nbsp;to normalization form KD, you will get <A href="http://www.fileformat.info/info/unicode/char/1100">U+1100</A> <A href="http://www.fileformat.info/info/unicode/char/1161">U+1161</A>&nbsp;as expected.</FONT></P>
<P><FONT face=Tahoma>And now here comes the bug -- if you convert <A href="http://www.fileformat.info/info/unicode/char/3131">U+3131</A> <A href="http://www.fileformat.info/info/unicode/char/314f">U+314f</A>&nbsp;to normalization form KC, you also get <A href="http://www.fileformat.info/info/unicode/char/1100">U+1100</A> <A href="http://www.fileformat.info/info/unicode/char/1161">U+1161</A>, rather than <A href="http://www.fileformat.info/info/unicode/char/ac00">U+ac00</A>.</FONT></P>
<P><FONT face=Tahoma>Oops!</FONT></P>
<P><FONT face=Tahoma>Of course if you convert again (either to KC or C) you will get <A href="http://www.fileformat.info/info/unicode/char/ac00">U+ac00</A>&nbsp;as expected. And to be honest you probably shouldn't be using those compatibility forms anyway. Plus it is not like <A href="http://www.fileformat.info/info/unicode/char/1100">U+1100</A> <A href="http://www.fileformat.info/info/unicode/char/1161">U+1161</A>&nbsp;is actually an intermediate form or anything.</FONT></P>
<P><FONT face=Tahoma>It just struck me as kind of a cool bug when it was discovered, one the developer who owned the code and a Unicode geek (me) were both able to understand what was going on&nbsp;before even looking at the code to see what the reason might be (I think the code owner probably even knew of the underlying problem before he looked at it -- this is just one of those kind of bugs).</FONT></P>
<P><FONT face=Tahoma>Anyway, it will be fixed in Vista and probably in the next Whidbey and IDN Tools updates. And I guess it was pretty obscure anyway. I still find this kind of bug to be cool for reasons I cannot completely define....</FONT></P>
<P><FONT face=Tahoma>Kind of&nbsp;a fun job when even the bugs are cool. :-)</FONT></P>
<P><FONT face=Tahoma></FONT>&nbsp;</P>
<P><FONT face=Tahoma><FONT color=#ff1493><EM>This post brought to you by </EM>"ㄱ"&nbsp;<EM>(</EM><EM><A href="http://www.fileformat.info/info/unicode/char/3131">U+3131</A></EM><EM>, a.k.a.&nbsp;HANGUL LETTER KIYEOK)</EM></FONT></FONT></P>
<hr/><p><a id="499754" href="#499754">#</a> <strong>Syrian</strong> on 3 Dec 2005 12:29 PM:</p><div style="margin-left: 1em">Ha ha ha. Check out abecedaria.blogspot.com<br><br>Suzanne is like your biggest fan or something and even she has to use Firefox instead of Internet Exploder.<br><br>Serves as an excellent example to motivate the question: When will Microsoft take international issues seriously inside their products instead of just pontificating at great length about them on blogs.</div>
<p><a id="499762" href="#499762">#</a> <strong>Michael S. Kaplan</strong> on 3 Dec 2005 1:27 PM:</p><div style="margin-left: 1em">Hard to say, I am running XP SP2, Server 2003 SP1, and random daily builds of Vista, and I almost never have problems with things working well in IE.<br><br>(note that the search bug is a problem with SEARCH and the other bug is ours -- so none of them are IE bugs)<br><br>So I think I will stick with IE until I actually have a reason to switch....</div>
<p><a id="499764" href="#499764">#</a> <strong>Michael S. Kaplan</strong> on 3 Dec 2005 1:29 PM:</p><div style="margin-left: 1em">But beyond that, Syrian -- I guess I am the target of the criticism since I am the primary pontificator on international issues. But I blog about actual features and bugs in MS products along with all that pontification, and am on a team with hundreds of people on it -- so what makes you think MS does not take international issues seriously?</div>
<hr/><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2005/12/03/499661.html" title="The default character is not always the question mark">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2005/12/02/498889.html" title="Getting out of dodge (or at least out of the compatibility range!)">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2005-12">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2005-12-03">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2005/12/03/499419.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:40 GMT -->
</html>