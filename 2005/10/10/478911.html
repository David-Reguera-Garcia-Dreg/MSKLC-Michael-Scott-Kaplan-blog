<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2005/10/10/478911.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:40 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>Console attributes that only relate to CJK</title></head><body>
<h1>Console attributes that only relate to CJK</h1>
<p><em>by Michael S. Kaplan, published on 2005/10/10 03:01 -04:00, original URI: http://blogs.msdn.com/b/michkap/archive/2005/10/10/478911.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<P><FONT face=Tahoma>Back in February of this year, KJK::Hyperion asked:</FONT></P>
<BLOCKQUOTE dir=ltr style="MARGIN-RIGHT: 0px">
<P><FONT size=2><EM>Michael, do you happen to know what these console character attributes are _really_ for? <BR><BR>COMMON_LVB_LEADING_BYTE <BR>COMMON_LVB_TRAILING_BYTE <BR>COMMON_LVB_GRID_HORIZONTAL <BR>COMMON_LVB_GRID_LVERTICAL <BR>COMMON_LVB_GRID_RVERTICAL <BR>COMMON_LVB_REVERSE_VIDEO <BR>COMMON_LVB_UNDERSCORE <BR><BR>The only real information I've found is a KB article ( </EM></FONT><A href="http://support.microsoft.com/default.aspx?scid=kb;en-us;145925" target=_new><FONT size=2><EM>http://support.microsoft.com/default.aspx?scid=kb;en-us;145925</EM></FONT></A><FONT size=2><EM> ) explaining that they won't be supported in Windows 95, but it doesn't say a lot about them, and no mention of "keisen ruled lines" anywhere else on the internet. Any idea?</EM></FONT></P></BLOCKQUOTE>
<P><FONT face=Tahoma>And then just last month, Robert Hodge asked the same question:</FONT></P>
<BLOCKQUOTE dir=ltr style="MARGIN-RIGHT: 0px">
<P><EM><FONT size=2>Do you know of any way to get characters to take an underscore attribute when being used by a Win32 Console application? The MSDN documentation for SetConsoleTextAttribute and CHAR_INFO (etc.) talks about an attribute called COMMON_LVB_UNDERSCORE, which is used like a 'color' setting and is used to get characters underlined, but it supposedly is associated with DBCS. I have tried using it but without success. I am considering a fallback strategy of altering a font to include pre-underlined characters, but that would be a lot of work. Any ideas? Thanks. </FONT></EM></P></BLOCKQUOTE>
<P><FONT face=Tahoma>Unfortunately, the documentation is correct -- this particular feature is only supported in CJK (Chinese, Japanese, Korean) contexts.</FONT></P>
<P><FONT face=Tahoma>Rich support of text is something better suited to non-console applications. These attributes are not generally available.&nbsp;Sorry!</FONT></P>
<P><FONT face=Tahoma></FONT>&nbsp;</P>
<P><FONT face=Tahoma color=#ff1493><EM>This post brought to you by</EM> "‚óè" <EM>(<A href="http://www.fileformat.info/info/unicode/char/25cf/index.htm">U+25cf</A>, a.k.a. BLACK CIRCLE)</EM></FONT></P>
<hr/><p><a id="479617" href="#479617">#</a> <strong>KJK::Hyperion</strong> on 11 Oct 2005 11:04 AM:</p><div style="margin-left: 1em">I was more interested in their meaning, since it isn't documented anywhere and back then I was writing a clone of the Windows console :-)</div>
<p><a id="494937" href="#494937">#</a> <strong>Robert Hodge</strong> on 19 Nov 2005 10:09 PM:</p><div style="margin-left: 1em">This is a followup question about console font indexes and font names.<br><br>I am able to call GetCurrentConsoleFont function and it seems to work.  I get back a value of 14 as the console font index.  My question is, can I convert a font index to a font face name?  On my system, Lucida Console has a font index of 14.  So how do I go from an index of 14 to a face name of &quot;Lucida Console&quot; ?  I want to know this so that I can go back and make a query on the currently active font, if a truetype font, to check if certain unicode ranges are present in the given font.  (I care about unicode font ranges because I have chosen to use the unicode &quot;full width forms&quot; region to store pre-underscored ASCII character glyphs; I need to know if the current font is one I have hacked so that if I use such characters, they won't show up as blanks if they aren't defined.) But I can't do that if I don't know what the current console font's name is.  Any clue how to do this?<br><br>Thanks,<br>Robert Hodge<br></div>
<p><a id="494972" href="#494972">#</a> <strong>Michael S. Kaplan</strong> on 20 Nov 2005 5:11 AM:</p><div style="margin-left: 1em">I think you will need to call the GetCurrentConsoleFontEx function to get the name here.</div>
<p><a id="496522" href="#496522">#</a> <strong>Robert Hodge</strong> on 23 Nov 2005 8:11 PM:</p><div style="margin-left: 1em">GetCurrentConsoleFontEx would be a good choice if I were running XP, but I need this to run on Win2K also, and that doesn't have GetCurrentConsoleFontEx.  Any guess how I could achieve the functionality of GetCurrentConsoleFontEx in Win2K ?</div>
<p><a id="496525" href="#496525">#</a> <strong>Michael S. Kaplan</strong> on 23 Nov 2005 8:49 PM:</p><div style="margin-left: 1em">Hmmm... you've got me, I have no idea, really. :-(</div>
<hr/><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2005/10/11/479301.html" title="Miss Manners probably did not cover this one">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2005/10/10/478582.html" title="426 e-mails">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2005-10">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2005-10-10">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2005/10/10/478911.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:40 GMT -->
</html>