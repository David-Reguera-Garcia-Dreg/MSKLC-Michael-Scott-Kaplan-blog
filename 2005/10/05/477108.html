<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2005/10/05/477108.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:41 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>How to track down collation bugs</title></head><body>
<h1>How to track down collation bugs</h1>
<p><em>by Michael S. Kaplan, published on 2005/10/05 03:01 -04:00, original URI: http://blogs.msdn.com/b/michkap/archive/2005/10/05/477108.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<P><FONT face=Tahoma>Every once in a while, it nice to be able to blog about something I am working on while I am working on it. And over the past few days I have been clearing out a bunch of small bugs in collation edge cases, the earliest of which was reported back in 2001.</FONT></P>
<P><FONT face=Tahoma>It occurred to me that there is a pattern I can use to narrow down where in the code the problem might be before I even look at the code. This is a good thing not because I am lazy but because there is a lot of code there....</FONT></P>
<P><FONT face=Tahoma>So I thought it would be nice to lay out a lot of these issues in as post.</FONT></P>
<P><FONT face=Tahoma>If this does not seem interesting to you, then you can probably move on at this point. :-)</FONT></P>
<P><FONT face=Tahoma>Anyway, without furth adieu, the LIST -- worded as if&nbsp;one had a specific problem with sorting results and wanted to figure out the cause:</FONT></P>
<OL>
<LI><FONT face=Tahoma>Does it happen only in a specific software product or products&nbsp;(e.g.&nbsp;Word 2000, Excel 2002, Access (any version), SQL Server)?</FONT><FONT face=Tahoma> 
<LI><FONT face=Tahoma>Does it happen only in Windows?</FONT> 
<LI>Does it happen only in Explorer (the Windows Shell)? 
<LI>Does it happen if you switch string1 and string2? 
<LI>Does it happen only with certain locales? 
<LI>Does it happen only when you pass -1 for the string length parameters? 
<LI>Does it happen only when you pass explicit lengths for the string length parameters? 
<LI>Does it happen only with the Korean locale? 
<LI>Does it happen only with Jamo, Kana, Extension A, or other specific interesting subranges of Unicode? 
<LI>Does it happen only when particular NORM_IGNORE* flags are passed? 
<LI>Does it happen only when SORT_STRINGSORT is passed? 
<LI>Does something different happen if you use LCMapString on each string to get two sort keys and then compare <EM>them</EM>, instead? 
<LI>Does something different happen if you perform the same comparison on an older or newer version of Windows? 
<LI>Does something different happen if you make the same comparisons in the .NET Framework? 
<LI>Does it happen only with certain kinds of characters?</LI></OL>
<P>You can probably think of some specific issues that each of these problems might imply....</P>
<P>Anyway, back to bugs!</P>
<P>&nbsp;</P>
<P><FONT color=#ff1493><EM>This post brought to you by</EM> "<FONT size=6>∂</FONT>" <EM>(<A href="http://www.fileformat.info/info/unicode/char/2202/index.htm">U+2202</A>, a.k.a. PARTIAL DIFFERENTIAL)</EM></FONT></P></FONT>
<hr/><div style="margin-left: 1em"><em>no comments</em></div><hr/><p><em>referenced by</em></p><div style="margin-left: 1em"><p>2010/09/07 <a href="http://archives.miloush.net/michkap/archive/2010/09/07/10058112.html">Refusing to ignore some particular character's width isn't [always] an act of discrimination…</a></p><p>2007/10/09 <a href="http://archives.miloush.net/michkap/archive/2007/10/09/5375754.html">A&P of Sort Keys, part 13 (About the function that is too lazy to get it right every time)</a></p><p>2006/03/30 <a href="http://archives.miloush.net/michkap/archive/2006/03/30/564598.html">If at first you don't succeed, there's probably still a bug</a></p></div><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2005/10/05/477190.html" title="AD, and a little KB confusion">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2005/10/04/477199.html" title="How to avoid stepping in it">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2005-10">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2005-10-05">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2005/10/05/477108.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:41 GMT -->
</html>