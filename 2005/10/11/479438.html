<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2005/10/11/479438.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:40 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>How to know whether to go with the old or the new?</title></head><body>
<h1>How to know whether to go with the old or the new?</h1>
<p><em>by Michael S. Kaplan, published on 2005/10/11 03:31 -04:00, original URI: http://blogs.msdn.com/b/michkap/archive/2005/10/11/479438.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<P><FONT face=Tahoma>I believe I have mentioned before (perhaps in passing) about how WinForms 2.0 is not locked into using GDI+ for it text rendering.</FONT></P>
<P><FONT face=Tahoma>This is really a good thing since the GDI+ text shaping engines&nbsp;have not been updated for some time, and every new lanaguage requiring a rendering engine added since&nbsp;XP SP2 (not to mention all of the shaping engines that have been updated since then) have been unvailable in GDI+. So the world is moving ahead and should not be held back here.</FONT></P>
<P><FONT face=Tahoma>With that said, although I am 100% in favor of progress and getting the latest language support, I am not dumb enough to think that this is the only consideration. :-)</FONT></P>
<P><FONT face=Tahoma>Luckily for all of us, the WinForms team isn't either!</FONT></P>
<P><FONT face=Tahoma>In order to know who wins the battle for which method to call:</FONT></P>
<UL>
<LI><FONT face=Tahoma>the old <A href="http://winfx.msdn.microsoft.com/library/en-us/cpref/html/O_T_System_Drawing_Graphics_MeasureString.asp">Graphics.MeasureString</A>&nbsp;versus the new <A href="http://winfx.msdn.microsoft.com/library/en-us/cpref/html/O_T_System_Windows_Forms_TextRenderer_MeasureText.asp">TextRenderer.MeasureText</A>;</FONT> 
<LI><FONT face=Tahoma>the old <A href="http://winfx.msdn.microsoft.com/library/en-us/cpref/html/O_T_System_Drawing_Graphics_DrawString.asp">Graphics.DrawString</A>&nbsp;versus the new <A href="http://winfx.msdn.microsoft.com/library/en-us/cpref/html/O_T_System_Windows_Forms_TextRenderer_DrawText.asp">TextRenderer.DrawText</A>;</FONT></LI></UL>
<P><FONT face=Tahoma>there is a (settable!) <A href="http://winfx.msdn.microsoft.com/library/en-us/cpref/html/P_System_Windows_Forms_Label_UseCompatibleTextRendering.asp">UseCompatibleTextRendering</A> property on the various WinForms controls that tells the .NET Framework whether to be compatible with what was or to&nbsp;embrace what is and what will be.</FONT></P>
<P><FONT face=Tahoma>And as a bonus (this info from the inestimable <a href="http://blogs.msdn.com/jfoscoding/">Jessica Fosler</A>!), you can use Label.GetPreferredSize(proposedConstraints) to correctly switch between GDI/Uniscribe and GDI+.</FONT></P>
<P><FONT face=Tahoma>And <EM>Bravo</EM> to&nbsp;all of the folks on the WinForms team for developing an clever and innovative solution with the ability to support full backwards compatibility....</FONT></P>
<P><FONT face=Tahoma>Awesome!</FONT></P>
<P><FONT face=Tahoma></FONT>&nbsp;</P>
<P><FONT face=Tahoma color=#ff1493><EM>This post brought to you by</EM> "<FONT face="Mongolian Baiti" size=6>саж</FONT>" <EM>(<A href="http://www.fileformat.info/info/unicode/char/1826/index.htm">U+1826</A>, MONGOLIAN LETTER UE)<BR><FONT size=1>A letter whose WinForms story is significantly enhanced when combining version 2.0 and Vista!</FONT></EM></FONT></P>
<hr/><p><a id="479598" href="#479598">#</a> <strong>Mike</strong> on 11 Oct 2005 10:30 AM:</p><div style="margin-left: 1em">Also, according to the help page you mentioned, UseCompatibleTextRendering is a compiler switch, which is even better so you don't have to muck around with setting individual properties on each control.</div>
<p><a id="479599" href="#479599">#</a> <strong>Mike</strong> on 11 Oct 2005 10:37 AM:</p><div style="margin-left: 1em">or another way of doing it: <br><br>Application.SetCompatibleTextRenderingDefault will change the default for every control in the application.  </div>
<p><a id="479606" href="#479606">#</a> <strong>Michael S. Kaplan</strong> on 11 Oct 2005 10:49 AM:</p><div style="margin-left: 1em">Ah, two excellent points, Mike -- they definitely make the global setting story easier to manage!</div>
<p><a id="479648" href="#479648">#</a> <strong>Jerry Pisk</strong> on 11 Oct 2005 12:20 PM:</p><div style="margin-left: 1em">So doest GDI+ is a dead end project that has already been abandoned and our code would be better off never to use it?</div>
<p><a id="479651" href="#479651">#</a> <strong>Michael S. Kaplan</strong> on 11 Oct 2005 12:26 PM:</p><div style="margin-left: 1em">Hi Jerry,<br><br>I cannot speak to that knowledgeably, because I am not involved with that team's plans. But the GIFT team builds the shaping engines consumed by both GDI/Uniscribe and Avalon -- and there is no move to update the shaping engines. There may be other aspects of GDI+ unrelated to text that are incredibly useful?</div>
<hr/><p><em>referenced by</em></p><div style="margin-left: 1em"><p>2006/05/28 <a href="http://archives.miloush.net/michkap/archive/2006/05/28/609369.html">Mirror, mirror... before whom I fuss, does mirroring work well in GDI+?</a></p></div><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2005/10/11/479581.html" title="I love a good typography joke">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2005/10/11/479301.html" title="Miss Manners probably did not cover this one">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2005-10">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2005-10-11">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2005/10/11/479438.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:40 GMT -->
</html>