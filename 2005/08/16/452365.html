<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2005/08/16/452365.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:41 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>The .NET Framework is not Windows (and vice versa)</title></head><body>
<h1>The .NET Framework is not Windows (and vice versa)</h1>
<p><em>by Michael S. Kaplan, published on 2005/08/16 17:45 -04:00, original URI: http://blogs.msdn.com/b/michkap/archive/2005/08/16/452365.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<P><FONT face=Tahoma>The title of this post seems like such an obvious point, but people have a tendency to mix them up. Now in fairness to these people, it is largely due to the integration that has been done to help them work together. Still, I am often left wondering how people trip over this fundamental issue. For example, this was something in my inbox recently:</FONT></P>
<BLOCKQUOTE dir=ltr style="MARGIN-RIGHT: 0px">
<P><FONT face=Tahoma size=2><EM>Can you point me to a way of how to change user locale at run time using C#? I made few trials like: </EM></FONT></P>
<P><FONT face=Tahoma size=2><FONT face="Courier New">Thread.CurrentThread.CurrentUICulture = new CultureInfo("de-DE")</FONT> <EM>but it did not seem to work.</EM></FONT></P>
<P><FONT face=Tahoma size=2><EM>I needed this for automation purposes.</EM></FONT></P></BLOCKQUOTE>
<P><FONT face=Tahoma>Now of course this code will not affect the user locale or the current culture (it will affect the "UICulture" which is to say the language in which the UI might be localized. But I honestly did not know if what was wanted here was fof unmanaged or managaed code. So I chose to answer for both:</FONT></P>
<BLOCKQUOTE dir=ltr style="MARGIN-RIGHT: 0px">
<P><FONT face=Tahoma size=2><EM>If you want the managed thing, you want CurrentCulture, not CurrentUICulture.</EM></FONT></P>
<P><FONT face=Tahoma size=2><EM>If you want the unmanaged thingB, you want </EM></FONT><A href="http://support.microsoft.com/?kbid=289125"><FONT face=Tahoma size=2><EM>http://support.microsoft.com/?kbid=289125</EM></FONT></A></P></BLOCKQUOTE>
<P><FONT face=Tahoma>But we were not out of the woods just yet -- since the association of the user locale being a part of the <EM>unmanaged</EM> world was not being made:</FONT></P>
<BLOCKQUOTE dir=ltr style="MARGIN-RIGHT: 0px">
<P><FONT face=Tahoma size=2><EM>You are right. Actually, I tried both but user locale did not change. I checked the user locale in the regional settings of the control panel to see the change, but the user locale remain as is. Also, my Excel code did not have effect on locale sensitive areas like calendar and date format after executing the locale change code.</EM></FONT></P>
<P><FONT face=Tahoma size=2><EM>Here some of the other trials I made:</EM></FONT></P>
<P><FONT face="Courier New" size=2>Thread.CurrentThread.CurrentCulture = new CultureInfo("fr-FR") <BR></FONT><FONT face=Tahoma size=2><FONT face="Courier New">Thread.CurrentThread.CurrentCulture = new CultureInfo("fr-FR", true)</FONT> <EM>also tried false<BR></EM></FONT><FONT face=Tahoma size=2><FONT face="Courier New">Thread.CurrentThread.CurrentCulture = new CultureInfo(LCID)</FONT> where LCID <EM>is the hex value for a specific locale</EM></FONT></P>
<P><FONT face=Tahoma size=2><EM>In all of the above cases, there was no compiler error.</EM></FONT></P></BLOCKQUOTE>
<P><FONT face=Tahoma>Ok, at least the problem is&nbsp;clear now -- they were clearly expecting that there was some managed technique that would change the user locale. However that is simply not the case.&nbsp; The various managed code snippets would simply work to change the current culture in the current thread in managed code.</FONT></P>
<P><FONT face=Tahoma>It is true that the&nbsp;"default" setting of the current culture is based on the user locale.&nbsp; But that is one of those common sense integrations between the .Net Framework and Windows; any other default would be unlikely to be correct.&nbsp; This is not however a setting that goes both ways.</FONT></P>
<P><FONT face=Tahoma>To help it be more confusing, you can contrast this with the InputLanguage class. The default is picked up is based on the default for new processes, and if you change the InputLanguage in the thread then that is the selection that will appear in the Windows Language Bar.&nbsp; So in that case, it does appear to go both ways.</FONT></P>
<P><FONT face=Tahoma>In the end, it is hard to say whether a global strategy is being employed for such scenarios -- usually there is not.&nbsp; Each case is taken individually to try to do the right (whatever that means!), and occasionally people note consistency or the lack thereof with one item compared to another.&nbsp; In the specific situation of the keyboard, the Language Bar is&nbsp;representing the currently selected keyword in the thread, which is exactly what was set in the .Net Framework; in a situation like that having the.net framework affect the setting in Windows takes total sense.&nbsp; On the other hand, the user locale is a setting that affects every new process and thread that this user starts.&nbsp; Affecting such a setting based on the value in a property that is clearly meant to represent settings within a single thread would cause a lot more problems than it could ever solve.</FONT></P>
<P><FONT face=Tahoma>Just always try to remember that the .NET Framework and Windows are not the same thing.&nbsp; They are good friends and colleagues who work together and who really try to make things work well, but not every single action that you can do in one can also be done in the other.</FONT></P>
<P><FONT face=Tahoma><FONT color=#ff0000><EM>This post brought to you by</EM> "<FONT size=5>à©«</FONT>" <EM>(<A href="http://www.fileformat.info/info/unicode/char/0a6b/index.htm">U+0a6b</A>, a.k.a. GURMUKHI DIGIT FIVE)</EM></FONT></FONT></P>
<hr/><div style="margin-left: 1em"><em>no comments</em></div><hr/><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2005/08/16/452430.html" title="Program Managers vs. Developers? :-)">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2005/08/16/452036.html" title="It may make my brown eyes blue">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2005-08">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2005-08-16">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2005/08/16/452365.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:41 GMT -->
</html>