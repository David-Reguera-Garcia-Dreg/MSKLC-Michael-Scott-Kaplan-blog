<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2005/08/25/456237.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:41 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>My kingdom for some Unicode controls</title></head><body>
<h1>My kingdom for some Unicode controls</h1>
<p><em>by Michael S. Kaplan, published on 2005/08/25 07:40 -07:00, original URI: http://blogs.msdn.com/michkap/archive/2005/08/25/456237.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostOld -->
<P><FONT face=Tahoma>I have certainly done my share of pushing for Unicode controls in various programming languages on Windows. From the <A href="http://www.unitoolbox.com/">UniToolbox controls</A>&nbsp;link on this very blog to the <A href="http://i18nwithvb.com/">book</A> I wrote for Visual Basic (see Chapter 6 online!) -- this is the one that Joel Spolsky said all of the very nice things about in <A href="http://www.joelonsoftware.com/items/2005/08/10.html">this post</A> and the audio interview it links to (in the interview I was an example, he was mainly talking about how Amazon ratings/comments can be particularly biased/skewed by folks with a "smear tactic" agenda, a point on which I agree with him -- but I usually just filter the anonymous comments to get a more accurate answer!).</FONT></P>
<P><FONT face=Tahoma><EM>(Joel, I'll cover my thoughts on a book in another post!)</EM></FONT></P>
<P><FONT face=Tahoma>Anyway, I am a huge fan of Unicode controls.</FONT></P>
<P><FONT face=Tahoma>In prior versions of VB (&lt;= 6.0) they were only half-Unicode, by which I mean they all had Unicode interfaces but for the most part were wrappers around non-Unicode intrinsic or common controls. Which means a lot of conversions back and forth (and back again in many cases on NT-based platforms since the underlying controls themselves are Unicode!). So you get all of the space and performance penalties of Unicode with none of the benefits (like the Shell Unicode interfaces in Windows 95!).</FONT></P>
<P><FONT face=Tahoma>It was very exciting that in .NET all of the WinForms controls are 100% Unicode any time the OS could support it happening. Even on Win9x all of the owner draw controls still support Unicode, and some of the common controls. You can see some of this in the documentation, like in <A href="http://msdn.microsoft.com/library/en-us/vbcon/html/vbconunicodecharacterdisplayinwfcprojects.asp">this topic</A>:</FONT></P>
<BLOCKQUOTE dir=ltr style="MARGIN-RIGHT: 0px">
<P><FONT size=2>However, certain controls do not support Unicode in Windows 98 and Windows Millennium Edition. These controls, all of which inherit from the common control, will process data with the Windows code pages, as ANSI. These controls are: <B>TabControl</B>, <B>ListView</B>, <B>TreeView</B>, <B>DateTimePicker</B>, <B>MonthCalendar</B>, <B>TrackBar</B>, <B>ProgressBar</B>, <B>ImageList</B>, <B>ToolBar</B>, and <B>StatusBar</B>. The result of this is that you cannot display Unicode data in these controls on the listed platforms. For example, you cannot display Japanese characters on an English Windows 98 system.</FONT></P></BLOCKQUOTE>
<P><FONT face=Tahoma>We'll ignore the technical mistakes here and the fact&nbsp;that it does not mention some of the intrinsic-based controls like the TextBox also have this problem (and especially the fact that some of the common controls actually <STRONG>do</STRONG> support Unicode on Win9x, and will work properly in WinForms!) and concentrate on the issue that there are a few controls which will not support Unicode on Win9x, even in WinForms.</FONT></P>
<P><FONT face=Tahoma>It is easy to get worked up about this, but these days I do not. After all, the only time I ever run Windows 98 or Millenium these days is when I am looking at an MSLU bug, and it has been a long time since one of those has needed a look. And even if the controls fully supported Unicode, usually the fonts would not be there so all you would see is&nbsp;a bunch of square boxes a.k.a. NULL glyphs (��������) which is really not much better in terms of information than a bunch of question marks (????????).</FONT></P>
<P><FONT face=Tahoma>For me it is enough that everything is Unicode whenever it can be. Thats cool.</FONT></P>
<P><FONT face=Tahoma>Now the final frontier is C++ projects -- since so many people still don't create the projects as Unicode ones, and a lot of developers still write that TCHAR code even if they are only writing for NT-based platforms like Win2000 or XP or Server 2003 or Vista -- LPTSTRs and TCHARs, yuck!</FONT></P>
<P><FONT face=Tahoma>In NLS we put our foot down in Windows Server 2003 -- no new NLS API functions will be written with ANSI counterparts. And we're continuing that in Vista. Not everyone has gotten the word on this yet, so we'll need to step up on the "internal evangelism" with other&nbsp;teams and groups. But it should be easier to suggest that people write <EM>less</EM> code, I think -- much easier than to suggest that people need to write twice as many functions and messages!</FONT></P>
<P><FONT face=Tahoma>The old functions will still work, sure. But there is plenty of new functionality like <a href="http://archives.miloush.net/michkap/archive/2005/07/31/445819.html">FindNLSString</A>&nbsp;and <A href="http://msdn.microsoft.com/library/en-us/intl/nls_normalize_string.asp">NormalizeString</A>&nbsp;and lots more that I will be covering in future posts -- and it is Unicode only, like many of the new locales in Vista are.</FONT></P>
<P><FONT face=Tahoma>So if you are writing C/C++ applications, you have to ask yourself if you really want half the world to have to speak fluent question mark to use the products you write?</FONT></P>
<P><FONT face=Tahoma></FONT>&nbsp;</P>
<P><FONT face=Tahoma color=#ff0000><EM>This post brought to you by</EM> "<FONT size=6>ཀ</FONT>" <EM>(<A href="http://www.fileformat.info/info/unicode/char/0f40/index.htm">U+0f40</A>, a.k.a. TIBETAN LETTER KA)<BR><FONT size=1>(A letter that you are probably not looking at a NULL GLYPH for if you are running&nbsp;Vista Beta 1!)</FONT></EM></FONT></P>
<hr/><p><a id="456267" href="#456267">#</a> <strong>Wayne Steele</strong> on Thursday, August 25, 2005 11:33 AM:</p><div style="margin-left: 1em">I'm running XP sp2, and I see the glyph just fine (Kind of like a three-legged PI, with each leg longer than the one to its left).<br></div>
<p><a id="456276" href="#456276">#</a> <strong>TUniverse</strong> on Thursday, August 25, 2005 11:41 AM:</p><div style="margin-left: 1em">Hey there -- <br>Just found your blog the other day and have been enjoying the new knowledge. <br><br>Questions for you: Is your bias against TCHAR and LPTSTRs just a bias against having to support 2 APIs? Or is there more to it than that? In my code, should I not be using the TCHAR and _T() and the likes, and what should I be using instead?</div>
<p><a id="456286" href="#456286">#</a> <strong>Peter Ibbotson</strong> on Thursday, August 25, 2005 11:46 AM:</p><div style="margin-left: 1em">That letter looks ok to me even in WinXP or have I missed something?</div>
<p><a id="456287" href="#456287">#</a> <strong>Michael S. Kaplan</strong> on Thursday, August 25, 2005 11:50 AM:</p><div style="margin-left: 1em">Wayne and Peter -- you must have a font with Tibetan in it on your machine? :-)</div>
<p><a id="456288" href="#456288">#</a> <strong>Michael S. Kaplan</strong> on Thursday, August 25, 2005 11:54 AM:</p><div style="margin-left: 1em">Hey TUniverse -- <br><br>Welcome to the blog!<br><br>My bias is (in part) that it means you have to support two functions, but also because you deal with larger number of languages that the function cannot support, and by doing that extra work you enable developers to write code that will not support those languages, either....<br><br>If you can move away from all that and write purely Unicode applications with L&quot;&quot;, L'', and LPWSTR/WCHAR then I would encourage people to make the jump. Win9x is the past, and Unicode is definitely the way going forward.</div>
<p><a id="456365" href="#456365">#</a> <strong>CornedBee</strong> on Thursday, August 25, 2005 2:07 PM:</p><div style="margin-left: 1em">My dear Linux displays the glyph without problems.<br><br>I agree, the time of ANSI is past. But I still favour wchar_t and std::wstring :)</div>
<p><a id="456391" href="#456391">#</a> <strong>Michael S. Kaplan</strong> on Thursday, August 25, 2005 2:43 PM:</p><div style="margin-left: 1em">I am a huge fan of wchar_t and std::wstring, too. Any type, as long as its Unicode....</div>
<p><a id="456402" href="#456402">#</a> <strong>Jonathan</strong> on Thursday, August 25, 2005 3:16 PM:</p><div style="margin-left: 1em">Perhaps the next version of Visual Studio should create Unicode projects by default?</div>
<p><a id="456405" href="#456405">#</a> <strong>Mihai</strong> on Thursday, August 25, 2005 3:23 PM:</p><div style="margin-left: 1em">From the fonts I have on my system, U+0f40 seems to be present in:<br> - Arial Unicode MS Regular<br> - NSimSun-18030 regular<br> - SimSun-18030 regular<br>The 18030 are part of the GB-18030 support pack, and not many systems have this installed.<br>But Arial Unicode MS (from Office, I thing) is quite a popular one :-)<br></div>
<p><a id="456427" href="#456427">#</a> <strong>CN</strong> on Thursday, August 25, 2005 4:06 PM:</p><div style="margin-left: 1em">Doesn't render as null, it looks like a character. If it's correct, well, I don't know that :-) (WinXP)</div>
<p><a id="456430" href="#456430">#</a> <strong>Jerry Pisk</strong> on Thursday, August 25, 2005 4:18 PM:</p><div style="margin-left: 1em">I have to disagree that Win9x is the past. A lot of customers still use it (25% of our users still use Win9x) and unless you're going to ignore those you have to stick to writing ANSI versions of your code as well. And the easy way is to use TCHAR unless you want to maintain two versions of your code.</div>
<p><a id="456435" href="#456435">#</a> <strong>Michael S. Kaplan</strong> on Thursday, August 25, 2005 4:31 PM:</p><div style="margin-left: 1em">For those still using Win9x, there is MSLU -- and since Win9x does not support new API functions, there is no purpose to new ANSI API functions in the future.</div>
<p><a id="456497" href="#456497">#</a> <strong>Jerry Pisk</strong> on Thursday, August 25, 2005 6:23 PM:</p><div style="margin-left: 1em">MSLU is a very nice thing but trying to convince a large corporation to install it on all their desktops, the ones they are still running on Win95, is simply impossible. Especially since there are a lot of competitors that will be more than happy to stitch together a VB program that will work in their environment. And this is not even anything extreme, we also support a 16-bit versions of some of our products because we have customers that still run Win 3.1 :) Part of the problem is that those people are still supported, by companies like ours, so they have absolutely no need to upgrade.</div>
<p><a id="456501" href="#456501">#</a> <strong>Michael S. Kaplan</strong> on Thursday, August 25, 2005 6:30 PM:</p><div style="margin-left: 1em">Well Jerry, the old functions that work on both Win95 and Vista are still there. But new functions would not help Win95 anyway, so there is no reason to create them just to encourage people to write apps that won't support languages in Vista....</div>
<p><a id="456557" href="#456557">#</a> <strong>Robert</strong> on Thursday, August 25, 2005 9:00 PM:</p><div style="margin-left: 1em">Unicode controls should be used wherever possible. The time of ANSI controls has passed. Personally, I'd like to see Outlook Express use Unicode controls -- currently, no matter which default system locale I have selected, the message list pane in Outlook Express shows many of the mails I receive with garbled subject lines and names.</div>
<p><a id="456644" href="#456644">#</a> <strong>Serge Wautier</strong> on Friday, August 26, 2005 4:35 AM:</p><div style="margin-left: 1em">No earlier than a couple of months ago, I started a small contracting project. The client wanted an app that was world-ready. &quot;I'm glad you ask&quot;, I said, 'because it's the only way I can work :-)&quot;. More seriously, when I told him it was going to be a Unicode app : &quot;I guess you don't care if it doesn't work on 9x ?&quot;.<br>He said &quot;Hhhmmmm... That might be a problem to our clients in the emerging markets.&quot; I don't quite agree: The people in emerging markets who still use 9x for professional use are most likely not his clients.<br><br>But it's OK to me, 'coz MSLU is my friend ! And even if listview controls were used quite extensively, I'm not worried : I believe these users don't go 'cross-codepage'.</div>
<hr/><p><em>referenced by</em></p><div style="margin-left: 1em"><p>2008/06/09 <a href="http://archives.miloush.net/michkap/archive/2008/06/09/8583970.html">But What of Michael?</a></p><p>2006/01/17 <a href="http://archives.miloush.net/michkap/archive/2006/01/17/513635.html">They don't make Null Glyphs like they used to!</a></p><p>2005/08/28 <a href="http://archives.miloush.net/michkap/archive/2005/08/28/457383.html">About [not] writing books</a></p></div><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2005/08/25/456496.html" title="The Milk Bet lives!">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2005/08/24/456021.html" title="The loader without the loaded">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2005-08">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2005-08-25">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2005/08/25/456237.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:41 GMT -->
</html>