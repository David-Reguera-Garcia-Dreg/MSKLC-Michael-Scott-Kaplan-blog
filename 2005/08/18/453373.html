<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2005/08/18/453373.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:41 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>GetDateFormat is Gregorian based</title></head><body>
<h1>GetDateFormat is Gregorian based</h1>
<p><em>by Michael S. Kaplan, published on 2005/08/18 21:15 -04:00, original URI: http://blogs.msdn.com/b/michkap/archive/2005/08/18/453373.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<P><FONT face=Tahoma>The <A href="http://msdn.microsoft.com/library/en-us/intl/nls_5w6s.asp">GetDateFormat</A> function either takes a <A href="http://msdn.microsoft.com/library/en-us/sysinfo/base/systemtime_str.asp">SYSTEMTIME</A> struct or if you pass a NULL for that parameter it uses the <A href="http://msdn.microsoft.com/library/en-us/sysinfo/base/getsystemtime.asp">GetSystemTime</A> function to retrieve the current date in the form of a <A href="http://msdn.microsoft.com/library/en-us/sysinfo/base/systemtime_str.asp">SYSTEMTIME</A> struct.</FONT></P>
<P><FONT face=Tahoma>One weird thing about all of that? Well, <A href="http://msdn.microsoft.com/library/en-us/sysinfo/base/systemtime_str.asp">SYSTEMTIME</A>&nbsp;is Gregorian calendar based.</FONT></P>
<P><FONT face=Tahoma>So even if you have some other calendar selected as the current calendar (or if you specify a locale that has some other calendar as its default), you have to pass the current date as a Gregorian thing in order to format it as something non-Gregorian.</FONT></P>
<P><FONT face=Tahoma>Some people have trouble with this idea conceptually (so luckily this is hidden from all but the developer types, who usually can deal with it okay). But in the end the system has to pivot off of <EM>some</EM> calendar. It is hard to begrudge software for going with the calendar that is the default where the software comes from, originally.</FONT></P>
<P><FONT face=Tahoma>Imagine if it were not true, and every developer who called <A href="http://msdn.microsoft.com/library/en-us/sysinfo/base/getsystemtime.asp">GetSystemTime</A>&nbsp;was required to understand every other calendar in the world, depending on user settings.</FONT></P>
<P><FONT face=Tahoma>Imagine how your code would only work with some user settings and not others!</FONT></P>
<P><FONT face=Tahoma>One thing that is important to remember is my bias -- remember that old post <a href="http://archives.miloush.net/michkap/archive/2005/01/14/353216.html"><STRONG>Calendars on Win32 -- just there for show....</STRONG></A>&nbsp;that kind of explains how the calendars are just for display purposes. The same is true of the dates, which is why everything I have said in this post is basically true.</FONT></P>
<P><FONT face=Tahoma>As an alternative, we could have made all date functions use some kind of system that is indepenent of all calendars and pivot off of that. But imagine doing all that work to make sdure it is harder for everyone to work with the software. I am personally kind of glad that such a decision was not made. :-)</FONT></P>
<P><FONT face=Tahoma></FONT>&nbsp;</P>
<P><FONT face=Tahoma><FONT color=#ff0000><EM>This post brought to you by </EM>"€ù"<EM> (<A href="http://www.fileformat.info/info/unicode/char/06dd/index.htm">U+06dd</A>, ARABIC END OF AYAH)</EM></FONT></FONT></P>
<hr/><p><a id="453393" href="#453393">#</a> <strong>Shaun Bedingfield</strong> on 18 Aug 2005 10:20 PM:</p><div style="margin-left: 1em">Well, I guess Microsoft needs to be more PC and start using fractions of a revolution around the sun to store time and convert that to a date :)  That way they can be safe until we discover aliens or start colonizing other planets.</div>
<p><a id="453432" href="#453432">#</a> <strong>Keith Farmer</strong> on 18 Aug 2005 11:41 PM:</p><div style="margin-left: 1em">Is there a reason for not being able to store the gregorian value for internal use, and let the user use whatever basis desired?<br><br>Sort of like storing time in ticks or Julian Day Numbers, and converting dates internally to those to do calculations.  Astronomers have been doing that for decades.</div>
<p><a id="453435" href="#453435">#</a> <strong>Dean Harding</strong> on 18 Aug 2005 11:46 PM:</p><div style="margin-left: 1em">Wouldn't basing it off FILETIME be the same as making it calendar-independant?  I mean, FILETIME is defined using the Gregorian calendar (&quot;a 64-bit value representing the number of 100-nanosecond intervals since January 1, 1601 (UTC)&quot;) but it could just as easily be described in terms of other calendars.<br><br>So if you don't like the Gregorian calendar (or you just want to be difficult), you could just convert the date &quot;January 1, 1601 (UTC)&quot; into your own calendar, define the FILETIME structure in terms of that, and just do a FileTimeToSystemTime at the very last moment before calling GetDateFormat!</div>
<p><a id="453678" href="#453678">#</a> <strong>Maurits [MSFT]</strong> on 19 Aug 2005 11:52 AM:</p><div style="margin-left: 1em">Am I missing something?<br><br>In UNIX-land, dates/times are stored as integers, representing a number of seconds (or milliseconds?  I forget) since the &quot;epoch&quot; -- which is defined as the moment in time AKA 1/1/1970 12AM UTC Gregorian time.  So effectively this is &quot;another calendar&quot;.<br><br>This kind of calendar has some obvious advantages for computer use, though.<br><br>So why not store all dates/times in this fashion, and convert from Gregorian and/or Julian and/or what-have-you to this?  The particular moment-of-epoch is irrelevant... and it is trivial to map from any new epoch-based &quot;Microsoft calendar&quot; to the existing &quot;UNIX calendar&quot; by adding or subtracting a fixed number.</div>
<p><a id="453693" href="#453693">#</a> <strong>Mihai</strong> on 19 Aug 2005 12:40 PM:</p><div style="margin-left: 1em">Maybe not 100% on the subject, but it is about calendars.<br><br>I have always wondered if why there is no way to format a date with any calendar I want (for a certain locale). GetDateFormat gives you the result for the current calendar, or it can take DATE_USE_ALT_CALENDAR to use &quot;the alternate calendar, if one exists.&quot;<br><br>But my problem is: how do I use one of the alternate calendars for locales with more then to? I can enumerate them, but cannot use them.<br><br>For Japanese I have 3 calendars:<br> - Japanese Emperor Era<br> - Gregorian (English strings always)<br> - Gregorian (localized)<br>Korean also 3:<br> - Korean Tangun Era<br> - Gregorian (English strings always)<br> - Gregorian (localized)<br>And some Arabic locales have up to 6:<br> - Hijri (Arabic Lunar)<br> - Gregorian (English strings always)<br> - Gregorian Middle East French<br> - Gregorian Arabic<br> - Gregorian (localized)<br> - Gregorian transliterated French<br><br>Missing API? Any chance to see this changing? Long^H^H^HVista?<br></div>
<p><a id="453706" href="#453706">#</a> <strong>Michael S. Kaplan</strong> on 19 Aug 2005 1:11 PM:</p><div style="margin-left: 1em">Mihai -- see <a rel="nofollow" target="_new" href="http://archives.miloush.net/michkap/archive/2005/05/12/416761.html">http://blogs.msdn.com/michkap/archive/2005/05/12/416761.aspx</a> for more info.<br><br>For the Vista question, no comment at this time. :-)</div>
<p><a id="453708" href="#453708">#</a> <strong>Michael S. Kaplan</strong> on 19 Aug 2005 1:17 PM:</p><div style="margin-left: 1em">Dean -- you are correct, though I assume that lots of people will have trouble thinking of FILETIME values that way!<br><br>Maurits -- much of the very underneath work does just that -- but it is not as intuitive for most people as something based on a calendar they know....</div>
<p><a id="453709" href="#453709">#</a> <strong>Michael S. Kaplan</strong> on 19 Aug 2005 1:18 PM:</p><div style="margin-left: 1em">kfarmer -- see my prior response, which covers that thought. :-)<br><br>Shaun -- what if we wanted people using smartphones on the shuttle or on the trip to Mars? :-)</div>
<p><a id="453824" href="#453824">#</a> <strong>Maurits [MSFT]</strong> on 19 Aug 2005 4:55 PM:</p><div style="margin-left: 1em">Heh, there it is:<br><a rel="nofollow" target="_new" href="http://msdn.microsoft.com/library/en-us/sysinfo/base/rtltimetosecondssince1970.asp">http://msdn.microsoft.com/library/en-us/sysinfo/base/rtltimetosecondssince1970.asp</a><br><br>&quot;It may be altered or unavailable in subsequent versions&quot; -- (as Kyle's mom) what what what?</div>
<p><a id="454075" href="#454075">#</a> <strong>Michael S. Kaplan</strong> on 20 Aug 2005 4:41 PM:</p><div style="margin-left: 1em">Maurits -- yes, that one exists. Of course I try to avoid using functions that have built-in warnings about expiration dates.... :-)</div>
<p><a id="454295" href="#454295">#</a> <strong>Dean Harding</strong> on 21 Aug 2005 7:53 PM:</p><div style="margin-left: 1em">Maurits: The FILETIME structure is like UNIX time, except it uses 1601 as it's epoch, rather than 1970: <a rel="nofollow" target="_new" href="http://msdn.microsoft.com/library/en-us/sysinfo/base/filetime_str.asp">http://msdn.microsoft.com/library/en-us/sysinfo/base/filetime_str.asp</a> As long as you don't think &quot;FILETIME only applies to files,&quot; (which, technically, it doesn't have to) then you're OK. And that RtlTimeToSecondsSince1970 looks like one of those APIs that were documented as part of the anti-trust suit :)</div>
<hr/><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2005/08/20/454071.html" title="New in Vista Beta 1: Updated OS casing tables">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2005/08/17/452603.html" title="Every character has a story #13: U+0241 and U+0294 (upper and lower case glottal stops)">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2005-08">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2005-08-18">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2005/08/18/453373.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:41 GMT -->
</html>