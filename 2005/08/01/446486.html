<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2005/08/01/446486.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:41 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>Stripping out diacritics, redux</title></head><body>
<h1>Stripping out diacritics, redux</h1>
<p><em>by Michael S. Kaplan, published on 2005/08/02 02:56 -04:00, original URI: http://blogs.msdn.com/b/michkap/archive/2005/08/01/446486.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<P><FONT face=Tahoma>This last week, Dean Harding asked in the suggestion box:</FONT></P>
<BLOCKQUOTE dir=ltr style="MARGIN-RIGHT: 0px">
<P>Hey Michael, after all these years of reading your blog I finally got a question for you (your topics have always been so well-covered that I never needed to suggest anything before, but now I got a specific problem which I hope you can help me with :) <BR><BR>Anyway, one of the most interesting parts of my job is that I get to do a lot of interfacing with SMS (and I use the term "interesting" as in that old Chinese proverb ;) and one of the things about SMS is that it has a very limited character set. <BR><BR>Now, one of the new applications we're setting up is essentially a database of live events (shows, bands, DJs, etc) which you can access via the web and via SMS. Occasionally, however, you'll get a band with non-US-ASCII characters in their name (most popular are of course the famous Umlauts!) but of course accented characters and so forth cannot be displayed in SMS. <BR><BR>Now, we don't want to miss out the Umlauts and such for the web interface, but for SMS we don't have much choice. So there's a couple of solutions. First is we have two fields in the database, the "web" name and the "sms" name - but that's no good cause it means we have to keep both up-to-date. <BR><BR>The solution I was hoping to go for was to do a simple run through an Encoding.GetBytes followed by Encoding.GetString with a US-ASCII encoding. My hope was that this would be equivalent to WideCharToMultiByte followed by MultiByteToWideChar /without/ the WC_NO_BEST_FIT_CHARS flag which would convert all the accented characters to their non-accented equivalents. But that doesn't seem to be the case - they get converted to ?'s which is no good. <BR><BR>I was hoping for a .NET-only solution, but it looks like I'll have to p/invoke the WideCharToMultiByte/MultiByteToWideChar calls. Unless you've got some good news for me :)</P></BLOCKQUOTE>
<P><FONT face=Tahoma>Well, I did start posting in November of last year, so technically it has been "years", but it really has been less than a full year that I have been blogging, Dean. :-)</FONT></P>
<P><FONT face=Tahoma>But I can definitely speak against using encoding support&nbsp;directly to support the plan here -- mainly because the "best fit" support in the Win32 encoding API is not really a completely firm way to take out all of the diacritics!</FONT></P>
<P><FONT face=Tahoma>Offhand, I would way the best way is the <a href="http://archives.miloush.net/michkap/archive/2005/02/19/376617.html">Stripping Diacritics...</A> post I did this last February, which will handle this case quite well and quite a bit more completely than the Win32 encoding APIs in concert will do.</FONT></P>
<P><FONT face=Tahoma>Or if you really wanted to do it through encoding you could use the .NET Framework 2.0 support custom encoding fallbacks with the ASCII encoding to simply drop anything you wanted to and replace it with whatever you like, including the ASCII-fied version of text sans diacritics....</FONT></P>
<P><FONT face=Tahoma>Is that close enough to good news? At least since I include the warning about using the Win32 functions? :-)</FONT></P>
<P><FONT face=Tahoma></FONT>&nbsp;</P>
<P><FONT face=Tahoma color=#ff0000><EM>This post brought to you by</EM> "è" <EM>(<A href="http://www.fileformat.info/info/unicode/char/00e8/index.htm">U+00e8</A>, a.k.a. LATIN SMALL LETTER E WITH GRAVE)<BR><FONT size=1>A character that might have resented having its grave stripped from it, but then realizxd that it meant in your application it might a little further from the grave due to the joy of pronunciational ambiguities!</FONT></EM></FONT></P>
<hr/><p><a id="446505" href="#446505">#</a> <strong>Dean Harding</strong> on 2 Aug 2005 3:40 AM:</p><div style="margin-left: 1em">Heh, OK fair enough, it hasn't been years :)<br><br>Hmm, I must've missed (or at least forgot about) that other post of yours.  I was thinking about this a bit over the weekend, and I was thinking that I could probably do something like that as well.<br><br>The other thing is, of course, that SMS does allow for *some* diacritics on *some* characters, but only half a dozen or so.  It's a bit unfortunate that we're not using .NET 2.0 yet, cause it's got some really nice features that I could have made use of!<br><br>Ah well, perhaps what I'll have to do is the FoldString method with a bit of custom logic to allow for the couple of &quot;extended&quot; characters allowed by the SMS protocol...<br><br>Thanks for the advice, anyway - much obliged!</div>
<p><a id="446527" href="#446527">#</a> <strong>Michael S. Kaplan</strong> on 2 Aug 2005 5:28 AM:</p><div style="margin-left: 1em">Think of my blog as being like the world of film, where you can make ten minutes seem like eight! :-)</div>
<p><a id="456935" href="#456935">#</a> <strong>Crissov</strong> on 26 Aug 2005 6:28 PM:</p><div style="margin-left: 1em">Um, doesn’t GSM-SMS support UCS-2? Of course with a decreased max length of 70 characters (1120/16 = 70, 1120/7 = 160). Actual implementation in phones might be a problem, though.</div>
<hr/><p><em>referenced by</em></p><div style="margin-left: 1em"><p>2007/09/04 <a href="http://archives.miloush.net/michkap/archive/2007/09/04/4734456.html">I am not a nudist, but I do support stripping when it is appropriate, part 1</a></p><p>2007/08/17 <a href="http://archives.miloush.net/michkap/archive/2007/08/17/4424917.html">Normalize Wide Shut</a></p><p>2007/03/04 <a href="http://archives.miloush.net/michkap/archive/2007/03/04/1802729.html">The non-ASCII solution to the .NET Unicode Puzzle</a></p><p>2006/09/22 <a href="http://archives.miloush.net/michkap/archive/2006/09/22/765618.html">Those letters are stripping off their diacritics in public again, the sluts!</a></p></div><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2005/08/02/446522.html" title="New in Vista Beta 1: more use of the word &#39;linguistic&#39;">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2005/08/01/446475.html" title="Not every code page value is supported">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2005-08">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2005-08-01">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2005/08/01/446486.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:41 GMT -->
</html>