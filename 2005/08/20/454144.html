<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2005/08/20/454144.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:41 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>Mitigation tools for IDN security problems</title></head><body>
<h1>Mitigation tools for IDN security problems</h1>
<p><em>by Michael S. Kaplan, published on 2005/08/20 21:16 -07:00, original URI: http://blogs.msdn.com/michkap/archive/2005/08/20/454144.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostOld -->
<P><FONT face=Tahoma>Back in January, just before the flap at the hacker's convention with the paypal.com like that used a cyrillic 'a' to prove that IDN without a way to ferret out phishing attacks, I posted my own post entitled <STRONG><a href="http://archives.miloush.net/michkap/archive/2005/01/11/350482.html">International Domain Names? The sign on the door says 'Gone Phishing'....</A></STRONG></FONT></P>
<P><FONT face=Tahoma>It was an interesting flap because the RFCs for Internationalized Domain Names clearly points out the dangers and talks about the need to do some extra work to avoid security issues, but several browsers jumped ahead to support them and then just as quickly rushed out to turn them off by default.</FONT></P>
<P><FONT face=Tahoma>Folks at Microsoft, who knew about the need to do work here first, did not jump ahead without looking. And Microsoft was complimented for not jumping in too quickly. :-)</FONT></P>
<P><FONT face=Tahoma>Unicode has move in to assist with <A href="http://www.unicode.org/reports/tr36/#international_domain_names">Unicode Technical Report #36: Unicode Security Considerations</A>.</FONT></P>
<P><FONT face=Tahoma>And now Microsoft has some functions to help ISVs jump in (functions that can and will also be used in future versions of Microsoft products!).</FONT></P>
<P><FONT face=Tahoma>Here it is: </FONT><FONT face=Tahoma><A href="http://www.microsoft.com/downloads/details.aspx?FamilyId=E289BB2C-D111-4331-8FB2-CC6C5A026C93&amp;displaylang=en">Microsoft Internationalized Domain Names (IDN) Mitigation APIs 1.0</A>.</FONT></P>
<P><FONT face=Tahoma>From the overview:</FONT></P>
<BLOCKQUOTE dir=ltr style="MARGIN-RIGHT: 0px">
<P><FONT size=2><EM>The "Internationalized Domain Names Mitigation APIs" download includes several API functions to convert an IDN to different representations, as well as several API functions specifically intended to allow applications to mitigate some of the security risks presented by this technology. The functions IdnToAscii, IdnToUnicode, and IdnToNameprepUnicode each convert an IDN string to a particular form. The functions DownlevelGetLocaleScripts, DownlevelGetStringScripts, and DownlevelVerifyScripts allow applications to verify that the characters in a given IDN are drawn entirely from the scripts associated with a particular locale or locales. However, these functions are only helpers; applications have still to perform comprehensive threat modeling and create appropriate mitigation for these threats.</EM></FONT></P>
<P><FONT size=2><EM>Also included are the Unicode normalization APIs IsNormalizedString and NormalizeString, which are used by the mitigation APIs.</EM></FONT></P></BLOCKQUOTE>
<P><FONT face=Tahoma>This package is supported on XP (Service Pack 2 or later) and Server 2003 (Service Pack 1 or later). And differently named functions will also be in Vista!</FONT></P>
<P><FONT face=Tahoma>For info on the Normalization API&nbsp;functions, look <A href="http://msdn.microsoft.com/library/en-us/intl/nls_Normalization.asp">here</A>.</FONT></P>
<P><FONT face=Tahoma>For info on the IDN API functions, look <A href="http://msdn.microsoft.com/library/en-us/intl/nls_IDN.asp">here</A>.</FONT></P>
<P><FONT face=Tahoma>The cool functions in the package to help with the mitigation (they make use of <A href="http://www.unicode.org/iso15924/iso15924-codes.html">ISO 15942</A>&nbsp;for their script definitions):</FONT></P>
<UL>
<LI><A href="http://msdn.microsoft.com/library/en-us/intl/nls_DownlevelGetLocaleScripts.asp"><B><FONT face=Tahoma>DownlevelGetLocaleScripts</FONT></B></A><FONT face=Tahoma>&nbsp;- Returns a list of scripts generally used in a given locale</FONT></LI>
<LI><A href="http://msdn.microsoft.com/library/en-us/intl/nls_DownlevelGetStringScripts.asp"><B><FONT face=Tahoma>DownlevelGetStringScripts</FONT></B></A><FONT face=Tahoma>&nbsp;- Returns a list of scripts used in a given string</FONT></LI>
<LI><A href="http://msdn.microsoft.com/library/en-us/intl/nls_DownlevelVerifyScripts.asp"><B><FONT face=Tahoma>DownlevelVerifyScripts</FONT></B></A><FONT face=Tahoma>&nbsp;- Takes two lists of scripts (such&nbsp;as those returned by the previous two functions) and tells you whether one is within the other</FONT></LI></UL>
<P><FONT face=Tahoma>You can use these functions as part of your strategy for dealing properly with internationalized domain names -- warning users of potentially dangerous links to information.</FONT></P>
<P><FONT face=Tahoma>Awesome!</FONT></P>
<P><FONT face=Tahoma></FONT>&nbsp;</P>
<P><FONT face=Tahoma color=#ff0000><EM>This post brought to you by</EM> "Ð°" <EM>(U+0430, a.k.a. CYRILLIC SMALL LETTER A)</EM></FONT></P>
<hr/><p><a id="454224" href="#454224">#</a> <strong>Maurits</strong> on Sunday, August 21, 2005 1:22 PM:</p><div style="margin-left: 1em">Phishers don't typically need to resort to IDN's to perform effective social engineering, of course.  Consider windowsupdate.com:<br><br>windows-update.com was ACTUALLY USED by a phisher<br><br>then there's windows.update.com<br>updatewindows.com<br>W1NDOWSUPDATE.COM<br>windowsupdate.secure-login.com<br>windowsupdate-en.com<br><br>etc.<br><br>I only see a couple of ways around this:<br><br>1) Use microsoft.com as the parent domain<br>windowsupdate.microsoft.com<br>2) Use https<br><a rel="nofollow" target="_new" href="https://update.microsoft.com/">https://update.microsoft.com</a><br><br>Using microsoft.com as the parent domain means only thirteen characters (fourteen including the . before the m) need to be security-checked.<br><br>Using https means black hats have to shell out another couple of hundred.  Also the security certificate issuer is expected to take certain steps to make sure the issuee really is who they say they are.  There might even be liability.</div>
<p><a id="454226" href="#454226">#</a> <strong>Michael S. Kaplan</strong> on Sunday, August 21, 2005 1:29 PM:</p><div style="margin-left: 1em">Hi Maurits --<br><br>I guess the main point of the functions is to help remove a particular new attack vector, not to solve all attack vectors (most of which, as you point out, are not internationalization issues).<br><br>Plus it adds normalization and IDNA support downlevel, which is awesome!</div>
<p><a id="454555" href="#454555">#</a> <strong>Maurits</strong> on Monday, August 22, 2005 12:18 PM:</p><div style="margin-left: 1em">Perhaps the best way to address the problem is at the registrar level.  ICANN might need to come up with some stiff penalties for registrars that accept obviously fraudulent name registration requests.</div>
<p><a id="454616" href="#454616">#</a> <strong>Michael S. Kaplan</strong> on Monday, August 22, 2005 1:22 PM:</p><div style="margin-left: 1em">I doubt that it would be a popular move with the registrars to start talking punishment....</div>
<p><a id="454623" href="#454623">#</a> <strong>Maurits</strong> on Monday, August 22, 2005 1:34 PM:</p><div style="margin-left: 1em">I know... but we're talking about identity theft here.  Eventually the cops need to get involved.<br><br>Forcing URLs to be ASCII-only smacks of xenophobia and the anglicanization of the internet.<br><br>The company I work for has a fairly high percentage of employees with &quot;8-bit&quot; names... accented characters in particular.  I've had to implement a policy of changing these to their vanilla equivalents when giving usernames and passwords.  But I feel kind of dirty doing that.  Hopefully in ten years they can keep their accented characters in their return email address, and keep the vanilla equivalent as a secondary email address on their mailbox.<br><br>Perhaps a similar rule can be generated for domain name registrations?  So, for example,<br>m&#237;crosoft.com [1]<br>COULD be registered - but ONLY by whoever holds microsoft.com<br>?<br><br>Note verisign et al. actually allow IDN registrations, and they're not too forthcoming with the fact that you can't actually use those domains in any practical fashion.<br><br>[1] MEE-crow-sohft -- accent is necessary per Spanish pronunciation rules</div>
<p><a id="454627" href="#454627">#</a> <strong>Michael S. Kaplan</strong> on Monday, August 22, 2005 1:45 PM:</p><div style="margin-left: 1em">Hmmm.... well, I'll wait to see what the UTC comes up with, and how people use this package from Microsoft. :-)</div>
<p><a id="454633" href="#454633">#</a> <strong>Maurits</strong> on Monday, August 22, 2005 1:51 PM:</p><div style="margin-left: 1em">Sorry, Verisign...<br><br>It appears that they have mended their ways.  They no longer offer IDN registrations (though last time I registered a domain from them, they did.)<br><br>Now they merely link to other registrars that do.<br><br><a rel="nofollow" target="_new" href="http://www.verisign.com/products-services/naming-and-directory-services/naming-services/internationalized-domain-names/page_001397.html">http://www.verisign.com/products-services/naming-and-directory-services/naming-services/internationalized-domain-names/page_001397.html</a></div>
<p><a id="454893" href="#454893">#</a> <strong>Michael S. Kaplan</strong> on Monday, August 22, 2005 10:03 PM:</p><div style="margin-left: 1em">Hi Maurits -- <br><br>Of course they used to take money for them. Do you think they refunded it all? :-)</div>
<p><a id="475801" href="#475801">#</a> <strong>Maurits</strong> on Friday, September 30, 2005 2:47 PM:</p><div style="margin-left: 1em">Did you see this?<br><a rel="nofollow" target="_new" href="http://www.icann.org/general/idn-guidelines-20sep05.htm">http://www.icann.org/general/idn-guidelines-20sep05.htm</a><br><br>Public Comment period ends October 20.</div>
<p><a id="475805" href="#475805">#</a> <strong>Michael S. Kaplan</strong> on Friday, September 30, 2005 2:53 PM:</p><div style="margin-left: 1em">There does have to be ICANN interest here, obviously. They need registrars and others to be involved with the screening processes...</div>
<hr/><p><em>referenced by</em></p><div style="margin-left: 1em"><p>2008/04/30 <a href="http://archives.miloush.net/michkap/archive/2008/04/30/8440675.html">Why WC2MB needs a CP, chaver sheli!</a></p><p>2006/07/28 <a href="http://archives.miloush.net/michkap/archive/2006/07/28/680759.html">The download you requested is unavailable.</a></p><p>2006/07/16 <a href="http://archives.miloush.net/michkap/archive/2006/07/16/667468.html">Update to the mitigation tools for IDN security problems</a></p><p>2006/06/17 <a href="http://archives.miloush.net/michkap/archive/2006/06/17/634936.html">64-bit thoughts, and an apology</a></p><p>2006/01/14 <a href="http://archives.miloush.net/michkap/archive/2006/01/14/512985.html">Getting out of the compatibility zone, redux</a></p><p>2005/12/20 <a href="http://archives.miloush.net/michkap/archive/2005/12/20/505946.html">IDN hits the uber-client</a></p><p>2005/12/03 <a href="http://archives.miloush.net/michkap/archive/2005/12/03/499419.html">When even the bugs seem cool</a></p><p>2005/12/02 <a href="http://archives.miloush.net/michkap/archive/2005/12/02/498889.html">Getting out of dodge (or at least out of the compatibility range!)</a></p><p>2005/09/29 <a href="http://archives.miloush.net/michkap/archive/2005/09/29/475174.html">It's already in there, or it's on the way</a></p><p>2005/09/12 <a href="http://archives.miloush.net/michkap/archive/2005/09/12/463560.html">Theory vs. practice for Korean text collation, Redux</a></p><p>2005/09/09 <a href="http://archives.miloush.net/michkap/archive/2005/09/09/462880.html">Safe 'DrawText' function</a></p></div><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2005/08/21/454247.html" title="The meaning of the word &#39;unsupported&#39;">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2005/08/20/454114.html" title="The Keyboard Convert Service">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2005-08">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2005-08-20">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2005/08/20/454144.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:41 GMT -->
</html>