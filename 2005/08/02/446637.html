<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2005/08/02/446637.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:41 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>Errors in wizards and add-ins that are not my fault</title></head><body>
<h1>Errors in wizards and add-ins that are not my fault</h1>
<p><em>by Michael S. Kaplan, published on 2005/08/02 11:30 -04:00, original URI: http://blogs.msdn.com/b/michkap/archive/2005/08/02/446637.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<P><FONT face=Tahoma>I used to write a bunch of wizards and add-ins for Microsoft Access. One of the things that these add-ins include is a USysRegInfo table that instructs the Microsoft Access Add-In Manager on what registry keys to add so that the wizard can be installed.</FONT></P>
<P><FONT face=Tahoma>But that Add-In Manager has a flaw.</FONT></P>
<P><FONT face=Tahoma>If you mark registry keys as needing to be written to HKEY_LOCAL_MACHINE (which Access documents you must do to get the wizard or add-in installed properly) and the user who runs the Add-In Manager has no permission to do so, the helpful error message along the lines&nbsp;of this one (translated into your local language):</FONT></P>
<P><FONT face=Tahoma><IMG src="http://trigeminal.fmsinc.com/images/AccessMsgBox.jpg"></FONT></P>
<P><FONT face=Tahoma>So now people will send email to me complaining about the error my wizard/add-in puts up when they try to install it.</FONT></P>
<P><FONT face=Tahoma>How hard would it be to say in the error message that this error has to do with permissions and is something to talk about with your administrator rather than the developer of the add-in, rather than saying very little and naturally causing the poor customer to assume that this is an error for the person who developed the free wizard?</FONT></P>
<P><FONT face=Tahoma>Hopefully someone who is involved with Microsoft Access will suggest this feedback for the next version of Access and help out the poor ISV who is being blamed for something that is <EM>not their fault!</EM> :-(</FONT></P>
<P><FONT face=Tahoma>And even more hopefully, this problem will be fixed some time soon. :-)</FONT></P>
<hr/><p><a id="446706" href="#446706">#</a> <strong>Maurits [MSFT]</strong> on 2 Aug 2005 1:29 PM:</p><div style="margin-left: 1em">Well.. aren't there other reasons a registry modification could fail, besides permissions?  The registry might have hit its maximum size, for example.<br><br>Is there a way to check for this?</div>
<p><a id="446716" href="#446716">#</a> <strong>Michael S. Kaplan</strong> on 2 Aug 2005 1:55 PM:</p><div style="margin-left: 1em">I believe the error return on permission failures is a specific ERROR_ACCESS_DENIED or something detectable like that....<br><br>Back when I owned the code it was a RegCreateKeyEx call that would fail here (it creates a key and then values under it; the key create fails).</div>
<hr/><p><em>referenced by</em></p><div style="margin-left: 1em"><p>2005/08/21 <a href="http://archives.miloush.net/michkap/archive/2005/08/21/454247.html">The meaning of the word 'unsupported'</a></p></div><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2005/08/03/447052.html" title="When did Bidi happen?">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2005/08/02/446522.html" title="New in Vista Beta 1: more use of the word &#39;linguistic&#39;">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2005-08">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2005-08-02">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2005/08/02/446637.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:41 GMT -->
</html>