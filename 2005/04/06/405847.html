<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2005/04/06/405847.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:42 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>When Notepad's Find doesn't</title></head><body>
<h1>When Notepad's Find doesn't</h1>
<p><em>by Michael S. Kaplan, published on 2005/04/06 09:45 -04:00, original URI: http://blogs.msdn.com/b/michkap/archive/2005/04/06/405847.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<P><FONT face=Tahoma>I met Chris Walker the other day. </FONT></P>
<P><FONT face=Tahoma>It is amazing how you can "know" someone at Microsoft through email without ever actually meeting them. Occasionally with a name like Leslie or Sam or&nbsp;Chris you might even not know their gender, so you just have these faceless relationships through you inbox....</FONT></P>
<P><FONT face=Tahoma>Anyway, we were at a talk about compiler optimizations and he asked me "are you Michael Kaplan?"</FONT></P>
<P><FONT face=Tahoma>I guess there are benefits to having the picture on top of the blog. Though it does kill the faceless aspect a bit. :-)</FONT></P>
<P><FONT face=Tahoma>Anyway, we were talking about the functionality of the "Find" and "Replace" functionalities in Notepad. He was pretty sure that it did not do the right thing with situations where the length of the search string and the target string were different (something which can indeed happen, as we talked about before). </FONT></P>
<P><FONT face=Tahoma>He's right, it cannot yet handle that situation. So it cannot find the case of å (<A href="http://www.fileformat.info/info/unicode/char/0061/index.htm">U+0061</A> <A href="http://www.fileformat.info/info/unicode/char/030a/index.htm">U+030a</A>) when å (<A href="http://www.fileformat.info/info/unicode/char/00e5/index.htm">U+00e5</A>) is what you are looking for. And&nbsp;it has an optimization that looks for the first character in the search string prior to checking for the whole string. Though is on the right track since he is at least calling the right API (<A href="http://msdn.microsoft.com/library/en-us/winui/winui/windowsuserinterface/resources/strings/stringreference/stringfunctions/comparestring.asp">CompareString</A>) at least half the time. :-)</FONT></P>
<P><FONT face=Tahoma>Of course features for a product like Notepad are always hard to balance. It has come a long way since NT 3.1 but like everyone I have my wish list of features to add to it. I am sure that this is how an innocent bunch of RichEdit control developers thought up a product like Word, but I probably would not lose that much control in what I would ask for....</FONT></P>
<P><FONT face=Tahoma>Notepad is probably the single most-used HTML, XML, and text editor in the known universe. But its dependence on the Win32 EDIT control and its implicit use (through the EDIT control) on Uniscribe's ScriptString* APIs when Uniscribe is turned on make it a great testbed for international features in plain text. I promised him I would put in a few bugs for him to take a look at, but I have to admit it is a little daunting to think that anything I say or do would affect a tool that is consciously used as much as Notepad!</FONT></P>
<P><FONT face=Tahoma>I'll see if I can pick on Notepad a few days this week. If I am lucky Chris will fix the issues and then he can pick on <A href="http://msdn.microsoft.com/library/en-us/winui/winui/windowsuserinterface/resources/strings/stringreference/stringfunctions/comparestring.asp">CompareString</A> a bit for bugs he finds while he does it!</FONT></P>
<P><FONT face=Tahoma></FONT>&nbsp;</P>
<P><FONT face=Tahoma><FONT color=#ff0000><EM>This post brought to you by</EM> "å" </FONT><EM><FONT color=#ff0000>(<A href="http://www.fileformat.info/info/unicode/char/00e5/index.htm">U+00e5</A>, a.k.a. LATIN SMALL LETTER A WITH RING ABOVE)<BR><FONT size=1>A letter that has been really happy to be seen as the default example for normalization functionality. :-)</FONT></FONT></EM></FONT></P>
<hr/><p><a id="406023" href="#406023">#</a> <strong>Dean Harding</strong> on 6 Apr 2005 6:43 PM:</p><div style="margin-left: 1em">Heh, I loved Rory's post on Notepad in Longhorn: <a rel="nofollow" target="_new" href="http://neopoleon.com/blog/posts/12904.aspx">http://neopoleon.com/blog/posts/12904.aspx</a></div>
<p><a id="406046" href="#406046">#</a> <strong>Michael S. Kaplan</strong> on 6 Apr 2005 8:26 PM:</p><div style="margin-left: 1em">That is pretty funny. Probably no way to get my features in if I have to compete with exciting ones like that!</div>
<hr/><p><em>referenced by</em></p><div style="margin-left: 1em"><p>2011/10/13 <a href="http://archives.miloush.net/michkap/archive/2011/10/13/10224477.html">Every rose has it's Þ....</a></p><p>2006/07/09 <a href="http://archives.miloush.net/michkap/archive/2006/07/09/658454.html">The fallacy of comparing out of context</a></p></div><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2005/04/06/406044.html" title="Michael Penn at the Tractor Tavern on April 9th">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2005/04/05/405443.html" title="So what happened in v.Next?">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2005-04">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2005-04-06">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2005/04/06/405847.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:42 GMT -->
</html>