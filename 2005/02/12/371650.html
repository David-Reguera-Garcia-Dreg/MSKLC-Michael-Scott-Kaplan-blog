<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2005/02/12/371650.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:42 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>Why/how MSLU came to be, and more</title></head><body>
<h1>Why/how MSLU came to be, and more</h1>
<p><em>by Michael S. Kaplan, published on 2005/02/12 13:50 -05:00, original URI: http://blogs.msdn.com/b/michkap/archive/2005/02/12/371650.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<P>A question that I used to be asked all the time (and even to this day am still asked on&nbsp;a regular basis) is <STRONG>Why did Microsoft create <A title=MSLU href="http://www.microsoft.com/globaldev/handson/dev/mslu_announce.mspx" target=_blank>MSLU</A>?</STRONG></P>
<P>I'll see if I can shed some light on this today. </P>
<P>(Sometimes people ask less charitable versions of the question, like <STRONG>Why did Microsoft wait for so long to make MSLU?</STRONG> or <STRONG>Why did you wait to make MSLU until it was too late?</STRONG> but I'll stick to the nice version of the question!).</P>
<P>Note that at the time it was written I was not yet an employee of Microsoft, so I was definitely not involved in all of the core strategic decisions behind why a product ships. Think of what follows as a bunch of somewhat educated suppositions, many years after the actual events took place.</P>
<P>&nbsp;</P>
<P>As it is also the story of how I got my first contract with the group that I subsquently joined MS as a full-time employee, it is very much related to why I work where I do!</P>
<P>Anyway, here is the story....</P>
<P>Back some time in 2000, I was first starting to look at the globalization namespace in the .NET Framework. There was not much in the way of documentation available to me, but I did&nbsp;find a detailed spec that told a lot of the&nbsp;story but still left me with some questions. I noticed that the author (Julie Bennett) was a software design engineer, who I did not know. So I sent her&nbsp;a piece of mail asking if she was free for lunch some time to talk about some <A title=System href="http://msdn.microsoft.com/library/en-us/cpref/html/frlrfsystemglobalization.asp" target=_blank>System.Globalization</A> stuff. I did not hear back from her right away, so i figured she was not comfortable talking about it prior to release since I was not really working on any of the development teams involved with the project....</P>
<P>Then she emailed me out of the blue and mentioned that she remembered I had asked about lunch, and if I was still interested she had some time the next day. I thought -- <EM>Cool! I can fine out about these things that do not seem to be captured in the spec!</EM></P>
<P>She had a very different set of motivations, though. </P>
<P>You see, for many years she had been trying to convince people of the need for a Unicode layer for Windows 9x, because too many people needed to write for all platforms and so for ease of release management were not writing unicode applications. Even articles like the one F. Avery Bishop wrote for MSJ back in 1999 (<A href="http://www.microsoft.com/msj/0499/multilangUnicode/multilangUnicode.aspx" target=_blank n="8">Design a Single Unicode Appthat Runs on Both Windows 98 and Windows 2000</A>) were not making a huge dent in this problem. And it would really hurt the whole story for international support if new "Unicode only" languages would not work in third party applications.</P>
<P>So for her, this lunch was sort of an informational. She had a project in mind and thought that I would be a great person to work on it. Of course I had a job already and was not looking for a new one at the time, and probably would have said no to lunch if I knew it <EM>was</EM> an informational. Luckily she did not tell me....</P>
<P>Anyway, at one point we were talking about random NLS stuff and I bemoaned the fact that "THEY" had not just made the whole "Traditional" vs "Modern" Spanish sort thing go away into an alternate sort rather than a new LANGID. She gently pointed out to me (in classic "<a href="http://archives.miloush.net/michkap/archive/2004/11/28/271121.html">My Dear Boy...</A>" style!) that the concept of alternate sorts did not yet exist; they were in fact created largely due to the postmortem of the "Traditional Spanish sort" issue to make sure such a problem would not happen again.</P>
<P>But when she laid out the idea of a layer that would be able to let people write Unicode applications that would do incredible things on Windows 2000 while still being functional on Win9x, I was amazed. When she asked whether I would I be interested in doing this project if she could get people behind the idea of making it happen, I think I said <EM>Hell yes!</EM> or something equally coherent. It sounded like an amazing project to be involved with! </P>
<P>Had I been less dumb, I would have known that "THEY"&nbsp;I was complaining about with the Spanish thing was actually "HER" since she was the developer who owned the area. and would have been quite embarrassed that I wanted a contract from someone who I had just dissed their work. I think she knew that the effect on me would be more powerful if I found out myself<SUP><FONT size=1>1</FONT></SUP> -- which I did, not too long after. :-)</P>
<P>MSLU was an adventure of a project, with sometimes invaluable,&nbsp;often interesting, and always entertaining help from folks like </P>
<UL>
<LI><FONT size=1>Raymond (random Win9x-specific strangeness that he always knew what was causing the problems)</FONT> 
<LI><FONT size=1>Bryan (architecture of the MSLU loader, our own private delay load solution)</FONT> 
<LI><FONT size=1>Dan (author of the original delayload, who helped Bryan architect the MSLU solution)</FONT> 
<LI><FONT size=1>Jay (the mysteries of DllMain, TLS allocation, and eventually Fusion assistance)</FONT> 
<LI><FONT size=1>Phil (working without the CRT, since not all Win9x platforms had one!)</FONT> 
<LI><FONT size=1>Cathy (the only person in the universe who could ever PM such a project, and also the one who came up with just about every internal and external name we had) </FONT>
<LI><FONT size=1>Mike (assistance with subclassing, Shell team style)</FONT> 
<LI><FONT size=1>Gerardo (who has forgotten more about window management and user messaging than most people will ever know)</FONT> 
<LI><FONT size=1>Barry (generating and working with thunks)</FONT> 
<LI><FONT size=1>most of all Julie (for providing the vision for MSLU in the first place)</FONT></LI></UL>
<P>Microsoft is an excellent place to work, and folks like these are one of most impotant reasons!</P>
<P>By April 2001, Cathy Wissink and I were able to announce MSLU at the 18th International Unicode Conference in Hong Kong (in a special add-on talk that was not in the original schedule!).</P>
<P>We also wrote an article for the October 2001&nbsp;<A href="http://msdn.microsoft.com/msdnmag/">MSDN Magazine</A> entitled <A href="http://msdn.microsoft.com/msdnmag/issues/01/10/MSLU/">MSLU: Develop Unicode Applications for Windows 9x Platforms with the Microsoft Layer for Unicode</A>&nbsp;which talked about both many of the motivations for doing the project as well as technical information about using MSLU.</P>
<P>So why did it take so long for people to see it was an important project to do? It is hard to say (I was certainly not in the meetings Julie would have with Execs about doing the work!), though if I had to guess it would be that everyone had really moved on mentally to Windows 2000 and it took&nbsp;a while to admit that fuller migration strategies were needed to get developers writing Unicode applications. The code name for the project was Godot, based on the <A href="http://samuel-beckett.net/">Samuel Beckett</A>&nbsp;play <STRONG>Waiting for Godot</STRONG>, which should give some hint as to the feelings of those who knew all along how important the project was yet did not know if anyone else would ever realize it. We just had to wait for it, so we could all be saved.</P>
<P>Though the confusion of many people was evident when they wondered if it was some type of managed reference (i.e. Go.dotnet or somesuch).</P>
<P>A final note for this post. <A id=Comments href="http://archives.miloush.net/michkap/archive/2005/01/31/363007.html#363645" target=_blank>Serge Wautier</A> asked (from the suggestion box):</P>
<BLOCKQUOTE dir=ltr>
<P><FONT size=2><EM>I always wondered why Begin/End/UpdateResourceA() were not implemented in Win9x. Was there a technical reason ? You recently wrote that all the work had been done to make the API Win9x friendly. Then why didn't it show up ? </EM></FONT></P>
<P><FONT size=2><EM>Note that I'm asking just for the historical anecdote. I am an happy user of MSLU</EM></FONT></P></BLOCKQUOTE>
<P>I cannot really take responsibility for this part, it was really due to the hard work of Matt Curland (author of the excellent <A href="http://www.powervb.com/">Advanced Visual Basic 6: Power Techniques for Everyday Programs</A>&nbsp;from which I took code&nbsp;for my own book, making modifications so it would be more internationally friendly). Matt was a full-time MS employee back then and was working on his&nbsp;cool resource editor. He wanted to support it on Win9x, too so he asked me if he could take a look at the code for the resource updating functions <A title=BeginUpdateResource href="http://msdn.microsoft.com/library/en-us/winui/winui/windowsuserinterface/resources/introductiontoresources/resourcereference/resourcefunctions/beginupdateresource.asp" target=_blank>BeginUpdateResource</A>, <A title=UpdateResource href="http://msdn.microsoft.com/library/en-us/winui/winui/windowsuserinterface/resources/introductiontoresources/resourcereference/resourcefunctions/updateresource.asp" target=_blank>UpdateResource</A>, and <A title=EndUpdateResource href="http://msdn.microsoft.com/library/en-us/winui/winui/windowsuserinterface/resources/introductiontoresources/resourcereference/resourcefunctions/endupdateresource.asp" target=_blank>EndUpdateResource</A>, and after getting the okay from my management I sent him the source file. After converting it to be able to work on Win9x (which was no mean feat!) he asked if he could ship&nbsp;a DLL with the code, but management was not as thrilled about <EM>that</EM> idea (the distance between "code to look at"and "code to ship to customers" is a large one!). I cannot remember which of us now, but one of us suggested that to get out of this stalemate maybe it could be added to MSLU. This did sit better with management, so it was added and working well by the 1.0.3703.0 release. </P>
<P>Now I added both "A" and "W" versions because it just seemed kind of insane not to in this case. But all of this happened years after the last version of Win9x ever shipped, and as far as I know no one ever really considered adding these APIs to Win9x. The effort to make them Win9x-friendly was not&nbsp;a trivial one. The only reason it really happened is because Matt is an excellent developer who is fond of full and elegant solutions to problems.... :-)</P>
<P>&nbsp;</P>
<P><FONT size=1><EM>1 - Incidentally, its really one of the big reasons I took that contract, once approval for the project happened (something that she said was much easier with a development resource raring to go!). It takes a class act to be insulted (even unknowingly and unintentionally) and not treat it as an attack. I decided I wanted to stay at least long enough to learn how to do that sort of thing! </EM></FONT><FONT size=1><EM>Now it is years later, I work full time for Microsoft in the group (GIFT) where she is a Director with over 130 reports. I still have not completely learned the lesson, but there are times that I can see&nbsp;progress....</EM></FONT></P>
<P>&nbsp;</P>
<P><FONT color=#800080><EM>This post brought to you by </EM>"∞"<EM> (<A href="http://www.fileformat.info/info/unicode/char/221e/index.htm">U+221e</A>, a.k.a. INFINITY)</EM></FONT></P>
<hr/><p><a id="373000" href="#373000">#</a> <strong>Zach Glazer</strong> on 15 Feb 2005 7:08 AM:</p><div style="margin-left: 1em">Good read - found the back history very interesting. (also something I could follow, which many of the posts leave me buried under too much technical mumbo jumbo)<br><br>Otherwise, how are things with you? All is well here in Cleveland.</div>
<p><a id="373164" href="#373164">#</a> <strong>Michael Kaplan</strong> on 15 Feb 2005 10:17 AM:</p><div style="margin-left: 1em">Well, I do try to get in the fun story now and again when I can....<br><br>Things are well here, but busy. Send my love to my niece! :-)</div>
<hr/><p><em>referenced by</em></p><div style="margin-left: 1em"><p>2015/08/27 <a href="http://archives.miloush.net/michkap/archive/2015/08/27/8770668856267197121.html">Trying to build some kind of a narrative #6: Several of the more intriguing of the other 32 (of 37) contracts at Microsoft</a></p><p>2008/10/11 <a href="http://archives.miloush.net/michkap/archive/2008/10/11/8996201.html">Keeping myself up at night figuring out how to delight someone by making that special part of my package smaller</a></p><p>2008/08/21 <a href="http://archives.miloush.net/michkap/archive/2008/08/21/8883552.html">Its the End[UpdateResource] of the world we know it</a></p><p>2007/04/28 <a href="http://archives.miloush.net/michkap/archive/2007/04/28/2314479.html">Testing MSLU</a></p><p>2006/09/23 <a href="http://archives.miloush.net/michkap/archive/2006/09/23/768178.html">The modern solution to the problem of Traditional Spanish in Vista</a></p><p>2006/08/03 <a href="http://archives.miloush.net/michkap/archive/2006/08/03/687388.html">MSLU: some back-story, some back-formations (and no backwash)</a></p><p>2006/07/16 <a href="http://archives.miloush.net/michkap/archive/2006/07/16/667622.html">Nobody likes change</a></p><p>2006/05/24 <a href="http://archives.miloush.net/michkap/archive/2006/05/24/605599.html">Invariant vs. Ordinal, the third</a></p><p>2006/05/13 <a href="http://archives.miloush.net/michkap/archive/2006/05/13/596774.html">Font embedding -- the intro</a></p><p>2005/07/17 <a href="http://archives.miloush.net/michkap/archive/2005/07/17/439742.html">A Microsoft convention for compressions in sorting</a></p><p>2005/06/06 <a href="http://archives.miloush.net/michkap/archive/2005/06/06/425530.html">'desire to deeply understand core globalization features at their lowest levels'</a></p><p>2005/05/19 <a href="http://archives.miloush.net/michkap/archive/2005/05/19/420145.html">What it means to be in the default MOBILE install</a></p><p>2005/05/05 <a href="http://archives.miloush.net/michkap/archive/2005/05/05/414985.html">How can I use MSLU without shipping UnicoWS.dll?</a></p><p>2005/04/28 <a href="http://archives.miloush.net/michkap/archive/2005/04/28/412977.html">Cleaning out the suggestion box a bit</a></p><p>2005/04/15 <a href="http://archives.miloush.net/michkap/archive/2005/04/15/408422.html">From Win32 to .NET (and vice versa)</a></p><p>2005/03/06 <a href="http://archives.miloush.net/michkap/archive/2005/03/06/386194.html">Backcompat is the father of the NLS APIs</a></p></div><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2005/02/12/371737.html" title="Every character has a story #6: U+02eb U+02ea (Chinese departing tone marks)">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2005/02/11/371010.html" title="Surrogate pairs and binary (Ordinal) comparisons">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2005-02">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2005-02-12">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2005/02/12/371650.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:42 GMT -->
</html>