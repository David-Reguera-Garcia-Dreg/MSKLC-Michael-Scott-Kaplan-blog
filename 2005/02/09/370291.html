<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2005/02/09/370291.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:42 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>New info about old usability tests</title></head><body>
<h1>New info about old usability tests</h1>
<p><em>by Michael S. Kaplan, published on 2005/02/10 00:17 -05:00, original URI: http://blogs.msdn.com/b/michkap/archive/2005/02/09/370291.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<P>In prior posts I had talked about <a href="http://archives.miloush.net/michkap/archive/2004/12/23/331112.html">shortcuts</A> and <a href="http://archives.miloush.net/michkap/archive/2004/12/24/331661.html">accelerators</A>, and especially the difficulties involved with the possible changes that will occur with them as keyboard layouts change, etc.</P>
<P>Well, tonight I was looking at Nadine Kano's book <A href="http://www.microsoft.com/globaldev/dis_v1/disv1.asp">Developing International Software for Windows 95 and Windows NT</A> for something else entirely and happened to find the following text <A href="http://www.microsoft.com/globaldev/dis_v1/disv1.asp?DID=dis20d&amp;File=S24B5_a2.asp">here</A>:</P>
<BLOCKQUOTE dir=ltr>
<P><EM><FONT size=2>When you design functionality to allow the user to switch keyboard layouts, keep in mind that because the letters on keyboards vary from layout to layout, the keys used to generate shortcut-key combinations might also vary. For example, suppose a user selects French as his default keyboard layout. To sort a list on your application, he presses Ctrl+Z. When he changes the input language to Russian, which activates the Russian keyboard layout, he notices that his list isn't sorting. The Russian keyboard does not contain the letter Z, and the virtual-key codes generated by the Russian layout correspond to the virtual-key codes generated by the US layout, not the French layout. Because of this, the key that produces the letter Z on the French layout produces the virtual-key code for W on the Russian layout. (See the templates in Appendix Q to compare the US and French keyboard layouts.)</FONT></EM></P>
<P><EM><FONT size=2>Microsoft usability tests have shown that most users would prefer to learn only one set of shortcut-key combinations. When parsing keyboard input, always parse shortcut-key combinations based on the user's default keyboard layout. In other words, first test to see whether the active keyboard layout is the user's default. If it is not, test the shortcut-key combinations against whichever virtual codes correspond to the correct combination on the user's default layout. In the example above, if the Russian keyboard layout is active and your application receives the virtual code for Ctrl+W, it should still activate the sort command. The most efficient way to handle this is to build tables at startup to map between the default keyboard layout and additional layouts installed on the user's system.</FONT></EM></P></BLOCKQUOTE>
<P>I have probably read that book 100 times and I never remembered that text!</P>
<P>But it does make a lot of sense. Assuming that their default keyboard layout matched the actual keys on their keyboard, you could use this knowledge to provide useful maps that matched the physical&nbsp;keys on their keyboards for shortcuts.</P>
<P>It would be interesting to see if this usability data still holds true, especially if it has fallen out of the combined knowledge of MS products (I had never heard it before from any of the program managers of many products that have seen grapple and heard tell of grappling with this problem)....</P>
<P>&nbsp;</P>
<P><FONT color=#800080><EM>This post sponsored by</EM> "Ùª" <EM>(U+066a, ARABIC PERCENT SIGN)</EM></FONT></P>
<hr/><p><a id="370571" href="#370571">#</a> <strong>Dan</strong> on 10 Feb 2005 11:14 AM:</p><div style="margin-left: 1em">If I'm understanding you correctly, this is the same thing I ran into when trying to switch to dvorak for my wrists. Most common shortcut keys are designed for locality - the most notable is cut/copy/paste/undo. All available using one hand. On dvorak the keys get thrown all over the place, and it causes issues. Such a feature would be well recieved, however I get the feeling it could cause some interesting compatibility issues.</div>
<p><a id="370573" href="#370573">#</a> <strong>Michael Kaplan</strong> on 10 Feb 2005 11:17 AM:</p><div style="margin-left: 1em">Yes, as a rule any time someone comes up with a great new plan to change the way either shortcuts or accelerators work in order to simplify things, they end up making things more complex due to the need to support yet another new behavior....</div>
<p><a id="373011" href="#373011">#</a> <strong>Mark</strong> on 15 Feb 2005 7:27 AM:</p><div style="margin-left: 1em">Do you suggest something like:<br>0. Get the keyboard scancode (how? similarly to DirectInput or managed by system?)<br>1. Load default keyboard layout<br>2. <a title="MapVirtualKeyEx" href="http://msdn.microsoft.com/library/en-us/winui/winui/windowsuserinterface/userinput/keyboardinput/keyboardinputreference/keyboardinputfunctions/mapvirtualkeyex.asp" target="_blank">MapVirtualKeyEx</a>() (which reportedly doesn't seem to work on Korean Win98?)<br>3. Continue with <a title="WM_CHAR" href="http://msdn.microsoft.com/library/en-us/winui/winui/windowsuserinterface/userinput/keyboardinput/keyboardinputreference/keyboardinputmessages/wm_char.asp" target="_blank">WM_CHAR</a> etc. logic<br></div>
<p><a id="373175" href="#373175">#</a> <strong>Michael Kaplan</strong> on 15 Feb 2005 10:25 AM:</p><div style="margin-left: 1em">Actually, what <a title="MSKLC" href="http://www.microsoft.com/globaldev/tools/msklc.mspx" target="_blank">MSKLC</a> does is run through all the scan codes and get the VK and then the text from every one of them (the latter with <a title="ToUnicodeEx" href="http://msdn.microsoft.com/library/en-us/winui/winui/windowsuserinterface/userinput/keyboardinput/keyboardinputreference/keyboardinputfunctions/tounicodeex.asp" target="_blank">ToUnicodeEx</a>). So it can basically load the keyboard layout.</div>
<hr/><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2005/02/10/370460.html" title="Microsoft, you giving us some LIP?">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2005/02/09/369958.html" title="What is the difference between Big Endian and Little Endian Unicode?">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2005-02">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2005-02-09">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2005/02/09/370291.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:42 GMT -->
</html>