<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2005/06/05/425307.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:41 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>Does Bengali sorting work?</title></head><body>
<h1>Does Bengali sorting work?</h1>
<p><em>by Michael S. Kaplan, published on 2005/06/05 02:01 -04:00, original URI: http://blogs.msdn.com/b/michkap/archive/2005/06/05/425307.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<P><FONT face=Tahoma>I had a colleague of mine ask me this very question the other day.</FONT></P>
<P><FONT face=Tahoma>It was not an entirely offhand question. After all, as I mentioned in <a href="http://archives.miloush.net/michkap/archive/2005/01/26/360685.html">Lions and tigers and <STRIKE>bears</STRIKE>ELKs, Oh my!</A>, NLS support for Bengali was added to Windows XP in Service Pack 2. The post even mentions sorting as one of the many potential issues that one of these ELKs has to address. So it is not unreaonable to wonder if that support is in there. There are even easy things to check for, like <a href="http://archives.miloush.net/michkap/archive/2005/04/09/406765.html">the Hasant and its expected effect on Bengali collation</A>.</FONT></P>
<P><FONT face=Tahoma>Unfortunately, the joy by which one can be happy at how easy is to verify is quickly dashed by the results of calls to <A href="http://msdn.microsoft.com/library/en-us/winui/winui/windowsuserinterface/resources/strings/stringreference/stringfunctions/comparestring.asp">CompareString</A> and/or <A href="http://msdn.microsoft.com/library/en-us/intl/nls_5s2v.asp">LCMapString</A> with <A href="http://www.fileformat.info/info/unicode/char/0995/index.htm">U+0995</A> <A href="http://www.fileformat.info/info/unicode/char/09cd/index.htm">U+09cd</A> versus plain old <A href="http://www.fileformat.info/info/unicode/char/0995/index.htm">U+0995</A>:</FONT></P>
<UL>
<LI><FONT face=Tahoma><A href="http://msdn.microsoft.com/library/en-us/winui/winui/windowsuserinterface/resources/strings/stringreference/stringfunctions/comparestring.asp">CompareString</A> with LCID 0x0445 returns CSTR_GREATER_THAN, meaning the string with the Hasant is coming after the one without.</FONT> 
<LI><FONT face=Tahoma><A href="http://msdn.microsoft.com/library/en-us/intl/nls_5s2v.asp">LCMapString</A> with LCMAP_SORTKEY with LCID 0x0445 returns the following two sort keys for the respective strings:<BR><BR></FONT><FONT face="Courier New"><STRONG>15 10 01 <FONT color=#ff0000>0B</FONT> 01 01 01 00<BR>15 10 01 01 01 01 00</STRONG></FONT></LI></UL>
<P><FONT face=Tahoma>That extra secondary weight (marked in RED above) is clearly what is causing the first string to sort after the second. Which is not what the native speaker would expect (something the other article I wrote explains).</FONT></P>
<P><FONT face=Tahoma>Hoist by mine own petard. Darn.</FONT></P>
<P><FONT face=Tahoma>There was actually some early work done on the collation support for Bengali and Malayalam, but the initial investigation seemed to suggest that the collation would require features in the code that were not yet available in Windows XP. So we reluctantly shipped with only some of the mapping defined. Probably enough for any native speaker to think that a developmentally disabled Bengali youth had tried to define the ordering (hints of truth followed by blatant problems).</FONT></P>
<P><FONT face=Tahoma>Now I can say that a lot of work has gone into all of these "ELK" locales have been carried forward to Longhorn. And that many of these known UNDONEs in the language support are being taken as important issues to address. Not really startling news since language support always gets better in each version of Windows, but important to keep in mind if you are trying to look for "the next new thing."</FONT></P>
<P><FONT face=Tahoma>And then on the other side of the issue, later investigation proced that the earlier investigation was more pessimistic than it had to be. Which is okay -- it is the reason thst we always follow up our earlier investigation! But it makes it even easier to improve in the future.</FONT></P>
<P><FONT face=Tahoma>So hang in there, things seemed destined to get better here.... :-)</FONT></P>
<P><FONT face=Tahoma></FONT>&nbsp;</P>
<P><FONT face=Tahoma><FONT color=#ff0000><EM>This post brought to you by</EM> "‡ßç" <EM>(<A href="http://www.fileformat.info/info/unicode/char/09cd/index.htm">U+09cd</A>, a.k.a. BENGALI SIGN VIRAMA, a.a.k.a. BENGALI HASANT)</EM></FONT></FONT></P>
<hr/><div style="margin-left: 1em"><em>no comments</em></div><hr/><p><em>referenced by</em></p><div style="margin-left: 1em"><p>2006/02/03 <a href="http://archives.miloush.net/michkap/archive/2006/02/03/524139.html">We're drowning in LIPs!</a></p></div><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2005/06/05/425423.html" title="TechEd Orlando: Day 0">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2005/06/04/425286.html" title="Have a chat with me in the international cabana....">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2005-06">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2005-06-05">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2005/06/05/425307.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:41 GMT -->
</html>