<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2005/06/16/429667.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:41 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>What it means to be case insensitive</title></head><body>
<h1>What it means to be case insensitive</h1>
<p><em>by Michael S. Kaplan, published on 2005/06/16 02:30 -04:00, original URI: http://blogs.msdn.com/b/michkap/archive/2005/06/16/429667.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<P><FONT face=Tahoma>Brad Eck asked (in the microsoft.public.dotnet.internationalization newsgroup):</FONT></P>
<BLOCKQUOTE dir=ltr>
<P><EM><FONT size=2>I am calling the following code in a button click event. Every click causes <BR>the result set to 'toggle'. In otherwords, the original click will display <BR>'...,lIMES,LIMES,limes,...' and then the next click will display <BR>'...,limes,LIMES,lIMES,...'. Any ideas as to why?</FONT></EM><BR><BR><FONT face="Courier New" size=2>string [] myValues = {"strawberries", "PEARS", "lIMES", "LIMES", "lIMES", <BR>"Apple",<BR>"Ã†pple", "BERRIES", "grapes", "olives", "cantaloupe"};<BR><BR>Array.Sort(myValues, new CaseInsensitiveComparer(Application.CurrentCulture));<BR>string output = "";<BR>for (int itemCount = 0; itemCount &lt; myValues.Length; ++itemCount)<BR>output += myValues[itemCount]+",";<BR>MessageBox.Show(output);</FONT></P></BLOCKQUOTE>
<P><FONT face=Tahoma>Lets take a look at the sort keys for those three strings, with and without the case insensitive comparer:</FONT></P>
<BLOCKQUOTE dir=ltr>
<P><FONT face=Tahoma>Case Sensitive</FONT></P>
<BLOCKQUOTE dir=ltr>
<P><FONT face="Courier New">limes 0E 48 0E 32 0E 51 0E 21 0E 91 01 01 01 01 00<BR>lIMES 0E 48 0E 32 0E 51 0E 21 0E 91 01 01 02 12 12 12 12 01 01 00<BR>LIMES 0E 48 0E 32 0E 51 0E 21 0E 91 01 01 12 12 12 12 12 01 01 00</FONT></P></BLOCKQUOTE>
<P><FONT face=Tahoma>Case Insensitive</FONT></P><FONT face=Tahoma>
<BLOCKQUOTE dir=ltr>
<P><FONT face="Courier New">limes 0E 48 0E 32 0E 51 0E 21 0E 91 01 01 01 01 00<BR>lIMES 0E 48 0E 32 0E 51 0E 21 0E 91 01 01 01 01 00<BR>LIMES 0E 48 0E 32 0E 51 0E 21 0E 91 01 01 01 01 00</FONT></P></BLOCKQUOTE></BLOCKQUOTE></FONT>
<P><FONT face=Tahoma>Suddenly, it is all clear as to why the strings might be moving around with each click --&nbsp;because when they are case-insensitive, they are all equal! And when they are equal, you are at the mercy of the sorting algorithm, whatever it may be. For example in my experience, quicksorts I have written have always been very good at (for example) swapping the second and third items if you put these three in a list, and other sort algorithms will do other things in this case. But the case sensitive sort will be deterministic and will always sort in the order I give above, though all three strings will always be together.</FONT></P>
<P><FONT face=Tahoma>This is of course not true of all sorting algorithms, but the quicksort, while great for most cases, is not the best possible sort for when strings are already properly ordered in scenarios like this one (it is fair to say that strings being equal are already sorted!). Your mileage will vary even with slightly different quicksort imeplementations, let alone with other types of sorts....</FONT></P>
<P><FONT face=Tahoma></FONT>&nbsp;</P>
<P><FONT face=Tahoma><FONT color=#ff0000><EM>This post brought to you by</EM> "L" <EM>(<A href="http://www.fileformat.info/info/unicode/char/004c/index.htm">U+004c</A>, a.k.a. LATIN CAPITAL LETTER L)</EM></FONT></FONT></P>
<P><FONT face=Tahoma></FONT>&nbsp;</P>
<hr/><p><a id="429691" href="#429691">#</a> <strong>Maurits [MSFT]</strong> on 16 Jun 2005 2:33 AM:</p><div style="margin-left: 1em">Any sort can be made into a stable sort...<br>Break ties by comparing the initial positions of the tied elements.</div>
<p><a id="429695" href="#429695">#</a> <strong>Michael S. Kaplan</strong> on 16 Jun 2005 2:46 AM:</p><div style="margin-left: 1em">I don't disagree -- but most implementations are not stable in that sense....<br><br>Which was the cause of the problem neing reported....</div>
<p><a id="429713" href="#429713">#</a> <strong>TheMuuj</strong> on 16 Jun 2005 4:09 AM:</p><div style="margin-left: 1em">For sorting, wouldn't a culture-aware, case-sensitive comparer be good enough?  Wouldn't &quot;ABCD&quot; sort next to &quot;abcd&quot;, unlike in an Ordinal comparison?  I mean, with the exception that there *is* a defined difference between the two cases (the result != 0).<br><br>In other words, aren't case-insensitive comparisons only useful for equality comparison?<br><br>One possible workaround comes to mind.  You could write a comparer with a definite sorting order (one that never returns 0).  If you are sorting objects by a .Name property, and there are two names with the *exact* same .Name, you could always fall back on the object's hash code or something just to get some kind of predictable result.<br><br>But I'm really surprised that there isn't a version of Array.Sort in the framework that is stable.  That's a pretty big hole, if you ask me.</div>
<p><a id="429745" href="#429745">#</a> <strong>Michael S. Kaplan</strong> on 16 Jun 2005 7:54 AM:</p><div style="margin-left: 1em">Well, I am not saying that there isn't a stable sort in there somewhere -- there might be. I was just explaining what he was seeing...<br><br>But I am a huge fan of using case- (and everything else-) sensitive sorts whenever possible, because they find bugs. Especially in SQL Server but really everywhere. Mishmashing stuff together hides bugs and sometimes (like when dealing with Korean language stuff, and Indic languages, and others) even cause new bugs of their own.</div>
<p><strong>Erica</strong> on 24 Dec 2008 9:19 AM:</p><div style="margin-left: 1em"><p>Does anyone know how to explain case sensitive for the game NHL 2006? Im trying to explain it to my brother, but Its hard to explain, my definition is a bit wierd for that game, but it is a definition. Can someone tell me? My e-mail is espinisgreat1@yahoo.com . Someone please e-mail me soon! Thanks</p></div>
<hr/><p><em>referenced by</em></p><div style="margin-left: 1em"><p>2006/03/02 <a href="http://archives.miloush.net/michkap/archive/2006/03/02/542395.html">CompareString ignores case by lowercasing....</a></p></div><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2005/06/16/429759.html" title="More on locales in SQL Server">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2005/06/15/429279.html" title="Once more into the palindrome">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2005-06">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2005-06-16">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2005/06/16/429667.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:41 GMT -->
</html>