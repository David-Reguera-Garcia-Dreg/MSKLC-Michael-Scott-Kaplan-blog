<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2005/06/01/424067.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:41 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>It's not quite done yet</title></head><body>
<h1>It's not quite done yet</h1>
<p><em>by Michael S. Kaplan, published on 2005/06/01 23:35 -04:00, original URI: http://blogs.msdn.com/b/michkap/archive/2005/06/01/424067.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<P><FONT face=Tahoma>A few days ago I was <a href="http://archives.miloush.net/michkap/archive/2005/05/28/422808.html">blathering about time zones, locations, and keyboards</A> and I made the mistake of talking about how all of the various pieces Microsoft needed to integrate these technologies were already present:</FONT></P>
<BLOCKQUOTE dir=ltr>
<P><FONT face=Tahoma size=2><EM>And once upon a time, there was some effort to integrate the time zones and user locales as well, but that particular integration no longer really happens -- and it would honestly be better if it integrated with the GEO settings anyway. Especially since there is no documented, queryable mapping between locales and time zones, but a call to the </EM></FONT><A href="http://msdn.microsoft.com/library/en-us/intl/nls_6bqn.asp"><FONT face=Tahoma size=2><EM>GetGeoInfo</EM></FONT></A><FONT face=Tahoma size=2><EM> function with a </EM></FONT><A href="http://msdn.microsoft.com/library/en-us/intl/nls_7d2d.asp"><FONT face=Tahoma size=2><EM>SYSGEOTYPE</EM></FONT></A><FONT face=Tahoma size=2><EM> of GEO_TIMEZONES will return an array of all&nbsp;of the time zones in the selected location.</EM></FONT></P></BLOCKQUOTE>
<P><FONT face=Tahoma>Luckily, one of our two Internationalization MVPs (Mihai Nita) noticed that the emporer had no clothes, and <a href="http://archives.miloush.net/michkap/archive/2005/05/28/422808.html#423153">pointed out</A>:</FONT></P>
<BLOCKQUOTE dir=ltr>
<P><FONT face=Tahoma size=2><EM>Has anyone seen this working? <BR>Everything works fine except for GEO_OFFICIALLANGUAGES &amp; GEO_TIMEZONES . <BR>Tried it on XP SP2, 2003, Longhorn 5048, compiled with C++ from .NET 2003 and .NET 2005 beta 2. Nothing. <BR><BR>The easyest way to check it: <BR>GetGeoInfo( 244, GEO_TIMEZONES, NULL, 0, NULL ); <BR>Returns 0 and GetLastError also 0. <BR>It should return the size needed. <BR><BR>I have also tried providing a huge buffer, and I have tried with all GEOIDs (enumerated). <BR><BR>Thanks :-)</EM></FONT></P></BLOCKQUOTE>
<P><FONT face=Tahoma>Now I admit this was not really something I had tried before. I just assumed it worked since the <A href="http://msdn.microsoft.com/library/en-us/intl/nls_7d2d.asp">SYSGEOTYPE</A> topic, which documents all of the members of this enumeration:</FONT></P>
<BLOCKQUOTE dir=ltr>
<P><FONT face=Tahoma size=2>GEO_NATION<BR><FONT size=1>GEOID of a nation. This value is stored in a long integer.</FONT><BR>GEO_LATITUDE<BR><FONT size=1>The latitude of the GEOID. This value is stored in a floating point number.</FONT><BR>GEO_LONGITUDE <BR><FONT size=1>The longitude of the GEOID. This value is stored in a floating point number.</FONT><BR>GEO_ISO2<BR><FONT size=1>The ISO 2-letter country/region code. This value is stored in a string.</FONT><BR>GEO_ISO3<BR><FONT size=1>The ISO 3-letter country/region code. This value is stored in a string.</FONT><BR>GEO_RFC1766<BR><FONT size=1>An RFC1766-style string derived from the locale and GEOID (for nations only).</FONT><BR>GEO_LCID<BR><FONT size=1>A locale ID (LCID) derived from the language and the GeoID (for nations only).</FONT><BR>GEO_FRIENDLYNAME<BR><FONT size=1>The friendly name of the nation. Example: Germany. This value is stored in a string.</FONT><BR>GEO_OFFICIALNAME<BR><FONT size=1>The official name of the nation. Example: Federal Republic of Germany. This value is stored in a string.</FONT><BR>GEO_TIMEZONES<BR><FONT size=1>The time zones associated with the GEOID. These values are stored in an array of IDs.</FONT><BR>GEO_OFFICIALLANGUAGES<BR><FONT size=1>The official languages of the nation at the GEOID. These values are stored in an array of LCIDs.</FONT></FONT></P></BLOCKQUOTE>
<P><FONT face=Tahoma>did not bother to mention that those last two items have never yet been implemented in any version of Windows.</FONT></P>
<P><FONT face=Tahoma>Oops!</FONT></P>
<P><FONT face=Tahoma>Mihai is completely correct, here. And the docs should definitely be updated to reflect these limitations.</FONT></P>
<P><FONT face=Tahoma>Anyway, sorry for the misdirection, it was not intentional....</FONT></P>
<P><FONT face=Tahoma></FONT>&nbsp;</P>
<P><FONT face=Tahoma><FONT color=#ff0000><EM>This post brought to you by</EM> "M" </FONT><EM><FONT color=#ff0000>(<A href="http://www.fileformat.info/info/unicode/char/004d/index.htm">U+004d</A>, LATIN CAPITAL LETTER M)<BR><FONT size=2>The first letter in the words Mea Culpa!</FONT></FONT></EM></FONT></P>
<hr/><p><a id="424098" href="#424098">#</a> <strong>Mihai</strong> on 2 Jun 2005 12:03 AM:</p><div style="margin-left: 1em">In all fairness, this was pointed to my by Bill Hall, my teacher in i18n. I have only confirmed his discovery and complained about it :-) <br><br>I do not have his web site, and I would not post his email here without his permission.<br>But you can find an email address here: <a rel="nofollow" target="_new" href="http://www.i18nguy.com/services/internationalization-engineers.html">http://www.i18nguy.com/services/internationalization-engineers.html</a><br>and his book is top of the list here: <a rel="nofollow" target="_new" href="http://www.i18nguy.com/books.html">http://www.i18nguy.com/books.html</a></div>
<p><a id="424135" href="#424135">#</a> <strong>Michael S. Kaplan</strong> on 2 Jun 2005 1:10 AM:</p><div style="margin-left: 1em">I definitely know Bill Hall, we have spoken at many a Unicode conference together!<br><br>But he did not tap me about this one -- you did. And the docs will be updated because of that, so after they are updated you can know that you were someone who helped make that happen. :-)</div>
<hr/><p><em>referenced by</em></p><div style="margin-left: 1em"><p>2008/03/22 <a href="http://archives.miloush.net/michkap/archive/2008/03/22/8330506.html">GetGeoInfo is a mostly useless bloody waste of a function that only a "B" Ark Golgafrincham could love</a></p><p>2005/11/06 <a href="http://archives.miloush.net/michkap/archive/2005/11/06/489583.html">Time zones, GEOs, and Percents</a></p><p>2005/10/12 <a href="http://archives.miloush.net/michkap/archive/2005/10/12/479817.html">Some of GetGeoInfo is sorta broken</a></p></div><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2005/06/02/424128.html" title="The New String recommendations">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2005/06/01/423711.html" title="Knock knock! Who&#39;s there? Kana! Kana Who?">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2005-06">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2005-06-01">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2005/06/01/424067.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:41 GMT -->
</html>