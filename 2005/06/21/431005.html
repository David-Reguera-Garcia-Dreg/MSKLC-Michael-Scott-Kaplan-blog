<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2005/06/21/431005.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:41 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>Number format and currency format are not always the same</title></head><body>
<h1>Number format and currency format are not always the same</h1>
<p><em>by Michael S. Kaplan, published on 2005/06/21 05:51 -04:00, original URI: http://blogs.msdn.com/b/michkap/archive/2005/06/21/431005.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<P><FONT face=Tahoma>Almost a&nbsp;month ago I was talking about how <A href="http://msdn.microsoft.com/library/en-us/intl/nls_0rec.asp">GetCurrencyFormat</A> and <A href="http://msdn.microsoft.com/library/en-us/intl/nls_8a0k.asp">GetNumberFormat</A>&nbsp;take <a href="http://archives.miloush.net/michkap/archive/2005/05/29/422980.html">strings for their number parameters</A>&nbsp;and why. And&nbsp;John Bates&nbsp;<a href="http://archives.miloush.net/michkap/archive/2005/05/29/422980.html#425496">commented</A>:</FONT></P>
<BLOCKQUOTE dir=ltr>
<P><FONT face=Tahoma size=2><EM>One of my web forms (an invoice) has a column of currency amounts with a total at the bottom. The customer prefers to have the currency symbol only on the total. <BR><BR>So I should really be using GetCurrencyFormat for all the numbers, but have to use GetNumberFormat to get a string without the currency symbol. <BR><BR>So my question is: Does the number format for any locale differ from its currency format, with the exception of the symbol? </EM></FONT></P></BLOCKQUOTE>
<P><FONT face=Tahoma>The answer to that question is that there are indeed locales where they are different, indeed that is the reason that all of the settings between the two are kept separate. </FONT></P>
<P><FONT face=Tahoma>The PMs who work with customers and governments and subsidiaries know that the ramifications of adding an LCTYPE to <A href="http://msdn.microsoft.com/library/en-us/intl/nls_34rz.asp">GetLocaleInfo</A>, especially&nbsp;one that will affect other functions and parsing/formatting rules in Windows or the .NET Framework, keep them from ever adding <A href="http://msdn.microsoft.com/library/en-us/intl/nls_8rse.asp">LCTYPEs</A> without having proof that they are needed. It is in fact why sometimes the names do not seem 100% consistent (e.g. there is a LOCALE_SDECIMAL and then there is a LOCALE_SMONDECIMALSEP). The latter was added because it became clear that there are sometimes differences....</FONT></P>
<P><FONT face=Tahoma>And this is an ever-evolving issue. For example, when all of the various percentage formats were added for the .NET Framework, a lot of the data was always identical to the numeric formats, so&nbsp;extra data fields were not added for them. But as data comes in that there are differences in some cases (as it has been), then the decision on what fields to add has to be made....</FONT></P>
<P><FONT face=Tahoma>Sorry, John. You may want to find a better way to get the data....</FONT></P>
<P><FONT face=Tahoma></FONT>&nbsp;</P>
<P><FONT face=Tahoma color=#ff0000><EM>This post brought to you by</EM> "ã‰§" <EM>(<A href="http://www.fileformat.info/info/unicode/char/3267/index.htm">U+3267</A>, a.k.a. CIRCLED HANGUL IEUNG)</EM></FONT></P>
<hr/><p><a id="431323" href="#431323">#</a> <strong>Meikel Weber</strong> on 21 Jun 2005 6:50 PM:</p><div style="margin-left: 1em">&gt; So my question is: Does <br>&gt; the number format for any locale <br>&gt; differ from its currency format, <br>&gt; with the exception of the symbol? <br><br>Just download this one here:<br><a rel="nofollow" target="_new" href="http://www.freemem.de/InfoExplorer.zip">http://www.freemem.de/InfoExplorer.zip</a><br><br>Not release quality software, not very beautiful, not code signed, but made for questions like this one. I built it while I was examining the whole international features of Windows.<br>Should run from 95 to 2003 just fine.</div>
<p><a id="431334" href="#431334">#</a> <strong>John Bates</strong> on 21 Jun 2005 7:18 PM:</p><div style="margin-left: 1em">That's what I thought.<br><br>So GetCurrencyFormat really needs a new associated API to retrieve the CURRENCYFMT structure for a specified locale, with flags to turn off currency symbols, etc. GetNumberFormat and GetDateFormat may also benefit from similar functions.<br><br>Are there any plans to add something similar to Longhorn? Can we also ask the owner of the GetXxxFormat functions to create a sample for MSDN that builds XxxFMT structures from the GetLocaleInfo results (especially for downlevel systems)?</div>
<p><a id="431400" href="#431400">#</a> <strong>Michael S. Kaplan</strong> on 22 Jun 2005 12:21 AM:</p><div style="margin-left: 1em">Hi John --<br><br>I can forward the suggestion on, it is a good one.<br><br>On the whole, I am not sure it is worth adding flags to change behavior.<br><br>If I were designing something here, I would probably not add a function at all -- I would add a flag to &quot;fill in data not provided by the caller in the struct, from the locale.&quot; <br><br>This would save people the trouble of having to call two functions....</div>
<hr/><p><em>referenced by</em></p><div style="margin-left: 1em"><p>2012/09/24 <a href="http://archives.miloush.net/michkap/archive/2012/09/24/10352537.html">NOTE TO SELF: Not every team in Microsoft does things the same way...</a></p><p>2011/02/18 <a href="http://archives.miloush.net/michkap/archive/2011/02/18/10128879.html">speaking with an accent, conceptually</a></p><p>2010/08/30 <a href="http://archives.miloush.net/michkap/archive/2010/08/30/10055550.html">A difference that makes no difference shouldn't make a difference, but...</a></p></div><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2005/06/21/431062.html" title="Whither SHAnsiToUnicode?">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2005/06/20/430924.html" title="Jim Boggia in Seattle, July 13th">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2005-06">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2005-06-21">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2005/06/21/431005.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:41 GMT -->
</html>