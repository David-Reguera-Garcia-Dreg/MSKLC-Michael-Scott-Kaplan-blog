<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2005/06/18/430507.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:41 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>Font substitution and linking #3</title></head><body>
<h1>Font substitution and linking #3</h1>
<p><em>by Michael S. Kaplan, published on 2005/06/19 00:20 -04:00, original URI: http://blogs.msdn.com/b/michkap/archive/2005/06/18/430507.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<FONT face=Tahoma>
<P><FONT face=Tahoma>Earlier posts about font linking, substitution and fallback were:</FONT></P>
<P><FONT face=Tahoma><a href="http://archives.miloush.net/michkap/archive/2005/03/20/399322.html">Font substitution and linking #1</A>&nbsp;(About font substitution)<BR><a href="http://archives.miloush.net/michkap/archive/2005/05/16/417711.html">Font substitution and linking #2</A>&nbsp;(About industrial strength font linking, with MLang)</FONT></P>
<P>Anyway, at&nbsp;the end of last month, M.W. Grossman asked me the following question:</FONT></P><FONT face=Tahoma><FONT size=2>
<BLOCKQUOTE dir=ltr style="MARGIN-RIGHT: 0px">
<P><EM>Unicode is so much fun. My company has paid me to read through most of your writing today (thanks for the Steve Taylor tip) but haven't found anything that gets into what I'm looking for, namely the method used to determine which font is selected and how to influence this. </EM></P>
<P><EM>My problem lies in a mixed CJK system. The won, yuan and yen characters are being displayed differently depending on the client OS (Win2K, CHT/CHS/KOR/JPN). In JPN, everything displays well but both CHT and CHS mangle all currencies but the yuan and dollar. All machines have a number of CJK fonts in addition to MS Mincho and clearly there's some font substitution going on, but how and where? I can't be the only one wondering about this but I can't find anything on the subject beyond references to "MS Shell Dlg 2".</EM></P></BLOCKQUOTE></FONT></FONT>
<P><FONT face=Tahoma>An interesting problem, one that is rooted in the issues of Han unification that I have <a href="http://archives.miloush.net/michkap/archive/2005/05/22/420879.html">discussed previously</A>.</FONT></P>
<P><FONT face=Tahoma>What it comes down to is that there are many characters which can have four different possible looks:</FONT></P>
<UL>
<LI><FONT face=Tahoma><STRONG>Japanese</STRONG> will default to using&nbsp;MS UI Gothic (fallback to PMingLIU, then SimSun, then Gulim)</FONT> 
<LI><FONT face=Tahoma><STRONG>Korean</STRONG> will default to using&nbsp;Gulim (fallback to PMingLiu, then MS UI Gothic, then SimSun)</FONT> 
<LI><FONT face=Tahoma><STRONG>Simplified Chinese</STRONG> will default to using SimSun (fallback to PMingLiu, then MS UI Gothic, then Batang)</FONT> 
<LI><FONT face=Tahoma><STRONG>Traditional Chinese</STRONG> will default to using PMingLiu (fallback to SimSun, then MS Mincho, then Batang)</FONT></LI></UL>
<P><FONT face=Tahoma>Now there are nuances like when you install HKSCS stuff for Hong Kong or GB18030 stuff for China and other random things that I'll talk some other time. But the above four are the msin font linking rules.</FONT></P>
<P><FONT face=Tahoma>The change depends on the setting of the NLS default system locale (meaning of course that this is a setting that is not just for non-Unicode programs!). It affects the behavior of several things, according to the rules spelled out above for each group -- linking to the fonts <EM>in that given order</EM>:</FONT></P>
<UL>
<LI><FONT face=Tahoma>The preferred font for each group (for EA system locales)</FONT> 
<LI><FONT face=Tahoma>Lucida Sans Unicode</FONT> 
<LI><FONT face=Tahoma>Microsoft Sans Serif (<EM>not MS Sans Serif!</EM>)</FONT> 
<LI><FONT face=Tahoma>Tahoma</FONT></LI></UL>
<P><FONT face=Tahoma>This is the most common Windows XP/Server 2003 list, it changes a bit between versions depending on default UI fonts -- mainly by adding new entries but leaving the old ones intact. Your mileage may vary, especially as some third party font installs will often try to modify these settings, often with success but occasionally with messed up registry setttings....</FONT></P>
<P><FONT face=Tahoma>Now I have gone on for quite a while here, without explaining what this linking <EM>does</EM>. The essential task performed is to give the operating system a list of fonts to look in <EM>and an order to look in them</EM>&nbsp;when the requested character cannot be found in the original font. Given that both Han unification and typographic traditions will dictate a specific look, feel, and glyph design&nbsp;to each font, the list is chosen so that a cirrect choice for the default system locale is most likely to give an intuitive look to the text that is shown on Windows.</FONT></P>
<P><FONT face=Tahoma>The actual mapping is found in the registry; it is seen in the values under HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\FontLink\SystemLink. A change requires a new windowstation, which for all shipping versions of Windows means either a reboot (which the default system locale requires anyway) or a new Terminal Services session.</FONT></P>
<P><FONT face=Tahoma>Of course, the user can always override these things if he wants to by explicitly choosing the 'right' default system locale; the developer can override these&nbsp;things if she needs to&nbsp;p.r.n. by choosing the fonts to use, explicitly. But in both cases, the user and the developer will often just <a href="http://archives.miloush.net/michkap/archive/2005/05/13/417167.html">use the default</A>.</FONT></P>
<P><FONT face=Tahoma>But if you are a developer who is wanting to influence the selection here, PLEASE consider explicitly choosing a font rather than changing a system wide setting....</FONT></P>
<P><FONT face=Tahoma></FONT>&nbsp;</P>
<P><FONT face=Tahoma><FONT color=#ff0000><EM>This post brought to you by</EM> "ä¸€" <EM>(<A href="http://www.fileformat.info/info/unicode/char/004c/index.htm">U+4e00</A>, a.k.a. the first CJK Unified Idedograph)<BR><FONT size=1>One of the few ideographs used by all languages that use Han/Kanji/Hanja but that does not tend to vary too much in style....</FONT></EM></FONT></FONT></P>
<hr/><p><a id="430618" href="#430618">#</a> <strong>Mihai</strong> on 19 Jun 2005 3:35 PM:</p><div style="margin-left: 1em">Back in March you wrote:<br>&quot;In fact, one of the first things I do with each new version of Word is find out how to set the Print TrueType Fonts as Graphics setting...&quot;<br><br>To achieve this I go to the printer settings - advanced - printing defaults - advanced, and change Truetype font from &quot;Substitute with Device Font&quot; to &quot;Download as Softfont&quot;<br>Some printer drivers also give access to the substitution table. I set everything to use downloaded fonts.<br><br>This improves the performance, works for all applications, not only Word, and never had a problem.</div>
<p><a id="430633" href="#430633">#</a> <strong>Michael S. Kaplan</strong> on 19 Jun 2005 7:20 PM:</p><div style="margin-left: 1em">Yep, that is the setting I mean -- I should have been more specific about whose dialogs moved around -- it is not Word's (although if you go there from Word, *their* dialogs move around, too!). It is either the ones from the Windows print dlg or the ones from the driver. Or sometimes both....<br><br>Great tip, though. Thanks!</div>
<p><a id="433840" href="#433840">#</a> <strong>Mike Lippert</strong> on 29 Jun 2005 11:55 AM:</p><div style="margin-left: 1em">OK, Supposed my application installs a font that supports some of the specialized math characters (and not much else). Is it really a bad idea to append this font to the font linking list for the system?<br><br>I'd like these characters to show up in browsers, and other documents that use these Unicode characters without having to actually select a font each time they're used.<br><br>Granted that this would also make displaying these characters in tooltip messages in my app easier.<br><br>Mike<br></div>
<p><a id="433851" href="#433851">#</a> <strong>Michael S. Kaplan</strong> on 29 Jun 2005 12:17 PM:</p><div style="margin-left: 1em">Hi Mike,<br><br>The thing is that these characters will also be in other fonts. So if you put your math font at the top of the list, people wsill randomly pick up this differently styled text for individual characters. And if you put it at the bottom, your math text will suffer with the same problem.<br><br>Font linking should be a last resort if you want things to look right -- and I assume that when you do math you want things to always look right?</div>
<p><a id="436667" href="#436667">#</a> <strong>Mike Lippert</strong> on 7 Jul 2005 8:26 PM:</p><div style="margin-left: 1em">Well, your assumption is correct, for the math it had better look right. However, I'm actually working on getting the tooltips to display correctly and we don't need that many characters. Actually right now we only need the U+0192 Latin Small Letter F With Hook and U+2192 Rightwards Arrow. They're even usually available in the normal Arial font. However they aren't both available in Tahoma, and the user is free to change the tooltip font using the Windows Display Properties.<br><br>I guess I was hoping that I could have our installer modify a font-linking entry in the registry so that those characters would always be available and not ever be displayed as a square box.<br><br>Wouldn't it be better to have the massive Unicode font as a final fallback so that the user sees some reasonable approximation of what character is being displayed, rather than a square box?<br><br>Mike<br></div>
<p><a id="436711" href="#436711">#</a> <strong>Michael S. Kaplan</strong> on 7 Jul 2005 11:07 PM:</p><div style="margin-left: 1em">Well, one cannot always assume that fonts like Arial Unicode MS will be there (it does not ship with the OS), and in some cases (like CJK) the glyphs in that font may not be preferred at all, which can make it problematic as a fallback that could be seeing so much use, potentially....</div>
<p><a id="438151" href="#438151">#</a> <strong>Mike Lippert</strong> on 12 Jul 2005 6:29 PM:</p><div style="margin-left: 1em">OK, so it's really not a good idea to modify the system wide font-linking.<br><br>That means I'll have to go back to one of your earlier posts and figure out how to create a font-linked font when displaying tooltips.<br><br>Could you give me any advice as to which font I could choose to link that should have the 2 characters named above (U+0192 &amp; U+2192) and exists on all versions of Windows (2000 &amp; above) internationally? (Actually I'm most interested in the English, European and Chinese, Japanese and Korean Windows). Arial on my system has both those characters, but can I assume that will be true on all the Windows systems?<br><br>I think that this is likely a common issue, that people want a few rare characters to display and are not sure how to make that happen, or whether they can count on them existing on all systems.<br><br>Thanks,<br>Mike</div>
<p><a id="438266" href="#438266">#</a> <strong>Michael S. Kaplan</strong> on 13 Jul 2005 12:18 AM:</p><div style="margin-left: 1em">You can actually assume that Arial will be on all of those systems -- it is one of the &quot;core fonts&quot; that is always there.</div>
<p><a id="438391" href="#438391">#</a> <strong>Mike Lippert</strong> on 13 Jul 2005 10:28 AM:</p><div style="margin-left: 1em">Awesome,<br>Thanks for your help Michael. And many many thanks for your blog!<br><br>Mike</div>
<hr/><p><em>referenced by</em></p><div style="margin-left: 1em"><p>2012/01/26 <a href="http://archives.miloush.net/michkap/archive/2012/01/26/10260726.html">If font linking doesn't fit the text to a T (or È›!), a Romanian letter may be right but not quite look it</a></p><p>2008/03/19 <a href="http://archives.miloush.net/michkap/archive/2008/03/19/8323216.html">The forensic typographers found no link to Lucida Console, and the D.A. had nothing to fallback to</a></p><p>2008/01/17 <a href="http://archives.miloush.net/michkap/archive/2008/01/17/7141157.html">Expertise isn't always everything (aka When the one who is learning teaches us something important)</a></p><p>2007/07/07 <a href="http://archives.miloush.net/michkap/archive/2007/07/07/3738133.html">We've got a style of glyphs, yes we do; we've got a style of glyphs, how 'bout you?</a></p><p>2006/06/06 <a href="http://archives.miloush.net/michkap/archive/2006/06/06/618628.html">Is this the Ãœber-font post? No, but it is the teaser for it!</a></p><p>2006/03/14 <a href="http://archives.miloush.net/michkap/archive/2006/03/14/551068.html">GDI Font Linking in GDI+</a></p><p>2006/03/08 <a href="http://archives.miloush.net/michkap/archive/2006/03/08/546809.html">You can often do better than [GDI] font linking</a></p><p>2006/01/22 <a href="http://archives.miloush.net/michkap/archive/2006/01/22/515864.html">Questions about font linking, etc.</a></p><p>2005/12/28 <a href="http://archives.miloush.net/michkap/archive/2005/12/28/507759.html">Getting rid of your extra yen</a></p></div><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2005/06/19/430591.html" title="Star Trek with linguistic pretensions">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2005/06/17/430391.html" title="Anyone having trouble with MSKLC on an x64 machine?">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2005-06">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2005-06-18">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2005/06/18/430507.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:41 GMT -->
</html>