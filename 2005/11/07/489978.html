<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2005/11/07/489978.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:40 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>SQL Server and the CLR have different ways of getting the money</title></head><body>
<h1>SQL Server and the CLR have different ways of getting the money</h1>
<p><em>by Michael S. Kaplan, published on 2005/11/07 15:20 -05:00, original URI: http://blogs.msdn.com/b/michkap/archive/2005/11/07/489978.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<P><FONT face=Tahoma><A href="http://blogs.sqlpassj.org/yoshihirokawabata/archive/2005/11/06/14767.aspx">Yoshihiro Kawabata</A> said (in the suggestion box):</FONT></P>
<BLOCKQUOTE dir=ltr style="MARGIN-RIGHT: 0px">
<P><FONT size=2><EM>Hello, Michael <BR><BR>I listed up NumberFormatInfo's Culture related property in .NET by C#. The result posted below blog. <BR></EM></FONT><A href="http://blogs.sqlpassj.org/yoshihirokawabata/archive/2005/11/06/14767.aspx" target=_new rel=nofollow><FONT size=2><EM>http://blogs.sqlpassj.org/yoshihirokawabata/archive/2005/11/06/14767.aspx</EM></FONT></A><FONT size=2><EM> <BR><BR>And then, the result is very different with SQL Server's Currency Symbols. <BR></EM></FONT><A href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/acdata/ac_8_con_03_5c69.asp" target=_new rel=nofollow><FONT size=2><EM>http://msdn.microsoft.com/library/default.asp?url=/library/en-us/acdata/ac_8_con_03_5c69.asp</EM></FONT></A><FONT size=2><EM> <BR><BR>1.A lot of culture's .NET currency symbol have over 2 charactors but SQL Server always 1 char. <BR>2.SQL Server's Decimal Seprarator and Group Separator always , and . but there are so many valiation , . / - in .NET. <BR>3.SQL Server's positivePattern always is $10, but there are a lot of valiation 10 $, $ 10 etc, in .NET <BR><BR>We need to common currency between applications. </EM></FONT></P></BLOCKQUOTE>
<P><FONT face=Tahoma>I would take <a href="http://archives.miloush.net/michkap/archive/2005/10/12/479561.html">the table put together with your help</A> as much more representative of what SQL Server is doing, myself. :-)</FONT></P>
<P><FONT face=Tahoma>The problem here is a different one than was posted to talk about SQLCLR consistency in collation, entitled <a href="http://archives.miloush.net/michkap/archive/2005/06/09/427293.html">String.Compare is for sissies (not for people who want SQLCLR consistency)</A>. But in a way it is much more insidious. We are basically looking at two entirely different models:</FONT></P>
<UL>
<LI><FONT face=Tahoma><STRONG>SQL Server</STRONG>: Accept any of the hard coded list of currency symbols as valid (one UTF-16 code point maximumj), assume US formatting rules for currency values</FONT></LI>
<LI><FONT face=Tahoma><STRONG>.NET Framework</STRONG>: Accept only the valid currency symbol for the culture (however long it is), assume formatting matches the culture's preferences.</FONT></LI></UL>
<P><FONT face=Tahoma>As you can see, the main difference has to do with SQL Server attempting to be independent of culture/locale settings, while the .NET Framework embraces its dependence on these things.</FONT></P>
<P><FONT face=Tahoma>While I would like to embrace the plan of a common currency handling between Microsoft applications, I am not sure how it could really happen, though. Because neither Windows nor the .NET Framewok are changing their reliace on the locale/culture preferences in parsing/formatting operations.</FONT></P>
<P><FONT face=Tahoma>And if SQL Server made any changes to their model, they would break any customer using them today. Which is also not so great. It would have to be new conversion mechanisms of some sort so that the old (broken) method was still possible.</FONT></P>
<P><FONT face=Tahoma>In the long run, I would love it if blogs like the <a href="http://blogs.msdn.com/sqlclr/">SQLCLR</A> one and the people behind it could be pushing on the compatibility problems here; they are certainly not trivial.</FONT></P>
<P><FONT face=Tahoma>In the meantime, I will admit my bias for the NLS plan and not use the SQL Server locale-independent mishmosh for handling strings and converting them to various types. :-)</FONT></P>
<P><FONT face=Tahoma></FONT>&nbsp;</P>
<P><FONT face=Tahoma color=#ff1493><EM>This post brought to you by</EM> "<FONT size=6>Â¤</FONT>" <EM>(<A href="http://www.fileformat.info/info/unicode/char/00A4">U+00a4</A>, a.k.a. CURRENCY SIGN)</EM></FONT></P>
<hr/><p><a id="491218" href="#491218">#</a> <strong>Yoshihiro kawabata</strong> on 10 Nov 2005 4:05 AM:</p><div style="margin-left: 1em">Hello, Thank you for picking up our suggestion.<br>I agree to solution by SQLCLR.<br>And I hope that MSKB or .NET/SQL Help reveal a difference between .NET/SQL Currency,<br>because so many people dosent konw these issue.<br><br></div>
<p><a id="491283" href="#491283">#</a> <strong>Michael S. Kaplan</strong> on 10 Nov 2005 9:07 AM:</p><div style="margin-left: 1em">I agree completely -- and hope that such KB/doc/core support can happen in the future....</div>
<hr/><p><em>referenced by</em></p><div style="margin-left: 1em"><p>2007/11/09 <a href="http://archives.miloush.net/michkap/archive/2007/11/09/6006868.html">If you get a yen for something a bit wider you might be out of luck</a></p></div><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2005/11/08/490305.html" title="SQL Compatibility collations are a bit too retro for me">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2005/11/06/489605.html" title="Saying please and thank you">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2005-11">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2005-11-07">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2005/11/07/489978.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:40 GMT -->
</html>