<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2005/11/06/489583.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:40 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>Time zones, GEOs, and Percents</title></head><body>
<h1>Time zones, GEOs, and Percents</h1>
<p><em>by Michael S. Kaplan, published on 2005/11/06 13:15 -05:00, original URI: http://blogs.msdn.com/b/michkap/archive/2005/11/06/489583.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<P><FONT face=Tahoma>John Bates asked in the Suggestion Box:</FONT></P>
<BLOCKQUOTE dir=ltr style="MARGIN-RIGHT: 0px">
<P><EM><FONT size=2>1. Will Vista/future NLS support expose timezone info get/set APIs? If so will it also be tied to the GeoInfo APIs? </FONT></EM></P>
<P><EM><FONT size=2>2. Will Vista expose the percentage-related formatting currently in .NET's NumberFormat class in Win32? </FONT></EM></P>
<P><EM><FONT size=2>Thanks in advance. </FONT></EM></P></BLOCKQUOTE>
<P><FONT face=Tahoma>Well, of course there are the <A href="http://msdn.microsoft.com/library/en-us/sysinfo/base/gettimezoneinformation.asp">GetTimeZoneInformation</A> and <A href="http://msdn.microsoft.com/library/en-us/sysinfo/base/settimezoneinformation.asp">SetTimeZoneInformation</A> functions in the Win32 API, both of which work with a <A href="http://msdn.microsoft.com/library/en-us/sysinfo/base/time_zone_information_str.asp">TIME_ZONE_INFORMATION</A> struct:</FONT></P>
<BLOCKQUOTE dir=ltr style="MARGIN-RIGHT: 0px">
<P><FONT face="Courier New"><STRONG>typedef struct _TIME_ZONE_INFORMATION {<BR>&nbsp; &nbsp; LONG Bias;<BR>&nbsp;&nbsp;&nbsp; WCHAR StandardName[32];<BR>&nbsp; &nbsp; SYSTEMTIME StandardDate;<BR>&nbsp;&nbsp;&nbsp; LONG StandardBias;<BR>&nbsp; &nbsp; WCHAR DaylightName[32];<BR>&nbsp;&nbsp;&nbsp; SYSTEMTIME DaylightDate;<BR>&nbsp; &nbsp; LONG DaylightBias;<BR>} TIME_ZONE_INFORMATION, *PTIME_ZONE_INFORMATION;</STRONG></FONT></P></BLOCKQUOTE>
<P><FONT face=Tahoma>Though of course as I mentioned before in the post&nbsp;<a href="http://archives.miloush.net/michkap/archive/2005/06/01/424067.html"><STRONG>It's not quite done yet</STRONG></A>, the GEO integration tantalizingly placed in the <A href="http://msdn.microsoft.com/library/en-us/intl/nls_6bqn.asp">GetGeoInfo</A> function with the GEO_TIMEZONES <A href="http://msdn.microsoft.com/library/en-us/intl/nls_7d2d.asp">SYSGEOTYPE</A>&nbsp;is not actually hooked right not. And the time zone functions I mentioned earlier do not take the ID values that the GEO function would return -- no function does. So the answer to what you meant to ask with the first question is not at the moment....</FONT></P>
<P><FONT face=Tahoma>Though I can promise you that enhanced support in the whole area of time zones is getting higher and higher on the priority list in both Windows and the .NET Framework all the time.</FONT></P>
<P><FONT face=Tahoma>The other question, about the percent formatting values, is that the current plan does not have them in Vista either. Percent formatting is actually one of the interesting features that was inherited in the .NET Framework from prior versions of Visual Basic and COM; you can actually notice the signs of this legacy when you see how many of the formatting values inherit information from the number formatting (though it looks like there may be a few cultues in which this may not be entirely correct).</FONT></P>
<P><FONT face=Tahoma>Though this too is on the list of possible ideas for the future, at which point a <EM>GetPercentFormat</EM> function could be added to go alongside the <A href="http://msdn.microsoft.com/library/en-us/intl/nls_8a0k.asp">GetNumberFormat</A> and <A href="http://msdn.microsoft.com/library/en-us/intl/nls_0rec.asp">GetCurrencyFormat</A> functions in the NLS API today.</FONT></P>
<P><FONT face=Tahoma></FONT>&nbsp;</P>
<P><FONT face=Tahoma color=#ff1493><EM>This post brought to you by</EM> "<FONT size=6>ï¼…</FONT>" <EM>(<A href="http://www.fileformat.info/info/unicode/char/ff05">U+ff05</A>, a.k.a. FULLWIDTH PERCENT SIGN)</EM></FONT></P>
<hr/><p><a id="489622" href="#489622">#</a> <strong>Serge Wautier</strong> on 6 Nov 2005 5:40 PM:</p><div style="margin-left: 1em">I second John regarding the lack of an API to enumerate time zones and retrieve each time zone settings (not only the current one).<br><br>No offense, Michael, but with a new version of Windows every 5 years, a higher and higher priority on you guys priority list may not mean we'l get it soon :-(</div>
<p><a id="489682" href="#489682">#</a> <strong>Michael S. Kaplan</strong> on 6 Nov 2005 9:09 PM:</p><div style="margin-left: 1em">Hi Serge --<br><br>I won't say I disagree with you on time zone issue, but I will say that when you don't the core functionality in question (time zones), it is much harder to add features to it (since there are many stakeholders and several different opinions on the best way to do things)....</div>
<p><strong>Anonymous Coward</strong> on 16 Oct 2007 9:03 PM:</p><div style="margin-left: 1em"><P>Checkout PublicDomain.dll which has Olson Time Zone database support, and also code to get all Win32 time zones in static method Win32.GetSystemTimeZones.</P>
<P><A href="http://www.codeplex.com/publicdomain" target=_new rel=nofollow>http://www.codeplex.com/publicdomain</A></P>
<P>and</P>
<P><A href="http://www.codeproject.com/useritems/Using_time_zones_in_NET.asp" target=_new rel=nofollow>http://www.codeproject.com/useritems/Using_time_zones_in_NET.asp</A></P></div>
<hr/><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2005/11/06/489593.html" title="Attempting to control thought via language">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2005/11/05/489505.html" title="Word rage is in Southeast Asia, too">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2005-11">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2005-11-06">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2005/11/06/489583.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:40 GMT -->
</html>