<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2005/11/13/491646.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:40 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>Hungarian is even more complicated than I thought</title></head><body>
<h1>Hungarian is even more complicated than I thought</h1>
<p><em>by Michael S. Kaplan, published on 2005/11/13 01:01 -08:00, original URI: http://blogs.msdn.com/michkap/archive/2005/11/13/491646.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostOld -->
<P><FONT face=Tahoma>Back in August in the post <STRONG><a href="http://archives.miloush.net/michkap/archive/2005/08/10/449909.html">Double compressions -- Hungarian goulash?</A></STRONG> I described how double compressions worked in Windows and the .NET Framework.</FONT></P>
<P><FONT face=Tahoma>It&nbsp;can indeed be a complicated feature to support, and not just for the reasons I explicitly stated but because you not only need to make text pieces&nbsp;like <STRONG>ddzs</STRONG> equivalent to <STRONG>dzsdzs</STRONG> but also because you had to treat both strings as if they contained two sort elements (more on sort elements <a href="http://archives.miloush.net/michkap/archive/2005/07/19/440320.html">here</A> and <a href="http://archives.miloush.net/michkap/archive/2005/07/20/440842.html">here</A>).</FONT></P>
<P><FONT face=Tahoma>It is not so hard to do though, and we have supported it for a long time without people complaining about the support.</FONT></P>
<P><FONT face=Tahoma>It turns out that the truth is even more complicated than that, though!</FONT></P>
<P><FONT face=Tahoma>You see in the language there are two behaviors that are supposed to be captured:</FONT></P>
<OL>
<LI><FONT face=Tahoma>As I said,&nbsp;<STRONG>ddzs</STRONG> should be treated as equivalent to <STRONG>dzsdzs</STRONG> when doing comparisons;</FONT> 
<LI><FONT face=Tahoma>Additionally, <STRONG>ddzs</STRONG> should be sorted as if it were <STRONG>d</STRONG> + <STRONG>dzs</STRONG> rather than <STRONG>dzsdzs</STRONG>.</FONT></LI></OL>
<P><FONT face=Tahoma>As I have said <a href="http://archives.miloush.net/michkap/archive/2005/04/10/406880.html#406999">previously</A>&nbsp;though, comparison <STRONG>is</STRONG>&nbsp;sorting on Windows. For linguistic purposes, both are done through the same basic functions, such as <A href="http://msdn.microsoft.com/library/en-us/winui/winui/windowsuserinterface/resources/strings/stringreference/stringfunctions/comparestring.asp">CompareString</A>.</FONT></P>
<P><FONT face=Tahoma>In order to support these two different operations, you would need to have an additional <STRONG>EqualString</STRONG> function to give the linguistic absolute equality question while still giving the different answer for collation. And the behavior of <STRONG>EqualString</STRONG> would almost always be identical to the behavior of <A href="http://msdn.microsoft.com/library/en-us/winui/winui/windowsuserinterface/resources/strings/stringreference/stringfunctions/comparestring.asp">CompareString</A>&nbsp;returning CSTR_EQUAL, with the only exceptions being that:</FONT></P>
<UL>
<LI><FONT face=Tahoma>cases like above one in Hungarian double compressions could in theory be supported;</FONT> 
<LI><FONT face=Tahoma>it could be&nbsp;a bit&nbsp;faster since it no longer has to detect which comes first; any difference of any weight level would cause the function to immediately return the result.</FONT></LI></UL>
<P><FONT face=Tahoma>Note that is really not&nbsp;as good&nbsp;of a reason that there being both an <A href="http://msdn.microsoft.com/library/en-us/kmarch/hh/kmarch/k109_ddeef320-7510-446b-af6f-756c3999bec1.xml.asp">RtlCompareUnicodeString</A> and an&nbsp;<A href="http://msdn.microsoft.com/library/en-us/kmarch/hh/kmarch/k109_67ef861f-4f4b-4e98-be53-8962b02df08e.xml.asp">RtlEqualString</A>&nbsp;in ntdll.dll, because both of those functions immediately return the results when any difference is found. </FONT><FONT face=Tahoma>Because although we could argue the speed differences between "<EM>the difference of two numbers not being zero</EM>" and "<EM>two numbers not being equal</EM>" in compiled code, it is nowhere near the order of magnitude of difference in speed you would see in a linguistic function that could stop on the first character an return FALSE when comparing <STRONG>Abcdefg</STRONG> and <STRONG>abcdefĝ</STRONG> rather than needing to walk the whole string to know it should return CSTR_LESS_THAN.</FONT></P>
<P><FONT face=Tahoma>One unfortunate side effect of this post and talking about a theoretical&nbsp;<STRONG>EqualString</STRONG>&nbsp;is that the more I type, the more I think it might actually be a useful function to have available, given the large number of times that one might really prefer to answer the abolute identity question rather than a which one comes first question.</FONT></P>
<P><FONT face=Tahoma>Though in principle,&nbsp;in most cases absolute identity is only important in binary/ordinal comparisons, not linguistic ones -- such as looking at filenames and other symbolic identifiers. This issue with Hungarian double compressions being a great example of an exception to that principle, of course.</FONT></P>
<P><FONT face=Tahoma>It is interesting to speculate why complaints have never been escalated by the Hungarian users of Windows, since as our collation is sorting rather than absolute identity, the behavior is technically incorrect. Although I suspect that</FONT></P>
<UL>
<LI><FONT face=Tahoma>The number of real world situations where such string comparisons might&nbsp;return different results&nbsp;could be reasonably small;</FONT> 
<LI><FONT face=Tahoma>Hungarian customers may simply accept and enjoy&nbsp;the identity-type behavior in both situations;</FONT> 
<LI><FONT face=Tahoma>Those customers&nbsp;may actually be resigned to the situation;</FONT> 
<LI><FONT face=Tahoma>Some other reason I do not understand.</FONT></LI></UL>
<P><FONT face=Tahoma>Truth be told I am hoping it is mostly the first&nbsp;and/or second&nbsp;of these&nbsp;four options. :-)</FONT></P>
<P><FONT face=Tahoma>Though I must say that language issues such as this one fascinate me and sometimes frighten me, as I think about how the behavior on Windows can shape user experiences and expectations&nbsp;across a culture. It definitely encourages me to try hard to do right by the language and not make decisions that would negatively impact a language or its usage!</FONT></P>
<P><FONT face=Tahoma></FONT>&nbsp;</P>
<P><FONT face=Tahoma color=#ff1493><EM>This post brought to you by</EM> "<FONT size=6>ĝ</FONT>" <EM>(<A href="http://www.fileformat.info/info/unicode/char/011d">U+011d</A>, a.k.a. LATIN SMALL LETTER G WITH CIRCUMFLEX)</EM></FONT></P>
<hr/><p><a id="492237" href="#492237">#</a> <strong>Szajd</strong> on Sunday, November 13, 2005 6:26 AM:</p><div style="margin-left: 1em">Yes, Hungarian is quite difficult and complex.<br><br>Let me illustrate you another one: we have letters that consist of two characters (dzs is the only letter in the Hungarian alphabet which is three characters long). We have these letters also: sz and zs. And we have this word here: eg&#233;szs&#233;gedre, which is not a rare word (it means: &quot;bless you&quot;). How should a machine know, that in the middle its [sz + s] or [s + zs]?<br>And also with dzs, you could imagine the following example now: you not only have the problem of ddzs being [dzsdzs] or [d + dzs], but dzs itself could be [d + zs]! Wow.<br><br>But I for myself can't tell you any real-world examples for these. I mean I really can't say nothing for the problem you described. For the first proble mI described, there are some other words in Hungarian where there could be problems with sz and zs. And in the third one, one might imagine a compound word, where the first part ends with a letter D, and the second starts with zs.<br><br>You wanna learn some Hungarian? It's easy. ;)</div>
<p><a id="492247" href="#492247">#</a> <strong>denis bider</strong> on Sunday, November 13, 2005 9:31 AM:</p><div style="margin-left: 1em">I think people need to simplify their languages.<br><br>In my experience, the primary reason such complexities endure is destructive: nationalistic pride, arising out of a fear that the nation will otherwise be trampled. Fear of change, fear of foreigners.<br><br>In order to protect this sense of false security, people go to great lengths to maintain traditions which would have long become a useless burden otherwise. Examples are plenty : the French language board, a Don Quixotic attempt to &quot;protect&quot; against English; Japan and Kanji, taking children a perplexingly long time to learn, which they could spend learning many more things that would be more useful (including, perhaps, a foreign language?).<br><br>We are all human; only good can come from mixing freely. Maintaining disfunctional traditions just for the sake of it does not lead anywhere (except perhaps to war). Nationalism is inherently bad.<br><br>I'm not American, and not from an English speaking country either. But I think people should embrace the opportunity to unite (in a global language, and a global culture associated with it) rather than putting on brakes.</div>
<p><a id="492250" href="#492250">#</a> <strong>Michael S. Kaplan</strong> on Sunday, November 13, 2005 9:56 AM:</p><div style="margin-left: 1em">He Denis,<br><br>I do feel that inconsistencies should be fixed so that things can be implemented and used, but I do not feel it is fair to 'simplify' language where 'simplify' translated to cultural imperialism.<br><br>I think it is unfortunate that it has taken as long as it had to support some languages, but I would not want to see language diversity destroyed....</div>
<p><a id="492253" href="#492253">#</a> <strong>Michael S. Kaplan</strong> on Sunday, November 13, 2005 10:01 AM:</p><div style="margin-left: 1em">Hi Szajd --<br><br>Our implementation would find the first one and use it for sorting, which would be unfortunate if the second one was the intended one. And of course without a dictionary behind it there is no way to know the difference between dzs and d+zs.<br><br>As I just wrote to Denis, I am in favor of simplifications that eliminate inconsistencies or rules that cannot otherwise be implemented in software, but NOT if such changes are just due to laziness (thus vertical support or bidi is not in the same category for me as linguistoc compressions).<br><br>I wish I had time to learn Hungarian!</div>
<p><a id="492254" href="#492254">#</a> <strong>denis bider</strong> on Sunday, November 13, 2005 10:02 AM:</p><div style="margin-left: 1em">Diversity is not destroyed, it is replaced. All diversity requires maintenance, if by &quot;diversity&quot; you mean things that are alive (as opposed to a dead, but well-documented language such as Latin). The amount of diversity that is maintained in the world is therefore a function of the number of people living and the freedom they have. Language boards like the French actually restrict the freedom people have in expressing in diverse ways, so these attempts actually decrease the total amount of diversity.</div>
<p><a id="492255" href="#492255">#</a> <strong>Michael S. Kaplan</strong> on Sunday, November 13, 2005 10:09 AM:</p><div style="margin-left: 1em">Hi Denis,<br><br>I hear you, but I do not think that people outside a culture have the right to choose what is simply cruft and what is valuable. If change comes from within (something that has happened many times in many places) then that is fine. But if it comes from without then it is imperialism, and if software enforces it then the software is an agent of a destructive policy....</div>
<p><a id="492259" href="#492259">#</a> <strong>denis bider</strong> on Sunday, November 13, 2005 11:04 AM:</p><div style="margin-left: 1em">I agree, certainly the freedom of the people to choose is theirs. But software that fails to implement local idiosyncrasies does not enforce cultural imperialism. It just fails to implement a locally important feature, and it's going to get bad reputation for this, and if it's not improved it can be locally replaced by a competitor that does impleemnt the feature. :)<br><br>(If you're saying Microsoft's software cannot be replaced by a local competitor, you're admitting a monopoly. ;) )</div>
<p><a id="492265" href="#492265">#</a> <strong>Michael S. Kaplan</strong> on Sunday, November 13, 2005 11:31 AM:</p><div style="margin-left: 1em">Actually, what I notice is how hard other software tries to emulate (or at least be compatible with) Microsoft software.<br><br>If there are two dictionaries with two different collations, and Microsoft after working with government and linguitic experts chooses which one to use, and then other implementations follow, then have these companies affected language policy, creating language policy?<br><br>It definitely makes a difference, one I have actually lost sleep over on occasion!</div>
<p><a id="492310" href="#492310">#</a> <strong>Szajd</strong> on Sunday, November 13, 2005 4:44 PM:</p><div style="margin-left: 1em">Also, is there a way to find out the human-readable algorithm for a specifig language sorting. I'm pretty interested in Hungarian's. Or is that a secret.<br><br>But otherwise, I don't think it's a secret, but I couldn't find the difference about the so-called traditional and technical Hungarian sorting. What are these two things?</div>
<p><a id="492318" href="#492318">#</a> <strong>Michael S. Kaplan</strong> on Sunday, November 13, 2005 5:12 PM:</p><div style="margin-left: 1em">Hi Szajd,<br><br>Microsoft does not publish its tables or its algorithm, beyond the sorts of hints given in the first edition of Developing Interntional Software and on posts done this blog.<br><br>It is not an ownership issue (since we do not own a language's sort any more than a map company owns the land they sell maps for), but it is an IP issue, given the time, effort, and expense to develop (the same way a map company would not want people copying their maps and selling the copies).<br><br>The Hungarian technical sort does not have any of those compressions (the combinations of letters such as dz that both of us were taslking about earlier) and it puts uppercase characters before lowercase ones.</div>
<p><a id="493337" href="#493337">#</a> <strong>Peter</strong> on Wednesday, November 16, 2005 7:05 AM:</p><div style="margin-left: 1em">The top reason is Reason #1 -- like Szajd, I cannot think of any real-world examples when it would make a difference.<br><br>The only case I remember when someone complained was due to the difference between the default and the technical sort order of Hungarian: using default order, a case-insensitive comparison of &quot;PicSize&quot; and &quot;picsize&quot; will tell that the two text is different, because &quot;cs&quot; is a stand-alone letter in Hungarian. As Szajd pointed out, the obvious problem with this is that no software can tell what is &quot;c&quot; + &quot;s&quot; and what is &quot;cs&quot; or what is &quot;sz&quot; + &quot;s&quot; or &quot;s + zs&quot;.</div>
<p><a id="493340" href="#493340">#</a> <strong>Michael S. Kaplan</strong> on Wednesday, November 16, 2005 7:17 AM:</p><div style="margin-left: 1em">Hi Peter,<br><br>Ah, the reason for the first problem you mention is that when you use the default Hungarian we treat CS, Cs, and cs specially, but not cS (see <a rel="nofollow" target="_new" href="http://archives.miloush.net/michkap/archive/2005/07/17/439742.html">http://blogs.msdn.com/michkap/archive/2005/07/17/439742.aspx</a> for more information on that one). And then in the technical support there are no compressions so they are definitely related. But abbreviations like that can definitely make things confusing!<br><br>For the second issue, we will see the &quot;sz&quot; before we ever get to the last &quot;s&quot; so we have behavior that is consistent, if not correct....</div>
<p><a id="494387" href="#494387">#</a> <strong>Peter</strong> on Friday, November 18, 2005 5:47 AM:</p><div style="margin-left: 1em">Thanks Michael, that makes sense and appears to be the right approach in comparison's view of point.<br><br>I fully understand, however, the surprise of the developer who faced with this PicSize vs. Picsize problem -- as humans, we expect that the OS will recognize that we used English and ignore the locale-based comparison :)</div>
<p><a id="494425" href="#494425">#</a> <strong>Miklos Hollender</strong> on Friday, November 18, 2005 9:14 AM:</p><div style="margin-left: 1em">The IDEA of collation itself is a completely crazy thing.<br><br>I tell you a story. I had a strange error on MS SQL Server. select ... where [Product  Identifier] = '%SG%' did no find the product with the identifier of &quot;KCSG01&quot;<br><br>A friend suggested that maybe it treats &quot;cs&quot; as one letter. I said impossible, even MS can't be so crazy. And he was right - after setting collation to binary it worked!<br><br>I it is completely amazing - who wanted this this feature? Who needs it? Why did it have to be developed and hardcoded into Windows/MS SQL? I agree that a grammatical analyser function library might sometimes useful to someone, but to hardcode it right into the OS!... Why?<br><br>When users search for &quot;ddzs&quot;, they don't want to find &quot;dzsdzs&quot; - they are searching for LETTERS, you know, they don't want to keep all these grammatical rules in their heads. No one expects that their search input will be grammatically analysed! <br><br>So why has this feature been implemented?</div>
<p><a id="494428" href="#494428">#</a> <strong>Michael S. Kaplan</strong> on Friday, November 18, 2005 9:26 AM:</p><div style="margin-left: 1em">Hi Miklos --<br><br>You are in the minority here, not the majority. Most users do want the collation to use the conventions of the language. This feature has existed for over a decade and is actually highly valued by a lot more people than it is considered 'crazy.'<br><br>Just FWIW.</div>
<p><a id="494790" href="#494790">#</a> <strong>Zka</strong> on Saturday, November 19, 2005 3:05 AM:</p><div style="margin-left: 1em">I agree Mikl&#243;s. I've never seen anyone missing this crazy collation... But I've seen lots of software errors caused by it... However it's not hardcoded into MSSQL servers - thankfully :)</div>
<p><a id="495166" href="#495166">#</a> <strong>Peter</strong> on Monday, November 21, 2005 2:37 AM:</p><div style="margin-left: 1em">I agree with Michael -- collation is the foundation base of sorting and most casual computer users expect their programs to sort their data in the natural language order. Indeed, it is often ignored that the default Hungarian collation takes compressions in consideration and that string comparsion is affected by this. At least developers and DBAs should be aware of this, however.<br><br>MSSQL 2000 (maybe earlier versions as well) and a bunch of other DBMS's like Interbase/Firebird allow you to define the collation per column, so it might be a good idea to use the default Hungarian collation only on fields that absolutely need it. Alternatively, switching the entire DB to technical/binary collation could help (Hungarian_Technical instead of Hungarian).<br><br>Another option is to specify a different collation for search, e.g.<br>SELECT ... WHERE [Product Identifier] LIKE '%SG%' COLLATE Hungarian_Technical_CI_AS</div>
<hr/><p><em>referenced by</em></p><div style="margin-left: 1em"><p>2010/03/15 <a href="http://archives.miloush.net/michkap/archive/2010/03/15/9974423.html">Thus the problems resist solution, and the workarounds are often inadequate</a></p><p>2007/04/11 <a href="http://archives.miloush.net/michkap/archive/2007/04/11/2087685.html">Microsoft is not uncaron^H^Hing about the issue!</a></p><p>2006/04/29 <a href="http://archives.miloush.net/michkap/archive/2006/04/29/586726.html">'Which comes first?' vs. 'Are they equal?'</a></p><p>2006/02/09 <a href="http://archives.miloush.net/michkap/archive/2006/02/09/528297.html">Is RtlCompareUnicodeString used correctly?</a></p><p>2005/11/26 <a href="http://archives.miloush.net/michkap/archive/2005/11/26/495072.html">Technically it *is* a hungarian sort</a></p><p>2005/11/22 <a href="http://archives.miloush.net/michkap/archive/2005/11/22/495033.html">More on the fabled EqualString</a></p></div><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2005/11/13/492179.html" title="Which comes first, &#39;a&#39; or &#39;A&#39; ?">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2005/11/12/491519.html" title="The Software Tester&#39;s Axioms">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2005-11">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2005-11-13">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2005/11/13/491646.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:40 GMT -->
</html>