<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2005/11/17/492328.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:40 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>Using multiple keyboards</title></head><body>
<h1>Using multiple keyboards</h1>
<p><em>by Michael S. Kaplan, published on 2005/11/17 04:01 -05:00, original URI: http://blogs.msdn.com/b/michkap/archive/2005/11/17/492328.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<P><FONT face=Tahoma>The other day, Jerry Pisk asked in the Suggestion Box:</FONT></P>
<BLOCKQUOTE dir=ltr style="MARGIN-RIGHT: 0px">
<P><FONT size=2><EM>How does Windows handle input from multiple keyboards? Can each keyboard have a different layout? Do dead and control (shift/control/alt/win/context) keys cross keyboards and what happens if each is set to a different layout? How about the lock keys (caps/num/scroll)?</EM></FONT></P></BLOCKQUOTE>
<P><FONT face=Tahoma>To Windows, each thread has an input method (it might be a selected keyboard layout or whatever).</FONT></P>
<P><FONT face=Tahoma>Whether there&nbsp;is one keyboard or many keyboards, than each of those keyboards has a bunch of keys on it and each&nbsp;key has a scan code. It is the keyboard layout that takes those scan codes and maps them to virtual keys and sometimes even characters. But it does not pay attention to which hardware keyboard you type on (you can even split typing between them, mixing the typing of dead keys between them).</FONT></P>
<P><FONT face=Tahoma>So the answer to your question would be that each thread can have a different layout but the keyboards themselves are all shared for the system when they are typed in.</FONT></P>
<P><FONT face=Tahoma>Now application developers can take advantage of <A href="http://msdn.microsoft.com/library/en-us/winui/winui/windowsuserinterface/userinput/rawinput/aboutrawinput.asp">Raw Input</A> between the various Human Interface Devices such as keyboards, joysticks, mice, microphones, and so on. You could even theoretically use this information to distinguish between keyboards and then use the traditional Keyboard Input API functions to map each keyboard to a different layout. But that would be a lot of work to do, especially in cases where you would have to keep your own buffer for the input of dead keys and such.</FONT></P>
<P><FONT face=Tahoma>It is much more reasonable to stick with the built-in model, in my opinion. :-)</FONT></P>
<P><FONT face=Tahoma></FONT>&nbsp;</P>
<P><FONT face=Tahoma color=#ff1493><EM>This post brought to you by</EM> "<FONT size=6>Ê¢</FONT>" <EM>(<A href="http://www.fileformat.info/info/unicode/char/02a2">U+02a2</A>, LATIN LETTER REVERSED GLOTTAL STOP WITH STROKE)</EM></FONT></P>
<hr/><p><a id="493852" href="#493852">#</a> <strong>Rosyna</strong> on 17 Nov 2005 7:34 AM:</p><div style="margin-left: 1em">Funny that you post about this now. I'm in Japan for the next two months and decided to get a Japanese keyboard to test with. This thing is weird. It's got extra keys that I have *no* idea what they do and all the normal keys are all moved around (It is still qwerty though) so I have to retrain some of my muscle memory. Argh&#165;&#165;&#165;.</div>
<p><a id="494033" href="#494033">#</a> <strong>Jerry Pisk</strong> on 17 Nov 2005 2:19 PM:</p><div style="margin-left: 1em">So it is entirely valid to receive two WM_KEYDOWN for the same key before receiving WM_KEYUP twice, right? I press A on one keyboard and press it again on the other before I release them both. Wonder how many programs that handle DOWN/UP messages test for this :)</div>
<p><a id="494376" href="#494376">#</a> <strong>Gabe</strong> on 18 Nov 2005 4:48 AM:</p><div style="margin-left: 1em">I would expect a separate WM_KEYDOWN for each time a key repeats, with the WM_KEYUP usually thrown away or doing something idempotent. It's unlikely you would find a program that handles multiple WM_KEYUP messages in an unexpected way.<br><br>BTW, since you mentioned RawInput, do you know of any place that has documentation on how to actually decode HID input? How about for devices other than keyboards and mice?</div>
<p><a id="494392" href="#494392">#</a> <strong>Michael S. Kaplan</strong> on 18 Nov 2005 6:10 AM:</p><div style="margin-left: 1em">Hi Gabe --<br><br>It is funny -- the docs tell you to not expect th ecount of WM_KEYDOWN and WM_KEYUP messages to match -- the multgiple keyboard scenario is just one of the many reasons. :-)<br><br>I do not know of a whole lot documentation for the raw input functions -- it is an area that I would love to see more info/samples on, myself....</div>
<p><a id="494598" href="#494598">#</a> <strong>Jerry Pisk</strong> on 18 Nov 2005 3:09 PM:</p><div style="margin-left: 1em">Let me turn it around - it's possible to get two WM_KEYUP without WM_KEYDOWN between them.</div>
<p><a id="494743" href="#494743">#</a> <strong>Michael S. Kaplan</strong> on 18 Nov 2005 10:02 PM:</p><div style="margin-left: 1em">Well, yes -- just by careful planning of the order of keystrokes -- just make sure you are going up twice before going down again, with your fingers....</div>
<hr/><p><em>referenced by</em></p><div style="margin-left: 1em"><p>2010/07/02 <a href="http://archives.miloush.net/michkap/archive/2010/07/02/10032473.html">No plans to deliver a "suck it" message, though Suck It Message Potential (SIMP) would exist</a></p></div><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2005/11/17/493945.html" title="The journey to visit Godot.... Er... Dublin">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2005/11/17/492197.html" title="Parse vs. ParseExact, revisited">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2005-11">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2005-11-17">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2005/11/17/492328.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:40 GMT -->
</html>