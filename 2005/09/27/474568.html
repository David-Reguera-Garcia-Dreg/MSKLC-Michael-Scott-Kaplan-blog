<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2005/09/27/474568.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:41 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>What I learn versus what I am told</title></head><body>
<h1>What I learn versus what I am told</h1>
<p><em>by Michael S. Kaplan, published on 2005/09/27 16:50 -04:00, original URI: http://blogs.msdn.com/b/michkap/archive/2005/09/27/474568.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<P><FONT face=Tahoma>A few years ago, there was someone internal at Microsoft who was asking about storing binary data in a string. Since they were using VB, I pointed out the many problems with a lot of VB (the intrinsic controls, the&nbsp;built-in functions, the Win32 and other API calls, and more), any of which could corrupt the binary data.</FONT></P><FONT face=Tahoma>
<P><FONT face=Tahoma>In fact, VB's easy conversions between byte arrays and strings are in many cases somewhat evil, given the chance of data corruption not too long after the conversion.</FONT></P>
<P>They were insistent that none of that would happen.</FONT></P>
<P><FONT face=Tahoma>So I finally gave in and said maybe it will be fine, only to have someone else point out a fairly elemental issue -- that UTF-16 has an even number of bytes, while binary data may not. Plus a bunch of other reasons why this particular misuse of strings&nbsp;could really be a problem.</FONT></P>
<P><FONT face=Tahoma>You know what? That person was right.</FONT></P>
<P><FONT face=Tahoma>Then, a few years later, the question came up again, this time in VBScript. Of course everything is&nbsp;a Variant there, but people had problems where they wanted to try to interact with the bytes. So could they put it into a String and then use functions like AscB, LenB, and so on to work with it?</FONT></P>
<P><FONT face=Tahoma>I honestly forgot about the earlier conversation.</FONT></P>
<P><FONT face=Tahoma>So I gave the same warnings, they insisted that no operations involving conversion out of Unicode would be happening. And I said cautiously that if they follow those rules, then it might not hurt the data too much.</FONT></P>
<P><FONT face=Tahoma>Luckily, <a href="http://blogs.msdn.com/EricLippert">Eric Lippert</A> saved me from myself an once again pointed out why it was a bad idea.</FONT></P>
<P><FONT face=Tahoma>I spent&nbsp;a little time trying to understand why I had forgotten the earlier conversation. Why the lessons&nbsp;I learn myself are so much easier to remember than the ones someone else points out. It was not embarrassment at being wrong or anything like that -- being wrong is how one learns!</FONT></P>
<P><FONT face=Tahoma>Maybe it would be easier to remember if I did get embarrassed when I was wrong -- I never have trouble remembering times that I am embarrassed, after all. It is almost like&nbsp;my memory requires some kind of emotional tag -- good or bad-- to be effective.</FONT></P>
<P><FONT face=Tahoma>Anyway, yesterday Shawn pointed out&nbsp;that <a href="http://blogs.msdn.com/shawnste/archive/2005/09/26/474105.aspx">you do not want to treat binary data like a string</A>, and&nbsp;I did not have any problem with the advice, it all makes sense. But if you look at his post, the people who he is talking about are specifically trying to treat the binary data as a string and convert it out of Unicode, which is something I have warned against any time it came up. So I realized that I may not have learned anything yet, at least not to have a deeply internalized answer to the people who insist they will avoid converting the data.</FONT></P>
<P><FONT face=Tahoma>So I finally did internalize a particular notion to cover both the practical and the theoretical aspects of the problem: i</FONT><FONT face=Tahoma>t is not that strings are sacred or anything; they never were. It is that data is sacred.</FONT></P>
<P><FONT face=Tahoma>Or at the very least that corrupting data (of any sort) is profane. :-)</FONT></P>
<P><FONT face=Tahoma>We'll see if thinking that will help me remember the next time that comes up (of course the act of posting this to my blog may have contaminated the process; posting to the blog might make it memorable, too!).</FONT></P>
<hr/><p><a id="474583" href="#474583">#</a> <strong>Maurits [MSFT]</strong> on 27 Sep 2005 5:32 PM:</p><div style="margin-left: 1em">Binary data, in a string!<br><br>&lt;?xml version=&quot;1.0&quot;?&gt;<br>&lt;!DOCTYPE binary<br>	[<br>	&lt;!ELEMENT binary (bit*)&gt;<br>	&lt;!ELEMENT bit EMPTY&gt;<br>	&lt;!ATTLIST bit value (0|1) #REQUIRED&gt;<br>	]<br>&gt;<br>&lt;binary&gt;<br>	&lt;bit value=&quot;0&quot;/&gt;<br>	&lt;bit value=&quot;1&quot;/&gt;<br>	&lt;bit value=&quot;0&quot;/&gt;<br>	&lt;bit value=&quot;0&quot;/&gt;<br>	&lt;bit value=&quot;1&quot;/&gt;<br>	&lt;bit value=&quot;1&quot;/&gt;<br>	&lt;bit value=&quot;0&quot;/&gt;<br>	&lt;bit value=&quot;1&quot;/&gt;<br>&lt;/binary&gt;<br></div>
<p><a id="474608" href="#474608">#</a> <strong>Michael S. Kaplan</strong> on 27 Sep 2005 6:22 PM:</p><div style="margin-left: 1em">I am sure you can pick holes in this method without any help from me. :-)</div>
<p><a id="474782" href="#474782">#</a> <strong>Vorn</strong> on 28 Sep 2005 4:25 AM:</p><div style="margin-left: 1em">If you absolutely MUST throw binary data around as a string, your best bet is probably base64.<br><br>Vorn</div>
<hr/><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2005/09/28/474690.html" title="Using Hijri dates in SQL Server">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2005/09/27/474261.html" title="Acronyms do not become words that fast!">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2005-09">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2005-09-27">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2005/09/27/474568.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:41 GMT -->
</html>