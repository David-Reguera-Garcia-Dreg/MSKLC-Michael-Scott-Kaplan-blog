<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2005/09/21/472075.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:41 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>More on OEMCP vs. ACP</title></head><body>
<h1>More on OEMCP vs. ACP</h1>
<p><em>by Michael S. Kaplan, published on 2005/09/21 03:03 -04:00, original URI: http://blogs.msdn.com/b/michkap/archive/2005/09/21/472075.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<P><FONT face=Tahoma>Yesterday, someone asked:</FONT></P><FONT face=Tahoma>
<BLOCKQUOTE dir=ltr style="MARGIN-RIGHT: 0px">
<P class=MsoNormal><FONT face=Arial size=2><SPAN style="FONT-SIZE: 10pt; FONT-FAMILY: Arial"><EM>I have a cmd line tool. On French Windows its output is correct in the cmd window but when I redirect it to a file it is no longer good. I noticed that if I set the output encoding on the Console class explicitly to the default encoding then redirecting to a file works fine:<?xml:namespace prefix = o ns = "urn:schemas-microsoft-com:office:office" /><o:p></o:p></EM></SPAN></FONT></P>
<P class=MsoNormal><FONT face=Arial size=2><SPAN style="FONT-SIZE: 10pt; FONT-FAMILY: Arial"><o:p>&nbsp;</o:p></SPAN></FONT><FONT face="Courier New" size=2><SPAN style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'">&nbsp;&nbsp;&nbsp; <FONT color=teal><SPAN style="COLOR: teal">Console</SPAN></FONT>.OutputEncoding = <FONT color=teal><SPAN style="COLOR: teal">Encoding</SPAN></FONT>.Default;<o:p></o:p></SPAN></FONT></P>
<P class=MsoNormal><FONT face=Arial size=2><SPAN style="FONT-SIZE: 10pt; FONT-FAMILY: Arial"><EM>Does anyone know why the default encoding is not set by default? Is there any reason why I shouldnâ€™t put the line above in my code?<o:p></o:p></EM></SPAN></FONT></P></BLOCKQUOTE></FONT>
<P><FONT face=Tahoma>The problem here is of course that the console defaults to using the default system OEM code page (CP_OEMCP) and the file once opened in Notepad will be interpreted as being in the default 'ANSI' code page (CP_ACP). There are a few cases where they are the same (Chinese, Japanese, Korean, Thai, Vietnamese) but for most cases the two code pages give two different results.</FONT></P>
<P><FONT face=Tahoma>This will of course have the effect of corrupting data.</FONT></P>
<P><FONT face=Tahoma>Now the line of code above causes the console to match the 'ANSI' code page, so things are put out to the text file in the same encoding that Notepad will eventually use to interpret the file, so everything will work.</FONT></P>
<P><FONT face=Tahoma>Bill Poser recently discussed a similar one of these "write the file with one encoding, read with another" type problems, and he discussed it <A href="http://itre.cis.upenn.edu/~myl/languagelog/archives/002437.html">here</A> and <A href="http://itre.cis.upenn.edu/~myl/languagelog/archives/002438.html">here</A>.</FONT></P>
<P><FONT face=Tahoma>And it can indeed be fascinating when you have to track down what the problems actually is in some of these cases. Well, fascinating or frustrating -- which one it is will depend on how much you enjoy this sort of torture. :-)</FONT></P>
<hr/><div style="margin-left: 1em"><em>no comments</em></div><hr/><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2005/09/21/472386.html" title="How to turn off the CAPS LOCK key">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2005/09/21/471982.html" title="Some people hate the CAPS LOCK key">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2005-09">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2005-09-21">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2005/09/21/472075.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:41 GMT -->
</html>