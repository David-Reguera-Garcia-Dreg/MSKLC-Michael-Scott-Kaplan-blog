<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2005/03/02/383458.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:42 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>Why do LCIDs skip around so much?</title></head><body>
<h1>Why do LCIDs skip around so much?</h1>
<p><em>by Michael S. Kaplan, published on 2005/03/02 01:35 -05:00, original URI: http://blogs.msdn.com/b/michkap/archive/2005/03/02/383458.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<p>I have people ask me with an alarming frequency why LCIDs jump around so that for example en-US is 0x0409 and en-UK is 0x0809, and so forth. Why wouldn't it be 0x409, 0x0509, 00609, et.?</p> <p>To answer the question, let's look at the diagram of LANGID contents, found in winnt.h:</p> <blockquote dir="ltr" style="MARGIN-RIGHT: 0px"> <p><font face="Courier New" size="1">//<br />//&nbsp; A language ID is a 16 bit value which is the combination of a<br />//&nbsp; primary language ID and a secondary language ID.&nbsp; The bits are<br />//&nbsp; allocated as follows:<br />//<br />//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; +-----------------------+-------------------------+<br />//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp; Sublanguage ID&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp; Primary Language ID&nbsp;&nbsp; |<br />//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; +-----------------------+-------------------------+<br />//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 15&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 10 9&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp; bit<br />//<br />//<br />//&nbsp; Language ID creation/extraction macros:<br />//<br />//&nbsp;&nbsp;&nbsp; <a title="MAKELANGID" href="http://msdn.microsoft.com/library/en-us/intl/nls_97vo.asp" target="_blank">MAKELANGID</a>&nbsp;&nbsp;&nbsp; - construct language id from a primary language id and<br />//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; a sublanguage id.<br />//&nbsp;&nbsp;&nbsp; <a title="PRIMARYLANGID" href="http://msdn.microsoft.com/library/en-us/intl/nls_9c84.asp" target="_blank">PRIMARYLANGID</a> - extract primary language id from a language id.<br />//&nbsp;&nbsp;&nbsp; <a title="SUBLANGID" href="http://msdn.microsoft.com/library/en-us/intl/nls_2iec.asp" target="_blank">SUBLANGID</a>&nbsp;&nbsp;&nbsp;&nbsp; - extract sublanguage id from a language id.<br />//</font></p></blockquote> <p>If you look at the makeup, the primary language is 10 bits, and the sublanguage id is 6. Therefore, the "count by 0x0400" is there because that is what happens when you start in the eleventh bit (2<sup>10</sup>).</p> <p>Now there is another important consequence of this, as more and more LCIDs are added. Soon we we will run out of eight-bit LCIDs, and suddenly there will be LCID values of 0x0500, 0x0501, 0x0502, and so on. At that point, all of the people who do not use the macros to parse through LCIDs (preferring to chop these 16-bit values into two equal 8-bit pieces) will assume&nbsp;that 0x0501&nbsp;is a locale based on LANG_ARABIC. Yikes!</p> <p>Unfortunately, I have seen a bunch of code over the years that does this. </p> <p>If you look back to the post I did about <a id="CategoryEntryList" href="http://archives.miloush.net/michkap/archive/2005/01/26/360685.html">Lions and tigers and <strike>bears</strike>ELKs, Oh my!</a>&nbsp;then you'll see that at the rate we are adding them, it will not take too much longer to hit this issue. If you have written or are the owner of such code, you have been warned. Fix your code today!</p> <p>Now some people actually like to look at these numbers in decimal form (<a href="http://blogs.msdn.com/oldnewthing/">Raymond Chen</a> talked about this last year when he asked <a id="viewpost" href="http://blogs.msdn.com/oldnewthing/archive/2004/06/09/151689.aspx">What are these directories called 0409 and 1033?</a>). The split seems to be:</p> <p>HEXIDECIMAL: Windows, Windows CE</p> <p>DECIMAL: Office, VB/VBA/VS .NET, SQL Server</p> <p>Since I have actually done work at one time or another for all of these groups, I got pretty good at knowing both of them (and doing fast conversions for unfamilar ones). The hexidecimal LCIDs feel more natural to me, for what it's worth. Though some may think this is due to a bias now that my main home is Windows, for me it is just easier to parse through what the LCIDs are this way....</p> <p>I'll talk more about LCIDs another time. There are&nbsp;a fascinating number of oddities with them....</p> <p>&nbsp;</p> <p><font color="#ff0000"><em>This post brought to you by </em>"Î›"<em> (<a href="http://www.fileformat.info/info/unicode/char/039b/index.htm">U+039b</a>, GREEK CAPITAL LETTER LAMDA)</em></font></p>
<hr/><p><a id="383537" href="#383537">#</a> <strong>Jonathan</strong> on 2 Mar 2005 6:16 AM:</p><div style="margin-left: 1em">Hex vs. Decimal - many people look at the decimal, completely missing the point of bitfields. I once had to explain someone about MSI Custom Action Attributes, where the doc basically says:<br>256 - A<br>512 - B<br>768 - AB<br>1024 - C<br>And he seriously asked me &quot;but you can get 1024 by adding 768+256, so is it AB+A or C?&quot;<br><br>-Jonathan</div>
<p><a id="383653" href="#383653">#</a> <strong>Michael Kaplan</strong> on 2 Mar 2005 9:00 AM:</p><div style="margin-left: 1em">Excellent point. And now that I think about it, that is the one thing that is harder to do in decimal than in hex -- understanding bitfields....</div>
<hr/><p><em>referenced by</em></p><div style="margin-left: 1em"><p>2010/09/30 <a href="http://archives.miloush.net/michkap/archive/2010/09/30/10069631.html">Office skipped version "13" (makes you wonder what they will do in 2013!)</a></p><p>2007/07/04 <a href="http://archives.miloush.net/michkap/archive/2007/07/04/3693118.html">I think they might kind of get it now</a></p><p>2006/08/21 <a href="http://archives.miloush.net/michkap/archive/2006/08/21/707790.html">Decimal vs. hexadecimal LCIDs, backcompat, and being weird</a></p><p>2006/08/16 <a href="http://archives.miloush.net/michkap/archive/2006/08/16/702877.html">Walking off the end of the eighth bit</a></p><p>2005/05/17 <a href="http://archives.miloush.net/michkap/archive/2005/05/17/418372.html">The weird, weird world of the SUBLANGID</a></p></div><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2005/03/02/383595.html" title="Not running as Admin....">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2005/03/01/382289.html" title="Code pages are really not enough....">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2005-03">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2005-03-02">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2005/03/02/383458.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:42 GMT -->
</html>