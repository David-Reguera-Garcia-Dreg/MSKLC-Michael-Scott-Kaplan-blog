<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2005/03/13/394822.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:42 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>IStemmer'ed the tide (or, Language-specific processing #2)</title></head><body>
<h1>IStemmer'ed the tide (or, Language-specific processing #2)</h1>
<p><em>by Michael S. Kaplan, published on 2005/03/13 06:15 -05:00, original URI: http://blogs.msdn.com/b/michkap/archive/2005/03/13/394822.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<P><EM><FONT size=2>Prior posts in this series:<BR>&nbsp; </FONT></EM><A id=CategoryEntryList href="http://archives.miloush.net/michkap/archive/2005/03/08/389360.html"><EM><FONT size=2>Before you find, or search, you have to *index* (or, Language-specific processing #0)</FONT></EM></A><BR><EM><FONT size=2>&nbsp; </FONT></EM><A id=CategoryEntryList href="http://archives.miloush.net/michkap/archive/2005/03/08/389675.html"><EM><FONT size=2>I coffee, therefore IFilter (or, Language-specific processing #1)</FONT></EM></A></P>
<P>Now note that this is not a "how-to" post since the docs kind of do that. It is also not a sample since the doce have one of those too. But I going to talk about stemmers for a bit&nbsp; -- explain what they are and talk about some of the interesting issues with them....</P>
<P>I will start by saying that I am not a linguist (in case anyone had not yet figured it out yet). But I do have some delusions of linguistic aptitude<SUP><FONT size=1>1</FONT></SUP>.</P>
<P>Anyway, with all of that said, let's get started.</P>
<P>Looking at the <A title="IStemmer interface" href="http://msdn.microsoft.com/library/en-us/indexsrv/html/ixrefint_4b76.asp" target=_blank>IStemmer interface</A>, the first and most obvious question that may come to mind is "what the hell is a stemmer?".</P>
<P>Probably easiest to go right to the <A href="http://msdn.microsoft.com/library/en-us/indexsrv/html/wbrscenario_99ev.asp?frame=true">docs</A> for starters, as they explain a bit about what stemmers do without saying too much:</P>
<BLOCKQUOTE dir=ltr>
<P><FONT size=2>Stemmers perform morphological analysis and apply grammatical rules to generate a list of alternative, or inflected, forms for words. Alternative forms often have the same stem or base form. By generating the inflected forms for a word, Indexing Service returns query results that are statistically more relevant to a query. For example, a full-text query for "swim meet" matches documents that contain "swim, swim's, swims, swims', swimming, swam, swum" or "meet, meet's, meets, meets', meeting, met" and combinations of these terms.</FONT></P>
<P><FONT size=2>Some languages require that inflected terms be generated at both index time and query time for both standard and variant inflections. In this case, stemming happens with the word breaker component, with minimal stemming work in the actual stemmer. For example, the Japanese word breaker performs stemming during both index creation and querying to enable a query to find different inflected forms of the search terms.</FONT></P></BLOCKQUOTE>
<P>So you can think of a stemmer as a sort of "parser" that can discern the base or "stem" form of a word given one of the many possible inflections. Of course when to do the stemming really can be based on the cost of the work in terms of runtime performance versus the need to save space by not building huge indexes -- the size versus speed" issue is a very real one here. In a way it is unfortunate that the text implies that Japanese is done a particular way because the language requires it, rather than the underlying size/speed debate.</P>
<P>Knowledge of rules about the language and its grammar are obvious prerequisites.&nbsp;After all, a&nbsp;generic stemmer like the neutral one that is built in to Windows cannot do too much in the way of <EM>morphological analysis</EM> without the context of&nbsp;a language to use. If you are building a stemmer then you have to decide whether the language needs stemming done in the word breaker at index time or in the actual IStemmer implementation at runtime for querying (or both, in some cases). The results are often taken for granted in searches (if we look for "swim" we are not surprised to results like "swimming", "swam", and "swum" were also found. That is because a superior stemmer for a language will have both</P>
<UL>
<LI>Simple grammatical rules like tenses suffix "-ed" in English 
<LI>Lists of exceptions (crucial for a language like English that has no many exceptions!)</LI></UL>
<P>An interesting question to ask at this point is what one would do with cases where the rules are followed but an exception exists. We routinely see toddlers say things like "I goed to the store" and know that they are saying "I went to the store." They are learning the rules, that's all. So why make the stemmer less smart than the parent who can understand what their child is saying, or for that matter the child who is only guilty of following the rules?</P>
<P>(hint for the answer to the above question -- neither MSN Search nor Google handle&nbsp;'goed' in this&nbsp;context; they do not stem it to&nbsp;'go'&nbsp;-- should we wonder about advanced search technology that cannot keep up with the little tykes who are probably already using a computer, at least to play Magic School Bus or whatever? &lt;grin&gt;)</P>
<P>To take a more interesting example, let's take another look at the Jack Winter's <A href="http://www.macchiato.com/humor/how_i_met_my_wife.htm">How I Met My Wife</A>&nbsp;story&nbsp;from the 23 July 1994 New Yorker (previously discussed in the context of machine translation challenges in&nbsp;<A id=viewpost href="http://archives.miloush.net/michkap/archive/2004/12/15/309881.html">Saying all those nouns over and over again...</A>). You can pop over to one of those links to refresh your memory if you like. :-)</P>
<P dir=ltr align=left>Aha, there is now more that we can say about what is happening here than last time. If it was important (for whatever reason) to create an IStemmer implementation that would go this extra step to stem words down past the "legal" word usage level where it could actually find all of these non-standard terms later, then it is possible to imagine doing so. In practical terms, this level of stemming is seldom useful to do intentionally, but it is easy to see how hard it would be to never have it happen at all in any kind of rule based system that understands how a language works.</P>
<P>Let's take a quick look at the lrsample sample that exists in the Platform SDK for Index Server -- basically it is the word breaker and stemmer sample&nbsp;described <A href="http://msdn.microsoft.com/library/en-us/indexsrv/html/wbrscenario_3e91.asp">here</A>.</P>
<P>First, you have to install the Core SDK component of the Platform SDK from <A href="http://www.microsoft.com/msdownload/platformsdk/sdkupdate/">here</A>. I am not recommending you install the PSDK just for the one sample, unless you really do want to see&nbsp;a simple one in action. I'll likely be talking more about pieces of this sample on other days). There are also other samples there worth taking a look at in the area of filtering, for example.</P>
<P>The sample's simple stemmer is sitting in the code in (lrsample.CXX) and consists of just a few lines:</P>
<P><FONT face="Courier New" size=2>const WCHAR * aStems[][ cMaxStemForms ] =<BR>{<BR>&nbsp;&nbsp;&nbsp; { L"abide", L"abode", L"abided", L"abiding", L"abides" },&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // 0<BR>&nbsp;&nbsp;&nbsp; { L"bat", L"bats", L"batted", L"batting" },&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // 1<BR>&nbsp;&nbsp;&nbsp; { L"batch", L"batches", L"batched", L"batching" },&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // 2<BR>&nbsp;&nbsp;&nbsp; { L"bear", L"bears", L"bore", L"borne", L"born" },&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // 3<BR>&nbsp;&nbsp;&nbsp; { L"begin", L"began", L"begun", L"beginning", L"begins" },&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // 4<BR>&nbsp;&nbsp;&nbsp; { L"dance", L"danced", L"dances", L"dancing" },&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // 5<BR>&nbsp;&nbsp;&nbsp; { L"heave", L"heaved", L"hove", L"heaves", L"heaving" },&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // 6<BR>&nbsp;&nbsp;&nbsp; { L"hero", L"heroes" },&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // 7<BR>&nbsp;&nbsp;&nbsp; { L"keep", L"keeps", L"kept", L"keeping" },&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // 8<BR>&nbsp;&nbsp;&nbsp; { L"misspell", L"misspelled", L"misspelt", L"misspelling", L"misspells" },&nbsp;// 9<BR>&nbsp;&nbsp;&nbsp; { L"plead", L"pleaded", L"pled", L"pleading", L"pleads" },&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // 10<BR>&nbsp;&nbsp;&nbsp; { L"run", L"runs", L"ran", L"running" },&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // 11<BR>&nbsp;&nbsp;&nbsp; { L"swim", L"swam", L"swum", L"swimming", L"swims" },&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // 12<BR>&nbsp;&nbsp;&nbsp; { L"underlie", L"underlay", L"underlain", L"underlying", L"underlies" },&nbsp;&nbsp; // 13<BR>};</FONT></P>
<P>This stemmer is indeed almost exclusively looking at exceptional edge cases in English. If you were creating an actual stemmer you would almost certainly want a dictionary of the information kept in some separate data file rather than defined in code like this one. You can even see how one could use no rules and only have extensive lists of the words in a language and yet be effective for normal text while doing nothing useful for things like the Winter piece. </P>
<P>It feels like (and is!) quite a brute force technique, and&nbsp;even developers who are not linguists realize that&nbsp;simple rules like the "-s" suffix meaning plural and the "-ed" suffix meaning past tense ar perhaps more accessible. Would it not make sense to generate such terms automatically rather than requiring each such term be explicitly added? Or are we so afraid of those cases where we"goed to the meeting" that we want to banish them all and have our prescriptive grammarian's hats on when designing a word breaker.</P>
<P>The interesting point here is that if one does have knowledge of a language and a desire to see that language supported, one can add the component to make it happen. And you can do this in Windows today. Microsoft has taken steps here toward getting out of the way, huh? :-)</P>
<P>Of course this only solves the problem for linguists who are developers, developers who are linguists, or teams that contain both and maintain cordial relations. I'm not saying this doesn't ahppen, but when it does there are so many potenial project of interest that developing stemmers may not be the highest item on the list....</P>
<P>In the next post in the series I'll talk a bit about word breaking, and then in future posts after that I'll talk about other issues that exist here. It is a rich area.:-)</P>
<P><FONT size=1></FONT>&nbsp;</P>
<P><FONT size=1><EM>1 - Also, I am proud to be the "data owner" of collation of some of the languages that require no linguistic aptitude whatsoever. And I am the one behind the "teaching the computer 100 lies to make the it tell the truth" strategy (more on this another day!).</EM></FONT></P>
<P>&nbsp;</P>
<P><FONT color=#ff0000><EM>This post brought to you by</EM> "ם" <EM>(<A href="http://www.fileformat.info/info/unicode/char/00fe/index.htm">U+05dd</A>, HEBREW LETTER FINAL MEM)</EM><BR><FONT size=1>A letter that often forms part of the suffix used to create the masculine plural form of words (e.g. "ילד" boy becomes "ילדים" boys/children)</FONT></FONT></P>
<hr/><p><a id="394908" href="#394908">#</a> <strong>bg</strong> on 13 Mar 2005 11:28 AM:</p><div style="margin-left: 1em">nice one, - is there a system provided stemmer?<br><br>cheers <br>bg</div>
<p><a id="394910" href="#394910">#</a> <strong>Michael Kaplan</strong> on 13 Mar 2005 11:32 AM:</p><div style="margin-left: 1em">Indeed -- every language supported by Index Server, SQL Server Full Text Search, and Exchange Server Full Text Search have stemmers (plus there is the language neutral one, but it is easier to be cooler than that!).</div>
<p><a id="394987" href="#394987">#</a> <strong>Dean Harding</strong> on 13 Mar 2005 4:06 PM:</p><div style="margin-left: 1em">Heh, the title of this article is classic :-) Not only funny, but demonstrates the point of stemmers quite well!<br><br>There's so much fun to be had with the &quot;I&quot; prefix for interfaces.  One project I worked on a while ago had an IThinkThereforeIAm interface, though I can't remember what it actually did, anymore...  I don't think it ever got released publicly, hehe.</div>
<p><a id="394990" href="#394990">#</a> <strong>Michael Kaplan</strong> on 13 Mar 2005 4:21 PM:</p><div style="margin-left: 1em">Hey dean! <br><br>I remember a fun time I had with Richard Campbell and Stephen Forte in Amsterdam where we mappe out the important methods of the IToilet interface. :-)<br><br>Glad you noticed the subtle attempt at relevant humor -- I thought it my have been a little obscure. But is fun to consider such distinctions and the effect they ought to have on search....<br></div>
<hr/><p><em>referenced by</em></p><div style="margin-left: 1em"><p>2008/12/05 <a href="http://archives.miloush.net/michkap/archive/2008/12/05/9178155.html">"If you haven't had sex is six months..." the IM read</a></p><p>2007/07/24 <a href="http://archives.miloush.net/michkap/archive/2007/07/24/4022881.html">Pluralization(s) can be singularly difficult</a></p><p>2006/11/12 <a href="http://archives.miloush.net/michkap/archive/2006/11/12/1031784.html">If I wasn't watching her blog, could you really claim I was filtering the list of blogs I read?</a></p><p>2006/08/20 <a href="http://archives.miloush.net/michkap/archive/2006/08/20/707726.html">Avrupalılaştıramadıklarımızdanmışsınızcasına</a></p><p>2006/04/08 <a href="http://archives.miloush.net/michkap/archive/2006/04/08/571353.html">It may not always end with ի</a></p><p>2005/10/14 <a href="http://archives.miloush.net/michkap/archive/2005/10/14/480965.html">Syntax Savvy dictionaries?</a></p><p>2005/03/21 <a href="http://archives.miloush.net/michkap/archive/2005/03/21/399589.html">Linguistic and Unicode considerations (or Language-specific Processing #4)</a></p><p>2005/03/14 <a href="http://archives.miloush.net/michkap/archive/2005/03/14/395199.html">You toucha my letters, IWordBreaker you face (or, Language-specific processing, #3)</a></p><p>2005/03/13 <a href="http://archives.miloush.net/michkap/archive/2005/03/13/394979.html">What about search for kids?</a></p></div><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2005/03/13/394979.html" title="What about search for kids?">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2005/03/12/394716.html" title="Stability of the Unicode Character Database">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2005-03">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2005-03-13">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2005/03/13/394822.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:42 GMT -->
</html>