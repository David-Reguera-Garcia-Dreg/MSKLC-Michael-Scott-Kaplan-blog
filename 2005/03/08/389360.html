<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2005/03/08/389360.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:42 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>Before you find, or search, you have to *index* (or, Language-specific processing #0)</title></head><body>
<h1>Before you find, or search, you have to *index* (or, Language-specific processing #0)</h1>
<p><em>by Michael S. Kaplan, published on 2005/03/08 02:02 -05:00, original URI: http://blogs.msdn.com/b/michkap/archive/2005/03/08/389360.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<P>(I call this post #0 since it is more of an introduction to a topic that I will be returning to on a regular basis over the next few months.)</P>
<P>Back in the end of 2000, I had a meeting with the lead international program manager of SQL Server. One of the architects in the group had written a multiple page email describing the collation support in SQL Server 2000, and the PM wanted to include some more information about other parts of the SQL Server product to have a single place with all there is to know about SQL Server's international support could be found. </P>
<P>They estimated it would be about 10-15 pages. I put together an outline and let them know that to cover all of the topics on that outline it would actually be more like forty. They were a little staggered by the outline, but the "cover everything" idea was theirs, not mine. So they accepted my updated number.</P>
<P>Turns out we were both wrong. </P>
<P>The finished white paper&nbsp;<A href="http://msdn.microsoft.com/library/techart/IntlFeaturesInSQLServer2000.htm"><STRONG>International Features in Microsoft SQL Server 2000</STRONG></A> came out in April 2001 and clocked in at somewhere between 57 and 65 pages, depending on whether you had the HTML version or the Word .DOC file version (content is the same, they just format pages and margins differently).</P>
<P>They got ripped off. It was a really fun project, I would probably have done it for nothing had I known how much fun it would be. I probably would have paid them for the point when the person in SQL Server marketing wanted to talk about my over-use of the word <EM>unfortunately</EM> when I talked about limitations. :-)</P>
<P>Now a lot of what was&nbsp;there, I already knew. For those topics the white paper was a chance to get it all down in one place (there was also going to be a book by Sams Publishing independent of this white paper entitled <STRONG>Internationalization with SQL Server</STRONG>&nbsp;but the publisher decided the market&nbsp;was not big enough to sustain the book. So they paid off my advance&nbsp;when the book was only&nbsp;about 10% turned in and 50% done. My Acquisitions Editor (Sharon Cox) had left Sams so I was not at all put out by this. Especially when they paid me off. :-)</P>
<P>Anyway, there were a few topics that were new to me, and one of those was the Microsoft Search service, which sits underneath SQL Server's Full-Text Search, Index Server, and Exchange Full-Text Search. And SharePoint. I had a few amazing conversations with Margaret Li where I learned about the work that the word breakers and stemmers do for the various languages supported by the engine underneath these search technologies. At the end, she pointed out that Nadine Kano first obliquely hinted at the interfaces that one would use to do this work in <STRONG><A href="http://www.microsoft.com/globaldev/dis_v1/disv1.asp">Developing International Software for Windows 95 and Windows NT</A></STRONG>:</P>
<BLOCKQUOTE dir=ltr>
<P><EM><FONT size=2>Line-breaking and word-wrapping algorithms are important to text parsing as well as to text display. The rules for Asian languages, however, are quite different from the rules for Western languages. For example, unlike most Western written languages, Chinese, Japanese, Korean, and Thai do not necessarily indicate the distinction between words by using spaces. The Thai language doesn't even use punctuation. For these languages, software applications cannot conveniently base line breaks and word-wrapping algorithms on a space character or on standard hyphenation rules. They must follow different guidelines.</FONT></EM></P>
<P><EM><FONT size=2>Because the Win32 full-text search engine for Microsoft WinHelp recognizes that word wrapping is more complex for some languages than for others, it supports the IWordBreak OLE interface. That way, if a third-party developer creates a superior word-wrapping algorithm for any language, the WinHelp engine can take advantage of it through OLE.</FONT></EM></P></BLOCKQUOTE>
<P>The only problem is that the interface was not yet public. Oops!</P>
<P>Margaret did tell me that her team was willing to do publish it but that they needed the time to get it done (and there never seemed to be enough time). Luckily someone did find the time, because today you can read all about the interfaces&nbsp;right on MSDN. And in this blog, in this series....&nbsp;</P>
<P>This post will be the first of what will be many articles on this fascinating area that is a&nbsp;cousin of collation and an uncle of search,&nbsp;but which has many interesting features and issues of its own. </P>
<P>The interfaces I will be talking about here are ones that are used by MSN Desktop Search, as I talked about previously in <A id=ArchiveMonth href="http://archives.miloush.net/michkap/archive/2005/02/21/377288.html">Give me a [word-]break!</A>&nbsp;Imagine for a moment -- perhaps the act of creating such a component might one day allow components like MSN Desktop Search,&nbsp;SQL Server Full-Text Search,&nbsp;or any of the pothers&nbsp;to index content for you using the rules of your own language.</P>
<P>That is undeniably cool, is it not?</P>
<P>And it definitely falls into both of the categories of <STRONG>opening it all up</STRONG> and&nbsp;<STRONG>getting out of the way</STRONG>. :-)</P>
<P>&nbsp;</P>
<P><FONT color=#ff0000><EM>This post brought to you by</EM> "L" <EM>(<A href="http://www.fileformat.info/info/unicode/char/004c/index.htm">U+004c</A>, LATIN CAPITAL LETTER L)<BR><FONT size=1>Because <STRONG>L</STRONG> is for <STRONG>Language</STRONG> and this letter just couldn't stay away from a cool topic like this one!</FONT></EM></FONT></P>
<hr/><p><a id="389462" href="#389462">#</a> <strong>bg</strong> on 8 Mar 2005 4:09 AM:</p><div style="margin-left: 1em">can't find anything about IWordBreak on MSDN, is it called something different now?<br><br>cheers<br><br>bg</div>
<p><a id="389482" href="#389482">#</a> <strong>Michael Kaplan</strong> on 8 Mar 2005 5:04 AM:</p><div style="margin-left: 1em">Interesting question, bg. :-)<br><br>The name that the book quoted was not actually correct. But I'll be posting more about the actual feature as it currently exists soon....</div>
<p><a id="389560" href="#389560">#</a> <strong>Brian</strong> on 8 Mar 2005 7:50 AM:</p><div style="margin-left: 1em">bg: MK probably meant IWordBreaker <a target="_new" href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/indexsrv/html/ixrefint_93xu.asp">http://msdn.microsoft.com/library/default.asp?url=/library/en-us/indexsrv/html/ixrefint_93xu.asp</a><br><br>I don't know if it was a typo or a name change since he wrote this.</div>
<p><a id="389565" href="#389565">#</a> <strong>Michael Kaplan</strong> on 8 Mar 2005 7:53 AM:</p><div style="margin-left: 1em">Yes,I did. it was not a typo -- I quoted Nadine's book directly (check it out via the link!).<br><br>I'll talk about some of these classes more later....</div>
<p><a id="390403" href="#390403">#</a> <strong>RIO - Randekt&#237;v Informatikai Oldal</strong> on 9 Mar 2005 3:54 AM:</p><div style="margin-left: 1em">Istanbul &#250;j nevet kapott: <a target="_new" href="http://www.betanews.com/article/Microsoft_Unveils_Office_Communicator/1110303540">http://www.betanews.com/article/Microsoft_Unveils_Office_Communicator/1110303540</a></div>
<p><a id="394061" href="#394061">#</a> <strong>Anthony Mills</strong> on 11 Mar 2005 9:01 AM:</p><div style="margin-left: 1em">Typo alert! <br><br>In your linked SQL Server article, about halfway down, it says <br><br>... if you are using any COM service such as ADO to access the server, you must for its intervention. <br><br>That would probably be &quot;you must plan for its intervention,&quot; I think ... <br><br>A great article, and thanks for linking it!</div>
<p><a id="394062" href="#394062">#</a> <strong>Michael Kaplan</strong> on 11 Mar 2005 9:01 AM:</p><div style="margin-left: 1em">Indeed, no one ever brought that one up during the editing. Good catch! :-)<br><br>It was a lot of fun to write, and even more fun learning about the different technologies....</div>
<hr/><p><em>referenced by</em></p><div style="margin-left: 1em"><p>2005/03/21 <a href="http://archives.miloush.net/michkap/archive/2005/03/21/399589.html">Linguistic and Unicode considerations (or Language-specific Processing #4)</a></p><p>2005/03/14 <a href="http://archives.miloush.net/michkap/archive/2005/03/14/395199.html">You toucha my letters, IWordBreaker you face (or, Language-specific processing, #3)</a></p><p>2005/03/13 <a href="http://archives.miloush.net/michkap/archive/2005/03/13/394822.html">IStemmer'ed the tide (or, Language-specific processing #2)</a></p><p>2005/03/08 <a href="http://archives.miloush.net/michkap/archive/2005/03/08/389675.html">I coffee, therefore IFilter (or, Language-specific processing #1)</a></p></div><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2005/03/08/389675.html" title="I coffee, therefore IFilter (or, Language-specific processing #1)">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2005/03/07/389276.html" title="Global Development &amp; Deployment Virtual Track at TechEd 2005">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2005-03">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2005-03-08">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2005/03/08/389360.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:42 GMT -->
</html>