<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2005/03/28/402839.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:42 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>The WinForms DateTimePicker and MonthCalendar do not support culture settings</title></head><body>
<h1>The WinForms DateTimePicker and MonthCalendar do not support culture settings</h1>
<p><em>by Michael S. Kaplan, published on 2005/03/28 02:19 -05:00, original URI: http://blogs.msdn.com/b/michkap/archive/2005/03/28/402839.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<P>The issue is partially described in the Microsoft Knowledge Base (article <A href="http://support.microsoft.com/default.aspx?scid=kb;en-us;889834">889834</A>) but this article does not tell the full story (and some of what it tells is wrong).</P>
<P>Let's start with the title and its problems between <A title=CurrentUICulture href="http://msdn.microsoft.com/library/en-us/cpref/html/frlrfsystemglobalizationcultureinfoclasscurrentuiculturetopic.asp" target=_blank>CurrentUICulture</A> and <A title=CurrentCulture href="http://msdn.microsoft.com/library/en-us/cpref/html/frlrfsystemglobalizationcultureinfoclasscurrentculturetopic.asp" target=_blank>CurrentCulture</A>: </P>
<BLOCKQUOTE dir=ltr>
<P><EM><FONT size=2><STRONG>The DateTimePicker control and the MonthCalendar control do not reflect the CurrentUICulture property of an application's main execution thread as you expected when you created a localized application in the .NET Framework or in Visual Studio .NET</STRONG></FONT></EM></P></BLOCKQUOTE>
<P>Now the MonthCalendar and the DateTimePicker are not based on the UI settings, they are based on the user settings. So even if the control is fully globalized, it would never be based on the UI settings. This is because the date, time, calendar, number, currency, and collation settings are always based on the default user locale (and on CurrentCulture in the .NET Framework). If a localized application's language were to match this, it would only because the user happened to set CurrentCulture and CurrentUICulture to be the same culture, which is often the case but does not have to be.</P>
<P>Now the article <STRONG>is</STRONG> smart enough to point out the user locale settings control the language of the DateTimePicker and the MonthCalendar controls, and it does point out why -- because these two controls are wrappers around the Windows Shell common controls.</P>
<P>But this is not the full story.</P>
<P>Because calendars, as imperfect as they are in Win32 (cf: <A id=CategoryEntryList href="http://archives.miloush.net/michkap/archive/2005/01/14/353216.html">Calendars on Win32 -- just there for show....</A>,&nbsp;<A id=CategoryEntryList href="http://archives.miloush.net/michkap/archive/2005/01/14/353347.html">Calendars on Win32 -- Not all there yet</A>) and .NET (cf: <A id=CategoryEntryList href="http://archives.miloush.net/michkap/archive/2005/02/23/378804.html">Calendars.NET -- new platform, new issues</A>) both platforms have serious advantages over the Shell controls, since <STRONG>the Shell DateTimePicker and MonthCalendar common controls only support the Gregorian calendar</STRONG>.</P>
<P>Thus even if your default user locale settings include a calendar setting where <A title=GetLocaleInfo href="http://msdn.microsoft.com/library/en-us/intl/nls_34rz.asp" target=_blank>GetLocaleInfo</A> with the LOCALE_ICALENDARTYPE returns any of the following values:</P>
<BLOCKQUOTE dir=ltr>
<P><FONT face="Courier New"><FONT size=2><U><STRONG>Value Constant&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</STRONG>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <STRONG>Meaning&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </STRONG></U><BR>1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CAL_GREGORIAN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Gregorian (localized) <BR>2&nbsp;&nbsp;&nbsp;&nbsp; CAL_GREGORIAN_US&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Gregorian (English strings always) <BR>3&nbsp;&nbsp;&nbsp;&nbsp; CAL_JAPAN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Year of the Emperor (Japan) <BR>4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CAL_TAIWAN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Taiwan calendar <BR>5&nbsp;&nbsp;&nbsp;&nbsp; CAL_KOREA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Tangun Era (Korea) <BR>6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CAL_HIJRI&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Hijri (Arabic lunar) <BR>7&nbsp;&nbsp;&nbsp;&nbsp; CAL_THAI&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Thai <BR>8&nbsp;&nbsp;&nbsp;&nbsp; CAL_HEBREW&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Hebrew (Lunar) <BR>9&nbsp;&nbsp;&nbsp;&nbsp; CAL_GREGORIAN_ME_FRENCH&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Gregorian Middle East French calendar <BR>10&nbsp;&nbsp;&nbsp;&nbsp;CAL_GREGORIAN_ARABIC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Gregorian Arabic calendar <BR>11&nbsp;&nbsp;&nbsp;&nbsp;CAL_GREGORIAN_XLIT_ENGLISH&nbsp;&nbsp;&nbsp;Gregorian Transliterated English calendar <BR>12&nbsp;&nbsp;&nbsp;&nbsp;CAL_GREGORIAN_XLIT_FRENCH&nbsp;&nbsp;&nbsp; Gregorian Transliterated French calendar </FONT></FONT></P></BLOCKQUOTE>
<P>the DateTimePicker and MonthCalendar controls will never go beyond the Gregorian calendar.</P>
<P>Now the methods and properties on the calendar classes derived from <A title=Calendar href="http://msdn.microsoft.com/library/en-us/cpref/html/frlrfsystemglobalizationcalendarclasstopic.asp" target=_blank>Calendar</A> class (GregorianCalendar, <A title=HebrewCalendar href="http://msdn.microsoft.com/library/en-us/cpref/html/frlrfsystemglobalizationhebrewcalendarclasstopic.asp" target=_blank>HebrewCalendar</A>, <A title=HijriCalendar href="http://msdn.microsoft.com/library/en-us/cpref/html/frlrfsystemglobalizationhijricalendarclasstopic.asp" target=_blank>HijriCalendar</A>, <A title=JapaneseCalendar href="http://msdn.microsoft.com/library/en-us/cpref/html/frlrfsystemglobalizationjapanesecalendarclasstopic.asp" target=_blank>JapaneseCalendar</A>, <A title=JulianCalendar href="http://msdn.microsoft.com/library/en-us/cpref/html/frlrfsystemglobalizationjuliancalendarclasstopic.asp" target=_blank>JulianCalendar</A>, <A title=KoreanCalendar href="http://msdn.microsoft.com/library/en-us/cpref/html/frlrfsystemglobalizationkoreancalendarclasstopic.asp" target=_blank>KoreanCalendar</A>, <A title=TaiwanCalendar href="http://msdn.microsoft.com/library/en-us/cpref/html/frlrfsystemglobalizationtaiwancalendarclasstopic.asp" target=_blank>TaiwanCalendar</A>, and <A title=ThaiBuddhistCalendar href="http://msdn.microsoft.com/library/en-us/cpref/html/frlrfsystemglobalizationthaibuddhistcalendarclasstopic.asp" target=_blank>ThaiBuddhistCalendar</A>) contain the capabilities to let you create your own calendar. I'll try and throw such a sample of a calendar together another time.</P>
<P>Note that the above limitations do not apply to the ASP.Net control (System.Web.UI.WebControls.Calendar). I will cover this control and its capabilities another day....</P>
<P>&nbsp;</P>
<P><FONT color=#ff0000><EM>This post brought to you by</EM> "à¸Ÿ" <EM>(<A href="http://www.fileformat.info/info/unicode/char/0e1f/index.htm">U+0e1f</A>, THAI CHARACTER FO FAN)</EM></FONT></P>
<hr/><p><a id="402907" href="#402907">#</a> <strong>Michael Kaplan</strong> on 28 Mar 2005 7:44 AM:</p><div style="margin-left: 1em">The constants I gave above are defined in the main NLS header file in tha Platform SDK: winnls.h; sorry I did not give the reference.<br></div>
<p><a id="406390" href="#406390">#</a> <strong>Anand</strong> on 7 Apr 2005 11:16 PM:</p><div style="margin-left: 1em">This is a big problem when using Windows Forms. We moved from ASP.NET  to Windows forms for a specific project now and am now stuck with this bug.:-(</div>
<p><a id="406393" href="#406393">#</a> <strong>Michael S. Kaplan</strong> on 7 Apr 2005 11:26 PM:</p><div style="margin-left: 1em">Sorry about that.... I feel your pain (as someone who has had to write calendars in the past!). But the APIs in the System.Globalization class give the plumbing that makes those things possible, much moreso than anything in Windows....</div>
<p><a id="429922" href="#429922">#</a> <strong>Brad Eck</strong> on 16 Jun 2005 4:30 PM:</p><div style="margin-left: 1em">Do you know if this will be dealt with in the next release (2.0)?</div>
<p><a id="429958" href="#429958">#</a> <strong>Michael S. Kaplan</strong> on 16 Jun 2005 7:04 PM:</p><div style="margin-left: 1em">Hi Brad,<br><br>As the post indicated, this is a Windows issue, not a .NET Framework one. So there is no way it *could* be fixed in Whidbey. They are Shell Common Controls.</div>
<hr/><p><em>referenced by</em></p><div style="margin-left: 1em"><p>2011/12/30 <a href="http://archives.miloush.net/michkap/archive/2011/12/30/10251957.html">We call 'em ShortestDayNames for a reason; they're as short as they're EVER gonna be!</a></p><p>2006/11/19 <a href="http://archives.miloush.net/michkap/archive/2006/11/19/1103636.html">'Son, your TextBox is writing checks that your EDIT control can't cash'</a></p><p>2006/07/24 <a href="http://archives.miloush.net/michkap/archive/2006/07/24/676072.html">Our highly internationalized OS uses DPI, aka Dots Per In-.... um, never mind!</a></p><p>2005/12/21 <a href="http://archives.miloush.net/michkap/archive/2005/12/21/506427.html">New in Windows Vista: updates to clock and calendar</a></p><p>2005/10/27 <a href="http://archives.miloush.net/michkap/archive/2005/10/27/485462.html">The WinForms Common Dialogs do not support culture settings</a></p><p>2005/04/01 <a href="http://archives.miloush.net/michkap/archive/2005/04/01/404454.html">Simplification is not necessarily grounds for canonization; ask the IMEMode property!</a></p></div><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2005/03/29/403216.html" title="Flag behavior for the NLS APIs">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2005/03/27/402746.html" title="Post categorization (and people who pick up the feed)">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2005-03">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2005-03-28">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2005/03/28/402839.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:42 GMT -->
</html>