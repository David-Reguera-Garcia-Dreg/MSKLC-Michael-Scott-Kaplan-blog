<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2005/03/25/402313.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:42 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>What is the InstalledUICulture for?</title></head><body>
<h1>What is the InstalledUICulture for?</h1>
<p><em>by Michael S. Kaplan, published on 2005/03/25 16:38 -05:00, original URI: http://blogs.msdn.com/b/michkap/archive/2005/03/25/402313.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<P>This question often comes up -- what is the <A title=InstalledUICulture href="http://msdn.microsoft.com/library/en-us/cpref/html/frlrfsystemglobalizationcultureinfoclassinstalleduiculturetopic.asp" target=_blank mce_href="http://msdn.microsoft.com/library/en-us/cpref/html/frlrfsystemglobalizationcultureinfoclassinstalleduiculturetopic.asp">InstalledUICulture</A> used for?</P>
<P>Short answer? It isn't for anything. Don't use it.</P>
<P>Longer answer? It is a culture based on the return of the <A title=GetSystemDefaultUILanguage href="http://msdn.microsoft.com/library/en-us/intl/nls_2ip1.asp" target=_blank mce_href="http://msdn.microsoft.com/library/en-us/intl/nls_2ip1.asp">GetSystemDefaultUILanguage</A> for systems that support that API. This API is itself fairly useless. Which is why you should avoid the managed object -- wrapped up useless does not find itself being more useful.&nbsp;Neither one is for anything. Don't use them.</P>
<P>Want an even longer answer? Ok, you asked for it....</P>
<P>The GetSystemDefaultUILanguage returns the install language of the operating system. On a localized system that is the install language of the OS, and on an MUI system that is almost always English<SUP><FONT size=1>1</FONT></SUP>.</P>
<P>Now note that this is not a language that the user has chosen to work in, or claimed to have knowledge of, or claims to even be able to comprehend. Having your application do something with it is as productive as looking into who your grandfather took to the prom and chatting them up as if they should know who you are. In summary, it is a bad idea.</P>
<P>There are exceptions, but to date I have never seen an application that uses it which is doing so appropriately.</P>
<P>This is in marked contrast to a similarly named but very different API that I have talked about in the past -- <A title=GetSystemDefaultLCID href="http://msdn.microsoft.com/library/en-us/intl/nls_85yc.asp" target=_blank mce_href="http://msdn.microsoft.com/library/en-us/intl/nls_85yc.asp">GetSystemDefaultLCID</A>. Although it too is misused (and such misuse can be dangerous), it does at least have some important functionality. If you need a conceptual hook to understand the difference between GetSystemDefaultUILanguage&nbsp;and GetSystemDefaultLCID, it is like looking at the difference between Heroin and Cocaine -- both are very dangerous but the latter does have some medicinal benefit<FONT size=1><SUP>2</SUP></FONT>. </P>
<P>The API and method are similar to the drugs in that the developer gets a "high" from thinking that their code works; the "down" comes later when they find out that the whole usage thing was just a "bad trip."</P>
<P>Don't you wish you had stuck with the short answer and avoided my drug analogy? :-)</P>
<P mce_keep="true">&nbsp;</P>
<P><EM><FONT size=1>1 - I'll talk about the exceptions to this another time. I promise that they will not rehbailitate either the Win32 API or the managed object.<BR>2 -&nbsp;e.g. as a diagnostic indicator for people suffering from glossopharayngeal neuralgia. I'll talk about this disease&nbsp;some other time, though I do not myself have it. :-)</FONT></EM></P>
<P mce_keep="true">&nbsp;</P>
<P><FONT color=#ff0000><EM>This post brought to you by</EM> "d" </FONT><EM><FONT color=#ff0000>(<A href="http://www.fileformat.info/info/unicode/char/0064/index.htm" mce_href="http://www.fileformat.info/info/unicode/char/0064/index.htm">U+0064</A>, a.k.a. LATIN SMALL LETTER D)<BR><FONT size=1>(The Letter "d" says "Don't say NO to drugs; say&nbsp;NO THANK YOU and calmly walk away)</FONT></FONT></EM></P>
<hr/><p><strong>Umesh</strong> on 11 Aug 2010 11:58 PM:</p><div style="margin-left: 1em"><p>You don&#39;t suggest what needs to be used though. Let me give an example. Suppose my application needs that a prerequisite be installed. And I want to help the user by directing him to a download site where usage directions are in different languages at different links. How do I choose the appropriate link to present to the user?</p>
</div>
<p><strong>Michael S. Kaplan</strong> on 12 Aug 2010 7:02 AM:</p><div style="margin-left: 1em"><p>The user&#39;s chosen UI language!</p>
</div>
<hr/><p><em>referenced by</em></p><div style="margin-left: 1em"><p>2008/03/07 <a href="http://archives.miloush.net/michkap/archive/2008/03/07/7994143.html">Requirements first, criticism of attempted solutions second!</a></p></div><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2005/03/25/402444.html" title="Consistency and correctness are both four letter words">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2005/03/24/402055.html" title="Accessibility, Internationalization, and Keyboards (#4 Creating good keyboards, part A)">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2005-03">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2005-03-25">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2005/03/25/402313.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:42 GMT -->
</html>