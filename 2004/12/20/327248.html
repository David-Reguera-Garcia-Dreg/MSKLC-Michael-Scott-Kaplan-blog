<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2004/12/20/327248.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:42 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>IMEs? They have it easy....</title></head><body>
<h1>IMEs? They have it easy....</h1>
<p><em>by Michael S. Kaplan, published on 2004/12/20 03:13 -05:00, original URI: http://blogs.msdn.com/b/michkap/archive/2004/12/20/327248.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<P>Yes, I said it. IMEs (<STRONG>I</STRONG>nput <STRONG>M</STRONG>ethod <STRONG>E</STRONG>ditors) have it easy. And I will say that even though I have only ever built them myself from the samples in the Platform SDK or the ones already in Windows. Even though I have only ever really worked at building keyboards, which cover such a small fraction of characters compared to IMEs that it makes me look like the kid on the beach building sand castles compared to Buckingham Palace by comparison.</P>
<P>Kind of cheeky to make such a claim, huh?</P>
<P>Nevertheless, I will make it. Because I am not talking about the design&nbsp;or the development part of it (which has obviously just a much chance to be intuitve/useful or not as any other project involving user interface and user interaction). I am talking about from a data management and data usage standpoint. And the questions that the data can answer.</P>
<P>With an IME, an attempt to take the small number of keys found on the regular keyboard and map them to up to some subset of the entire set of CJK ideographs, Kana, Bopomofo, Hangul, and Jamo characters in Unicode. The basis of the mapping varies, depending on language and user preference. It could be based on pronunciation, on the code point number, on count of strokes, on radical. The user can then commit the choice and it will be entered into the application. </P>
<P>And here is where we get to the part that makes me (as the owner of collation support in Windows an the .NET Framework) jealous, that makes me say the IME folks have it easy.</P>
<P>Because if that first choice is not what the user was looking for, then they get a list of alternate candidates that meet the same criteria as that keystroke or set of keystrokes. The list can be ordered by some collected data that tells the IME which candidate is more likely to be the right choice.</P>
<P>Ameliorated are the <A href="http://archives.miloush.net/michkap/archive/2004/12/18/323941.html">problems</A> I discussed a few days ago about ideographs that have more than one pronunciation, because they can all be there, an entry for each pronunication. </P>
<P>Mitigated are the problems I mentioned about pronunications that can apply to many different characters, because each additional character can show up in the candidate list. </P>
<P>And Gone is the need to answer the question of equality that is so central to the <A title=CompareString href="http://msdn.microsoft.com/library/en-us/winui/winui/windowsuserinterface/resources/strings/stringreference/stringfunctions/comparestring.asp" target=_blank>CompareString</A> and <A title=LCMapString href="http://msdn.microsoft.com/library/en-us/intl/nls_5s2v.asp" target=_blank>LCMapString</A> APIs, the <A title=CompareInfo href="http://msdn.microsoft.com/library/en-us/cpref/html/frlrfsystemglobalizationcompareinfoclasstopic.asp" target=_blank>CompareInfo</A> and <A title=SortKey href="http://msdn.microsoft.com/library/en-us/cpref/html/frlrfsystemglobalizationsortkeyclasstopic.asp" target=_blank>SortKey</A> classes -- because the question is no longer "<EM>are they equal, my liege?</EM>" or "<EM>which&nbsp;is ordered first, sire?</EM>". Instead, it's "<EM>what's on the list, dude?</EM>"</P>
<P>And it just struck me that it feels like a much cooler question, if you ask me. </P>
<P>Of course I was immediately reminded by colleagues that this is only cooler when it is the question that one is wanting to ask. If Jessica needs an order for a list of strings or Wendy needs to answer the quesion of equality or Molly needs to build indexes for her database, then the question that the IME works so hard to answer is not nearly as cool.</P>
<P>I was also reminded of something else I know but sometimes forget (which is good, because the remembering part humbles me a bit&nbsp;-- there are many people who feel I need that!). A question's coolness cannot be judged solely by the ease or even the possibility of a good answer. Some of the&nbsp;coolest questions in the world do not have answers yet. Some have answers that seem much simpler or even dumber than the original questions. Some are brilliant even if the initial question seems at first glance to be dumb or trite.</P>
<P>So why am I jealous of the IME folks? Because getting a satisfactory answer to their question is a more tractable problem for Korean, Japanese, and Chinese (both Mandarin and Cantonese), when compared to the questions that the technologies I work on ask. </P>
<P>For me,&nbsp;a function that is smart enough to order multiple characters with the same pronunication is easy -- I just plug in the rules for whatever mechanism acts as the tie-breaker. However, the function to take a character with multiple possible pronunciations and choose the "right" one for a pronunication based sort is a lot harder. Under current art, one needs to add one's own pronunication data a-la-Ruby (or other annotation mechanism). </P>
<P>Perhaps surrounding text could provide the context, if it exists -- but what it is does not? Also, a machine being able to choose the "right" pronunication based on&nbsp;such context&nbsp;is really the first half of the machine translation problem -- to know how to treat the data, the machine must first be able to in some sense understand what is meant. </P>
<P>Are there answers? Well, not in Windows or the .NET Framework today. But there is an understanding of the desired functionality. There may even by thoughts about avenues of attempts at solution. One day.</P>
<P>But at the very least, I thought that this post might make a good quick introduction to the problem.</P>
<P><FONT color=#800080><EM>This post brought to you by </EM>"à¸¬"</FONT><EM><FONT color=#800080> (U+0e2c, a.k.a. THAI CHARACTER LO CHULA)</FONT></EM></P>
<hr/><p><a id="327254" href="#327254">#</a> <strong>Jade Lin</strong> on 20 Dec 2004 12:32 AM:</p><div style="margin-left: 1em">&gt; Bopomofo<br><br>Hehehe  =D  That would be &quot;ZhuYin FuHao&quot; or &quot;ZhuYin&quot; (&quot;Sound Annotation Symbols&quot;), as opposed to &quot;HanYu PinYin&quot; or &quot;PinYin&quot; (&quot;Chinese Phonetic Transcription&quot;).<br><br>It's the difference between calling it &quot;the alphabet&quot; and &quot;the ABCs&quot;  =)<br><br>-- J.</div>
<p><a id="327256" href="#327256">#</a> <strong>Michael Kaplan</strong> on 20 Dec 2004 12:39 AM:</p><div style="margin-left: 1em">In this case, I was referring to the actual bopomofo script ranges in Unicode at <a target="_new" href="http://www.unicode.org/charts/PDF/U3100.pdf">http://www.unicode.org/charts/PDF/U3100.pdf</a> and <a target="_new" href="http://www.unicode.org/charts/PDF/U31A0.pdf">http://www.unicode.org/charts/PDF/U31A0.pdf</a> just as with the other items in the list there. :-)</div>
<p><a id="327687" href="#327687">#</a> <strong>Norman Diamond</strong> on 20 Dec 2004 5:02 PM:</p><div style="margin-left: 1em">&gt; With an IME, an attempt to take the small<br>&gt; number of keys found on the regular keyboard<br><br>That's the theory.  In Unix systems it did that, in most Japanese Windows systems it did that, and then things get more complicated.  This is something that has been discussed many times in Usenet newsgroups and I think you would likely be aware, but this makes me wonder.  You know that the regular keyboard has a character ; to the right of l, when shifted it is +, and to the right of that is :, and when shifted it is *.  Etc.  Japanese Windows 2000 and XP were hacked so that, even though they get installed thinking they have a US layout keyboard underneath the IME, they still work with the regular keyboard underneath the IME.  But if the user ever changes a keyboard operation, then this hack gets lost, and then even Japanese Windows 2000 and XP suffer from the same problems as US Windows of all versions with real or &quot;global&quot; IMEs.  Microsoft's meaning to the word &quot;global&quot; is US, because its &quot;global&quot; IMEs don't work right if the actual physical keyboard is regular or German or French, they only work if it's US.  The US versions of Windows 2000 and XP include real IMEs but they suffer the same defect.  In US Windows 2000 and XP (and in Japanese Windows 2000 and XP if the user has ever changed a keyboard setting) then the user has to replace the lower level keyboard driver instead of just setting the layout properly.  And Microsoft made it really really hard to get to the necessary lower level keyboard driver.  Once the user finds all the necessary steps, Microsoft even asserts that the Japanese 106 driver isn't compatible with the laptop's built-in keyboard.<br><br>&gt; and map them to up to some subset of [...]<br>&gt; characters in Unicode.<br><br>I wonder if all of Microsoft's IMEs operated in Unicode, including those for MS-DOS and Windows 95 etc.  But IMEs for Unix traditionally didn't, because Unicode didn't even exist yet.<br><br>By the way if Unicode provided the same degree of backwards compatibility for US and European character encodings as it does for Japanese, I'll bet you wouldn't even have heard of Unicode.  For you it isn't a bad joke, but if it had been done equitably then it would be one even for you.  Sure we have to contend with Unicode, but a ton of existing databases are not going to be converted for it.</div>
<p><a id="327724" href="#327724">#</a> <strong>Michael Kaplan</strong> on 20 Dec 2004 6:03 PM:</p><div style="margin-left: 1em">I do understand the difficulties to which you refer, but I think that for the most part these have much more to do with documentation than with functionality (since it is possible to get the layout that matches your hardware, its just not explained very well how). Of course they only affect Japanese and to a lesser extent Korean, not all IME languages.<br><br>This whole discussion is of course a &quot;hijacking&quot; of what *this* post is about since I was really not talking about this type of issue in keyboards or IMEs or TIPs.<br><br>I will look into covering these issues in a future post.<br><br>As for the unicode backcompat, that clearly has nothing whatsoever to do with this topic and is politically charged enough that I'd rather not see it here just now, as we do not need to fight a Japanese-US war based on differing perceptions (also with the people in Japan who felt the JIS-0x213 should be treated as a repetoire and not as a code page?).</div>
<p><a id="329360" href="#329360">#</a> <strong>Norman Diamond</strong> on 21 Dec 2004 4:51 PM:</p><div style="margin-left: 1em">12/20/2004 6:03 PM Michael Kaplan<br><br>&gt; (since it is possible to get the layout that<br>&gt; matches your hardware, its just not<br>&gt; explained very well how)<br><br>For the &quot;Global&quot; IMEs for Windows 9x, it requires hacking the registry in a way that was discovered and posted to Usenet by someone I don't recall, and not explained at all by Microsoft.<br><br>For Windows 2000 and XP, I don't recall seeing any explanations, but even if there are any, EVEN MICROSOFT DID NOT FOLLOW THEM.  Microsoft hacked the installs of Japanese Windows 2000 and Japanese Windows XP to work around that misdesign (which works for a while) without even being aware that there is a designed way to work around the misdesign.<br><br>&gt; As for the unicode backcompat, that clearly<br>&gt; has nothing whatsoever to do with this topic<br><br>Well, I intended it to point out the extent to which it was a misstatement to say that IMEs convert keyboard input to Unicode.  IMEs were converting keyboard input to character sets before Unicode existed and they continue to target those character sets.<br><br>&gt; and is politically charged enough<br><br>OK sure it became political, but it started out technical, because the fact was that all those tons of data already existed and continue to exist.</div>
<p><a id="329607" href="#329607">#</a> <strong>Michael Kaplan</strong> on 21 Dec 2004 10:30 PM:</p><div style="margin-left: 1em">For your first set of issues, I believe you are mistaken on some points, but THIS IS NOT THE PLACE to vent about it. I will talk about it in a future post, where it can be on-topic. <br><br>All but the Win9x issue, about which I have neither knowledge nor opinion. :-)<br><br>It is not a mis-statement to talk about the intention of IMEs on Windows, which swork exclusively with Unicode (since the OS does). Even a third party IME will end up using Unicode even if they are using a legacy code page since the conversion always happens....<br><br>The final set of issues related to your opinions on the issues related to Han unification, I will not cover. You are welcome to do so in your own blog, but I am not interested in that type of discussion here, certainly not in hijacking unrelated threads! :-(</div>
<p><a id="331586" href="#331586">#</a> <strong>Norman Diamond</strong> on 23 Dec 2004 7:38 PM:</p><div style="margin-left: 1em">***MODERATED POST***<br><br>&gt; It is not a mis-statement to talk about the <br>&gt; intention of IMEs on Windows <br><br>True. I apologize for misinterpreting the scope of your posting concerning IMEs. <br><br>&gt; The final set of issues related to your <br>&gt; opinions on the issues related to Han <br>&gt; unification <br><br>I have not stated any opinion about Han unification -- not even anywhere else, to the best of my recollection.</div>
<p><a id="331587" href="#331587">#</a> <strong>Michael Kaplan</strong> on 23 Dec 2004 7:41 PM:</p><div style="margin-left: 1em">No worries. I really am talking about Microsoft stuff here. :-)<br><br>Well, lets extend that to &quot;or any other politically charged issue about Unicode's history&quot;. The Unicode List is a much better place for that sort of thing, if only that it is at least on topic there....</div>
<hr/><p><em>referenced by</em></p><div style="margin-left: 1em"><p>2006/12/30 <a href="http://archives.miloush.net/michkap/archive/2006/12/30/1383684.html">The candidates might have two dimensions (at least!)</a></p><p>2006/07/27 <a href="http://archives.miloush.net/michkap/archive/2006/07/27/679538.html">The Cantonese IME (not for input of characters from Canton, Ohio)</a></p><p>2006/01/03 <a href="http://archives.miloush.net/michkap/archive/2006/01/03/508579.html">'Acceptable' Japanese sort order?</a></p><p>2005/05/10 <a href="http://archives.miloush.net/michkap/archive/2005/05/10/416008.html">Raymond's Chinese dictionary</a></p></div><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2004/12/20/328040.html" title="The Time [Zone] is Right...">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2004/12/20/327248.html" title="IMEs? They have it easy....">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2004-12">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2004-12-20">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2004/12/20/327248.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:42 GMT -->
</html>