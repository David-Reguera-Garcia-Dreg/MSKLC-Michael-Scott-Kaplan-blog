<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2004/12/01/272864.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:42 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>Crossing the <b>DIGIT</b>al divide...</title></head><body>
<h1>Crossing the <b>DIGIT</b>al divide...</h1>
<p><em>by Michael S. Kaplan, published on 2004/12/01 06:58 -05:00, original URI: http://blogs.msdn.com/b/michkap/archive/2004/12/01/272864.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<P>Digits have worked on Windows for a while. From the longstanding LCTYPE for <A title=GetLocaleInfo href="http://msdn.microsoft.com/library/en-us/intl/nls_34rz.asp" target=_blank>GetLocaleInfo</A>&nbsp;and <A title=SetLocaleInfo href="http://msdn.microsoft.com/library/en-us/intl/nls_7w1b.asp" target=_blank>SetLocaleInfo</A>&nbsp;(LOCALE_SNATIVEDIGITS/LOCALE_IDIGITSUBSTITUTION) and its crazy weird support in Regional and Language Options in Windows (both of which support having the system render digits using the locale/user preference) to the also longstanding mapping type in FoldString to move many of the various ways to represent digits to plain old&nbsp;0 to 9 (MAP_FOLDDIGITS), support has been in Windows for some time. </P>
<P><FONT color=#ff0000>DIGITal Addeddum (08:45am): </FONT><EM>It occurred to me that I was a bit lax in talking about property support on Windows. Although this is in most cases pretty limited (a topic for another day!), for digits there is a great detection method -- the GetStringTypeEx API, with the CT_CTYPE1 info type. The returned array of character information will contain a C1_DIGIT info type for each code point that is a digit.</EM></P>
<P>Of course life is easier on Windows since there is no parsing support. The support on the framework has been rockier -- there is no shipping version that has the equivalent of LOCALE_SNATIVEDIGITS or LOCALE_IDIGITSUBSTITUTION, and there is an honest mismatch that <a href="http://blogs.msdn.com/oldnewthing/archive/2004/03/09/86555.aspx">Raymond Chen</A>&nbsp;and others have noted between Char.IsDigit&nbsp;(based on Unicode properties) and the semantics of the Parse method. The latter is not even supported in the newest "coming out RSN" (Real Soon Now) version of the .NET Framework (Whidbey), and although the former will be supported in Whidbey in new NumberFormatInfo&nbsp;properties (.NativeDigits and .DigitSubstitution)&nbsp;it is purely informational, with no effect on rendering at all.</P>
<P>To make it even more confusing, Whidbey supports a new&nbsp;CharUnicodeInfo class that has a GetDecimalDigitValue method. That method will get the Nd (Numeric Digit) value that any digit has, so that a developer can now not only detect what is a digit but they can also find out which digit it is -- the&nbsp;crucial step needed to make parsing support work.</P>
<P>So the interesting question is: why are these half measures there -- why do half of the feature without doing the other half?</P>
<P>Of course part of the problem is that calling it one feature (digit support) does not change the fact that it involves many different entirely separate features, owned by different teams.</P>
<P>Putting on the apologist hat (just for a moment, don't worry!), the items that are being added at least go as far as to let developers know what is available -- they can at least take it to the next level and add more sophisticated parsing support so that things that should be easy (like converting U+FF10 to U+FF19, the full-width digits ０１２３４５６７８９, to their thinner look-alikes) are at least possible without hacks. And maybe the next version of the CLR after Whidbey will support doing the extra step to parsing them in .Parse methods and in regular expressions.</P>
<P>But the big reason that support for NumberFormatInfo.NativeDigits and NumberFormatInfo.DigitSubstitution is being added to Whidbey is <STRONG>CUSTOM CULTURES</STRONG>. This feature is one that will be shared with future versions of Windows, where Longhorn will use the same support to allowed for the unmanaged&nbsp;analogue (<STRONG>CUSTOM LOCALES</STRONG>). And for that "feature sharing" to work it was important to make sure that at least the existing Windows support had a framework analogue.</P>
<P>Now the .NET Framework will have to decide in the next version how to take the next two steps and try to fill in the missing holes in the digit support feature. Each version makes for a stronger foundation (which is awesome)&nbsp;without&nbsp;providing the&nbsp;actual&nbsp;structure (which is not awesome in the slightest).</P>
<hr/><div style="margin-left: 1em"><em>no comments</em></div><hr/><p><em>referenced by</em></p><div style="margin-left: 1em"><p>2010/11/12 <a href="http://archives.miloush.net/michkap/archive/2010/11/12/10088056.html">Suddenly, in a bit more time than a blink of an eye, "standards support" becomes "less i18n support"</a></p><p>2008/10/02 <a href="http://archives.miloush.net/michkap/archive/2008/10/02/8971896.html">When swimming in a sea of CONTEXT, applications can drown (and there is no lifeguard)</a></p><p>2007/02/14 <a href="http://archives.miloush.net/michkap/archive/2007/02/14/1675303.html">Nothing seems to be parsing the crap out of *this* number</a></p><p>2006/06/18 <a href="http://archives.miloush.net/michkap/archive/2006/06/18/636180.html">The Phantom of the Digits</a></p><p>2006/04/26 <a href="http://archives.miloush.net/michkap/archive/2006/04/26/583390.html">How to NOT Parse Unicode Digits, or How to: Parse Unicode Digits... NOT!</a></p><p>2006/02/22 <a href="http://archives.miloush.net/michkap/archive/2006/02/22/536877.html">And the digits just keep on coming</a></p><p>2006/01/18 <a href="http://archives.miloush.net/michkap/archive/2006/01/18/514171.html">Digits -- there is no substitute</a></p><p>2005/01/24 <a href="http://archives.miloush.net/michkap/archive/2005/01/24/359347.html">In Tamil -- sometimes, they are digits; other times, just numbers</a></p></div><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2004/12/02/273619.html" title="Get off my [lower] case! (or: Casing, the 1st)">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2004/11/30/272207.html" title="They ask me &quot;why is my Korean text in random order?&quot;">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2004-12">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2004-12-01">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2004/12/01/272864.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:42 GMT -->
</html>