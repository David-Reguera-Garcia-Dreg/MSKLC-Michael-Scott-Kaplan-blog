<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2004/12/11/279998.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:42 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>Explaining the Windows XP/Server 2003 Regional and Language Options Dialog</title></head><body>
<h1>Explaining the Windows XP/Server 2003 Regional and Language Options Dialog</h1>
<p><em>by Michael S. Kaplan, published on 2004/12/11 12:48 -05:00, original URI: http://blogs.msdn.com/b/michkap/archive/2004/12/11/279998.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<p><em><font color="#ff0000">(This page was originally posted at </font></em><a href="http://i18nwithvb.com/win2k.htm"><em><font color="#ff0000">http://i18nWithVB.com/win2k.htm</font></em></a><em><font color="#ff0000"> but I thought it could use a wider audience)</font></em></p> <h1><b>Explaining the Windows&nbsp;XP/Server 2003&nbsp;Regional and Language Options Dialog</b></h1> <h5><i><b>Disclaimer</b>: This page is </i>not<i> officially sanctioned by Microsoft. If it were, it would almost certainly be more polite.&nbsp;:-)</i></h5> <p>A lot of work was done to this dialog since Windows 2000, including massive shifts in terminology. Here is the handy-dandy conversion chart of the most important items:</p> <p> <table class="MsoTableGrid" style="BORDER-RIGHT: medium none; BORDER-TOP: medium none; BORDER-LEFT: medium none; BORDER-BOTTOM: medium none; BORDER-COLLAPSE: collapse; mso-border-alt: solid windowtext .5pt; mso-yfti-tbllook: 480; mso-padding-alt: 0in 5.4pt 0in 5.4pt; mso-border-insideh: .5pt solid windowtext; mso-border-insidev: .5pt solid windowtext" cellspacing="0" cellpadding="0" border="1"> <tbody> <tr style="mso-yfti-irow: 0; mso-yfti-firstrow: yes"> <td style="BORDER-RIGHT: windowtext 1pt solid; PADDING-RIGHT: 5.4pt; BORDER-TOP: windowtext 1pt solid; PADDING-LEFT: 5.4pt; PADDING-BOTTOM: 0in; BORDER-LEFT: windowtext 1pt solid; WIDTH: 221.4pt; PADDING-TOP: 0in; BORDER-BOTTOM: windowtext 1pt solid; BACKGROUND-COLOR: transparent; mso-border-alt: solid windowtext .5pt" valign="top" width="295"> <p class="MsoNormal" style="MARGIN: 3pt 0in"><b><i><span style="FONT-FAMILY: Tahoma">Windows 2000 term<?xml:namespace prefix = o ns = "urn:schemas-microsoft-com:office:office" /><o:p></o:p></span></i></b></p></td> <td style="BORDER-RIGHT: windowtext 1pt solid; PADDING-RIGHT: 5.4pt; BORDER-TOP: windowtext 1pt solid; PADDING-LEFT: 5.4pt; PADDING-BOTTOM: 0in; BORDER-LEFT: #d4d0c8; WIDTH: 221.4pt; PADDING-TOP: 0in; BORDER-BOTTOM: windowtext 1pt solid; BACKGROUND-COLOR: transparent; mso-border-alt: solid windowtext .5pt; mso-border-left-alt: solid windowtext .5pt" valign="top" width="295"> <p class="MsoNormal" style="MARGIN: 3pt 0in"><b><i><span style="FONT-FAMILY: Tahoma">Windows XP/Server 2003 term<o:p></o:p></span></i></b></p></td></tr> <tr style="mso-yfti-irow: 1"> <td style="BORDER-RIGHT: windowtext 1pt solid; PADDING-RIGHT: 5.4pt; BORDER-TOP: #d4d0c8; PADDING-LEFT: 5.4pt; PADDING-BOTTOM: 0in; BORDER-LEFT: windowtext 1pt solid; WIDTH: 221.4pt; PADDING-TOP: 0in; BORDER-BOTTOM: windowtext 1pt solid; BACKGROUND-COLOR: transparent; mso-border-alt: solid windowtext .5pt; mso-border-top-alt: solid windowtext .5pt" valign="top" width="295"> <p class="MsoNormal" style="MARGIN: 3pt 0in"><span style="FONT-FAMILY: Tahoma">Regional Options<o:p></o:p></span></p></td> <td style="BORDER-RIGHT: windowtext 1pt solid; PADDING-RIGHT: 5.4pt; BORDER-TOP: #d4d0c8; PADDING-LEFT: 5.4pt; PADDING-BOTTOM: 0in; BORDER-LEFT: #d4d0c8; WIDTH: 221.4pt; PADDING-TOP: 0in; BORDER-BOTTOM: windowtext 1pt solid; BACKGROUND-COLOR: transparent; mso-border-alt: solid windowtext .5pt; mso-border-top-alt: solid windowtext .5pt; mso-border-left-alt: solid windowtext .5pt" valign="top" width="295"> <p class="MsoNormal" style="MARGIN: 3pt 0in"><span style="FONT-FAMILY: Tahoma">Regional and Language Options<o:p></o:p></span></p></td></tr> <tr style="mso-yfti-irow: 2"> <td style="BORDER-RIGHT: windowtext 1pt solid; PADDING-RIGHT: 5.4pt; BORDER-TOP: #d4d0c8; PADDING-LEFT: 5.4pt; PADDING-BOTTOM: 0in; BORDER-LEFT: windowtext 1pt solid; WIDTH: 221.4pt; PADDING-TOP: 0in; BORDER-BOTTOM: windowtext 1pt solid; BACKGROUND-COLOR: transparent; mso-border-alt: solid windowtext .5pt; mso-border-top-alt: solid windowtext .5pt" valign="top" width="295"> <p class="MsoNormal" style="MARGIN: 3pt 0in"><span style="FONT-FAMILY: Tahoma">Default User Locale<o:p></o:p></span></p></td> <td style="BORDER-RIGHT: windowtext 1pt solid; PADDING-RIGHT: 5.4pt; BORDER-TOP: #d4d0c8; PADDING-LEFT: 5.4pt; PADDING-BOTTOM: 0in; BORDER-LEFT: #d4d0c8; WIDTH: 221.4pt; PADDING-TOP: 0in; BORDER-BOTTOM: windowtext 1pt solid; BACKGROUND-COLOR: transparent; mso-border-alt: solid windowtext .5pt; mso-border-top-alt: solid windowtext .5pt; mso-border-left-alt: solid windowtext .5pt" valign="top" width="295"> <p class="MsoNormal" style="MARGIN: 3pt 0in"><span style="FONT-FAMILY: Tahoma">Standards and Formats<o:p></o:p></span></p></td></tr> <tr style="mso-yfti-irow: 3"> <td style="BORDER-RIGHT: windowtext 1pt solid; PADDING-RIGHT: 5.4pt; BORDER-TOP: #d4d0c8; PADDING-LEFT: 5.4pt; PADDING-BOTTOM: 0in; BORDER-LEFT: windowtext 1pt solid; WIDTH: 221.4pt; PADDING-TOP: 0in; BORDER-BOTTOM: windowtext 1pt solid; BACKGROUND-COLOR: transparent; mso-border-alt: solid windowtext .5pt; mso-border-top-alt: solid windowtext .5pt" valign="top" width="295"> <p class="MsoNormal" style="MARGIN: 3pt 0in"><span style="FONT-FAMILY: Tahoma">Default System Locale<o:p></o:p></span></p></td> <td style="BORDER-RIGHT: windowtext 1pt solid; PADDING-RIGHT: 5.4pt; BORDER-TOP: #d4d0c8; PADDING-LEFT: 5.4pt; PADDING-BOTTOM: 0in; BORDER-LEFT: #d4d0c8; WIDTH: 221.4pt; PADDING-TOP: 0in; BORDER-BOTTOM: windowtext 1pt solid; BACKGROUND-COLOR: transparent; mso-border-alt: solid windowtext .5pt; mso-border-top-alt: solid windowtext .5pt; mso-border-left-alt: solid windowtext .5pt" valign="top" width="295"> <p class="MsoNormal" style="MARGIN: 3pt 0in"><span style="FONT-FAMILY: Tahoma">Language for Non-Unicode Programs<o:p></o:p></span></p></td></tr> <tr style="mso-yfti-irow: 4; mso-yfti-lastrow: yes"> <td style="BORDER-RIGHT: windowtext 1pt solid; PADDING-RIGHT: 5.4pt; BORDER-TOP: #d4d0c8; PADDING-LEFT: 5.4pt; PADDING-BOTTOM: 0in; BORDER-LEFT: windowtext 1pt solid; WIDTH: 221.4pt; PADDING-TOP: 0in; BORDER-BOTTOM: windowtext 1pt solid; BACKGROUND-COLOR: transparent; mso-border-alt: solid windowtext .5pt; mso-border-top-alt: solid windowtext .5pt" valign="top" width="295"> <p class="MsoNormal" style="MARGIN: 3pt 0in"><span style="FONT-FAMILY: Tahoma">Language Settings for System</span></p></td> <td style="BORDER-RIGHT: windowtext 1pt solid; PADDING-RIGHT: 5.4pt; BORDER-TOP: #d4d0c8; PADDING-LEFT: 5.4pt; PADDING-BOTTOM: 0in; BORDER-LEFT: #d4d0c8; WIDTH: 221.4pt; PADDING-TOP: 0in; BORDER-BOTTOM: windowtext 1pt solid; BACKGROUND-COLOR: transparent; mso-border-alt: solid windowtext .5pt; mso-border-top-alt: solid windowtext .5pt; mso-border-left-alt: solid windowtext .5pt" valign="top" width="295"> <p class="MsoNormal" style="MARGIN: 3pt 0in"><span style="FONT-FAMILY: Tahoma">Supplemental Language Support</span></p></td></tr></tbody></table></p> <p>There are many other changes, as well. While I do welcome change when there are confusing issues, I am not sure how much I welcome change that others will find to be just as confusing. I'll let you decide how you feel about this particular issue yourself....</p> <p>Anyway, here are some screenshots for the three important tabs for the dialog:</p> <p><img src="http://www.i18nwithvb.com/images/RLO_Tab1.jpg" /> <br /><br /><img src="http://www.i18nwithvb.com/images/RLO_Tab2.jpg" /> <br /><br /><img src="http://www.i18nwithvb.com/images/RLO_Tab3.jpg" /></p> <p>The first change is obvious -- the settings that used to show up on the first tab are now spread across three of them.</p> <p>Here is each part, explained:</p> <p><strong>Language for Standards and Formats</strong>&nbsp;- Located in the first tab, these are the preference that you, the user, has for items like date formats, calendar, preferences for text sorting, etc. Now most of these settings can be handled individually by clicking on the Customize button. You can think of this dropdown combobox as a useful way to be lazy and have settings made automatically based on the locale you choose. There are really no <em>standards</em> per se involved (such as sorting), but not everything there is a format so there had to be something else there.</p> <p>I will talk about the Location stuff some other time.</p> <p><strong>Supplemental Language Support&nbsp;</strong>-- In Windows 2000 this was a list containing various familes of locales corresponding to lanaguage groups, but now most of the support is already installed and turned on. In fact, there are only two groups that are not:</p> <ol> <li>Languages that require complex script support, including Thai, Hebrew, Arabic, Hindi, Tamil, and all the rest of the Indic locales </li><li>East Asian languages, i.e. Chinese, Japanese, and Korean</li></ol> <p>This information is in the second tab and is handled by two checkboxes. These two checkboxes control the installation of all the code pages, fonts, keyboards, etc. so that applications can support the particular language. You will probably be prompted for your Windows CD to install the files that you are in essence requesting. </p> <p>The top of the second tab handles input methods. I will talk about that more another time.</p> <p><strong>User Interface Language</strong> - You may not have this control on your regional options at all; it is only there if you have MUI (the Multilingual User Interface) installed. This allows you to change the actual language of Windows itself. It has no effect, I repeat no effect, on your installation of Windows otherwise. At all. Period. If you think it will, then cure yourself of this delusion and realize that you do not need MUI to have a multilingual experience on Windows XP and Server 2003! </p> <p><strong>Language for Non-Unicode Programs</strong> (aka Default System Locale) - Located on the third tab, this setting is the one that controls, at the machine level, the locale that will be used for all conversions to and from Unicode for applications without Unicode support (like VB 6.0, for example). If you change the Default System Locale, you will be prompted to reboot afterwards (you may be prompted for your Windows CD first if you need to install some files). But I cannot stress it strongly enough: this is the top control on the third tab. You would not believe how many people mess this up and try to change the language at the top of the first tab under "Standards and Formats"! So think carefully and allow yourself to be one of the people laughing about the confusion, rather than one of the people being laughed at. </p> <p>Incidentally, it also controls the font "language" that is used for the case of [primarily] East Asian fonts that have more than one name, based on language. </p> <p>Under this are the various code pages you can install. I recommend you use Unicode and avoiding needing these things. :-)</p> <p><strong>Default Settings</strong> - Although the title is misleading, this checkbox located on the bottom of the third tab is incredibly useful in many situations. What is does is apply any changes you make on any of the three tabs to .DEFAULT, the default user profile (copied for all new user accounts), and several system accounts. In the case of keyboards, it copies all keyboards that have been selected by the given user <strong>whether they were selected at this time or not</strong> and applies them to the .DEFAULT account. The latter is very useful if you want the ability to switch keyboards in the logon dialog. </p> <p>This setting does not exist in prior versions, which is a damn shame since people try all the time to e.g. set the default user locale on a web server and expect that change to be applied to their IIS. It does not immediately occur to most people that the setting only applies to the currently logged in user; unfortunately understanding is likely piss off any reasonable person since Windows 2000 does not provide any user interface to resolve the issue. Thankfully, much of the problem is taken care of with this one confusing setting.</p> <p>That's all for now. Let me know if you have any questions or comments about this page!</p>
<hr/><p><a id="324004" href="#324004">#</a> <strong>Mike Williams</strong> on 18 Dec 2004 6:44 AM:</p><div style="margin-left: 1em">The important question - well, *an* important question - is when are Microsoft product teams going to figure out the difference between locale, language and location? Windows Media Player v10 grants access to nationally-based music stores on the basis of user locale rather than location. Half the Office downloads on Microsoft.com specify a locale e.g. English(US) as a prerequisite, rather than a language (English); so they'd have you believe for example, that the English (or Irish) spell-checker is ONLY for people with user locale = English(United States). It seems that all the locales of non-English(US) still get very little attention, even after years of complaints from folks in the UK, Ireland, Australia, Canada, New Zealand, Singapore, South Africa, ....</div>
<p><a id="325062" href="#325062">#</a> <strong>Michael Kaplan</strong> on 18 Dec 2004 11:13 AM:</p><div style="margin-left: 1em">I have to agree with you on this one -- we have a PM on our team who has been trying to sell the location stuff to all of the product groups that ought to be caring about *it* rather than the user locale....<br><br>For the case of neutrals, the problem is a different one -- in Windows, neutral locales do not really exist except for resource loading. When people cannot even get the OS to recognize something they are less likely to trust it....</div>
<p><a id="325063" href="#325063">#</a> <strong>Michael Kaplan</strong> on 18 Dec 2004 11:16 AM:</p><div style="margin-left: 1em">Also, a colleague of my once suggested that sometimes it is best to think of Microsot not as one big company; a more accurate model is that of a country with many warring factions that get together every four years to have a good olympic team for the world stage.<br><br>:-)<br><br><br></div>
<p><a id="327746" href="#327746">#</a> <strong>Mike Williams</strong> on 20 Dec 2004 6:27 PM:</p><div style="margin-left: 1em">Except some of the events only risk injury for the spectators... When I was there, the best description I heard was of 400 start-ups with a single marketing department.<br><br>It would be a nice if there were APIs that generated the name of a language from a locale, so that appropriate lists could iterate over that. I swear everyone looks at the Language list inside Word and thinks that's the right way to present a set of languages. For a start it incorrectly sets expectations about the level of support available for each of thse listed locales. For many listed, there is no substantial support, and for many others there is no difference. But it's hard getting that message across in Microsoft. <br><br>I can see more of the benefits accruing in the open-source world, where those arguments/discussions are carried out in public rather than having to pull together a bunch in PMs in dozens of areas who really aren't sympathetic to the cause.</div>
<p><a id="327774" href="#327774">#</a> <strong>Michael Kaplan</strong> on 20 Dec 2004 6:38 PM:</p><div style="margin-left: 1em">A single marketing department? You must not have gotten around too much -- in my experience one could easily mistake two different marketing teams as coming from rival companies!<br><br>For getting the name, LOCALE_SLANGUAGE does well -- it already exists and is used in Windows. I cannot answer for Word and Office but when we point out the invalidity of some entries (which we do) they point out they have shipped that way already. :-(<br><br>I am not truly convinced that open source is particularly superior in this case, because in my experience the same mix of smart and dumb, internationally saavy and internationally retarded exist as any other company (including Microsoft). And language support is *never* given the priority is deserves....</div>
<p><a id="328100" href="#328100">#</a> <strong>Mike Williams</strong> on 20 Dec 2004 9:35 PM:</p><div style="margin-left: 1em">I got around enough to have worked with you (briefly) on Access 2000/XP :-). Prior to that I remember one marketing department handling a press release from SQL Server to the effect that there would be no relational database built on Windows CE, on the same day as another team (partly housed in the same building) announced Pocket Access and ADO for Windows CE.<br><br>I love backward-compatibility of bugs. Point 'em out in a spec-review (&quot;let's get feedback in the beta&quot;), in the beta (&quot;postponed&quot;), for next version (&quot;sorry but we can't change it because X has deployed solutions based on that bug&quot; or &quot;I don't understand the issue, I'm new to this project&quot;).<br><br>My assessment of the language support is that there are good folks like you scurrying around at one level, and then waaay above is SteveB etc trying to placate large international customers ... but in between are VPs, PUMs and GPMs who really don't give a damn in the scheme of things.</div>
<p><a id="328203" href="#328203">#</a> <strong>Michael Kaplan</strong> on 20 Dec 2004 11:09 PM:</p><div style="margin-left: 1em">Yes, I remember. And I remember the fun and games on Pocket Access as well as when they did an encore for SQL Server CE Edition. :-) <br><br>A little over two years ago I was told that my becoming an MVP for all of my work in the newsgroups on international support and <a title="MSLU" href="http://www.microsoft.com/globaldev/handson/dev/mslu_announce.mspx" target="_blank">MSLU</a> was being turned down since folks were worried about how it would make Microsoft look. <br><br>This was roughly two days after I was made the offer to go full time at MS, as a developer in Windows Globalization who was expected to keep up the very public presence in newsgroups and conferences. So I guess these sorts of mixed messasges happen all over.... <br><br>Re: language support -- the face of language support is different, these days. From GPMs like John McConnell who own strategic work on ELKs and LIPs to directors like Julie Bennett (the genius whosed group is behind the ELK amd the Windows side of the LIP) to group managers like Lori Brownell (recently named to the Unicode board of directors) to VPs like Brian Valentine, Will Poole, and Jim Allchin (who were all heavily involved in Starter Edition) to CEOs like Steve Ballmer (who was also involved in Starter Edition and who has promised language support all over the world that our team *will* deliver) to Chairmen/Chief Software Architects like Bill Gates who was also involved in Starter Edition and who sees as clear as any of these others and maybe even more clearly than some that the emerging markets are the next frontier. And all up and down the chain people are getting it. <br><br>Its a whole new ball game, Mike. And its truly a pleasure to be a part of it. :-)</div>
<p><a id="9699057" href="#9699057">#</a> <strong>noman</strong> on 4 Jun 2009 5:59 AM:</p><div style="margin-left: 1em"><p>I have one web application created in asp.net. i hosted the website on one american server. As the site was on american server so i did all scripting for date checks and conversion by keeping in mind the format mm/dd/yyyy. Now after one and half year i have switched my site from that server to new server but unfortunatly this new server is in uk and that is why the date format configured on server is dd/mm/yyyy.</p>
<p>As i have uploaded all the things on the server and have made it live as well so it is not possible for me to reinstall the server and change the date format i.e to change it to dd/mm/yyyy.</p>
<p>Now the problem i am facing is server side script is doing date checks and display in dd/mm/yyyy, which is not required.</p>
<p>I trued changing dateformat from global settings also but it didnt work although i was aware intitally also that it work. Because as per my exp i have concluded that somewhere in system the date format got stored at installation time and after that changing that is not possible without re-installtion.</p>
<p>so, if anyone can help me how to change/set the date format in the application to mm/dd/yyyy, without re-installing the server. i think some thing like localize settings will have to do with it, but what i dont know... </p></div>
<p><a id="9970571" href="#9970571">#</a> <strong>Drewfus</strong> on 28 Feb 2010 1:44 PM:</p><div style="margin-left: 1em"><p>Michael,</p>
<p>you state:</p>
<p>&quot;Default Settings - Although the title is misleading, this checkbox located on the bottom of the third tab is incredibly useful in many situations. What is does is apply any changes you make on any of the three tabs to .DEFAULT, the default user profile (copied for all new user accounts), and several system accounts.&quot;</p>
<p>.DEFAULT is not the default user profile, it's the profile used by the logon desktop. The default user profile is stored in (by default!)</p>
<p>%SystemDrive%\Documents and Settings\Default User\NTUSER.DAT</p>
<p><a rel="nofollow" target="_new" href="http://blogs.sepago.de/helge/2007/11/19/why-is-almost-everybody-wrong-about-hkudefault/">http://blogs.sepago.de/helge/2007/11/19/why-is-almost-everybody-wrong-about-hkudefault/</a></p></div>
<p><a id="9970574" href="#9970574">#</a> <strong>Michael S. Kaplan</strong> on 28 Feb 2010 1:59 PM:</p><div style="margin-left: 1em"><p>Um, as I said: &quot;the default user profile (copied for all new user accounts),&quot;. That is one of the THREE places it is revelant to.</p>
</div>
<p><a id="9970819" href="#9970819">#</a> <strong>Drewfus</strong> on 1 Mar 2010 5:07 AM:</p><div style="margin-left: 1em"><p>Michael,</p>
<p>i misread what you'd said. Er, maybe the coffee hadn't kicked in when i read it. Sorry about that.</p></div>
<p><a id="9970896" href="#9970896">#</a> <strong>Michael S. Kaplan</strong> on 1 Mar 2010 7:44 AM:</p><div style="margin-left: 1em"><p>No worries - it ain't like they made it easy! ;-)</p>
</div>
<p><a id="9975315" href="#9975315">#</a> <strong>Drewfus</strong> on 8 Mar 2010 10:26 PM:</p><div style="margin-left: 1em"><P>I find it easy enough (after a fair bit of reading - including this excellent blog), although some of the regional settings in the GUI aren't quite consistent with the unattend settings.</P>
<P>Obviously, this won't work:</P>
<P>[RegionalSettings]</P>
<P>Language="East Asian"</P>
<P>Nor can the system locale be identified for what it really is (as i understand it) - a code page:</P>
<P>[RegionalSettings]</P>
<P>CodePage="Latin 1"</P>
<P>Nor is there GeoId option:</P>
<P>[RegionalSettings|Unattend]</P>
<P>Geoid=Australia</P>
<P>I guess that's what os upgrades are for. :-)</P>
<P>Btw, i came across this interesting page about adding new timezones to sysprep.inf.</P>
<P><A href="http://blogs.technet.com/askcore/archive/2009/07/13/adding-new-timezones-to-windows-xp-windows-server-2003-sysprep-inf-deployments.aspx" rel=nofollow target=_new>http://blogs.technet.com/askcore/archive/2009/07/13/adding-new-timezones-to-windows-xp-windows-server-2003-sysprep-inf-deployments.aspx</A></P>
<P>I suppose i'm hoping for a couple of other "undocumented" methods for the regional settings section.</P></div>
<p><a id="9975316" href="#9975316">#</a> <strong>Michael S. Kaplan</strong> on 8 Mar 2010 10:28 PM:</p><div style="margin-left: 1em"><p>The reason for the inconsistency is that the UI model changed in XP/Server 2003 (from Windows 2000) but the interface did not....</p>
</div>
<p><a id="9975950" href="#9975950">#</a> <strong>Drewfus</strong> on 9 Mar 2010 6:08 PM:</p><div style="margin-left: 1em"><p>I see.</p>
<p>Another scenario/question...</p>
<p>I have an XP image with all language groups installed. Before installing this image on any particular system, i want to backup various regional settings including preloaded language:keyboardLayout combinations.</p>
<p>Is it enought to simply backup and restore (per user)</p>
<p>HKEY_CURRENT_USER\Keyboard Layout\Preload</p>
<p>or should i really be doing it via</p>
<p>control.exe ...</p>
<p>[RegionalSettings]</p>
<p>InputLocale=locale ID:keyboard layout ID,...</p>
<p>One (other ;-)) thing i'm a little confused by is the format of the InputLocale key. According to this page</p>
<p><a rel="nofollow" target="_new" href="http://technet.microsoft.com/en-us/library/cc978687.aspx">http://technet.microsoft.com/en-us/library/cc978687.aspx</a></p>
<p>&quot;The keyboard layout code consists of the locale ID , which identifies the geographic variation of the spoken language that the user has chosen, and a 4-digit code that indicates whether the keyboard layout is the default layout for the locale.&quot;</p>
<p>Similar information here</p>
<p><a rel="nofollow" target="_new" href="http://msdn.microsoft.com/en-us/goglobal/bb688135.aspx#eve">http://msdn.microsoft.com/en-us/goglobal/bb688135.aspx#eve</a></p>
<p>I interpret this as meaning that InputLocale is formatted as</p>
<p>LCID:KbIdLCID</p>
<p>That is, the first LCID is apparently redundant. This also makes me think that preloading via the registry key will do the trick and that mapping keyboard layout IDs back to valid LCIDs isn't necessary, assuming that the appropriate language groups are installed.</p></div>
<p><a id="9975989" href="#9975989">#</a> <strong>Michael S. Kaplan</strong> on 9 Mar 2010 8:05 PM:</p><div style="margin-left: 1em"><P>Actually, it is:</P>
<P>LangId1:LangId2&lt;DeviceId&gt;</P>
<P>The two LangId values do not have to be the same, so they may not be redundant.</P>
<P>Note that KLID == LangId2&lt;DeviceId&gt;.</P></div>
<p><a id="9976010" href="#9976010">#</a> <strong>Drewfus</strong> on 9 Mar 2010 9:12 PM:</p><div style="margin-left: 1em"><p>Now looking at</p>
<p><a rel="nofollow" target="_new" href="http://msdn.microsoft.com/en-au/goglobal/bb895996.aspx">http://msdn.microsoft.com/en-au/goglobal/bb895996.aspx</a></p>
<p>i notice that for Australia, with LCID of 0c09, the only valid LangId1:KLIDLangId2 combo is</p>
<p>0c09:00000409</p>
<p>That is, you have to specify en-us (0409) as LangId2 (same for en-nz). Presumably this wouldn't work</p>
<p>0c09:00000c09</p>
<p>though i can't see why &quot;in theory&quot;.</p>
<p>Compare to en-uk, where LangId1=LangId2</p>
<p>0809:00000809</p>
<p>even though both languages are part of the Basic group.</p>
<p>For en-ca, it can be either</p>
<p>1009:00000409,</p>
<p>1009:00011009,</p>
<p>1009:00001009</p>
<p>Just a little curious of these apparent &quot;inconsistencies&quot;. But mostly interested in my previous question about backing up and restoring LangId1:KLIDLangId2 combos via the registry.</p></div>
<p><a id="9976029" href="#9976029">#</a> <strong>Michael S. Kaplan</strong> on 9 Mar 2010 9:57 PM:</p><div style="margin-left: 1em"><p>Well, the values for keyboards are hardcoded values, each representing an actual layout DLL. Don't get hung up on LANGID values matching 100% &nbsp;every time, since they often don't and in some cases never have.</p>
<p>Re: the backup, using the registry is not supported here; if you do it, you are on your own....</p>
</div>
<p><a id="9976567" href="#9976567">#</a> <strong>Drewfus</strong> on 10 Mar 2010 4:40 PM:</p><div style="margin-left: 1em"><p>Your right, i shouldn't get hung up on the details as long things &quot;just work&quot;, although it is that sense of curiousity into the inner workings of things that partly drives the interest in IT admin, and without which the industry would probably not be the same.</p>
<p>Now i think i can use the Go Global table to &quot;reverse engineer&quot; the data in</p>
<p>HKEY_USERS\SID\Keyboard Layout\Preload</p>
<p>back to a valid InputLocale key, and use the Locale value under</p>
<p>HKEY_USERS\SID\Control Panel\International</p>
<p>to create a valid UserLocal key.</p>
<p>With these two values i can build a regopt.txt per user, and apply the values in the supported manner, perhaps via Active Setup.</p>
<p>In case your wondering, the target market is international students and business people, newly arrived immigrants and tourists.</p>
<p>Don't stop me while i'm having fun learning!</p></div>
<p><a id="9976602" href="#9976602">#</a> <strong>Michael S. Kaplan</strong> on 10 Mar 2010 6:03 PM:</p><div style="margin-left: 1em"><p>Again I truly recommend against the registry here. If you run into any problems then don't forget I warned you, okay? :-)</p>
</div>
<p><a id="9976641" href="#9976641">#</a> <strong>Drewfus</strong> on 10 Mar 2010 8:35 PM:</p><div style="margin-left: 1em"><p>So i've now read your posts</p>
<p>Why are the HKL and KLID of the keyboard different?</p>
<p>and</p>
<p>How do I get the @!#$% name of the keyboard?</p>
<p>and i'm a little wiser for it.</p>
<p>Also, ive heeded your warnings.</p>
<p>And now i'm going to go ahead and try anyway...</p>
<p>:-)</p></div>
<p><a id="9985632" href="#9985632">#</a> <strong>NeetaBiswas</strong> on 26 Mar 2010 3:42 AM:</p><div style="margin-left: 1em"><p>Michael,</p>
<p>In the Default Settings paragraph you have mentioned that setting the default user locale on a web server does not apply to IIS, does that mean that checking default user account settings check box on the Advanced tab applies the locale to IIS, this there any msdn document which states this.</p>
<p>I have a confusion regarding from where IIS take the locale value when &quot;Enable anonymous access&quot; is checked? </p>
<p>The IIS appears to take the value of the local administrator account specified as the windows user account for anonymous access sometimes, sometimes it takes the locale of the default profile.</p>
<p>Is there any way to view the current locale and change it and expect a consistent behavior?</p>
<p>Is the explanation given in KB 306044 applicable to IIS 6.0 and Windows 2003 also</p>
<p>Does the registry entry VarConversionLocaleSetting decide the behavior of IIS to select locale in Windows 2003 and IIS 6.0 </p>
</div>
<p><a id="9986208" href="#9986208">#</a> <strong>Michael S. Kaplan</strong> on 27 Mar 2010 11:38 AM:</p><div style="margin-left: 1em"><p>No versions of IIS use the settings that come out of the first tab of regional options without that advanced tab checkbox.</p>
<p>Some versions of IIS use that checkbox's effect on the .DEFAULT locale (others use a separate account).</p>
</div>
<p><a id="9986520" href="#9986520">#</a> <strong>NeetaBiswas</strong> on 28 Mar 2010 10:41 PM:</p><div style="margin-left: 1em"><p>Thanks Michael,</p>
<p>Please could you provide any MSDN document as reference which specifically tells from where IIS 6.0 takes the locale from. </p>
<p>I need to provide it to the customer before telling them to check the &quot;Apply to default&quot; checkbox on the advanced tab</p>
</div>
<p><a id="9986529" href="#9986529">#</a> <strong>Michael S. Kaplan</strong> on 28 Mar 2010 11:15 PM:</p><div style="margin-left: 1em"><p>I do not know of one, sorry. The KB article pretty clearly references .DEFAULT which would handle the &lt;= Server 2003 case. The only one that doesn't follow those rules is .Net, which adds its own account that it runs stuff under....</p>
</div>
<p><a id="9986624" href="#9986624">#</a> <strong>NeetaBiswas</strong> on 29 Mar 2010 4:23 AM:</p><div style="margin-left: 1em"><p>Is there a way I could view the Locale value used by IIS 6.0</p>
<p>Does HKEY_USERS\.DEFAULT\Control Panel\International\Locale show the same locale as that used by IIS?</p>
</div>
<p><a id="9986725" href="#9986725">#</a> <strong>Michael S. Kaplan</strong> on 29 Mar 2010 8:03 AM:</p><div style="margin-left: 1em"><P>Didn't I just say that? :-)</P>
<P>Because of this, that checkbox WILL help in the non-.Net case.</P>
<P>Though I do not know if this applies to 6.0 or not. You'll have to try!</P></div>
<p><a id="9987930" href="#9987930">#</a> <strong>NeetaBiswas</strong> on 30 Mar 2010 10:41 PM:</p><div style="margin-left: 1em"><P>The reason I asked that question is because at the customer end one machine has HKEY_USERS\.DEFAULT\Control Panel\International\Locale set to English(Australia) and the date is displayed correctly in dd-mm-yyyy form, where as on the other machine with English(Australia) the date is displayed in mm-dd-yyyy form and on changing HKEY_USERS\.DEFAULT\Control Panel\International\Locale to English(US) by checking Default Settings the date displays as dd-mm-yyyy form.</P>
<P>What could be the reason for such behavior</P></div>
<p><a id="9987931" href="#9987931">#</a> <strong>Michael S. Kaplan</strong> on 30 Mar 2010 10:52 PM:</p><div style="margin-left: 1em"><p>Most likely one person's machine was shipped with one configuration, and the other with the other (most people do not go to Regional Options and use that checkbox, so most likely this is how they have always been).</p>
<p>But that is not really relevant anymore -- now you just need to fix it. And you know how, now. :-)</p>
</div>
<p><strong>Mahima Natarajan</strong> on 11 Nov 2011 9:48 PM:</p><div style="margin-left: 1em"><p>Hi Michael..I want a non-unicode program &quot;Toolbook&quot; to display hindi. I don&#39;t have the option &quot;Hindi&quot; in the Select a language for Non-Unicode program under the Advanced tab. How do I include it? Im a novice and its urgent. Please help.</p>
</div>
<p><strong>Michael S. Kaplan</strong> on 14 Nov 2011 8:30 AM:</p><div style="margin-left: 1em"><p>Answered <strong><a href="http://archives.miloush.net/michkap/archive/2011/11/14/10236814.html">here</a></strong>.</p></div>
<p><strong>FFS</strong> on 29 Jun 2012 12:43 AM:</p><div style="margin-left: 1em"><p>TMC....BKL</p>
</div>
<hr/><p><em>referenced by</em></p><div style="margin-left: 1em"><p>2011/11/14 <a href="http://archives.miloush.net/michkap/archive/2011/11/14/10236814.html">A Hindi default system locale isn't gonna happen</a></p><p>2010/03/25 <a href="http://archives.miloush.net/michkap/archive/2010/03/25/9982164.html">Q: Why do the small black squares disappear? Hint: The answer isn't complicated, it's complex...</a></p><p>2007/04/28 <a href="http://archives.miloush.net/michkap/archive/2007/04/28/2311321.html">When the system locale is the display language</a></p><p>2006/12/11 <a href="http://archives.miloush.net/michkap/archive/2006/12/11/1262690.html">IsComplexEnoughForYou?</a></p><p>2005/12/28 <a href="http://archives.miloush.net/michkap/archive/2005/12/28/507759.html">Getting rid of your extra yen</a></p><p>2005/12/09 <a href="http://archives.miloush.net/michkap/archive/2005/12/09/502054.html">And they sort that list HOW, exactly?</a></p><p>2005/11/04 <a href="http://archives.miloush.net/michkap/archive/2005/11/04/489013.html">Sticky keys vs. Reading Order</a></p><p>2005/02/21 <a href="http://archives.miloush.net/michkap/archive/2005/02/21/377288.html">Give me a [word-]break!</a></p><p>2005/02/18 <a href="http://archives.miloush.net/michkap/archive/2005/02/18/376225.html">Ready... set... Reboot!</a></p><p>2005/02/16 <a href="http://archives.miloush.net/michkap/archive/2005/02/16/374450.html">Language groups -- the vestigial tail of NLS</a></p><p>2005/02/01 <a href="http://archives.miloush.net/michkap/archive/2005/02/01/364707.html">What is my locale? Well, which locale do you mean?</a></p><p>2004/12/13 <a href="http://archives.miloush.net/michkap/archive/2004/12/13/281187.html">Regional Options is not intuitive (Duh!)</a></p></div><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2004/12/11/280129.html" title="I guess BIOS.NET may be on the way?">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2004/12/11/279997.html" title="Explaining the Windows 2000 Regional Options Dialog">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2004-12">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2004-12-11">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2004/12/11/279998.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:42 GMT -->
</html>