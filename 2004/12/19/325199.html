<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2004/12/19/325199.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:42 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>API Consistency and Developer Comfort</title></head><body>
<h1>API Consistency and Developer Comfort</h1>
<p><em>by Michael S. Kaplan, published on 2004/12/19 02:07 -05:00, original URI: http://blogs.msdn.com/b/michkap/archive/2004/12/19/325199.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<P>If anyone ever looked at the Win32 API and tried to claim that the functions were implemented consistently, then odds are they are clinically insane. If you know what I mean.</P>
<P>So thats not what I am thinking about.</P>
<P>I am thinking about the little consistencies that one can find in families of APIs, such as</P>
<UL>
<LI>Most of the NLS APIs take an LCID, all of which use the behavior of <A title=ConvertDefaultLocale href="http://msdn.microsoft.com/library/en-us/intl/nls_80o5.asp" target=_blank>ConvertDefaultLocale</A> on the LCID you pass in 
<LI>The registry APIs returning the error value so that 0 means success whereas it would mean failure for most other APIs. 
<LI>The "Ex" versions of keyboarding APIs take an HKL parameter, and their non-Ex counterparts use the current default 
<LI>The NLS APIs can take&nbsp;a buffer size for the in buffer or you can pass -1 to indicate it is null terminated 
<LI>Most of the GDI APIs return a BOOL 
<LI>Flags and the way they are named seem consistent within families in USER, GDI, KERNEL, NLS, etc., even though wildly different when compared between these families 
<LI>Buffer semantics are again generally consistent within families</LI></UL>
<P>This is something that I always personally found to be comforting -- like there were teams that had the institutional memory of the APIs they have and that when they add them they try to keep these little consistencies so that people who use them could have intelligent guesses as to behavior so if they understood some APIs they could end up understanding a lot of the rest.</P>
<P>But the other day I was talking to some colleagues who said that they never really grouped API behaviors this way, and they minimized the actual benefit to trying to maintain such a consistency.</P>
<P>So what do you think? Is there a benefit to the little consistencies? Do you believe they are even present? Or is that just me assuming patterns where there are none of any importance?</P>
<P>
<HR id=null>

<P></P>
<P>Also, a random note to answer a question posed by Jonathan Wilson in the "suggest a topic" post -- the LoadKeyboardLayoutEx API sort of follows the above pattern with "ex" versions of keyboard APIs but it also involves other stuff like windowstations. Its not documented because it does not really provide any usable functionality outside of the USER subsystem that one cannot get with existing APIs like <A title=LoadKeyboardLayout href="http://msdn.microsoft.com/library/en-us/winui/winui/windowsuserinterface/userinput/keyboardinput/keyboardinputreference/keyboardinputfunctions/loadkeyboardlayout.asp" target=_blank>LoadKeyboardLayout</A>. But the USER subsystem does have to care about things like separate windowstations....</P>
<P><FONT color=#800080><EM>This post brought to you by </EM>"<FONT size=5>àªµ</FONT>" <EM>(U+0ab5, a.k.a. GUJARATI LETTER VA)</EM></FONT></P>
<hr/><p><a id="325656" href="#325656">#</a> <strong>Uwe Keim</strong> on 19 Dec 2004 12:46 AM:</p><div style="margin-left: 1em">Usually, I only notice if an API does NOT follow a schema. <br><br>E.g. the .NET Framework naming rules state that 2-letter-abbreviations should be made uppercase (if I recall correctly), but e.g. the &quot;SqlDbType&quot; should read &quot;SqlDBType&quot; according to that rules... So there is an inconsistency in some API names.</div>
<p><a id="325712" href="#325712">#</a> <strong>Sebastian Redl</strong> on 19 Dec 2004 9:16 AM:</p><div style="margin-left: 1em">The consistencies within families are there. For example, all the Create* functions in the process, thread and sync family return NULL as error value (except for CreateProcess, which doesn't return a HANDLE in the first place, for understandable reasons.)<br>Yet the Storage function CreateFile, which returns a HANDLE too, returns INVALID_HANDLE_VALUE.<br><br>Yes, within families there is consistency. Still I absolutely don't understand why this is limited to families. How can it be that there were no standards set for the API? How can one developer group follow one pattern and another a different one? Where is the communication? Where are the standards?<br><br>The inconsistencies are one of the things that make the WinAPI so hard and error-prone to use. Perhaps even the main thing.<br><br>While having consistency within families is nice and helps a little, there are far too many families to keep track of. In practice, I still have to look up every function to see how it indicates an error. And because there are some inconsistencies even within families, I can't trust this not to be the case with the very function I'm currently calling, so in practice I still have to look up every single function and can't rely on the documentation of the function from the same family I used a few moments before.<br><br>So the consistencies help very little. The truth is that they shouldn't be anything remarkable in the first place. OpenSource projects like GTK, where ther eare hundreds if not thousands of completely disjoint programmers working on it, have better consistency than the WinAPI, which admittedly evolved over years, but still always had the same central guidance, which should have managed to keep them all consistent.</div>
<p><a id="326800" href="#326800">#</a> <strong>Michael Kaplan</strong> on 19 Dec 2004 1:25 PM:</p><div style="margin-left: 1em">Sebastian -- I am not going to disagree with a statement that standards across all APIs would have been a good thing. But the train has already left the station on that one, right?<br><br>I am also uncertain about how much the consistencies help -- they feel &quot;comfortable&quot; to me but I do not think there is an easy way to translate a feeling of comfort into an actual productivity gain.<br><br>At the moment, I'm looking at potential new APIs and how one should proceed there. Are the minor consistencies worth trying to preserve? Or should they be designed based on their own requirements without considering such factors? Its a tough question....</div>
<p><a id="327165" href="#327165">#</a> <strong>Larry Osterman</strong> on 19 Dec 2004 7:12 PM:</p><div style="margin-left: 1em">Fascinatingly enough, many of the &quot;families&quot; of APIs are a reflection of the preferences of the developers who write the APIs.<br><br>The developer who write most of the file I/O APIs felt that APIs should just return success and failure.  The developer who write the user mode registry APIs felt that an API should return the status code (he was following from the convention of the Lan Manager (Net*) APIs).<br><br>Similar things happened for GDI and user...<br></div>
<p><a id="327169" href="#327169">#</a> <strong>Michael Kaplan</strong> on 19 Dec 2004 7:24 PM:</p><div style="margin-left: 1em">Indeed, that is definitely the case for the NLS APIs as well, when it comes to the &quot;size of buffer or -1 for null terminated&quot; and &quot;don't touch the target buffer on failure&quot; principles. <br><br>I could even name names for some of these preferences (though I am sure Larry could name more!).<br><br>And in truth there are times that &quot;preferences&quot; here is a shorthand for very careful thought about what the semantic should be. Though that may not have happened as often as we all would have liked, in retrospect.</div>
<hr/><p><em>referenced by</em></p><div style="margin-left: 1em"><p>2008/08/11 <a href="http://archives.miloush.net/michkap/archive/2008/08/11/8847467.html">The fault is ~60% functionality, ~40% documentation</a></p><p>2007/09/23 <a href="http://archives.miloush.net/michkap/archive/2007/09/23/5070899.html">If it isn't Unicode, it isn't ANY code!</a></p><p>2006/11/28 <a href="http://archives.miloush.net/michkap/archive/2006/11/28/1166834.html">When you ask how long it is, keep in mind that some guys may exaggerate their answer</a></p><p>2006/04/24 <a href="http://archives.miloush.net/michkap/archive/2006/04/24/581700.html">When the documentation is confusing, it is often because the functionality is, too</a></p><p>2005/04/20 <a href="http://archives.miloush.net/michkap/archive/2005/04/20/410043.html">Encoding APIs and Security Concerns, APIs and Security Decisions</a></p></div><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2004/12/19/326806.html" title="Hebrew -- logical versus visual">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2004/12/18/325156.html" title="What is behind the &quot;Blogs I Read&quot; list? (sorta OT)">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2004-12">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2004-12-19">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2004/12/19/325199.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:42 GMT -->
</html>