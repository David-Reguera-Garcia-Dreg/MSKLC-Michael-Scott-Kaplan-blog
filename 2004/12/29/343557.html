<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2004/12/29/343557.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:42 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>What is a neutral culture? What is a neutral locale?</title></head><body>
<h1>What is a neutral culture? What is a neutral locale?</h1>
<p><em>by Michael S. Kaplan, published on 2004/12/29 02:05 -05:00, original URI: http://blogs.msdn.com/b/michkap/archive/2004/12/29/343557.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<P>I am going to take these two questions out of order because (a) locales existed before cultures did, (b) neutral locales set the stage for neutral cultures, and (c) I think it may help us look less lame. Though that third reason is probably just naive optimism on my part....</P>
<P>To see what Windows does with neutral locales, you can look at the documented behavior of <A title=ConvertDefaultLocale href="http://msdn.microsoft.com/library/en-us/intl/nls_80o5.asp" target=_blank>ConvertDefaultLocale</A>. Basically, if you pass&nbsp;a neutral like LANG_ENGLISH then it will return the equivalent of <A title=MAKELANGID href="http://msdn.microsoft.com/library/en-us/intl/nls_97vo.asp" target=_blank>MAKELANGID</A>(LANG_ENGLISH, SUBLANG_DEFAULT)&nbsp;thus 0x009 becomes 0x0409, 0x01a becomes 0x041a, and so forth. Easy, huh?</P>
<P>This ConvertDefaultLocale function calls an internal routine to do its work; the same routine is called by every NLS function, too. Which is a long way around to say that neutral locales do not exist to the Win32 NLS APIs. </P>
<P>Now there is one use for them in Win32 -- resource loading. You can use neutral LCIDs either to more accurately tag resources or to provide an easy&nbsp;fallback mechanism. Of course, if you want to put names on them then you cannot use <A title=GetLocaleInfo href="http://msdn.microsoft.com/library/en-us/intl/nls_34rz.asp" target=_blank>GetLocaleInfo</A> since asking for the LOCALE_SLANGUAGE of LANG_ENGLISH will give you "English (United States)" which is probably not what you wanted. </P>
<P><EM>(In fact, I wonder what Visual Studio's resource editor does for its strings for these neutrals -- it must have its own strings somewhere, hard coded? Ick!)</EM></P>
<P>In retrospect, it might have been a better idea to not do things that way, but it has shipped this way for at least the last ten versions of Windows. So we are kinda stuck with it.</P>
<P>Anyway, thats neutral locales -- at best, they are tolerated. But you can't really do much with them. Using that ConvertDefaultLocale-ish behavior can actually get you unexpected results sometimes, too. <EM>More on this another day.</EM></P>
<P>This brings us to neutral cultures....</P>
<P>In the .NET Framework, a neutral <A title=CultureInfo href="http://msdn.microsoft.com/library/en-us/cpref/html/frlrfsystemglobalizationcultureinfoclasstopic.asp" target=_blank>CultureInfo</A> mostly does not do this weird implied LCID fallback thing. There is actual data behind these culures that you can query and use -- and you can get back the actual names and everything. It also does a great job on the resource loading fallback -- using the CultureInfo object's Parent property. The parent property is not based on LCID tricks, either -- it's actual planned data for each culture. Obviously much cooler and&nbsp;a bit more thought out.There is even a <A title=CreateSpecificCulture href="http://msdn.microsoft.com/library/en-us/cpref/html/frlrfsystemglobalizationcultureinfoclasscreatespecificculturetopic.asp" target=_blank>CreateSpecificCulture</A> method on a CultureInfo that does the same sort of thing as ConvertDefaultLocale, creating a specific culture from a neutral one.</P>
<P>A lot of you probably noticed where I said "mostly" in that last paragraph (an occupational hazard of having readers who&nbsp;can be as cynical as I am!). Unfortunately, that weird LCID-esque fallback behavior still basically happens for collation and encoding via the culture's <A title=CompareInfo href="http://msdn.microsoft.com/library/en-us/cpref/html/frlrfsystemglobalizationcompareinfoclasstopic.asp" target=_blank>CompareInfo</A> and <A title=TextInfo href="http://msdn.microsoft.com/library/en-us/cpref/html/frlrfsystemglobalizationtextinfoclasstopic.asp" target=_blank>TextInfo</A> objects. Which is not such a big deal, and it is really necessary since both of those objects need the context of a specific culture.&nbsp;</P>
<P>In retrospect, it might have been a better idea to not do things that way -- CompareInfo and TextInfo should not have been made available (as happens for other objects like the associated <A href="http://msdn.microsoft.com/library/en-us/cpref/html/frlrfsystemglobalizationdatetimeformatinfoclasstopic.asp" target=_blank>DateTimeFormatInfo</A> and <A title=NumberFormatInfo href="http://msdn.microsoft.com/library/en-us/cpref/html/frlrfsystemglobalizationnumberformatinfoclasstopic.asp" target=_blank>NumberFormatInfo</A>), but it has shipped this way for two versions so we are kinda stuck with it.</P>
<P>One important difference that distinguishes them from neutral locales is that one could create a class that is derived from CultureInfo that contains language-specific information which would make more sense in neutral cultures, which is really a fancy way of saying "language-only cultures" (which is itself kind of a fancy way of say something).</P>
<P>There are also some odd situations with the LCID property of the CultureInfo, but thats a separate issue. <EM>More on this another day, too.</EM></P>
<P>So, thats neutral cultures. Mostly not useful, except for resources -- except in the same way that they are useful in Win32 (by pretending its a specific culture). Or for potential extensibility either by Microsoft or by developers in the future.</P>
<P>Three steps forward, one step back? :-)</P>
<P><FONT color=#800080><EM>This post brought to you by</EM> "<FONT face="Arial Unicode MS,Code2000" size=4>â™Ž</FONT>" <EM>(U+264e, a.k.a. LIBRA)</EM></FONT></P>
<hr/><p><a id="343580" href="#343580">#</a> <strong>Luc Cluitmans</strong> on 29 Dec 2004 1:28 AM:</p><div style="margin-left: 1em">Quote: &quot;So, thats neutral cultures. Mostly not useful, except for resources&quot;.<br><br>Mostly not useful? I use them all the time!<br><br>The software I write, though usually using english as a user interface language, has to run on computers with different locale settings (mostly UK English and Finnish in our case).<br>If I export data in a text format on one computer, which happens to use a comma as its default 'decimal point', I still need to be able to read that data on computers that use a dot as decimal point. And I cannot always control the application that writes the data, so either decimal separator may occur in the input.<br>The only way I have found to reliably parse such data is to simply assume that there are no thousands separators, use String.Replace() to replace any commas with dots, and use the Neutral culture (which uses a dot as decimal separator) to parse the numbers.<br>In reverse, when writing data, I try to standardize the output format, and I do so by using the number formatting as dictated by the neutral culture (and use the 's' format for DateTime).<br>Also, several blogs have warned about not passing a culture to String.ToLower or String.ToUpper: not passing any culture there will give different results on different computers; passing the neutral culture at least gives a consistent result.<br>As for context, all these operations are used for transforming data from one data format mostly intended for computer consumption to another data format mostly for computer consumption. Presenting data to the user in his 'own' culture is not an issue here.<br></div>
<p><a id="343596" href="#343596">#</a> <strong>Michael Kaplan</strong> on 29 Dec 2004 2:30 AM:</p><div style="margin-left: 1em">Actually, that would be a misuse of the neutral culture. Neutral cultures do not provide valid or consistent formatting/parsing results.<br><br>If you need results that do not vary with user preference or machine setting, then the invariant culture is what you need to use.<br><br>&quot;CultureInfo.InvariantCulture&quot;</div>
<p><a id="343636" href="#343636">#</a> <strong>Panos Theofanopoulos</strong> on 29 Dec 2004 5:51 AM:</p><div style="margin-left: 1em">Michael : Infact BCL Component model is not using InvariantCulture but does it's comparisons using OrdinalIgnoreCase. What is the difference between OrdinalIgnoreCase and case insesitive comparisons using InvariantCulture ? Why we need both ?<br><br>btw if anyone finds my suggestion reasonable<br><a target="_new" href="http://lab.msdn.microsoft.com/ProductFeedback/viewfeedback.aspx?feedbackid=2682c87e-5c46-4697-bbed-6f0de0047a7d">http://lab.msdn.microsoft.com/ProductFeedback/viewfeedback.aspx?feedbackid=2682c87e-5c46-4697-bbed-6f0de0047a7d</a><br>please vote for it</div>
<p><a id="343686" href="#343686">#</a> <strong>Michael Kaplan</strong> on 29 Dec 2004 7:42 AM:</p><div style="margin-left: 1em">The question that Luc raised was related to formatting, not comparison.<br><br>But to answer your question -- the OrdinalIgnoreCase type comparison does not use linguistic tables at all. It is basically a binary comparison with a quick case ignorer. So it is faster if you do not care about the right thing happening linguistically.<br><br>I will be talking about this one more in a future posting. :-)</div>
<p><a id="343697" href="#343697">#</a> <strong>Michael Kaplan</strong> on 29 Dec 2004 8:04 AM:</p><div style="margin-left: 1em">Added to the suggestion list at:<br> <a target="_new" href="http://archives.miloush.net/michkap/archive/2004/12/29/343583.html#343693">http://blogs.msdn.com/michkap/articles/343583.aspx#343693</a></div>
<p><a id="343705" href="#343705">#</a> <strong>Panos Theofanopoulos</strong> on 29 Dec 2004 8:20 AM:</p><div style="margin-left: 1em">&gt; So it is faster if you do not care about the right thing happening linguistically<br><br>That means that InvariantCulture does the right thing linguistically ?<br>Who can validate that it does if it's Invariant ? ;-)</div>
<p><a id="343715" href="#343715">#</a> <strong>Michael Kaplan</strong> on 29 Dec 2004 8:39 AM:</p><div style="margin-left: 1em">I'll cover what I meant in that other post -- which I will probably do next. :-)</div>
<p><a id="344156" href="#344156">#</a> <strong>Luc Cluitmans</strong> on 30 Dec 2004 12:34 AM:</p><div style="margin-left: 1em">Quote: &quot;If you need results that do not vary with user preference or machine setting, then the invariant culture is what you need to use.&quot; <br><br>Oops, my bad. I mixed up the Neutral culture and the Invariant culture - I am using the Invariant culture in my code of course, I just didn't realize that the 'neutral' culture was a different beast than the 'invariant' culture...<br><br></div>
<p><a id="344158" href="#344158">#</a> <strong>Michael Kaplan</strong> on 30 Dec 2004 12:45 AM:</p><div style="margin-left: 1em">Ah, no worries. This stuff could be much less confusing, if you ask me. :-)</div>
<p><a id="360525" href="#360525">#</a> <strong>Andy</strong> on 25 Jan 2005 4:40 PM:</p><div style="margin-left: 1em">I appreciate this article.  I was looking for something that did what <a title="CreateSpecificCulture" href="http://msdn.microsoft.com/library/en-us/cpref/html/frlrfsystemglobalizationcultureinfoclasscreatespecificculturetopic.asp" target="_blank">CreateSpecificCulture</a> does, but I didn't know what it was called since I hadn't used it before.   The rest of the article was interesting as well.<br><br>In this case, the site was of certain value.<br><br>Cheers,<br><br>Andy</div>
<hr/><p><em>referenced by</em></p><div style="margin-left: 1em"><p>2011/03/16 <a href="http://archives.miloush.net/michkap/archive/2011/03/16/10141835.html">Reporting one casualty in the operation; luckily it was the stupidest member of the unit</a></p><p>2007/07/15 <a href="http://archives.miloush.net/michkap/archive/2007/07/15/3888681.html">Neutral? I do not think that word means what you think it means!</a></p><p>2006/11/07 <a href="http://archives.miloush.net/michkap/archive/2006/11/07/1011692.html">How ConvertDefaultLocale sorta broke backward compatibility in Vista, and why</a></p><p>2005/08/31 <a href="http://archives.miloush.net/michkap/archive/2005/08/31/458266.html">Sometimes it *does* pay to be neutral</a></p><p>2005/07/05 <a href="http://archives.miloush.net/michkap/archive/2005/07/05/435885.html">Change is in the cards for ConvertDefaultLocale....</a></p><p>2005/06/13 <a href="http://archives.miloush.net/michkap/archive/2005/06/13/428570.html">Using full locales rather than the neutral ones?</a></p></div><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2004/12/29/343583.html" title="Suggest a topic! (January 2005)">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2004/12/28/333168.html" title="&quot;To start press the ALTGR key.&quot; Hmm... where&#39;s the ALTGR key?">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2004-12">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2004-12-29">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2004/12/29/343557.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:42 GMT -->
</html>