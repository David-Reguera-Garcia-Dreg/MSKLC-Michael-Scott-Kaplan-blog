<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2004/11/27/270931.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:42 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>Some keyboarding terms</title></head><body>
<h1>Some keyboarding terms</h1>
<p><em>by Michael S. Kaplan, published on 2004/11/27 03:08 -05:00, original URI: http://blogs.msdn.com/b/michkap/archive/2004/11/27/270931.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<P>This posting will try to clear up some of the problems in documentation and info regading keyboards, since there is plenty left in those things to be confusing and there is no need to throw&nbsp;bewildering terms into the mix. Future posts will build on this one, so if you already know about keyboards you <EM>might</EM> be able to skip it (though I would not advise it!). It is not really a glossary since it is not alphabetized; the order is arbitrary based on either when I thought of a term to add or when I thought dramatic effect could be increased.</P>
<UL>
<LI><STRONG>LCID</STRONG> -- a locale identifier. Traditionally pronounced like "<EM>El-Sid</EM>". It is a value that has no real meaning at all to keyboards but some people who ought to know better seem to think it does. Those people&nbsp;are actually thinking of LANGID, another entry in the glossary. LCIDs are only 32 bits, a fact that sucks for reasons I'll talk about another day, but it's twice as much as keyboards use, anyway. 
<LI><STRONG>LANGID</STRONG> - a languge identifier. Traditionally <EM>not</EM> pronounced like "<EM>Lan-Gid</EM>", instead "<EM>Lang-Eye-Dee</EM>" is preferred. This is the bottom WORD of the DWORD that makes up an LCID and essentially represents a number that signifies a unique language/region/script combination. This combination is what is needed for keyboards, which are intended to be typical input methods for such combinations. Obviously, looking ahead to the world of custom cultures ans custom locales, this may not be the best design architecture. But it's a little too late to change now.... 
<LI><STRONG>Layout ID</STRONG> -- a layout identifier. This has no special pronunciation, probably because calling something a "Lid" would sound dumb. These numbers are used to help the USER SUBSYSTEM manage the situation when multiple keyboards use the same LANGID (something that happens for many keyboards that ship with Windows). Each keyboard layout using the same LANGID after the first must (1) have one and (2) it must not duplicate one that is already assigned on the system. Failure&nbsp;on&nbsp;either&nbsp;of these points will cause a layout to not be properly selected. 
<LI><STRONG>KLID</STRONG> -- a keyboard layout identifier. Traditionally pronounced "<EM>Kay-El-Eye-Dee</EM>" because <EM>some</EM> people in the USA get very uptight about certain homonyms (you can catch me slipping on this point from time to time). It's also sometimes called the input locale identifier since the name for HKL has been updated (see the HKL definiteion for info on why that is incorrect since the HKL is for something different). The KLID&nbsp;can be retrieved for the&nbsp;currently selected&nbsp;keyboard layout&nbsp;in a thread through the <A href="http://msdn.microsoft.com/library/en-us/winui/winui/windowsuserinterface/userinput/keyboardinput/keyboardinputreference/keyboardinputfunctions/getkeyboardlayoutname.asp">GetKeyboardLayoutName</A> API (note the pswzKLID parameter), though that is not true of any other selected or installed keyboard layout.&nbsp;Every keyboard layout on the system has one of these.&nbsp;Each&nbsp;KLID is&nbsp;32 bits (thus 8 hex digits), and they can all be found in the registry as the subkeys under HKLM\SYSTEM\CurrentControlSet\Control\Keyboard Layouts\. The bottom half of the KLID is a LANGID, and the top half is something device-specific. By convention, the first hex digit is usually as follows: 
<UL>
<LI><STRONG>0</STRONG> -- Most keyboard layouts 
<LI><STRONG>A</STRONG> -- Keyboard layouts defined by MSKLC 
<LI><STRONG>D </STRONG>-- Some non-CJK input methods that have been defined by the Text Services Framework <EM>(note: reported to me; I have never seen one of these!)</EM> 
<LI><STRONG>E</STRONG> -- CJK input methods, also known as IMEs</LI></UL>
<LI><STRONG>HKL</STRONG> -- a handle to a keyboard layout, traditionally pronounced "<EM>AÌ„ch-Kay-El</EM>", the terminiology folks have pretty aggressively tried to call this an "input locale identifier" despite the obvious problem that it has nothing to do with locales and that it is not the same value as the actual identifier (the KLID). The HKL in actuality <EM>is</EM> the handle to an input method. Althought defined as a handle, only the lower 32 bits are currently used. Of those 32 bits, the bottom 16 bits represent a LANGID, and the top 16 bits represent a value defined by the USER SUBSYSTEM which helps to uniquely identify an installed keyboard layout. This is crucial since any keyboard layout can be installed more than once (by installing it under different languages, which helps user operations like spell checking). 
<LI><STRONG>MKLC</STRONG> -- see MSKLC. The only people who call it MKLC are the ones who object to MSKLC since it's not a true acronym (Microsoft being a single word). None of the user interface or documentation calls it this, so it's unbelievable that it is getting such a large entry in this glossary, but people outside of Microsoft use it all the time. 
<LI><STRONG>MSKLC</STRONG> -- the <A href="http://www.microsoft.com/globaldev/tools/msklc.mspx">Microsoft Keyboard Layout Creator</A>, traditionally prounounced "<EM>Em-Es-Kay-El-See</EM>" by people not taken in by the MKLC arguments. It is a tool released by Microsoft which allows someone to build a custom keyboard layout and build a setup package to install it on Windows NT 4.0, 2000, XP, or Server 2003. The help file contains a ton of information about the best way to design keyboard layouts that work well on Windows. I am the developer on it and love to hear feedback any time people have it, since there is always room for improvement. 
<LI><STRONG>IME</STRONG> -- Input method editor, traditionally pronounced "<EM>Eye-Em-Eee</EM>". An IME is an engine that converts keystrokes into phonetic or ideographic characters. It is a commonly used abstraction that allows a keyboard with only 100 or so keystrokes to be able to support character sets that contain up to 20,000 or more ideographs. There are old samples in the Platform SDK using the Input Method Manager (IMM) APIs, but today most IMEs written by Microsoft use the much more approachable <A href="http://msdn.microsoft.com/library/en-us/tsf/tsf/what_is_text_services_framework.asp">Text Services Framework</A>. 
<LI><STRONG>Supported keyboard layout</STRONG> -- this is an odd terminology that actually means a keyboard layout is defined on the system. It may not be currently selectable by a user (e.g., if it's a Thai keyboard layout and Thai/complex script support is not enabled). It can also be an IME or a speed-to-text converter, so&nbsp;DEFINED INPUT METHOD might have been a better term. This terminology is slowly being removed from documentation and it's not entirely clear what is replacing it. 
<LI><STRONG>Installed keyboard layout</STRONG> -- another odd bit of terminology, it means a keyboard layout that a user has selected. It can also be an IME or a speed-to-text converter, so&nbsp;SELECTED INPUT METHOD might have been a better term. This terminology is slowly being removed from documentation and it's not entirely clear what is replacing it. 
<LI><STRONG>Scan code</STRONG> -- The numeric value given to each physical key on a keyboard; the scan code is a hardware-dependent number that identifies the key. Scan codes have a fixed position on the physical keyboard, irregardless of the keyboard layout chosen by the user. 
<LI><STRONG>Virtual Key</STRONG> -- Also called the VK, the code that is given by the Windows USER subsystem to represent a keystroke. It is mapped from a scan code by using the keyboard layout definition and is thus entirely dependent on the user's chosen layout. The reason for this is the [unfortunate, IMHO] choice to have e.g. VK_A to be used for the 'A' key, which meant that on keyboards that put 'A' in a different position the VK would have to be moved.</LI></UL>
<P>That's all I can think of at the moment, but I am sure I will be updating this topic any time I think of something else.</P>
<hr/><p><a id="329430" href="#329430">#</a> <strong>Norman Diamond</strong> on 21 Dec 2004 6:21 PM:</p><div style="margin-left: 1em">If Layout ID and KLID are two separate identifiers, how come Windows still suffers from the forcing a single value to misrepresent both the keyboard layout and IME together?  This is the root cause of some of the problems I've mentioned in feedback to some of your later postings.  The physical keyboard has a physical layout of what is shown on its keys, and the IME is a separate layer on top of that.  Why can't users (of either a real IME or &quot;Global&quot; IME) independently say what their real keyboard layout is and say what IME they wish to use on top of it?</div>
<p><a id="329602" href="#329602">#</a> <strong>Michael Kaplan</strong> on 21 Dec 2004 10:18 PM:</p><div style="margin-left: 1em">Your issue has nothing to do these two things being separate. I'll work at trying to help with the other issues you bring up in a different post though as this one is unrelated.</div>
<p><a id="329627" href="#329627">#</a> <strong>Norman Diamond</strong> on 21 Dec 2004 11:13 PM:</p><div style="margin-left: 1em">Well, I used to think that Microsoft had one single identifier into which they forced the combination of real keyboard layout and IME, resulting in the described problems.  I used to think that those problems could be avoided by using two separate identifiers.  Then in your posting I learned that there ARE two separate identifiers.  So why didn't one identifier get one of these meanings and the other identifier get the other meaning?  Why did both of them still get the combination of the same two meanings squashed together?<br><br>I understand that you will bring this up in another post, I thank you and I look forward to it.  But meanwhile it still looks to me like my question was on-topic.</div>
<p><a id="329643" href="#329643">#</a> <strong>Michael Kaplan</strong> on 21 Dec 2004 11:40 PM:</p><div style="margin-left: 1em">They are different meanings, and the meaning relate to important tracking issues within the USER subsystem and the architecture of keyboards.<br><br>Your interest in adding yet a third meaning is a separate issue. So the reason that that meaning was not captured here is that they were busy with the other stuff? :-)</div>
<hr/><p><em>referenced by</em></p><div style="margin-left: 1em"><p>2008/09/29 <a href="http://archives.miloush.net/michkap/archive/2008/09/29/8968315.html">What a tangled web we weave when a KLID from an HKL we must receive</a></p><p>2007/11/29 <a href="http://archives.miloush.net/michkap/archive/2007/11/29/6594984.html">The UK Extended keyboard -- over-extended? Or weirdly extended?</a></p><p>2007/08/23 <a href="http://archives.miloush.net/michkap/archive/2007/08/23/4535058.html">Getting the language (and more!) of an LCID-less keyboard</a></p><p>2007/02/07 <a href="http://archives.miloush.net/michkap/archive/2007/02/07/1616301.html">I do not think that word means what the Platform SDK thinks it means</a></p><p>2005/12/01 <a href="http://archives.miloush.net/michkap/archive/2005/12/01/498775.html">What is the VK for the semicolon?</a></p><p>2005/09/09 <a href="http://archives.miloush.net/michkap/archive/2005/09/09/462862.html">internationalizaton vs. localizability</a></p><p>2005/04/17 <a href="http://archives.miloush.net/michkap/archive/2005/04/17/409032.html">Why are the HKL and KLID of the keyboard different?</a></p><p>2005/04/08 <a href="http://archives.miloush.net/michkap/archive/2005/04/08/406413.html">The ever-misleadingly incorrect usage of the word DEFAULT</a></p><p>2004/12/05 <a href="http://archives.miloush.net/michkap/archive/2004/12/05/275231.html">How do I get the @!#$% name of the keyboard?</a></p></div><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2004/11/27/270995.html" title="Comment policy....">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2004/11/26/270769.html" title="&#39;Evil date parsing&#39;, Parse, and ParseExact">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2004-11">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2004-11-27">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2004/11/27/270931.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:42 GMT -->
</html>