<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2009/07/07/9822548.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:35 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>Buying the cow vs. the cut of beef you like</title></head><body>
<h1>Buying the cow vs. the cut of beef you like</h1>
<p><em>by Michael S. Kaplan, published on 2009/07/07 10:01 -04:00, original URI: http://blogs.msdn.com/b/michkap/archive/2009/07/07/9822548.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<p>The other day a question came from someone doing some work to support MUI in their application. Their question was simple enough:</p><blockquote><p><font face="times new roman,times"><i>Which one is preferred way GetFileMUIPath VS. GetThreadPreferredUILanguages?</i></font> <br></p></blockquote><p>Although the question seems simple, the answer is even simpler.</p><p><b>This is the wrong question.</b></p><p>These two functions have two different though related purposes:</p><ul><li><a href="http://msdn.microsoft.com/library/dd318097.aspx" mce_href="http://msdn.microsoft.com/library/dd318097.aspx">GetFileMUIPath</a> -- Retrieves the path to all language-specific resource files associated with the supplied LN file. The application must call this function repeatedly to get the path for each resource file.</li><li><a href="http://msdn.microsoft.com/library/dd318128.aspx" mce_href="http://msdn.microsoft.com/library/dd318128.aspx">GetThreadPreferredUILangauges</a> -- Retrieves the thread preferred UI languages for the current thread.</li></ul><p>GetFileMUIPath is best thought of as a Windows-specific
implementation of the resource logic -- it assumes that even if you are
not built into Windows that you are following the same rules about
directories and resources as if you were. And it returns information that your application may or may not even need, depending.<br></p><p>Now obviously GetFileMUIPath works at a much higher level than GetThreadPreferredUILanguages -- in fact, GetFileMUIPath even takes a flag value that instructs the function to make use of the samje list provided by GetThreadPreferredUILanguages (MUI_USE_PREFERRED_UI_LANGAUGES).</p><p>If you do anything even remotely different in how you have laid out the files or whatever then you have to do that extra work yourself, possibly based on the list provided by GetThreadPreferredUILanguages. Or not -- it is really up to you -- entirely based on how your app's resources work. </p><p>So asking which one to use is kind of the equivalent of asking something like:</p><p><b>Which is the preferred way -- buy the live cow, or the top round sirloin cut?</b></p><p>(A particularly relevant metaphor given the way the MUI (EHM-YOU-EYE) team calls themselves the MUI (MOO-EEY) team -- cows mooing seems within their expected results!)<br></p><p>Of course there is no best answer here either, except based on the situation. </p><p>Perhaps you lack the facilities to slaughter the cow. Or perhaps you preferred the ribeye. Maybe you are a vegetarian and need to make alternate plans for dinner.</p><p>But asking which one is "preferred" under those circumstances makes no sense....<br></p>
<hr/><p><strong>Mihai</strong> on 9 Jul 2009 1:21 PM:</p><div style="margin-left: 1em"><p>In fact the best use of GetFileMUIPath is for non-resources.</p>
<p>The Windows loader will take care of the resource part, but applications should use GetFileMUIPath for other localizable elements.</p>
<p>(ie help, samples, clipart, templates, read-me, license, ...)</p></div>
<p><strong>Mihai</strong> on 9 Jul 2009 1:24 PM:</p><div style="margin-left: 1em"><p>I initially thought that the connection with the cow is that the answer to the question is &quot;Mu&quot;</p>
<p>(<a rel="nofollow" target="_new" href="http://en.wikipedia.org/wiki/Mu_(negative)">http://en.wikipedia.org/wiki/Mu_%28negative%29</a>)</p></div>
<hr/><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2009/07/08/9823397.html" title="Suddenly the chair looks smarter and I am the one with the control issues">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2009/07/02/9813365.html" title="Confessions of an iBot riding fool....">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2009-07">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2009-07-07">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2009/07/07/9822548.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:35 GMT -->
</html>