<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2009/06/08/9707348.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:35 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>Text can sometimes just look wrong when it seems like it shouldn't. Why?</title></head><body>
<h1>Text can sometimes just look wrong when it seems like it shouldn't. Why?</h1>
<p><em>by Michael S. Kaplan, published on 2009/06/08 10:01 -04:00, original URI: http://blogs.msdn.com/b/michkap/archive/2009/06/08/9707348.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<p>The other day, Wayne Shu asked:</p>
<blockquote>
<p><font face="times new roman,times">Hello Michael:<br><br>&nbsp;&nbsp; I have visited your blog, and know that you are an expert in Windows Uniscribe, here I have some questions about Uniscribe to ask you.<br><br>&nbsp;&nbsp; now I am using Uniscribe to do a program to generate glyphs from a arbitrary unicode string.<br><br>&nbsp;&nbsp; I use ScriptItemize, ScriptShape, ScriptPlace functions, but it does not work correctly for some font,<br>&nbsp;&nbsp; for example the font "Arial Unicode MS",&nbsp; the unicode string is "<font face="arial unicode ms">ཀྲུང་ཧྭ་མི་དམངས་སྤྱི་མཐུན་རྒྱལ་ཁབ།</font>" (Tibetan&nbsp; version of "People's Republic of China")<br><br>&nbsp;&nbsp; ScriptShape always return USP_E_SCRIPT_NOT_IN_FONT for this string,<br>&nbsp;&nbsp; but I have checked "Arial Unicode MS" using Character Map, "Arial Unicode MS" do support Tibetan characters.<br><br>&nbsp;&nbsp; why ScriptShape return USP_E_SCRIPT_NOT_IN_FONT here?<br><br>&nbsp; another question about function ExtTextOut.<br>&nbsp; for the same font "Arial Unicode MS",&nbsp; and string "<font face="arial unicode ms">ཀྲུང་ཧྭ་མི་དམངས་སྤྱི་མཐུན་རྒྱལ་ཁབ།</font>", I have tried to use ExtTextOut to display it directly, ExtTextOut can display it correctly.<br><br>&nbsp; even for some characters that "Arial Unicode MS" does not support, for example sinhala characters, ExtTextOut still can display these character correctly,<br><br>&nbsp; why?&nbsp; as I know ExtTextOut has indirectly invoke Uniscribe for displaying texts. but they behave so differently, does ExtTextOut do some font back internally?<br><br>Thanks and forgive my poor english.<br><br>--<br>Best Regards.<br>Wayne Shu</font> <br></p>
</blockquote>
<p>Now when you stack his English up against my typos, I think he does pretty well, but that's just my opinion. :-)</p><p>Anyway, it would be easy to dismiss the whole question with a quick reference to a previous blog of mine like <b><a href="http://archives.miloush.net/michkap/archive/2007/07/15/3890144.html" mce_href="http://archives.miloush.net/michkap/archive/2007/07/15/3890144.html">Arial Unicode MS effectively [bites|sucks|blows]</a></b>.</p><p>But in the case of Tibetan is by its nature more complicated, taking the relatively minor issue of a few characters in Bengali and taking it to an extreme.</p><p>It is best to think of what Uniscribe does as a careful dance between the data inside the font and its own knowledge of Unicode generally and certain scripts within it specifically. This is not always true but generally is often quite true for anything requiring complex script processing (how true will vary with the script and is described within the documentation provided by Microsoft for that script).</p><p>In the case of Tibetan, the need for a font with the correct supporting data is crucial.</p><p>To some this may seem unfair -- this is not just different parts of Microsoft talking to itself; this the <b>same</b> parts of Microsoft (the Typography team) talking to itself! But in truth this is not the case, since (and this is a gross over-simplification that I might get into more specifically another day) a lot of the font "data" is the look of specific combinations that really amounts to the equivalent of substituting two or more separate Unicode code points with a particular grapheme that shapes better with surrounding text and often looks little like the original code points would by themselves. How could Uniscribe alone contain such data without knowledge of what is within the font? The split between shaping engine and font in such cases does make a lot of sense. </p><p>And in this particular case (Arial Unicode MS and Tibetan) the answer is easy: the data does not exist in the font at all! It has the individual graphemes but a lot opf the rest of the data simply ain't there.<br></p><p>Thus if you pick a font like <b>Arial Unicode MS</b> to do such work, you are never going to get the best result....</p><p>For the other question, when one calls ExtTextOutW one gets some of the higher level Uniscribe functionality like font substitution on a per script basis (something the lower level functiins will never do), and as a benefit they will generally pick better fonts than Arial Unicode MS, so one will tend to see better results when the support is there.<br></p><p>&nbsp;</p><p><font color="#ff00ff"><i>This post brought to you by</i><font size="7"> ུ </font><i>(U+0f74, aka TIBETAN VOWEL SIGN U)</i></font><br></p>
<hr/><p><strong>Wayne Shu</strong> on 9 Jun 2009 10:29 AM:</p><div style="margin-left: 1em"><p>Thank you, Michael, you have made a wonderful explanation about my questions. thanks!</p></div>
<hr/><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2009/06/09/9712595.html" title="When keeping things on a level Plane[ 1] doesn&#39;t work anymore">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2009/06/04/9698367.html" title="Almost winning an award can be pretty damn stressful!">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2009-06">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2009-06-08">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2009/06/08/9707348.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:35 GMT -->
</html>