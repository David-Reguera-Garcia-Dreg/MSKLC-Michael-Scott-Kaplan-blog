<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2006/08/18/706063.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:39 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>Creation of transliterating input methods</title></head><body>
<h1>Creation of transliterating input methods</h1>
<p><em>by Michael S. Kaplan, published on 2006/08/18 11:11 -04:00, original URI: http://blogs.msdn.com/b/michkap/archive/2006/08/18/706063.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<FONT face=Tahoma>
<P>Not too long ago, Thakara asked in the Suggestion Box: </P>
<BLOCKQUOTE dir=ltr style="MARGIN-RIGHT: 0px">
<P><FONT face="Times New Roman" size=2>Hi, <BR><BR>I’m working on a Transliterating Input Method for the Sinhala language. One that would allow Sinhala to be entered phonetically. I.e., you would enter ‘ka’ to get KAYANNA (“\u0D9A”), ‘kaa’ to get (“\u0D9A\u0DCF”), ‘kae’ to get (“\u0D9A\u0DD0”) and ‘k’ to get (“\u0D9A\u0DCA”), and so on. And it should work with any (or at least most) existing applications. <BR><BR>The need for this is that the existing layout for Sinhala (Wijesekara) is very hard to use with a non-Sinhala keyboard. I.e., it would require an actual Sinhala keyboard with Sinhala letters printed on the keys. It is very hard to enter Sinhala with, say, a US keyboard. For the relative lack of Sinhala keyboards on the market and to avoid the hassle of having to buy a Sinhala keyboard just to type a few sentences in Sinhala, it is useful to have such a phonetic mechanism. Since this is how we type Sinhala informally (e.g. while chatting), most Sri Lankans are used to such ‘phonetic’ typing. <BR><BR>After some poking around I came to the conclusion that IMM is old hat and the new way is to use the Text Services Framework (TSF) to build input methods. Then, I started looking for a .NET binding for TSF (since it’ll be much easier) but found there was none. Therefore, I started with VC++ 8 (with CLR support) to build my input method, hoping to use .NET facilities for common tasks such as reading/writing XML configs files and the composition window and some GUI elements. <BR><BR>However, working with TSF, I came across many problems. First of all, there seems to be very little documentation about TSF, even on the Internet. The TSF reference cannot even be reached from the Visual Studio 2005 MSDN index. The API seems to be so complex, so obfuscated that it led me to suspect that TSF is a phased-out API. <BR><BR>TSF and .NET does not seem to mix properly as well. I got access violations while trying to load a mixed-code input method DLL in some applications (Notepad.exe) while working fine in others. <BR><BR>The questions I have are these: <BR>*) Is it possible to build a transliterating input method (as I plan to do) with TSF? <BR>*) Is TSF “alive”? Has it been phased-out/deprecated in favor of something else? <BR>*) Is mixing .NET with TSF bad? Do I have to work in pure C++ (*pain!) <BR><BR>I would be very glad if you could shed some light on these questions, so that I can be sure I’m not on a wild goose chase with TSF. <BR><BR>Thanks! <BR><BR>Tharaka </FONT></P></BLOCKQUOTE>
<P>The Text Services Framework is definitely alive and well -- in fact, in Vista virtually all of the Input Mehod Editors (IMEs) have been converted to use it, and the input methods for Yi and Amharic both use it as well. </P>
<P>Unfortunately, I do not know of any specific way to allow for a managed (.NET) TSF Text Input Processor. I will inquire further but I suspect that this is not possible given how it has to be integrated into essentially any thread using it for input, whether managed or not.</P>
<P>But the good news is that such a transliterating input method is quite possible with the Text Services Framework. And companies like <A href="http://www.murasu.com/">Murasu</A> have actually created such input methods for Tamil and other languages already, when simple keyboards are simply inadequate. This is the model for the input methods used for Amharic in Vista, for example.</P>
<P>It is even quite easy in Vista using the same techniques I used to create the <A href="http://archives.miloush.net/michkap/archive/2006/07/27/679538.html"><STRONG>Cantonese</STRONG></A> and <A href="http://archives.miloush.net/michkap/archive/2006/07/20/671835.html"><STRONG>Unicode</STRONG></A> IME samples I have been working on. If you wanted to send me the table containing all of the equivalances you are using, i.e.</P>
<BLOCKQUOTE dir=ltr style="MARGIN-RIGHT: 0px">
<P><FONT face="Consolas,Courier New">"ka" = "\u0D9A"<BR>"kaa" = "\u0D9A\u0DCF"<BR>"kae" = "\u0D9A\u0DD0"<BR>"k" = "\u0D9A\u0DCA"</FONT></P></BLOCKQUOTE>
<P>and so on, I'll see if I can add another sample to the list....</P>
<P>This method does not currently work in versions of Windows prior to Vista, although to be honest the font and shaping support for Sinhala is also not widely available (other than the earlier version that was released as described <A href="http://archives.miloush.net/michkap/archive/2005/02/02/365993.html"><STRONG>here</STRONG></A>, and significant enhancements to the font and shaping engine have happened since then).</P>
<P>Some form of an input method&nbsp;like this, if it gains wider acceptance in the community and by language experts, could eventually find itself considered for inclusion in a future version of Windows!</P>
<P>So Thakara, if you can just send me your email contact info via that <A href="http://archives.miloush.net/michkap/archive/2004/11/01/280092.html">Contacting Michael...</A> link, we can&nbsp;talk further about how to get the info transferred and get the sample put together!</P>
<P>&nbsp;</P>
<P><FONT color=#ff1493><EM>This post brought to you by</EM> <FONT face="Iskoola Pota" size=8>ඐ</FONT> <EM>(<A href="http://www.fileformat.info/info/unicode/char/0d90">U+0d90</A>, a.k.a. SINHALA LETTER ILUUYANNA)</EM></FONT></P></FONT>
<hr/><p><a id="706555" href="#706555">#</a> <strong>Marc Durdin</strong> on 18 Aug 2006 5:03 PM:</p><div style="margin-left: 1em">You could also look at Tavultesoft Keyman which allows fully contextual input and supports Text Services Framework, as well as standard Unicode controls and has a full development kit - www.tavultesoft.com<br><br>There are a number of transliterating keyboards available for Keyman already.</div>
<p><a id="715094" href="#715094">#</a> <strong>NyaRuRu (MSMVP for Windows - DirectX)</strong> on 23 Aug 2006 2:41 PM:</p><div style="margin-left: 1em">I developed a pure .NET Text Input Service for Japanese language 4 years ago. It's very exciting experience for me.<br><br>But there is a problem that managed Text Service DLLs should be introduced to the target process, which may host another version of CLR.<br>Because current CLR can not run as side-by-side in the same process, the process will be crash.<br><br>I wish we could develop useful Text Services by .NET language without such a limitation.</div>
<p><a id="715336" href="#715336">#</a> <strong>Michael S. Kaplan</strong> on 23 Aug 2006 4:52 PM:</p><div style="margin-left: 1em">It should not actually crash, though. You do have to make sure you can load in any version of the BCL and not use methods that are only in newer versions, but you should be able to load in any process here?</div>
<p><a id="715673" href="#715673">#</a> <strong>NyaRuRu (MSMVP for Windows - DirectX)</strong> on 23 Aug 2006 8:14 PM:</p><div style="margin-left: 1em">Thanks to Michael,<br>Yes, I agree with you that we can run a (pure .NET) DLL under the different version of CLR, but I think it is not so easy and safe enough.<br><br>I found a similar thread :<br><a rel="nofollow" target="_new" href="http://www.hightechtalks.com/dotnet-framework-interop/net-2-0-mscoree-dll-209205.html">http://www.hightechtalks.com/dotnet-framework-interop/net-2-0-mscoree-dll-209205.html</a></div>
<p><a id="715993" href="#715993">#</a> <strong>Michael S. Kaplan</strong> on 23 Aug 2006 10:31 PM:</p><div style="margin-left: 1em">Well, that issue is explained in the thread:<br><br>&quot;If the third part application is a native COM client, the latest installed<br>version of the CLR and the framework will be loaded, this is by design.<br>This is done to guarantee that v2 add-in's as well as older version add-in's<br>can load and run in the same process.&quot;<br><br>But as long as your code will run in the latest version, it should be okay....</div>
<p><a id="716198" href="#716198">#</a> <strong>NyaRuRu (MSMVP for Windows - DirectX)</strong> on 24 Aug 2006 1:08 AM:</p><div style="margin-left: 1em">Thanks.<br><br>Anyway, I cannot use generics, C# 2.0 iterators and anonymous delegates to make my text service if I want to use the managed text service in Visual Stuio .NET 2003 into which .NET 1.1 CLR &nbsp;has been loaded.<br><br>Fortunately, my text service was written in C# 1.0, so it will be work fine both Visual Stuio .NET 2003 and Visual Stuio 2005.<br></div>
<hr/><p><em>referenced by</em></p><div style="margin-left: 1em"><p>2008/07/25 <a href="http://archives.miloush.net/michkap/archive/2008/07/25/8771255.html">Behold the Table Driven Text Service, Part 13 (Sinhalification proclamation!)</a></p><p>2008/06/21 <a href="http://archives.miloush.net/michkap/archive/2008/06/21/8632391.html">Back to Sri Lanka (conceptually)</a></p><p>2008/01/21 <a href="http://archives.miloush.net/michkap/archive/2008/01/21/7178421.html">Behold the Table Driven Text Service, Part 0 (You have to start somewhere!)</a></p><p>2006/09/17 <a href="http://archives.miloush.net/michkap/archive/2006/09/17/759687.html">And we are the knights who say நீ (NII)</a></p><p>2006/08/26 <a href="http://archives.miloush.net/michkap/archive/2006/08/26/725670.html">I must admit that an example would be nice</a></p></div><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2006/08/18/706383.html" title="Sometimes, uppercasing sucks">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2006/08/17/704559.html" title="You don&#39;t order Tatar sauce for your Filet-o-Fish!">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2006-08">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2006-08-18">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2006/08/18/706063.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:39 GMT -->
</html>