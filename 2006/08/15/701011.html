<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2006/08/15/701011.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:39 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>Customizing date formats in ASP.Net</title></head><body>
<h1>Customizing date formats in ASP.Net</h1>
<p><em>by Michael S. Kaplan, published on 2006/08/15 07:40 -04:00, original URI: http://blogs.msdn.com/b/michkap/archive/2006/08/15/701011.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<FONT face=Tahoma>
<P>I have known <A href="http://aspadvice.com/blogs/plitwin/">Paul Litwin</A> for a while, now that I think about it. He and I have spoken at the same conferences, been involved with the same book projects, and so on a bunch of times in the past, and there was even a period back during the Access 95 beta of a week or so that we both "figured out" Jet replication together despite not having met at that point, by a semi-continuous stream of phone calls and emails (he was writing the replication chapter for the Access 95 Developer's Handbook, I was just really interested in Jet replication and had no life; we were both a very motivated pair of geeks!). </P>
<P>Anyway, Paul sent me the following question in mail the other day: </P>
<BLOCKQUOTE dir=ltr style="MARGIN-RIGHT: 0px">
<P><FONT face="Times New Roman" size=2>Hey there. I have a question about dates and globalization.<BR><BR>I have an asp.net 1.1 app that is used in the USA only. However, they want dates to be handled as dd-MMM-yy. Do you know of an easy way to alter the treatment of dates both in textboxes and in the display of them in datagrids, etc? <BR><BR>Thanks,</FONT></P></BLOCKQUOTE>
<P>It's actually an interesting question, one that does not have a single, easy answer. Some time ago the decision was made that ASP.Net wouldn't generally want to be depending on Regional and Language Options on a random hosting server, plus the performance of a useUserOverride==false <A href="http://msdn2.microsoft.com/en-us/library/26xkefd5.aspx">CultureInfo</A> object&nbsp;is always going to be better than one that has to be checking what the user overrides might be. </P>
<P>The upside of all this&nbsp;is that in .NET 1.0 and 1.1 there is no easy way to set a particular override and make it stick everywhere, since there is always going to be a new thread that creates a new CultureInfo, and there was no way to get a <A href="http://msdn2.microsoft.com/en-us/library/system.globalization.datetimeformatinfo.shortdatepattern.aspx">DateTimeFormatInfo.ShortDatePattern</A> with that overridden date format of dd-MMM-yy to be automatically in the CultureInfo of every new thread....</P>
<P>The easiest thing to do here while staying in the System.Globalization namespace is to create a <A href="http://msdn2.microsoft.com/en-us/library/c6dw49cz.aspx">DateTimeFormatInfo</A>, set it's ShortDatePattern appropriately, and then use it as an <A href="http://msdn2.microsoft.com/en-us/library/system.iformatprovider.aspx">IFormatProvider</A> in each date formatting operation, while the easiest thing to do overall is to simply hardcode the date format in all of the various places -- basically to not be using the current culture mechanism to be setting up the formatting at all. Though either way is certainly a bit of extra work that keeps one from being able to use a lot of the built-in support.</P>
<P>This is a situation that gets much easier with .NET 2.0, using a <A href="http://msdn2.microsoft.com/en-us/library/system.globalization.cultureandregioninfobuilder.aspx">CultureAndRegionInfoBuilder</A>&nbsp;or the Locale Builder&nbsp;to create a supplemental custom culture with&nbsp;the&nbsp;specific&nbsp;ShortDatePattern. Just getting that custom culture on the server and setting its name as the culture for the application is all you have to do -- you let ASP.Net do all of the setting of the culture automatically for you....</P>
<P>One bit of trivia -- the original design of custom cultures (once replacement cultures were added) did not allow you to actually use replacement cultures when useUserOverride was set to false since it seemed like custom cultures were the ultimate form of overrides, but this design principle was abandoned when it was discovered that ASP.Net was never setting this attribute to <STRONG>true</STRONG> (for the reasons mentioned earlier). We simply&nbsp;didn't want to make the new feature less available to ASP.Net.</P>
<P>Even more trivia -- in the original design, for performance reasons, we made the decision to always look first to built-in cultures when useUserOverride was <STRONG>false</STRONG> and first to custom cultures when it was <STRONG>true</STRONG>. Although truth be told this pattern was also abandoned before .NET 2.0 was released as we decided the creation semantic was just a bit too complicated for people to easily discern how things were being created and why. It was just too good of an example of why it is better to be smart than clever....</P>
<P>&nbsp;</P>
<P><FONT color=#ff1493><EM>This post brought to you by</EM> <STRONG><FONT size=6>d</FONT></STRONG> <EM>(<A href="http://www.fileformat.info/info/unicode/char/0064">U+0064</A>, a.k.a. LATIN SMALL LETTER D)</EM></FONT></P></FONT>
<hr/><p><a id="702405" href="#702405">#</a> <strong>Paul van Brenk</strong> on 16 Aug 2006 8:03 AM:</p><div style="margin-left: 1em">Great post, I wrote some samples to show the different options.</div>
<hr/><p><em>referenced by</em></p><div style="margin-left: 1em"><p>2006/09/06 <a href="http://archives.miloush.net/michkap/archive/2006/09/06/742073.html">IsSortable() == false? Well, sometimes it may be lying....</a></p></div><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2006/08/16/702104.html" title="Something .NET does more intuitively than Windows">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2006/08/15/700676.html" title="Did software developers ever learn their ABC&#39;s?">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2006-08">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2006-08-15">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2006/08/15/701011.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:39 GMT -->
</html>