<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2006/01/15/512992.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:40 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>Installable language components in Internet Explorer</title></head><body>
<h1>Installable language components in Internet Explorer</h1>
<p><em>by Michael S. Kaplan, published on 2006/01/15 20:01 -05:00, original URI: http://blogs.msdn.com/b/michkap/archive/2006/01/15/512992.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<P><FONT face=Tahoma>The other day, someone with the handle of <STRONG>ox</STRONG> asked in the microsoft.public.win32.programmer.international newsgroup:</FONT></P>
<BLOCKQUOTE dir=ltr style="MARGIN-RIGHT: 0px">
<BLOCKQUOTE dir=ltr style="MARGIN-RIGHT: 0px">
<P><FONT size=2><EM>how to check in my code if a kind of language pack installed. For<BR>example, on english version winxp, while you access a Chinese website,<BR>system will prompt you to install Asian language pack. How did. Thanks.</EM></FONT></P></BLOCKQUOTE></BLOCKQUOTE>
<P><FONT face=Tahoma>The answer (which I had written up as a part of <A href="http://msdn.microsoft.com/msdnmag/issues/0700/localize/">an MSDN Magazine article</A> from a few years back) is to use the Component&nbsp;capability methods that were added back in IE 5.0. The important methods to get the job done are:</FONT></P>
<UL>
<LI><FONT face=Tahoma><A href="http://msdn.microsoft.com/workshop/author/behaviors/reference/methods/iscomponentinstalled.asp">isComponentInstalled</A></FONT> 
<LI><FONT face=Tahoma><A href="http://msdn.microsoft.com/workshop/author/behaviors/reference/methods/addcomponentrequest.asp">addComponentRequest</A></FONT> 
<LI><FONT face=Tahoma><A href="http://msdn.microsoft.com/workshop/author/behaviors/reference/methods/docomponentrequest.asp">doComponentRequest</A></FONT></LI></UL>
<P><FONT face=Tahoma>and the GUIDs for the various language packs and other components can be found in the <A href="http://msdn.microsoft.com/workshop/author/behaviors/reference/methods/detectable.asp">Detectable Components in Internet Explorer</A> and <A href="http://msdn.microsoft.com/workshop/author/behaviors/reference/methods/installable.asp">Installable Components in Internet Explorer</A> topics. The Language Pack and related GUIDS are:</FONT></P>
<P><FONT face=Tahoma><FONT face="Courier New">
<BLOCKQUOTE dir=ltr style="MARGIN-RIGHT: 0px">
<TABLE class=clsListOfStuff border=1>
<TBODY>
<TR>
<TH>Component</TH>
<TH>Component ID</TH></TR>
<TR>
<TD><FONT face=Tahoma size=2>Arabic Text Display Support</FONT></TD>
<TD><FONT size=2>{76C19B38-F0C8-11CF-87CC-0020AFEECF20}</FONT></TD></TR>
<TR>
<TD><FONT face=Tahoma size=2>Chinese (Simplified) Text Display Support</FONT></TD>
<TD><FONT size=2>{76C19B34-F0C8-11CF-87CC-0020AFEECF20}</FONT></TD></TR>
<TR>
<TD><FONT face=Tahoma size=2>Chinese (traditional) Text Display Support</FONT></TD>
<TD><FONT size=2>{76C19B33-F0C8-11CF-87CC-0020AFEECF20}</FONT></TD></TR>
<TR>
<TD><FONT face=Tahoma size=2>Hebrew Text Display Support</FONT></TD>
<TD><FONT size=2>{76C19B36-F0C8-11CF-87CC-0020AFEECF20}</FONT></TD></TR>
<TR>
<TD><FONT face=Tahoma size=2>Japanese Text Display Support</FONT></TD>
<TD><FONT size=2>{76C19B30-F0C8-11CF-87CC-0020AFEECF20}</FONT></TD></TR>
<TR>
<TD><FONT face=Tahoma size=2>Korean Text Display Support</FONT></TD>
<TD><FONT size=2>{76C19B31-F0C8-11CF-87CC-0020AFEECF20}</FONT></TD></TR>
<TR>
<TD><FONT face=Tahoma size=2>Pan-European Text Display Support</FONT></TD>
<TD><FONT size=2>{76C19B32-F0C8-11CF-87CC-0020AFEECF20}</FONT></TD></TR>
<TR>
<TD><FONT face=Tahoma size=2>Thai Text Display Support</FONT></TD>
<TD><FONT size=2>{76C19B35-F0C8-11CF-87CC-0020AFEECF20}</FONT></TD></TR>
<TR>
<TD><FONT face=Tahoma size=2>Vietnamese Text Display Support</FONT></TD>
<TD><FONT size=2>{76C19B37-F0C8-11CF-87CC-0020AFEECF20}</FONT></TD></TR>
<TR>
<TD><FONT face=Tahoma size=2>Language Auto-Selection</FONT></TD>
<TD><FONT size=2>{76C19B50-F0C8-11CF-87CC-0020AFEECF20}</FONT></TD></TR>
<TR>
<TD><FONT face=Tahoma size=2>Uniscribe</FONT></TD>
<TD><FONT size=2>{3BF42070-B3B1-11D1-B5C5-0000F8051515}</FONT></TD></TR></TBODY></TABLE></FONT></FONT>
<P></P></BLOCKQUOTE>
<P><FONT face=Tahoma>I even wrote up a nice "how to really annoy readers of your website" page that would try to install of the language components even though it used none of them. I am providing the HTML for this page below (to use it just copy it, paste it into Notepad, and then open it in IE). For obvious reasons I did not include this code behind any pages on this blog. :-)</FONT></P>
<P><FONT face=Tahoma>The technology has largely been passed over at this point, but getting people running earlier versions to get language support was once a very compelling technology.</FONT></P>
<P><FONT face=Tahoma>Enjoy!</FONT></P>
<P><FONT face=Tahoma></FONT>&nbsp;</P>
<P><FONT face=Tahoma color=#ff1493><EM>This post brought to you by</EM> "<FONT size=6>‡∑ù</FONT>" <EM>(<A href="http://www.fileformat.info/info/unicode/char/0ddd">U+0ddd</A>, a.k.a. SINHALA VOWEL SIGN KOMBUVA HAA DIGA AELA-PILLA)<BR><FONT size=1>(A letter that does not have its own language pack for IE)</FONT></EM></FONT></P>
<HR>

<BLOCKQUOTE dir=ltr style="MARGIN-RIGHT: 0px">
<P><FONT face="Courier New" size=2>&lt;HTML xmlns:IE&gt;<BR>&lt;HEAD&gt;<BR></FONT><FONT face="Courier New" size=2>&lt;STYLE&gt;<BR>@media all { IE\:clientCaps {behavior:url(#default#clientCaps)}}<BR>&lt;/STYLE&gt;</FONT></P>
<P><FONT face="Courier New" size=2>&lt;SCRIPT&gt;<BR>function window.onload()<BR>{<BR>&nbsp; &nbsp;var fAra,fChs,fCht,fHeb,fJpn,fKor,fEur,fTha,fVie,fUni;<BR>&nbsp;&nbsp; var fInstallWorked=false;<BR>&nbsp;&nbsp; var sAraID= "{76C19B38-F0C8-11CF-87CC-0020AFEECF20}";<BR>&nbsp;&nbsp; var sChsID= "{76C19B34-F0C8-11CF-87CC-0020AFEECF20}";<BR>&nbsp;&nbsp; var sChtID= "{76C19B33-F0C8-11CF-87CC-0020AFEECF20}";<BR>&nbsp;&nbsp; var sHebID= "{76C19B36-F0C8-11CF-87CC-0020AFEECF20}";<BR>&nbsp;&nbsp; var sJpnID= "{76C19B30-F0C8-11CF-87CC-0020AFEECF20}";<BR>&nbsp;&nbsp; var sKorID= "{76C19B31-F0C8-11CF-87CC-0020AFEECF20}";<BR>&nbsp;&nbsp; var sEurID= "{76C19B32-F0C8-11CF-87CC-0020AFEECF20}";<BR>&nbsp;&nbsp; var sThaID= "{76C19B35-F0C8-11CF-87CC-0020AFEECF20}";<BR>&nbsp;&nbsp; var sVieID= "{76C19B37-F0C8-11CF-87CC-0020AFEECF20}";<BR>&nbsp;&nbsp; var sUniID= "{3BF42070-B3B1-11D1-B5C5-0000F8051515}";&nbsp;<BR></FONT></P>
<P><FONT face="Courier New" size=2>&nbsp;&nbsp; // find out if a language is not installed<BR>&nbsp;&nbsp; fAra= (!(oClientCaps.isComponentInstalled(sAraID,"componentid")))<BR>&nbsp;&nbsp; fChs= (!(oClientCaps.isComponentInstalled(sChsID,"componentid")))<BR>&nbsp;&nbsp; fCht= (!(oClientCaps.isComponentInstalled(sChtID,"componentid")))<BR>&nbsp;&nbsp; fHeb= (!(oClientCaps.isComponentInstalled(sHebID,"componentid")))<BR>&nbsp;&nbsp; fJpn= (!(oClientCaps.isComponentInstalled(sJpnID,"componentid")))<BR>&nbsp;&nbsp; fKor= (!(oClientCaps.isComponentInstalled(sKorID,"componentid")))<BR>&nbsp;&nbsp; fEur= (!(oClientCaps.isComponentInstalled(sEurID,"componentid")))<BR>&nbsp;&nbsp; fTha= (!(oClientCaps.isComponentInstalled(sThaID,"componentid")))<BR>&nbsp;&nbsp; fVie= (!(oClientCaps.isComponentInstalled(sVieID,"componentid")))<BR>&nbsp;&nbsp; fUni= (!(oClientCaps.isComponentInstalled(sUniID,"componentid")))</FONT></P>
<P><FONT face="Courier New" size=2>&nbsp;&nbsp; // if support for any language is unavailable, mark it to be installed<BR>&nbsp;&nbsp; if (fAra) oClientCaps.addComponentRequest(sAraID, "componentid");<BR>&nbsp;&nbsp; if (fChs) oClientCaps.addComponentRequest(sChsID, "componentid");<BR>&nbsp;&nbsp; if (fCht) oClientCaps.addComponentRequest(sChtID, "componentid");<BR>&nbsp;&nbsp; if (fHeb) oClientCaps.addComponentRequest(sHebID, "componentid");<BR>&nbsp;&nbsp; if (fJpn) oClientCaps.addComponentRequest(sJpnID, "componentid");<BR>&nbsp;&nbsp; if (fKor) oClientCaps.addComponentRequest(sKorID, "componentid");<BR>&nbsp;&nbsp; if (fEur) oClientCaps.addComponentRequest(sEurID, "componentid");<BR>&nbsp;&nbsp; if (fTha) oClientCaps.addComponentRequest(sThaID, "componentid");<BR>&nbsp;&nbsp; if (fVie) oClientCaps.addComponentRequest(sVieID, "componentid");<BR>&nbsp;&nbsp; if (fUni) oClientCaps.addComponentRequest(sUniID, "componentid");<BR>&nbsp;&nbsp; <BR>&nbsp;&nbsp; // Do requests, if any were actually made<BR>&nbsp;&nbsp; if (fAra|fChs|fCht|fHeb|fJpn|fKor|fEur|fTha|fVie|fUni)<BR>&nbsp;&nbsp; {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; document.write('Must install some languages!');<BR>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;fInstallWorked=oClientCaps.doComponentRequest();<BR>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;document.write('The return from the doComponentRequest call was: ' + fInstallWorked); <BR>&nbsp; &nbsp;}<BR>&nbsp; &nbsp;else<BR>&nbsp; &nbsp;{<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; document.write('All languages are installed!');<BR>&nbsp; &nbsp;}<BR>}<BR>&lt;/SCRIPT&gt;<BR>&lt;Title&gt;The ANNOYING 'install every language on IE' page!&lt;/Title&gt;<BR>&lt;/HEAD&gt;</FONT></P>
<P><FONT face="Courier New" size=2>&lt;BODY BGCOLOR="#FFFFFF"&gt;<BR>&nbsp;&nbsp; :<BR>&nbsp;&nbsp; &lt;IE:clientCaps ID="oClientCaps" /&gt;<BR>&nbsp;&nbsp; :<BR>&lt;/BODY&gt;</FONT></P></BLOCKQUOTE>
<HR>
<hr/><p><a id="513386" href="#513386">#</a> <strong>Maurits [MSFT]</strong> on 16 Jan 2006 12:55 PM:</p><div style="margin-left: 1em">I can't get that code to work, as is.<br><br>I suspect that the<br>if (!fTha)<br>lines should be<br>if (fTha) // fTha means Tha is NOT installed<br><br>But either way, the doComponentRequest never returns.<br><br>I'm on Windows 2000 - I may have checked the &quot;never install language packs&quot; option out of annoyance in foreign email prompting me...<br><br>How can I un-&quot;never install&quot;?  I tried checking the &quot;Enable Install on Demand&quot; checkboxes but they had no effect.</div>
<p><a id="513420" href="#513420">#</a> <strong>Michael S. Kaplan</strong> on 16 Jan 2006 2:17 PM:</p><div style="margin-left: 1em">Whoops -- some double negatives in there! Fixed now....<br><br>Of course you would have to make sure that you did not have the appropriate language support installed....</div>
<p><a id="513490" href="#513490">#</a> <strong>Maurits [MSFT]</strong> on 16 Jan 2006 4:31 PM:</p><div style="margin-left: 1em">This line<br><br>if (fAra|fChs|fCht|fHeb|fJpn|fKor|fEur|fTha|fVie|fUni)<br><br>should be<br><br>if ((!fAra)||(!fChs)||(!fCht)||(!fHeb)||(!fJpn)||(!fKor)||(!fEur)||(!fTha)||(!fVie)||(!fUni))<br><br>But I'm still getting a &quot;permission denied&quot; error on the doComponentRequest(...) line.  I'm in the My Computer Zone... I'll try it on a different zone.</div>
<p><a id="513495" href="#513495">#</a> <strong>Maurits [MSFT]</strong> on 16 Jan 2006 4:37 PM:</p><div style="margin-left: 1em">Still errors (permission denied) on doComponentRequest<br><br>I did a search for how to undo the &quot;never install&quot; checkbox and came up with this thread:<br><br><a rel="nofollow" target="_new" href="http://www.annoyances.org/exec/forum/winxp/t1065439220">http://www.annoyances.org/exec/forum/winxp/t1065439220</a><br><br>It describes a method to fix it for XP but not for 2000 (bangs head against wall...)</div>
<p><a id="513512" href="#513512">#</a> <strong>Michael S. Kaplan</strong> on 16 Jan 2006 5:07 PM:</p><div style="margin-left: 1em">Permission denied kind of speaks for itself, I guess (the big question is whether the install works if you go to a site that needs the script support -- you should get the install happening then).<br><br>Ok, fixed the code to get rid of that last problem, to go with your initial fix idea.</div>
<p><a id="513515" href="#513515">#</a> <strong>Maurits [MSFT]</strong> on 16 Jan 2006 5:15 PM:</p><div style="margin-left: 1em">Well, I've given up on finding the way to undo that &quot;never install language packs&quot; checkbox in Windows 2000... but the Installable Components page<br><br><a rel="nofollow" target="_new" href="http://msdn.microsoft.com/workshop/author/behaviors/reference/methods/installable.asp">http://msdn.microsoft.com/workshop/author/behaviors/reference/methods/installable.asp</a><br><br>specifically says<br><br>&quot;Note: The following components do not install on demand in Microsoft Windows 2000.&quot;<br><br>so I guess it's by-design :'(</div>
<p><a id="513516" href="#513516">#</a> <strong>Michael S. Kaplan</strong> on 16 Jan 2006 5:17 PM:</p><div style="margin-left: 1em">Well, it will help get those pre-Win2000 machines up to date! :-)</div>
<p><a id="513524" href="#513524">#</a> <strong>Maurits [MSFT]</strong> on 16 Jan 2006 5:32 PM:</p><div style="margin-left: 1em">Just noticed this line in your custom CSS:<br>h2 { font-Variant:small-caps; }<br><br>Very nice, especially as a way to test how browsers handle small-cap variants of international characters :)</div>
<p><a id="513525" href="#513525">#</a> <strong>Michael S. Kaplan</strong> on 16 Jan 2006 5:38 PM:</p><div style="margin-left: 1em">Thanks Maurits!<br><br>I was especially sensitive about the issue raised for the title of *this* post:<br><br><a rel="nofollow" target="_new" href="http://archives.miloush.net/michkap/archive/2005/11/13/492179.html">http://blogs.msdn.com/michkap/492179.aspx</a><br><br>and I wanted to come up with some kind of override to the behavior. :-)</div>
<p><a id="513948" href="#513948">#</a> <strong>Jerry Pisk</strong> on 17 Jan 2006 3:31 PM:</p><div style="margin-left: 1em">Shouldn't GUIDs be random? Must have been a lot of luck getting those sequential ones generated ;)</div>
<p><a id="513959" href="#513959">#</a> <strong>Michael S. Kaplan</strong> on 17 Jan 2006 4:14 PM:</p><div style="margin-left: 1em">Hi Jerry --<br><br>Tools like guidgen generate the first one and then the rest are sequential.</div>
<p><a id="516174" href="#516174">#</a> <strong>Richard</strong> on 23 Jan 2006 7:23 AM:</p><div style="margin-left: 1em">GUID generation was always sequential, but revealed you NIC's MAC. So they were randomised in Win2k (also was the case if you had no NIC).<br><br>You can still get sequential ones, from a VS2005 command prompt:<br>  uuidgen /n20 /x<br>will give sequential ones (/x option).</div>
<p><strong>Wes</strong> on 15 Mar 2010 1:53 AM:</p><div style="margin-left: 1em"><P>thanks a million. the link to how to restore the language pack options helped me out. I have a native Korean customer that has learned to do the basic (click a box to see if it fixes it) surfing thru trial and error with an English xp pro install. he just needed to get the language packs and MUI's installed to fix a lot of his short-comings in the English version.</P>
<P>and now I have some new code to put on my home sever box to test these out :)</P>
<P>thanks again</P></div>
<hr/><p><em>referenced by</em></p><div style="margin-left: 1em"><p>2006/07/25 <a href="http://archives.miloush.net/michkap/archive/2006/07/25/677592.html">Is East Asian support installed?</a></p></div><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2006/01/16/513088.html" title="Just one code point for SGCAPS....">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2006/01/15/512928.html" title="Falling over the edge of a conceptual collation cliff">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2006-01">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2006-01-15">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2006/01/15/512992.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:40 GMT -->
</html>