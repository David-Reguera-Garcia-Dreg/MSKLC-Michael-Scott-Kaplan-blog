<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2006/01/06/509772.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:40 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>When not to use MLang</title></head><body>
<h1>When not to use MLang</h1>
<p><em>by Michael S. Kaplan, published on 2006/01/06 03:01 -05:00, original URI: http://blogs.msdn.com/b/michkap/archive/2006/01/06/509772.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<P><FONT face=Tahoma>Just yesterday, <a href="http://blogs.msdn.com/oldnewthing/">Raymond Chen</A> was talking about <a href="http://blogs.msdn.com/oldnewthing/509642.aspx">Converting between LCIDs and RFC 1766 language codes</A>. He was basically showing how to use MLang's&nbsp;<A href="http://msdn.microsoft.com/workshop/misc/mlang/reference/ifaces/imultilanguage/getrfc1766fromlcid.asp">GetRfc1766FromLcid</A> method&nbsp;to do the conversions between these two items.</FONT></P>
<P><FONT face=Tahoma>Under ordinary circumstances I would rather slide down a razor blade into a barrel of iodine than disagree with something that Raymond has posted, but in this&nbsp;case it might be better to either:</FONT></P>
<UL>
<LI><FONT face=Tahoma>Use the managed code properties off of <A href="http://msdn.microsoft.com/library/en-us/cpref/html/frlrfsystemglobalizationcultureinfoclasstopic.asp">CultureInfo</A> to get this information, or</FONT> 
<LI><FONT face=Tahoma>Use <A href="http://msdn.microsoft.com/library/en-us/intl/nls_34rz.asp">GetLocaleInfo</A> with the LOCALE_SISO639LANGNAME and LOCALE_SISO3166CTRYNAME <A href="http://msdn.microsoft.com/library/en-us/intl/nls_8rse.asp">LCType values</A>, or</FONT> 
<LI><FONT face=Tahoma>Use the <A href="http://msdn.microsoft.com/library/en-us/intl/nls_LocaleNameToLCID.asp">LocaleNameToLCID</A> function (new in Vista)</FONT></LI></UL>
<P><FONT face=Tahoma>The reason for this is that MLang itself, while entirely supported, is really not being actively developed right now. And any time there is a better option to go with, it should probably not be the first choice.</FONT></P>
<P><FONT face=Tahoma>Though it is sometimes the only good choice out there, for example in <a href="http://archives.miloush.net/michkap/archive/2005/05/16/417711.html">low-level font linking</A> and&nbsp;code page detection (sorry, no&nbsp;post yet -- I'll have to blog about that at some point!). And even going the opposite direction (from name to LCID&nbsp;in an unmanaged, non-Vista scenario where there are no other good options), MLang might be the way to go.</FONT></P>
<P><FONT face=Tahoma>But beyond that, it may be best to steer clear of MLang if you have a choice -- you will likely be a lot happier with the results....</FONT></P>
<P><FONT face=Tahoma></FONT>&nbsp;</P>
<P><FONT face=Tahoma><FONT color=#ff1493><EM>This post brought to you by</EM> "<FONT size=3>á¿´</FONT>" <EM>(</EM></FONT><EM><FONT color=#ff1493><A href="http://www.fileformat.info/info/unicode/char/1ff4">U+1ff4</A></FONT></EM><EM><FONT color=#ff1493>, a.k.a. GREEK SMALL LETTER OMEGA WITH OXIA AND YPOGEGRAMMENI)</FONT></EM></FONT></P>
<hr/><p><a id="510116" href="#510116">#</a> <strong>PatriotB</strong> on 6 Jan 2006 12:21 PM:</p><div style="margin-left: 1em">There've been lots of technologies that fall into the &quot;supported but not actively documented&quot; category, and in some cases its unfortunate.  Is MLang simply &quot;done&quot;--nothing more that needs to be done with it?  Or is it because most everything is now in the base platform?  Was MLang mostly to help with providing IE a common base for both NT and 9x platforms?</div>
<p><a id="510130" href="#510130">#</a> <strong>Michael S. Kaplan</strong> on 6 Jan 2006 12:51 PM:</p><div style="margin-left: 1em">MLang was indeed the IE answer to how to support things cross-Windows platform (not just 9x but also earlier NT), and prior to .NET was the only answer MS provided. But it falls short in many ways and is currently in maintenance mode in regard to the methods and interfaces (data may of course update, but that is a different story).</div>
<p><a id="510136" href="#510136">#</a> <strong>NikWeber</strong> on 6 Jan 2006 12:59 PM:</p><div style="margin-left: 1em">I use MLANG to do conversions from and to codepages. Our software needs to run under Win2000, XP and Win2k3. Unfortunately, when I query the name for the codepage 50220 under Win32 with GetCPInfoEx(), it does NOT return a name for it. To confuse matters more, I can go FROM 50220 to Unicode, but NOT from Unicode to 50220. I wonder if my OS had a failed language installation. All the languages are enabled in regional settings, the 5022x codepages do not appear in the advanced regional options.<br><br>I have checked the registry under:<br>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Nls\CodePage<br><br>and the proper values are there, as well as the needed c_is2022.dll<br><br>When I trace into MultibyteToWideChar the proper internal structure gets allocated, but the callback function for the Unicode-&gt;50220 is null.<br><br>So that is why I have to use the Mlang Interface (as COM). <br><br>Also in some prior posts you had said the Win32 tables are in some spots outdated.<br><br>So what should I do now?<br><br>Ps. And do not get me started on the fact that 50220 is a &quot;modal&quot; codepage. Pesky escaped switch sequences that used to crash my program. ARR</div>
<p><strong>pcunite</strong> on 29 Feb 2008 8:51 PM:</p><div style="margin-left: 1em"><P>&gt;&gt; When I trace into MultibyteToWideChar the<BR>&gt;&gt; proper internal structure gets allocated, but<BR>&gt;&gt; the callback function for the Unicode-&gt;50220<BR>&gt;&gt; is null.</P>
<P>This is how it should be. </P>
<P>1. MultibyteToWideChar is taking a smaller bit into a larger bit space. Works.</P>
<P>2. WideCharToMultibyte takes a large (16 bit) into a smaller (8 bit usually) encoding. 8 bit is only good for 255 chacters.</P>
<P>3. So what do you think is going to happen when you realize 50220 needs more than 8 bits? Yeah, ??? or worse charcters show up!</P>
<P>Just say no to WideCharToMultibyte()!</P></div>
<p><strong>Cain T. S. Random</strong> on 1 Apr 2008 9:09 AM:</p><div style="margin-left: 1em"><P>Nik: I'm having the exact same problem with codepage 50220. &nbsp;It's valid Unicode, but WideCharToMultiByte refuses to accept it. &nbsp;However, Mlang will. &nbsp;To deprecate the only working solution would be frustrating.</P></div>
<hr/><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2006/01/06/509784.html" title="If it&#39;s not in Unicode, don&#39;t expect it in Windows">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2006/01/05/509539.html" title="Keyboards over Terminal Server">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2006-01">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2006-01-06">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2006/01/06/509772.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:40 GMT -->
</html>