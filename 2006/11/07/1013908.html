<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2006/11/07/1013908.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:39 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>When it comes to duration, the little things can mean a lot</title></head><body>
<h1>When it comes to duration, the little things can mean a lot</h1>
<p><em>by Michael S. Kaplan, published on 2006/11/07 05:20 -05:00, original URI: http://blogs.msdn.com/b/michkap/archive/2006/11/07/1013908.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<P>At the recent MVP Webcast that I did, one of the viewers (I want to say it was Mike Dunn?) asked what the difference was between the (new in Vista) <A class="" href="http://windowssdk.msdn.microsoft.com/en-gb/library/ms776372(VS.80).aspx" mce_href="http://windowssdk.msdn.microsoft.com/en-gb/library/ms776372(VS.80).aspx ">GetDurationFormat</A> and StringFromTimeInterval.</P>
<P>At the time, my answer was easy -- I know what the former is since it is an NLS function that colleague Mike Dolenga wrote and which starts its life in the Vista release of Windows. And I have no idea what StringFromTimeInterval is!</P>
<P>Anyway, after spending a little time looking it up and realizing that he was actually referring to the shlwapi <A class="" href="http://windowssdk.msdn.microsoft.com/en-gb/library/ms538655.aspx" mce_href="http://windowssdk.msdn.microsoft.com/en-gb/library/ms538655.aspx">StrFromTimeInterval</A> function, and so I figured that now that I knew what we were talking about, I could answer intelligently. :-)</P>
<P>The&nbsp;major differences:</P>
<P><A class="" href="http://windowssdk.msdn.microsoft.com/en-gb/library/ms538655.aspx" mce_href="http://windowssdk.msdn.microsoft.com/en-gb/library/ms538655.aspx">StrFromTimeInterval</A>&nbsp;has no way to specify a locale, no way to specify format strings, takes its time in a DWORD that represents milliseconds, and is limited to hours/minutes/seconds with milliseconds being ignored.</P>
<P>On the other hand,&nbsp;<A class="" href="http://windowssdk.msdn.microsoft.com/en-gb/library/ms776372(VS.80).aspx" mce_href="http://windowssdk.msdn.microsoft.com/en-gb/library/ms776372(VS.80).aspx ">GetDurationFormat</A>&nbsp;(and its counterpart <A class="" href="http://windowssdk.msdn.microsoft.com/en-gb/library/ms776364.aspx" mce_href="http://windowssdk.msdn.microsoft.com/en-gb/library/ms776364.aspx">GetDurationFormatEx</A>&nbsp;that takes locale names rather than LCIDs)&nbsp;lets you specify the locale to use or use your own formatting string, can take either a <A class="" href="http://windowssdk.msdn.microsoft.com/en-gb/library/ms724950.aspx" mce_href="http://windowssdk.msdn.microsoft.com/en-gb/library/ms724950.aspx">SYSTEMTIME</A> struct or a 64 bit unsigned integer representing the number of 100 nanosecond intervals in the duration to specify, and can return days/hours/minutes/seconds/milliseconds/microseconds, as desired.</P>
<P>Both will return a formatted string, but the NLS function has a lot more functionality. :-)</P>
<P>Oh, also the Shell function supports an "A" version, which <A class="" href="http://archives.miloush.net/michkap/archive/2005/10/02/476213.html" mce_href="http://archives.miloush.net/michkap/archive/2005/10/02/476213.html"><STRONG>we don't do anymore</STRONG></A>.</P>
<P>And another interestingly weird difference is that <A class="" href="http://windowssdk.msdn.microsoft.com/en-gb/library/ms538655.aspx" mce_href="http://windowssdk.msdn.microsoft.com/en-gb/library/ms538655.aspx">StrFromTimeInterval</A>&nbsp;does load up its hours/minutes/seconds strings based on localized resources (presumably the current UI language, though the documentation did not specify details on this subject). Perhaps someone from the Shell side can explain how that part of it works....</P>
<P mce_keep="true">&nbsp;</P>
<P mce_keep="true"><FONT color=#ff00ff><EM>This post brought to you by</EM>&nbsp;<STRONG><FONT size=4>Âµ</FONT></STRONG> <EM>(<A class="" href="http://www.fileformat.info/info/unicode/char/00b5" mce_href="http://www.fileformat.info/info/unicode/char/00b5">U+00b5</A>, a.k.a. MICRO SIGN)</EM></FONT></P>
<hr/><p><strong>Sander</strong> on 7 Nov 2006 5:52 AM:</p><div style="margin-left: 1em"><p>The first link is broken (missing http://)</p></div>
<p><strong>Michael S. Kaplan</strong> on 7 Nov 2006 6:30 AM:</p><div style="margin-left: 1em"><p>Whoops, looks like they are fixed now (the other GetDurationFormat links were also broken). Thanks. :-)</p>
</div>
<p><strong>Mike Dunn</strong> on 7 Nov 2006 2:06 PM:</p><div style="margin-left: 1em"><p>I think you mentioned that GetDurationFormat was asked for by WMP, for use in their time displays. GetDurationFormat returns a string like &quot;42:37&quot; for 42 minutes and 37 seconds, just the formatting that a media player would need.</p>
<p>You can see StrFromTimeInterval in action in the IE download progress window, it would show &quot;42 min 37 sec&quot;.</p>
</div>
<p><strong>Michael S. Kaplan</strong> on 7 Nov 2006 2:11 PM:</p><div style="margin-left: 1em"><p>Ah, but you can use GetDurationFormat to get that same format by providing your own formatting string -- so it is much more powerful. :-)</p>
</div>
<hr/><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2006/11/08/1032747.html" title="What the hell is MFCENU.DLL?">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2006/11/07/1011692.html" title="How ConvertDefaultLocale sorta broke backward compatibility in Vista, and why">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2006-11">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2006-11-07">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2006/11/07/1013908.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:39 GMT -->
</html>