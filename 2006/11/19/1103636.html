<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2006/11/19/1103636.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:39 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>'Son, your TextBox is writing checks that your EDIT control can't cash'</title></head><body>
<h1>'Son, your TextBox is writing checks that your EDIT control can't cash'</h1>
<p><em>by Michael S. Kaplan, published on 2006/11/19 09:30 -05:00, original URI: http://blogs.msdn.com/b/michkap/archive/2006/11/19/1103636.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<FONT face=Tahoma size=3>
<P>In yesterday's <A class="" href="http://archives.miloush.net/michkap/archive/2006/11/18/1102236.html" mce_href="http://archives.miloush.net/michkap/archive/2006/11/18/1102236.html"><STRONG>Read-only, you say? Read-only to whom?</STRONG></A>, I ignored one of the important underlying issues even after explicitly mentioning its role in the disconnect between what someone might think the <A class="" href="http://msdn2.microsoft.com/en-us/library/system.windows.forms.textboxbase.readonly.aspx" mce_href="http://msdn2.microsoft.com/en-us/library/system.windows.forms.textboxbase.readonly.aspx">TextBox.ReadOnly property</A>&nbsp;might do and what it actually, in fact, manages to accomplish. </P>
<P>The issue in question is when the .NET Framework wraps an existing technology rather than&nbsp;writing something new. </P>
<P>Now this is hardly a new issue here, it is something that caused the problems I noted twenty months ago in <STRONG><A class="" href="http://archives.miloush.net/michkap/archive/2005/03/28/402839.html" mce_href="http://archives.miloush.net/michkap/archive/2005/03/28/402839.html">The WinForms DateTimePicker and MonthCalendar do not support culture settings</A></STRONG>. The reason is simple: <STRONG>there</STRONG> <STRONG>is no WinForms DateTimePicker or MonthCalendar</STRONG> as independent entities; there are just wrappers around the existing controls. Controls built by&nbsp;other teams for other purposes with other design philosophies and other priorities. </P>
<P>I suppose we are lucky that they were able to line up enough to allow wrappers to exist, now that I think about it. </P>
<P>Now when one talks about a feature in a product, if&nbsp;one piece&nbsp;has a 70% coverage and another related piece has a 40% coverage, it is not always easy to argue whether the feature as a whole has 40% or 70% coverage. If one wraps the other than usually it is the lower of the two numbers (unless we talk about security in which case it may be the higher of them if the weakness in one piece is still protected by the other).</P>
<P>But if one looks at a TextBox that wraps an EDIT control, can the TextBox really make promises in its object model that the underlying control does not support?</P>
<P>Well, generally speaking the answer is <STRONG>HELL NO</STRONG>, though obviously the TextBox owners can write code to shore up the support and make sure that the implied promise of the interface is represented in the final product. It is clearly the responsibility of the owners of the TextBox since the Shell folks never signed up for the features in question. Though at some point one has to worry whether the wrapper (which is of course meant to be as thin as possible to maximize performance) is going to be too heavy by virtue of too many implementation additions of that sort.</P>
<P>To go back to the DateTimePicker and MonthCalender example, it was simply impossible for WinForms to do anything <STRONG><A class="" href="http://archives.miloush.net/michkap/archive/2005/12/21/506427.html" mce_href="http://archives.miloush.net/michkap/archive/2005/12/21/506427.html">until Windows added support for the features themselves</A></STRONG>. Until then, the disparity between the controls and other .NET globalization features was simply a limitation to document since no one wanted to rewrite the controls. </P>
<P>If I were feeling more cynical, I might wonder how much of the TextBox problem is caused by members of the .NET Framework owners of the TextBox simply not having East Asian/Complex Script support enabled in prior versions. Though today I am feeling more optimistic, so I'll just write it off as an unintended (and undocumented)&nbsp;limitation without assigning any blame. The internationalization judge will not find any malice in the decision. :-)</P>
<P>The problem I have with all of it is when people argue from a standpoint of ignorance of the issue -- acting like it is a simple&nbsp;oversight bug&nbsp;in the .NET control that has no excuse or reason, when it is obviously simply due to the fact that a wrapper around such a different technology is bound to have differences which can be difficult to hide. Ignoring that piece of the puzzle is rather naive in my opinion....</P>
<P mce_keep="true">&nbsp;</P>
<P><FONT color=#ff00ff><EM>This post brought to you by</EM>&nbsp;<FONT size=4>à®”</FONT> <EM>(<A class="" href="http://www.fileformat.info/info/unicode/char/0b94" mce_href="http://www.fileformat.info/info/unicode/char/0b94">U+0b94</A>, a.k.a. TAMIL LETTER AU)</EM></FONT></P></FONT>
<hr/><p><strong>JohnGalt</strong> on 19 Nov 2006 11:27 AM:</p><div style="margin-left: 1em"><p>The point is that the readonly bug is a bug in Win32's Edit control. &nbsp;The .NET framework just continues to have the same bug. &nbsp;It should be fixed at the Win32 level NOT at the .NET level.</p>
<p>You're completely missing the point to this entire conversation. Readonly is READONLY. It is not readonly except when someone forgot to turn off the internationalization functions. &nbsp;This is a bug and a security hole. It should be hotfixed and immediately rolled out to all OSes that have this bug.</p>
<p>Having the .NET team hack a fix for it is not the solution, it's a hack that fixes a bug in future techology but doesn't fix existing technology. And no, this isn't a bug that people would actually use or expect to be there, so it's safe to fix the bug and move on.</p>
<p>*head shake*</p>
</div>
<p><strong>Michael S. Kaplan</strong> on 19 Nov 2006 12:15 PM:</p><div style="margin-left: 1em"><p>Well, except for the fact that it is not actually inserting anything and is therefore not actually a bug.</p>
<p>You didn't try it out first, did you? :-)</p>
<p>Nothing needs to be hotfixed, sorry!</p>
</div>
<p><strong>Coises</strong> on 19 Nov 2006 1:11 PM:</p><div style="margin-left: 1em"><p>I must be missing something. I admit to knowing nothing about .Net and little about Internationalization... I'm still gaining proficiency with the Windows API in VC6.</p>
<p>There must be some code, somewhere, that adds the complex script options to the context menu. Since it wouldn't make sense to add those options to every context menu in all of Windows, I must assume that *wherever* that code resides, it &quot;knows&quot; it is adding these items to the context menu for an Edit control. Coherently extending the Edit control model implies disabling context menu items that are meant to change the content of the control when the control is read-only. It would appear to be a bug, pure and simple: whoever wrote the extension forgot to enable or disable those items in accordance with the read-only state of the control.</p>
<p>The only &quot;out&quot;&#160;I can think of is if the menu additions are generated by &quot;generic&quot; code that expects them to be added only in writable contexts (knowing nothing about Edit controls in particular), while the code that's extending the Edit control has no way of knowing what it's adding, merely that it's supposed to add &quot;something&quot; supplied from elsewhere (so it has no way of telling that something about read-only Edit controls, nor of knowing it should either add something different or add nothing at all when the Edit control is read-only). In that case it would be more clear how the oversight could occur, but then the generic code has been misused by plugging it into a generic socket which it doesn't quite fit: ideally, both sides of the connection should be made a little &quot;smarter&quot; to cover the case that neither originally foresaw -- and others like it that will undoubtedly surface in the future.</p>
</div>
<p><strong>Michael S. Kaplan</strong> on 19 Nov 2006 1:22 PM:</p><div style="margin-left: 1em"><p>The actual cause is slightly more insidious though unrelated to the original question I was addressing in the first post or the later point I was addressing in this post.</p>
<p>Perhaps it could be the subject of yet another post if people are interested; it gets into the architecture of EDIT and Shell EDIT and the LPK extensions added to the latter when it largely replaced the former in Windows....</p>
</div>
<p><strong>Dean Harding</strong> on 19 Nov 2006 5:48 PM:</p><div style="margin-left: 1em"><p>John: It's not a security bug. I missed this post when I replied to the last one, but I explained why there.</p>
<p>The other thing is, if you actually try it out, what happens is that while the menu items aren't disabled, THEY DON'T DO ANYTHING (except the rtl/ltr ones, but that's a display issue only - the text isn't changed).</p>
<p>And, like I said in the last post, there's nothing stopping the user writing an app to send an EM_SETREADONLY message to make it non-readonly, then change the text anyway. It's just like how you can modify the style to remove the ES_PASSWORD style in a running app. If you're relying on these things for &quot;security&quot; then you don't understand security.</p>
</div>
<p><strong>JohnGalt</strong> on 21 Nov 2006 12:14 AM:</p><div style="margin-left: 1em"><p>I don't use them for security. The point is that a lot of developers I know do. I would shoot them if they worked for me, but since they don't, it's they're problem.</p>
<p>What MS doesn't get is that readonly to the casual programmer (which is most of them from what I can see of trying to hire good programmers) reads &quot;read-only&quot;'s description and tada, they're done. &nbsp;This is the equivalent of copy/copyf in C. &nbsp;MS remembers this command... copy was all through windows and resulted in buffer overuns everywhere because it copies data! Great, except when the information is too long... &nbsp;Yes, but normal programmers don't understand the ramifications and take the documentation literally.</p>
<p>Same is true about readonly. &nbsp;99% of programers aren't even aware that you can send messages out of process to any handle you want.</p>
<p>And if they don't do anything in readonly mode, they shouldn't be there, period.</p>
</div>
<p><strong>Michael S. Kaplan</strong> on 21 Nov 2006 12:20 AM:</p><div style="margin-left: 1em"><p>I take it that means you are no longer demanding that &quot;It should be hotfixed and immediately rolled out to all OSes that have this bug&quot;, right?</p>
</div>
<hr/><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2006/11/19/1104093.html" title="Even the characters with no weight can be given weight in their own special way">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2006/11/18/1102236.html" title="Read-only, you say? Read-only to whom?">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2006-11">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2006-11-19">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2006/11/19/1103636.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:39 GMT -->
</html>