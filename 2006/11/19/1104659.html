<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2006/11/19/1104659.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:39 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>Where'd *that* string come from?</title></head><body>
<h1>Where'd *that* string come from?</h1>
<p><em>by Michael S. Kaplan, published on 2006/11/19 19:01 -05:00, original URI: http://blogs.msdn.com/b/michkap/archive/2006/11/19/1104659.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<FONT face=Tahoma size=3>
<P>Remember when I posted about <STRONG><A class="" href="http://archives.miloush.net/michkap/archive/2006/04/04/568518.html" mce_href="http://archives.miloush.net/michkap/archive/2006/04/04/568518.html">Was the name ever really onghornlay?</A></STRONG></P>
<P>I noticed that Environment.OSVersion.ToString() was returning <STRONG>Microsoft Windows NT 6.0.6000.0</STRONG> rather than anything about either Longhorn or Vista.</P>
<P>I guess someone forgot to&nbsp;tell the .NET Framework to use the branding functionality? :-)</P>
<P>The BCL really does construct the string based on a GetVersionEx call that combines the type of Windows and the version number, and does nothing related to the name.</P>
<P>No biggee, it just seemed odd to me given all the effort to avoid coming up with the name in any independent way....</P>
<P>On the other hand, there doesn't seem to be any big rush to document how the branding stuff works, so maybe we didn't give them a whole lot of options.</P>
<P mce_keep="true">&nbsp;</P>
<P><FONT color=#ff00ff><EM>This post brought to you by</EM>&nbsp;<FONT size=6>áž¿</FONT> <EM>(<A class="" href="http://www.fileformat.info/info/unicode/char/17bf" mce_href="http://www.fileformat.info/info/unicode/char/17bf">U+17bf</A>, a.k.a. KHMER VOWEL SIGN YA)</EM></FONT></P></FONT>
<hr/><p><a id="1672463" href="#1672463">#</a> <strong>Eric Lee</strong> on 13 Feb 2007 8:20 PM:</p><div style="margin-left: 1em"><p>Hey Michael,</p>
<p>I'm seeing some funny behaviour with Environment.OSVersion.ToString() from my .NET application running on Windows Vista and I thought you might have some insight.</p>
<p>I have a simple Windows Form application that calls Environment.OSVersion.ToString() in its Main(). &nbsp;After I build the application, I go over in Windows Explorer and set the compatibility mode to Windows XP SP2.</p>
<p>When I run the application, my version string comes out as 6.0.6000.0 - Vista instead of 5.1 something for XP SP2.</p>
<p>Oddly, if I set the compatibility mode to Windows Server 2003 SP1, then my version string comes out as expected, 5.2 something.</p>
<p>Is there anything that might cause this behavior? &nbsp;This is a regular Windows Forms application created from the New Project dialog, no funny .config files or anything.</p>
<p>Any insight you might offer would be appreciated.</p>
<p>Thanks,</p>
<p>Eric.</p></div>
<hr/><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2006/11/19/1106351.html" title="Another satisfied customer!">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2006/11/19/1104093.html" title="Even the characters with no weight can be given weight in their own special way">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2006-11">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2006-11-19">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2006/11/19/1104659.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:39 GMT -->
</html>