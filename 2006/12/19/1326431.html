<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2006/12/19/1326431.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:38 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>Where are the per-user keyboard layouts?</title></head><body>
<h1>Where are the per-user keyboard layouts?</h1>
<p><em>by Michael S. Kaplan, published on 2006/12/19 11:51 -05:00, original URI: http://blogs.msdn.com/b/michkap/archive/2006/12/19/1326431.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<P>Reader Lionel Fourquaux asked me:</P>
<BLOCKQUOTE><FONT face="times new roman,times" size=2>
<P><EM>I was mentioning MSKLC to a fellow student who complained that he couldn't get his usual keyboard configuration on Windows, when I realized that on one point he was perfectly right to complain: since MSKLC install a system-wide keyboard DLL, it cannot be used by a normal user (non-admin). This can be very inconvenient for shared computers.<BR><BR>I think that keyboard configurations should be fully a per-user setting, and that this problem should be considered for the future.</EM></P></FONT></BLOCKQUOTE>
<P>This is a very interesting feature idea, even more so in the world of Vista and LUA/UAC. The question becomes almost obvious -- why can't keyboards work at a per-user level?</P>
<P>Unfortunately, the problem is complicated by the fact that since NT 4.0, this particular bit of the <STRONG>user subsystem</STRONG> has been one of those bits&nbsp;that is mostly a kernel mode component (more information in the article entitled <A class="" href="http://www.microsoft.com/technet/archive/winntas/plan/kernelwp.mspx?mfr=true" mce_href="http://www.microsoft.com/technet/archive/winntas/plan/kernelwp.mspx?mfr=true">MS Windows NT Kernel-mode User and GDI White Paper</A>&nbsp;for those who are curious about this change). </P>
<P>With user profiles being as complicated as they are, tying them in such a way as to allow per-user keyboards would be a pretty difficult negotiation!</P>
<P>With that said, there are other pieces of profiles that are made part of the local machine only (they end up in the user's hidden <STRONG>Local Settings </STRONG>directory (now <STRONG>AppData\Local</STRONG> in Vista). So perhaps there could be a mechanism to allow keyboards that are "per user" which are registered when the user is logged in so that the kernel mode piece would know to (and be able!) to pay attention to it. Perhaps this could be a feature in a future version of Windows? :-)</P>
<P>Now of course I would not encourage people to get their hopes up too much (and even ignoring that it is obviously going to be a bit of time before the next release of Windows), but it might be a feature idea to keep in mind.</P>
<P>I'll be sure to do my best to make sure that after such a feature is in Windows that the version of MSKLC that comes out will support it....</P>
<P mce_keep="true">&nbsp;</P>
<P><FONT color=#ff00ff><EM>This post brought to you by</EM>&nbsp;<FONT size=5>ï½‹</FONT> <EM>(<A class="" href="http://www.fileformat.info/info/unicode/char/ff4b" mce_href="http://www.fileformat.info/info/unicode/char/ff4b">U+ff4b</A>, a.k.a. FULLWIDTH LATIN SMALL LETTER K)</EM></FONT></P>
<hr/><p><strong>Darryl</strong> on 19 Dec 2006 2:23 PM:</p><div style="margin-left: 1em"><p>Not to mention when you use remote desktop to access a machine and the remote machine has some strange keyboard configured. &nbsp;</p>
<p>Nothing like trying to figure out how to type in your password only to find the key you are using isn't they key the machine is getting :( &nbsp;</p>
<p>Actually I am not sure if this is a keyboard definition thing or an IME thing. &nbsp;But I am sure you know. &nbsp; </p></div>
<p><strong>Ben Cooke</strong> on 19 Dec 2006 11:08 PM:</p><div style="margin-left: 1em"><p>I was just about to post about the same thing Darryl posted.</p>
<p>It seems that if the keyboard layout you're using on your local machine isn't available on the remote system, it defaults to some other layout. On the Windows Server 2003 systems at work, this always seems to be US English, which is annoying since I'm British! I guess the default depends on what regional version of Windows you are running, though?</p>
<p>It confused me no end at first, since I had forgotten that I was using a custom keyboard layout. Since Windows seems to group keyboard layouts by country anyway, perhaps it could be made to default to one of the keyboard layouts whose country matches the selected layout if the exact layout is unavailable. That way I'd still end up with my quote signs on Shift+2 even if I don't have my em-dashes on Shift+AltGr+minus; when remotely administrating servers, I generally type the quote character much more often than I type an em-dash!</p></div>
<p><strong>Lionel Fourquaux</strong> on 20 Dec 2006 1:31 PM:</p><div style="margin-left: 1em"><p>Thanks for the post, Michael!</p>
<p>I'm aware that the kernel-mode implementation makes this difficult. However, since part of the graphic code (WDDM drivers) was pulled back from kernel mode in Vista, while keeping correct performance, maybe something like that could be considered for keyboard layouts? While the Windows message queue itself should be fast, I doubt anyone is typing fast enough that there is a performance issue intrinsically tied to keyboard layouts. So, maybe this part could be moved to userland with little performance impact?</p>
<p>Anyway, I posted a suggestion about this on Connect (early feedback, bug id 247007).</p></div>
<hr/><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2006/12/20/1328701.html" title="For the [locale] explorer in you....">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2006/12/18/1314538.html" title="WinForms != WebForms">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2006-12">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2006-12-19">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2006/12/19/1326431.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:38 GMT -->
</html>