<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2006/12/29/1378466.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:38 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>By design? Well, not beautifully so....</title></head><body>
<h1>By design? Well, not beautifully so....</h1>
<p><em>by Michael S. Kaplan, published on 2006/12/29 03:01 -05:00, original URI: http://blogs.msdn.com/b/michkap/archive/2006/12/29/1378466.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<P>So the message I got yesterday&nbsp;from someone with the handle IDisposable was:</P>
<BLOCKQUOTE>
<P><FONT face="times new roman,times"><EM>RE: </EM></FONT><A href="http://archives.miloush.net/michkap/archive/2006/03/25/560838.html"><U><FONT color=#0000ff><FONT face="times new roman,times"><EM>http://blogs.msdn.com/michkap/archive/2006/03/25/560838.aspx</EM></FONT></U></FONT></A><BR><BR><FONT face="times new roman,times"><EM>This code doesn't work under Vista mostly because the Language Packs won't install (says they are already there), but the load of the Satellite assembly doesn't work (obviously) since the localized directories don't exist.<BR><BR>Help me, Obi Wan.</EM></FONT></P></BLOCKQUOTE>
<P>Ok, I'm kidding, it is actually the same Marc Brooks who came up during that blog post he is pointing to. IDisposable is just Marc's handle. I don't think he has it as a license plate though, so he is not as far gone as Mark Davis (president of the Unicode Consortium) whose license plate is UNICODE. :-)</P>
<P>Anyway, I tried it out with several of the language packs, both for <A class="" href="http://www.microsoft.com/downloads/details.aspx?FamilyId=04DBAF2E-61ED-43F4-8D2A-CCB2BAB7B8EB&amp;displaylang=en" mce_href="http://www.microsoft.com/downloads/details.aspx?FamilyId=04DBAF2E-61ED-43F4-8D2A-CCB2BAB7B8EB&amp;displaylang=en">1.1</A> and <A class="" href="http://www.microsoft.com/downloads/details.aspx?familyid=39C8B63B-F64B-4B68-A774-B64ED0C32AE7&amp;displaylang=en" mce_href="http://www.microsoft.com/downloads/details.aspx?familyid=39C8B63B-F64B-4B68-A774-B64ED0C32AE7&amp;displaylang=en">2.0</A>. Now allowing for the fact that I had to of course run them from an elevated command prompt, I had a 100% success rate for the 1.1 language packs, and a 0% success rate for the 2.0 language packs.</P>
<P>Marc is right. Even though 2.0 the langpack setups claim that they are already installed, they are not.</P>
<P>This is, unfortunately, by design.</P>
<P>An excerpt from a soon-to-be-available KB article:</P>
<BLOCKQUOTE>
<P><EM><FONT face="times new roman,times">When attempting to install an x86 .NET Framework 2.0 redistributable Language Pack (langpack.exe) on Vista x86, the installation will not fail but will result in no action. <BR><BR>When attempting an interactive install of an ia64 or x64.NET Framework 2.0 redistributable Language Pack (langpack.exe) on the corresponding Vista OS, the install will block with a dialog message: "The product has been already installed."<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>Silent ia64 and x64 installs will succeed, but result in no action.<BR><BR>In order to support existing application installers, including Visual Studio deployment projects, Vista‚Äôs registry will reflect a system with all .NET Framework 2.0 Language Packs installed (see <B style="mso-bidi-font-weight: normal">standard keys</B> below). This allows existing installers to succeed when probing the registry to detect language pack existence, installation or repair success. Attempts to install or repair version 2.0 language packs will result in a success (0) being returned immediately, but will result in no actions to the underlying system configuration. Whether .NET Framework 2.0 language components are, in fact, actually installed on a given Vista system will depend upon the set of Vista UI languages installed.<SPAN style="mso-spacerun: yes">&nbsp;&nbsp;</SPAN></FONT></EM></P></BLOCKQUOTE>
<P>Basically, given that the .NET Framework is considered to be a&nbsp;component of the operating system, the language packs are something that can only be installed as a part of the Windows user interface language support intrinsic in the MUI and LIP technologies. </P>
<P>So Marc is <EM>technically</EM> incorrect that the code I posted fails; it will work if you install a Vista&nbsp;MUI langpack or a Vista Language Interface Pack, for every language that you have installed. But the current plan of&nbsp;record for the behavior of the .NET Framework language packs is that they go hand-in-glove with the operating system's, starting in Vista.</P>
<P>I verified this on my machine with all of the pre-ship versions of the MUI langpcks -- this is working as designed and I got the following output running my code:</P>
<BLOCKQUOTE><FONT face="Consolas,Lucida Console,Courier New,Courier" size=2><B>
<P><A href="file:///E:/Windows/Microsoft.NET/Framework64/v2.0.50727/mscorlib.dll">file:///E:/Windows/Microsoft.NET/Framework64/v2.0.50727/mscorlib.dll</A><BR>&nbsp;ar<BR>&nbsp;zh-CHS<BR>&nbsp;cs<BR>&nbsp;da<BR>&nbsp;el<BR>&nbsp;es<BR>&nbsp;fi<BR>&nbsp;fr<BR>&nbsp;he<BR>&nbsp;hu<BR>&nbsp;it<BR>&nbsp;ja<BR>&nbsp;ko<BR>&nbsp;nl<BR>&nbsp;no<BR>&nbsp;pl<BR>&nbsp;pt<BR>&nbsp;ru<BR>&nbsp;sv<BR>&nbsp;tr<BR>&nbsp;pt-BR<BR>&nbsp;zh-CHT</P></B></FONT></BLOCKQUOTE>
<P>So if you have the Vista MUI langpacks if they are available to you then the .NET Framework langpacks will work.</P>
<P><EM>(the preliminary LIP Vista LIP langpacks are not done ednough for me to know whether they include the .NET Framework resources or not; given that the LIP list is larger than the .NET Framework list, I assume in many cases it may not be there.)</EM></P>
<P>In my opinion, given that design, at a minimum the fact that the langpack setups claim that the component is already installed (rather then the more accurate claim that the component cannot be installed on this platform) is a legitimate bug. </P>
<P>The fact that the download pages claim that Vista is supported is also (in my opinion)&nbsp;an obvious bug, since as far as these packages are concerned Vista is not supported.</P>
<P>Now the last point is the fact that these langpacks are designed not to install on Vista. That part was intentional, so it is (technically) by design. </P>
<P><STRONG>I won't go so far as to claim that I am thrilled about the design here, FWIW. </STRONG></P>
<P>Though to be honest the whole MUI licensing model is something that I won't claim to be thrilled about, either (and have not been since the Windows 2000 MUI licensing was worked out). So linking one to the other with no other option&nbsp;is a bad idea, in my opinion, not just for the sake of this one bug, but for the same reason why a person doesn't go to the boring party if they are used to ones that are fun. If you know what I mean.</P>
<P>Neither of them is one I have a whole lot of&nbsp;control over, of course.</P>
<P>In any case, I will see what I can do to keep raising the issue, and anyone who would like to see something different should probably feel free to do the same (here or in the issue Marc raised on the Feedback site <A class="" href="https://connect.microsoft.com/feedback/viewfeedback.aspx?FeedbackID=248617&amp;wa=wsignin1.0&amp;siteid=210" mce_href="https://connect.microsoft.com/feedback/viewfeedback.aspx?FeedbackID=248617&amp;wa=wsignin1.0&amp;siteid=210">here</A>)</P>
<P>But just so you know, the current behavior is considered by design.</P>
<P mce_keep="true">&nbsp;</P>
<P><FONT color=#ff00ff><EM>This post brought to you by</EM>&nbsp;íÅÅ <EM>(<A class="" href="http://www.fileformat.info/info/unicode/char/12041" mce_href="http://www.fileformat.info/info/unicode/char/12041">U+12041</A>, a.k.a. CUNEIFORM SIGN BAD)</EM></FONT></P>
<hr/><p><a id="1379949" href="#1379949">#</a> <strong>Tom Gewecke</strong> on 29 Dec 2006 10:11 AM:</p><div style="margin-left: 1em"><p>The list of MUI languages is impressive. &nbsp;But I've read elsewhere that Vista Basic, Premium, and Business will still only come in one language at a time, and that only Ultimate and Enterprise will actually have an mui. &nbsp;Is that true?</p></div>
<p><a id="1380239" href="#1380239">#</a> <strong>Michael S. Kaplan</strong> on 29 Dec 2006 11:29 AM:</p><div style="margin-left: 1em"><p>Yes Tom -- and now you understand why I am saying that I am unhappy wth the MUI licensing model....</p>
<p>What I am hoping to fo here is clarify what is going on so that people who are coming into the situation know what is happening and why. The worst thing that can happen as criticism will be more accurate. :-)</p>
</div>
<p><a id="1380981" href="#1380981">#</a> <strong>IDisposable</strong> on 29 Dec 2006 3:21 PM:</p><div style="margin-left: 1em"><p>Thanks tons for the clarification... so Vista, &quot;By Design&quot; says that the culture is installed. &nbsp;I'm down with that.</p>
<p>The .Net Framework 2.0 Language Packs, though, are NOT correct and need to be updated to check if they have been properly installed in a Vista-compatible way.</p>
<p>I guess we did the right thing by posting the bug against the Language Packs, not Vista.</p>
</div>
<p><a id="1381427" href="#1381427">#</a> <strong>Michael S. Kaplan</strong> on 29 Dec 2006 5:12 PM:</p><div style="margin-left: 1em"><p>Well, I think that I and others have pointed out that there are a few bugs in this area....</p>
<p>But the only real bugs are the two I mentioned -- the text in the download pages that claims Vista compatibility of the download, and the download itself claiming to be installed.</p>
<p>Fixing them still gets nothing installed, it just gets rid of some of the confusion. :-)</p>
<p>The separate issue I know you have about the download page languages is something I'll be covering soon.</p>
<p>The other part I mention in the post IS by design according to the folks in the .NET Framework, though I am not the only one who would like them to rethink their design here....</p>
</div>
<p><a id="1383108" href="#1383108">#</a> <strong>Mihai</strong> on 29 Dec 2006 11:39 PM:</p><div style="margin-left: 1em"><p>&lt;&lt;Vista Basic, Premium, and Business will still only come in one language at a time, and that only Ultimate and Enterprise will actually have an mui&gt;&gt;</p>
<p>Very disappointing!</p>
<p>Looking at the MUI/LIP licensing on XP, I would have expected the home versions to be LIP only, and the Business &amp; Ultimate to allow MUI.</p>
<p>And looking at the LIP push for XP, I was even half-hopping to see MUI on Home-Premium, as an extra bonus for the big money.</p>
<p>I know a lot of multi-lingual families, and being able to install 2-3 languages on a shared computer, with different UI for different accounts, would be a nice feature.</p>
<p>But even if I can understand the no MUI on Home-Premium part, the MUI missing from the Business versions is a WTF in my book, and a step backward :-(</p></div>
<p><a id="1383113" href="#1383113">#</a> <strong>Michael S. Kaplan</strong> on 29 Dec 2006 11:42 PM:</p><div style="margin-left: 1em"><p>LIPs will (as far as I know) still be as before and supported on all versions, I believe it is just MUI that has the additional SKU requirements....</p>
<p>(at least that is my understanding here)</p>
</div>
<hr/><p><em>referenced by</em></p><div style="margin-left: 1em"><p>2007/05/10 <a href="http://archives.miloush.net/michkap/archive/2007/05/10/2518799.html">English on Spanish?</a></p><p>2007/01/02 <a href="http://archives.miloush.net/michkap/archive/2007/01/02/1396598.html">Right behavior, wrong scenario</a></p></div><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2006/12/29/1383078.html" title="My New Year&#39;s Resolutions">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2006/12/29/1377788.html" title="Converting a project to Unicode: Part 2 (&#39;Sorry, you&#39;re not my type.&#39; &#39;Um, maybe I could change that?&#39;)">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2006-12">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2006-12-29">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2006/12/29/1378466.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:38 GMT -->
</html>