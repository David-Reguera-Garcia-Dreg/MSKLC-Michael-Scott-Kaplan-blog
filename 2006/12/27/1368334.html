<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2006/12/27/1368334.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:38 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>Converting a project to Unicode: Part 0 (The introduction)</title></head><body>
<h1>Converting a project to Unicode: Part 0 (The introduction)</h1>
<p><em>by Michael S. Kaplan, published on 2006/12/27 03:01 -08:00, original URI: http://blogs.msdn.com/michkap/archive/2006/12/27/1368334.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostOld -->
<P>It was over a year ago that Jeff D. asked in the Suggestion Box:</P>
<BLOCKQUOTE><FONT face="times new roman,times"><EM>Michael, <BR><BR>What I'd be interested in reading (assuming you haven't already given us one) is a primer on how to go about converting a non-Unicode app to Unicode compliance... for those of us who are starting to "see the light", as it were. <BR><BR>Cheers, <BR>~Jeff D. <BR><BR>P.S. <BR>Forgive me if you've already written an article like this and I simply haven't found it yet. </EM></FONT></BLOCKQUOTE>
<P>First, let me say that I hope Jeff is still around and that he wasn't holding his breath waiting for me to answer. :-)</P>
<P>Although I left the question "on the books" for all this time, I was hesitant to post about it because it really seems like a more a tutorial that one might expect and less of a blog topic.</P>
<P>But I kind of thought that the next time I had to take a purely non-Unicode app and convert it to Unicode that it would be cool to perhaps try to start an answer to Jeff's question by covering what was involved, and what I did to minimize the amount of work while maximizing the productivity.</P>
<P>The last app that I&nbsp;had in mind for this idea that&nbsp;I had to do this with (long before Jeff posted his question) was converting the Windows build tool kbdtool.exe to the kbdutool.exe that MSKLC ships and uses. I specifically decided not to write about the kbdtool --&gt; kbdutool conversion though, for&nbsp;a few&nbsp;reasons. First of all, the source for kbdtool.exe doesn't ship in the SDK, so no one could really see the project I did the work on, and second of all, the work was long done and it is easy to forget lots of details that long after the fact. </P>
<P>Plus I didn't want to just do something that wasn't related to what I'm doing.</P>
<P>And finally, I decided if I was ever going to do it I wanted it to be something that might be generally useful for others, too.</P>
<P>Tall order? Definitely.</P>
<P>And then earlier today, a project that fit my criteria pretty much fell in my lap!</P>
<P>In response to a bug that was reported earlier today:</P>
<BLOCKQUOTE>
<BLOCKQUOTE>
<P><FONT face="times new roman,times"><STRONG>BUG Title</STRONG>: MSKLC 1.4: The bootstrapper, setup.exe, is not Unicode?<BR><BR><STRONG>Repro Steps</STRONG>:</FONT></P>
<OL>
<LI><FONT face="times new roman,times">Launch MSKLC 1.4</FONT></LI>
<LI><FONT face="times new roman,times">Customize any key so we can build a keyboard layout</FONT></LI>
<LI><FONT face="times new roman,times">Point the working directory to a path that contains Unicode only chars like a Hindi char</FONT></LI>
<LI><FONT face="times new roman,times">Build the keyboard layout</FONT></LI>
<LI><FONT face="times new roman,times">Launch the created setup.exe</FONT></LI></OL>
<P><FONT face="times new roman,times"><STRONG>Result</STRONG>:&nbsp;Setup was unable to find the msi package or patch.</FONT></P></BLOCKQUOTE></BLOCKQUOTE>
<P>Suddenly&nbsp;I had a project to convert&nbsp;--&nbsp;&nbsp;the SETUP.EXE Bootstrap sample from the Platform SDK that <A class="" href="http://blogs.msdn.com/heaths/" mce_href="http://blogs.msdn.com/heaths/">Heath Stewart</A>&nbsp;<A class="" href="http://blogs.msdn.com/heaths/archive/2006/01/26/517998.aspx" mce_href="http://blogs.msdn.com/heaths/archive/2006/01/26/517998.aspx">mentioned</A> a while back!</P>
<P>As a bonus, perhaps one day the Windows Installer folks might want to pick it up and include in the SDK. :-)</P>
<P>Now I realized there are many ways to do this kind of thing in a blog. </P>
<P>I decided to take the approach of a multiple posts that anyone could follow along with if they have the project on their machine.</P>
<P>This is a nice small project (~3500 lines of code or thereabouts)&nbsp;that I can use to show how I approached the idea. </P>
<P>It also has some other cool aspects I'll be able to point out as I go along (and also a few aspects that don't apply here that I will be able to point out as well!).</P>
<P>The actual amount of time it took me for this project gong from A to Zed to a compiling Unicode version that works was two hours and&nbsp;three minutes. But this series will take a bit longer as do it again and take the time to comment on what I am doing each day.</P>
<P>Hopefully everyone will find this a fun and/or useful way to spend some time over the next week or so....</P>
<P>Each day, the sponsoring character will be a random character not found in&nbsp;any Windows code page that would be suitable for step #3 in the repro steps of the bug, given earlier. :-)</P>
<P mce_keep="true">&nbsp;</P>
<P><FONT color=#ff00ff><EM>This post brought to you by</EM>&nbsp;<FONT size=5>à¤•</FONT> <EM>(<A class="" href="http://www.fileformat.info/info/unicode/char/0915" mce_href="http://www.fileformat.info/info/unicode/char/0915">U+0915</A>, a.k.a. DEVAN</EM>AGA<EM>RI LETTER KA)</EM></FONT></P>
<hr/><p><a id="1370983" href="#1370983">#</a> <strong>Dean Harding</strong> on Wednesday, December 27, 2006 6:03 PM:</p><div style="margin-left: 1em"><P>&gt; As a bonus, perhaps one day the Windows Installer folks might want</P>
<P>&gt; to pick it up and include in the SDK.</P>
<P>One can only dream! Lets get them to support Unicode in MSI files, first :-)</P></div>
<p><a id="1371034" href="#1371034">#</a> <strong>Michael S. Kaplan</strong> on Wednesday, December 27, 2006 6:45 PM:</p><div style="margin-left: 1em"><P>Well, getting them to pick up a finished code sample is a whole lot easier than getting them to write a whole new feature into an existing code base....</P>
<P>But that team could use the same principles to do try to the conversion! :-)</P></div>
<p><a id="1372028" href="#1372028">#</a> <strong>Dean Harding</strong> on Wednesday, December 27, 2006 9:40 PM:</p><div style="margin-left: 1em"><P>Perhaps you could include support for MSLU in the sample, to show them how you can still be living in the 21st century, while at the same time, still supporting Windows 9X?</P></div>
<hr/><p><em>referenced by</em></p><div style="margin-left: 1em"><p>2007/12/24 <a href="http://archives.miloush.net/michkap/archive/2007/12/24/6843995.html">VS just got served!, aka The ??? Shift, aka 'Converting a project to Unicode???' No, it's 'Converting a project??? ToUnicode!!!'</a></p><p>2007/04/14 <a href="http://archives.miloush.net/michkap/archive/2007/04/14/2128198.html">Rhymes with Amharic (a.k.a. How about a little breakfast embed, dear?)</a></p><p>2007/01/24 <a href="http://archives.miloush.net/michkap/archive/2007/01/24/1520365.html">Thank Bob that there are no time machines!</a></p><p>2007/01/17 <a href="http://archives.miloush.net/michkap/archive/2007/01/17/1481756.html">Ungarbling the comments</a></p><p>2007/01/05 <a href="http://archives.miloush.net/michkap/archive/2007/01/05/1413001.html">Converting a project to Unicode: Part 9 (The project's postpartum postmortem)</a></p><p>2007/01/04 <a href="http://archives.miloush.net/michkap/archive/2007/01/04/1409380.html">Converting a project to Unicode: Part 8 (Fitting MSLU into the mix)</a></p><p>2007/01/03 <a href="http://archives.miloush.net/michkap/archive/2007/01/03/1395788.html">Converting a Project to Unicode: Part 7 (What does it mean to fit things to a 'T', anyway?)</a></p><p>2007/01/02 <a href="http://archives.miloush.net/michkap/archive/2007/01/02/1395703.html">Converting a Project to Unicode: Part 6 (Upon the road not traveled)</a></p><p>2007/01/01 <a href="http://archives.miloush.net/michkap/archive/2007/01/01/1391798.html">Converting a Project to Unicode: Part 5 (Are we there yet? Well, not *just* yet)</a></p><p>2006/12/31 <a href="http://archives.miloush.net/michkap/archive/2006/12/31/1386486.html">Converting a Project to Unicode: Part 4 (It's /Delightful, it's /Delicious, it's /DUnicode!)</a></p><p>2006/12/30 <a href="http://archives.miloush.net/michkap/archive/2006/12/30/1382886.html">Converting a project to Unicode: Part 3 (Can I quote you on that?)</a></p><p>2006/12/29 <a href="http://archives.miloush.net/michkap/archive/2006/12/29/1377788.html">Converting a project to Unicode: Part 2 ('Sorry, you're not my type.' 'Um, maybe I could change that?')</a></p><p>2006/12/28 <a href="http://archives.miloush.net/michkap/archive/2006/12/28/1372747.html">Converting a project to Unicode: Part 1 (Business before pleasure)</a></p></div><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2006/12/28/1371979.html" title="Changing MUI settings from MUISETUP command line?">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2006/12/27/1366186.html" title="If you decompose those city elders, you might be able to sort them out!">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2006-12">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2006-12-27">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2006/12/27/1368334.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:38 GMT -->
</html>