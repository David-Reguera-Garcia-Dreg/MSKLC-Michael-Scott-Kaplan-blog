<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2006/12/12/1264508.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:39 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>Sorting numbers as text AND as digits</title></head><body>
<h1>Sorting numbers as text AND as digits</h1>
<p><em>by Michael S. Kaplan, published on 2006/12/12 03:01 -05:00, original URI: http://blogs.msdn.com/b/michkap/archive/2006/12/12/1264508.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<P>It's funny, but the past few years whenever I have had to fly I have noticed (whether sitting in my scooter or sitting in a wheelchair) that people in the airport are really not paying very much attention where they are going. I m not sure what it is, but people kind of turn off the part of their brains that pays attention to details.</P>
<P>People are the same way when they use their computers, I think. So most people may not have noticed the kind of thing this post is about....&nbsp;</P>
<P>As much as the Shell tries to do everything that it does in a consistent way, the little things get in the way.</P>
<P>Like let's take sorting numbers as digits rather than as text, as discussed in <A href="http://archives.miloush.net/michkap/archive/2005/01/05/346933.html"><STRONG>What is up with number sorting?</STRONG></A>&nbsp;and other posts.</P>
<P>So I am in Vista with some text files designed to arbitrarily and unrealistically show off the feature:</P>
<P><IMG src="http://trigeminal.fmsinc.com/images/somewhatlogical1.png"></P>
<P>Now we already know that the Command Prompt won't handle things the same way:</P>
<P><IMG src="http://trigeminal.fmsinc.com/images/somewhatlogical2.png"></P>
<P>But if you look at some other pieces that the Shell provides like the File Open dialog (seen here in Notepad) you can see it looks like <A class="" href="http://msdn.microsoft.com/library/en-us/shellcc/platform/shell/reference/shlwapi/string/strcmplogicalw.asp" mce_href="http://msdn.microsoft.com/library/en-us/shellcc/platform/shell/reference/shlwapi/string/strcmplogicalw.asp">StrCmpLogicalW</A> is being used again:</P>
<P><IMG src="http://trigeminal.fmsinc.com/images/somewhatlogical3.png"></P>
<P>But if you try to start typing in <STRONG>file</STRONG> in the File name text box and then wait for a second, you see the sorted list of files:</P>
<P><IMG src="http://trigeminal.fmsinc.com/images/somewhatlogical4.png"></P>
<P>Looks like your average everyday listbox with the LBS_SORT style on it, so that when <A class="" href="http://msdn.microsoft.com/library/en-us/shellcc/platform/commctls/listboxes/listboxreference/listboxmessages/lb_addstring.asp" mce_href="http://msdn.microsoft.com/library/en-us/shellcc/platform/commctls/listboxes/listboxreference/listboxmessages/lb_addstring.asp">LB_ADDSTRING</A> is called something like a bunch of calls to <A class="" href="http://msdn.microsoft.com/library/en-us/winui/winui/windowsuserinterface/resources/strings/stringreference/stringfunctions/lstrcmp.asp" mce_href="http://msdn.microsoft.com/library/en-us/winui/winui/windowsuserinterface/resources/strings/stringreference/stringfunctions/lstrcmp.asp">lstrcmpW</A> or <A class="" href="http://msdn.microsoft.com/library/en-us/winui/winui/windowsuserinterface/resources/strings/stringreference/stringfunctions/lstrcmpi.asp" mce_href="http://msdn.microsoft.com/library/en-us/winui/winui/windowsuserinterface/resources/strings/stringreference/stringfunctions/lstrcmpi.asp">lstrcmpiW</A> happen&nbsp;to support&nbsp;some kind of insertion sort. So you have&nbsp;a list of files in the listbox that is not in the same order as the list in the listview above.it.</P>
<P>It is of course also possible that no one noticed this kind of thing (like most&nbsp;minor inconsistencies&nbsp;like this, I found it by accident).</P>
<P>I think most people do not spend much time paying attention to the Shell, even if they constantly use it. It's like they are at the airport or something, bumping into my scooter. :-)</P>
<P mce_keep="true">&nbsp;</P>
<P><FONT color=#ff00ff><EM>This post brought to you by</EM>&nbsp;<FONT size=5>à»–</FONT> <EM>(<A class="" href="http://www.fileformat.info/info/unicode/char/0ed6" mce_href="http://www.fileformat.info/info/unicode/char/0ed6">U+0ed6</A>, a.k.a. LAO DIGIT SIX)</EM></FONT></P>
<hr/><p><a id="1265560" href="#1265560">#</a> <strong>WebmasterX</strong> on 12 Dec 2006 6:27 AM:</p><div style="margin-left: 1em"><p>What a silly post. &nbsp;I would wager that this inconsistency is 100% done on purpose. &nbsp;When you are browsing for a file you want them organized in true alphabetical order. &nbsp;When you are typing a file name to save / rename / search for a file the sorting is in the other format because it's the only one that makes sense.</p></div>
<p><a id="1266209" href="#1266209">#</a> <strong>tzagotta</strong> on 12 Dec 2006 9:05 AM:</p><div style="margin-left: 1em"><p>Interesting - didn't notice that Vista's shell sorted in that way. Too bad that rename is still strange. It would be nice to, in your example, select all the files, hit F2, and then change &quot;file&quot; to &quot;text&quot; and have Vista keep all the existing numbers. Instead, Vista (and XP) do a rename using a style that probably doesn't do what anyone would expect - violating the principle of least surprise.</p>
</div>
<p><a id="1266281" href="#1266281">#</a> <strong>Michael S. Kaplan</strong> on 12 Dec 2006 9:23 AM:</p><div style="margin-left: 1em"><p>Actually WebmasterX, that isn't the case. It is just the autocomplete stuff is not tuned to using StrCmpLogicalW.</p>
<p>One of the devs pointed out that there are other problems here as well, which I sill point out in another post....</p>
</div>
<p><a id="1266291" href="#1266291">#</a> <strong>Michael S. Kaplan</strong> on 12 Dec 2006 9:25 AM:</p><div style="margin-left: 1em"><p>Hi tzagotta, </p>
<p>The multiple rename suffers from a different problem -- that there are multiple &quot;intuitive&quot; options as to how it should work, all of whcih are mutually contradictory....</p>
</div>
<p><a id="1266324" href="#1266324">#</a> <strong>tzagotta</strong> on 12 Dec 2006 9:35 AM:</p><div style="margin-left: 1em"><p>I agree that there are multiple possible interpretations, but the current approach of picking one that is wrong for most people most of the time is not the right approach. If there are a number of possible ways to do that, then there needs to be an option, either a static option, or a probably better - dialog box that comes up during the rename process, that allows the user to choose what they want if there are multiple possible ways.</p>
<p>And in the example you gave and I built on, I think that renaming in that case is pretty clear. Do you see different reasonable interpretations when the user just changes the &quot;words part,&quot; leaves alone the &quot;numbers part,&quot; and has selected a bunch of files that have the same &quot;words part&quot; and different &quot;numbers parts&quot;?</p>
<p>I agree it is a little complex and that it would require some thinking and some user research, but the OS is at the point now where it can start to address more complex usability scenarios like this. This functionality should be part of the OS, and not require that I load a &quot;rename utility&quot; just to get that functionality (many exist today).</p>
<p>Also, to a certain extent, I agree with WebmasterX - the incremental search would be a little strange if the entries were sorted the same way the shell does, right?</p>
</div>
<p><a id="1266518" href="#1266518">#</a> <strong>Michael S. Kaplan</strong> on 12 Dec 2006 10:43 AM:</p><div style="margin-left: 1em"><p>Well, perhaps on WebmasterX's point -- though the difference is stark enough to seem like a mistake, like people at Microsoft don't talk to each other. :-)</p>
<p>For the other, I think the Shell folks are kind of in transition now as far as features like this -- first steps have been taken, now they have to take the next steps. There are risks to including too many options, but there are definitely rewars to making a decision and going with it....</p>
</div>
<p><a id="1266691" href="#1266691">#</a> <strong>NBC</strong> on 12 Dec 2006 11:24 AM:</p><div style="margin-left: 1em"><p>i don't use the shell :) i use totalcmd :p</p></div>
<p><a id="1267067" href="#1267067">#</a> <strong>Maurits [MSFT]</strong> on 12 Dec 2006 11:47 AM:</p><div style="margin-left: 1em"><p>I find this feature unbelievably annoying, but I have to deal with large lists files whose names are GUIDS or other hex number strings. &nbsp;It's much easier to find any given hex number if they're sorted in hex order, which is alpha order; this alpha/numeric order does strange things to the brain for lists of hex.</p>
</div>
<p><a id="1267946" href="#1267946">#</a> <strong>Heath Stewart</strong> on 12 Dec 2006 1:35 PM:</p><div style="margin-left: 1em"><p>Yeah, foot traffic in the airport annoys me, too - actually, pretty much anywhere. In this country - and a few others - people drive on the right. In other countries the left. I believe foot traffic should follow the same practice as the country you're in jst like is expected when driving a rental or something.</p>
<p>If everyone stays on the same side when going a particular direction - until you need to turn - everything would run smoother. But when people walk all over the place - even at angles going back and forth like they wre served too much on the last flight - it just makes it a pain for everyone else. I can imagine that in a wheel chair or scooter this would be abigger pain because you can't exactly jump out of the way (although it should be easier to plow them over!).</p>
</div>
<p><a id="1311281" href="#1311281">#</a> <strong>raz</strong> on 17 Dec 2006 8:33 AM:</p><div style="margin-left: 1em"><p>windows stores and sorts albums of media content into folders based on name, so the first in a series of albums (music or movie) will be sorted out of order thus:</p>
<p>austin powers 2</p>
<p>austin powers</p>
<p>(in both the file system and media Player). manually fixing this to be &quot;austin powers 1&quot; will not work if media player is automatically updating the string from the online database, as it will rename this back to &quot;austin powers&quot;.</p></div>
<p><a id="1311926" href="#1311926">#</a> <strong>Michael S. Kaplan</strong> on 17 Dec 2006 1:28 PM:</p><div style="margin-left: 1em"><P>Hi raz ---</P>
<P>Yes, that is why the Vista changes I described <STRONG><A class="" href="http://archives.miloush.net/michkap/archive/2006/10/01/778990.html">here</A></STRONG> are so cool. :-)</P></div>
<p><a id="1455615" href="#1455615">#</a> <strong>raz</strong> on 12 Jan 2007 8:21 AM:</p><div style="margin-left: 1em"><p>it might be cool on vista, but that means moving to the latest version (v11) of media player and the library in that is a crippled version of the v10 library on XP. one small step forward for sorting, ten big steps backward for managing your media library. that's enough for me to avoid moving to vista</p></div>
<hr/><p><em>referenced by</em></p><div style="margin-left: 1em"><p>2007/01/18 <a href="http://archives.miloush.net/michkap/archive/2007/01/18/1487464.html">What the %$#&amp; is up with localized paths in Vista?</a></p></div><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2006/12/12/1266500.html" title="Open it all up, get out of the way, and then what happens?">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2006/12/11/1262690.html" title="IsComplexEnoughForYou?">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2006-12">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2006-12-12">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2006/12/12/1264508.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:39 GMT -->
</html>