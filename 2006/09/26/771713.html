<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2006/09/26/771713.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:39 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>Someone forgot the LCID? :-)</title></head><body>
<h1>Someone forgot the LCID? :-)</h1>
<p><em>by Michael S. Kaplan, published on 2006/09/26 03:01 -04:00, original URI: http://blogs.msdn.com/b/michkap/archive/2006/09/26/771713.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<P>Shell developer Ben Karas has been posting about the <A href="http://blogs.msdn.com/benkaras/archive/category/14682.aspx">property system</A> in the Shell in his new blog <A href="http://blogs.msdn.com/benkaras/">The Great Flying Tortoise</A>, and one post in particular caught my eye, the one entitled <A href="http://blogs.msdn.com/benkaras/archive/2006/09/22/763963.aspx">PROPVARIANT Helpers #6 - PropVariantCompare[Ex]</A>. </P>
<P>The function actually has one of those possible situations that drives people who are building indexes crazy, that case where A &lt; B and also B &lt; A. Though thankfully this has more to do with the fact that variants are being compared and thus they are always compared in the context of the first item -- meaning that comparing A to B will use A's type, while comparing B to A will use B's type. And thus what in the world of <A href="http://msdn.microsoft.com/library/en-us/winui/winui/windowsuserinterface/resources/strings/stringreference/stringfunctions/comparestring.asp">CompareString</A> and <A href="http://msdn.microsoft.com/library/en-us/intl/nls_5s2v.asp">LCMapString</A> is a bug that someone on the SQL Server team is justifiably unhappy about, can become an understandable&nbsp;issue that is not really going to be fatal....</P>
<P>As Ben mentioned, the RTM version of <A href="http://msdn.microsoft.com/library/en-us/shellcc/platform/shell/reference/functions/propvarconversionfunctions/propvariantcompareex.asp">PropVariantCompareEx</A>, while not containing an LCID (or locale name) parameter, will at least contain some flag values to&nbsp;control whether string comparsions are done with <A href="http://msdn.microsoft.com/library/en-us/shellcc/platform/shell/reference/shlwapi/string/strcmplogicalw.asp">StrCmpLogicalW</A> (the default), or the other Shell comparison functions like&nbsp;<A href="http://msdn.microsoft.com/library/en-us/shellcc/platform/shell/reference/shlwapi/string/strcmp.asp">StrCmp</A>, <A href="http://msdn.microsoft.com/library/en-us/shellcc/platform/shell/reference/shlwapi/string/strcmpc.asp">StrCmpC</A>, <A href="http://msdn.microsoft.com/library/en-us/shellcc/platform/shell/reference/shlwapi/string/strcmpi.asp">StrCmpI</A>, or <A href="http://msdn.microsoft.com/library/en-us/shellcc/platform/shell/reference/shlwapi/string/strcmpic.asp">StrCmpIC</A>. Looking at the flag values (which have not been published yet) they currently appear to literally be flag values using different bits (when obviously you would never really be able to reasonably combine them). </P>
<P>I'll wait for PropVariantCompareEx2 that takes an LCID, or even better takes a locale name. :-)</P>
<P>In the meantime, Ben's blog is definitely one worth keeping an eye on, so I have added it to the <STRONG><A href="http://archives.miloush.net/michkap/archive/2004/12/18/325156.html">blogs I read</A></STRONG>....</P>
<P>&nbsp;</P>
<P><FONT color=#ff1493><EM>This post brought to you by</EM> <STRONG><FONT size=6>ê‘‚</FONT></STRONG> <EM>(<A href="http://www.fileformat.info/info/unicode/char/a442">U+a442</A>, a.k.a. YI SYLLABLE NJURX)</EM></FONT></P>
<hr/><div style="margin-left: 1em"><em>no comments</em></div><hr/><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2006/09/27/773341.html" title="LOCALE_SABBREVLANGNAME is more than just an ISO-639 code">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2006/09/26/771554.html" title="In case you have a yen to extend your keyboard (or at least want a yen?)">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2006-09">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2006-09-26">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2006/09/26/771713.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:39 GMT -->
</html>