<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2006/09/13/752086.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:39 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>MSKLC and Vista? MSKLC and 64-bit? Darn, we're 0 for 2....</title></head><body>
<h1>MSKLC and Vista? MSKLC and 64-bit? Darn, we're 0 for 2....</h1>
<p><em>by Michael S. Kaplan, published on 2006/09/13 09:52 -04:00, original URI: http://blogs.msdn.com/b/michkap/archive/2006/09/13/752086.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<FONT face=Tahoma>
<P>Remember that MVP I was talking about in <STRONG><A href="http://archives.miloush.net/michkap/archive/2006/07/17/667809.html">this post</A></STRONG> and <A href="http://archives.miloush.net/michkap/archive/2006/07/19/670674.html"><STRONG>this one</STRONG></A>? Omi? </P>
<P>Well, he reported a few new issues he was running into with MSKLC in a couple of emails yesterday. :-) </P>
<P>One of them went like this: </P>
<BLOCKQUOTE dir=ltr style="MARGIN-RIGHT: 0px"><FONT face="Times New Roman" size=2>
<P>Dear Michael,<BR>I just installed Windows Vista RC-1 (64 bit) in my machine and<BR>installed the attached keyboard layout. But this is not working and I<BR>don't know why.<BR><BR>Can you please tell me what I need to do?<BR><BR>Thanks<BR>Omi</P></FONT></BLOCKQUOTE>
<P>And the other one went like this:</P>
<BLOCKQUOTE dir=ltr style="MARGIN-RIGHT: 0px"><FONT face="Times New Roman" size=2>
<P>Here is a problem I found<BR><BR>--Error Code--<BR><BR>See the end of this message for details on invoking just-in-time (JIT) debugging instead of this dialog box.<BR><BR>************** Exception Text **************<BR>System.UnauthorizedAccessException: Access to the path<BR>'D:\Soft\Final\Bengali\ekushey_UniJoy\UniJoy.klc' is denied.<BR>&nbsp;&nbsp; at System.IO.__Error.WinIOError(Int32 errorCode, String maybeFullPath)<BR>&nbsp;&nbsp; at System.IO.File.Delete(String path)<BR>&nbsp;&nbsp; at Microsoft.Globalization.Tools.KeyboardLayoutCreator.KeyboardTextFile..ctor(String<BR>fileName, String name, String description, String company, String<BR>copyright, UIntPtr localeId, VirtualKey[] vks, ArrayList alNames,<BR>ArrayList alExtNames, ArrayList alAttributes, ArrayList alDesciptions)<BR>&nbsp;&nbsp; at Microsoft.Globalization.Tools.KeyboardLayoutCreator.Keyboard.mnuFileSave_Click(Object<BR>sender, EventArgs e)<BR>&nbsp;&nbsp; at Microsoft.Globalization.Tools.KeyboardLayoutCreator.Keyboard.Keyboard_Closing(Object<BR>sender, CancelEventArgs e)<BR>&nbsp;&nbsp; at System.Windows.Forms.Form.OnClosing(CancelEventArgs e)<BR>&nbsp;&nbsp; at System.Windows.Forms.Form.WmClose(Message&amp; m)<BR>&nbsp;&nbsp; at System.Windows.Forms.Form.WndProc(Message&amp; m)<BR>&nbsp;&nbsp; at Microsoft.Globalization.Tools.KeyboardLayoutCreator.Keyboard.WndProc(Message&amp;<BR>m)<BR>&nbsp;&nbsp; at System.Windows.Forms.Control.ControlNativeWindow.OnMessage(Message&amp; m)<BR>&nbsp;&nbsp; at System.Windows.Forms.Control.ControlNativeWindow.WndProc(Message&amp; m)<BR>&nbsp;&nbsp; at System.Windows.Forms.NativeWindow.Callback(IntPtr hWnd, Int32<BR>msg, IntPtr wparam, IntPtr lparam)<BR><BR><BR>************** Loaded Assemblies **************<BR>mscorlib<BR>&nbsp;&nbsp;&nbsp; Assembly Version: 2.0.0.0<BR>&nbsp;&nbsp;&nbsp; Win32 Version: 2.0.50727.112 (rtmLHS.050727-1100)<BR>&nbsp;&nbsp;&nbsp; CodeBase: <A href="file:///C:/Windows/Microsoft.NET/Framework/v2.0.50727/mscorlib.dll">file:///C:/Windows/Microsoft.NET/Framework/v2.0.50727/mscorlib.dll</A><BR>----------------------------------------<BR>msklc<BR>&nbsp;&nbsp;&nbsp; Assembly Version: 1.3.4022.0<BR>&nbsp;&nbsp;&nbsp; Win32 Version: 1.3.4022.0<BR>&nbsp;&nbsp;&nbsp; CodeBase: <A href="file:///C:/Program Files (x86)/Microsoft Keyboard Layout Creator/msklc.exe">file:///C:/Program%20Files%20(x86)/Microsoft%20Keyboard%20Layout%20Creator/msklc.exe</A><BR>----------------------------------------<BR>System.Windows.Forms<BR>&nbsp;&nbsp;&nbsp; Assembly Version: 2.0.0.0<BR>&nbsp;&nbsp;&nbsp; Win32 Version: 2.0.50727.112 (rtmLHS.050727-1100)<BR>&nbsp;&nbsp;&nbsp; CodeBase: <A href="file:///C:/Windows/assembly/GAC_MSIL/System.Windows.Forms/2.0.0.0__b77a5c561934e089/System.Windows.Forms.dll">file:///C:/Windows/assembly/GAC_MSIL/System.Windows.Forms/2.0.0.0__b77a5c561934e089/System.Windows.Forms.dll</A><BR>----------------------------------------<BR>System<BR>&nbsp;&nbsp;&nbsp; Assembly Version: 2.0.0.0<BR>&nbsp;&nbsp;&nbsp; Win32 Version: 2.0.50727.112 (rtmLHS.050727-1100)<BR>&nbsp;&nbsp;&nbsp; CodeBase: <A href="file:///C:/Windows/assembly/GAC_MSIL/System/2.0.0.0__b77a5c561934e089/System.dll">file:///C:/Windows/assembly/GAC_MSIL/System/2.0.0.0__b77a5c561934e089/System.dll</A><BR>----------------------------------------<BR>System.Drawing<BR>&nbsp;&nbsp;&nbsp; Assembly Version: 2.0.0.0<BR>&nbsp;&nbsp;&nbsp; Win32 Version: 2.0.50727.112 (rtmLHS.050727-1100)<BR>&nbsp;&nbsp;&nbsp; CodeBase: <A href="file:///C:/Windows/assembly/GAC_MSIL/System.Drawing/2.0.0.0__b03f5f7f11d50a3a/System.Drawing.dll">file:///C:/Windows/assembly/GAC_MSIL/System.Drawing/2.0.0.0__b03f5f7f11d50a3a/System.Drawing.dll</A><BR>----------------------------------------<BR><BR>************** JIT Debugging **************<BR>To enable just-in-time (JIT) debugging, the .config file for this application or computer (machine.config) must have the jitDebugging value set in the system.windows.forms section. The application must also be compiled with debugging enabled.<BR><BR>For example:<BR><BR>&lt;configuration&gt;<BR>&nbsp;&nbsp;&nbsp; &lt;system.windows.forms jitDebugging="true" /&gt;<BR>&lt;/configuration&gt;<BR><BR>When JIT debugging is enabled, any unhandled exception will be sent to the JIT debugger registered on the computer rather than be handled by this dialog box.<BR><BR>--End Code--</P></FONT></BLOCKQUOTE>
<P>Now both of these are indeed legitimate issues, and I thought maybe worthy of a comment here. :-)</P>
<P>The first one, I have even blogged about the problem in <STRONG><A href="http://archives.miloush.net/michkap/archive/2006/01/26/517728.html">several</A></STRONG> <A href="http://archives.miloush.net/michkap/archive/2005/06/17/430391.html"><STRONG>other</STRONG></A> <STRONG><A href="http://archives.miloush.net/michkap/archive/2005/08/05/448006.html">previous</A></STRONG> <A href="http://archives.miloush.net/michkap/archive/2005/10/06/477930.html"><STRONG>posts</STRONG></A>. It boils down to the fact that 64-bit support in MSKLC does not yet exist, and won't exist without some sort of update that explicitly addresses it.</P>
<P>The second one is a UAC/LUA issue with MSKLC that I have not mentioned before (in other words it is not <STRONG><A href="http://archives.miloush.net/michkap/archive/2006/06/27/648618.html">this</A></STRONG> problem, which relates specifically to a UAC/LUA issue with installing keyboard layouts themselves.</P>
<P>The issue in this case is when you try to save a keyboard as a .KLC file&nbsp;over a copy that already exists when it sits in a location that requires administrative access to do the delete (the delete, and the save, are being done as MSKLC is being shut down). MSKLC, which has no knowledge of the need to elevate in this case, is failing on deleting the file to make room for the new one. It did verify it would&nbsp;be able to do so, etc. as far as it knew, but in Vista the circumstances changed a bit.&nbsp;Oops. </P>
<P>This second one is a (somewhat) known problem related to the general lack of knowledge that MSKLC has about its environment when it is running on Vista, though losing changes that have been made is a very bad thing here, and it is a pretty serious problem because of the effect of losing the changes. It is true that MSKLC is not quite as helpless on x86 Vista as it is on 64-bit Vista, but it is also true that there are many gotchas that are going to require an update to address....</P>
<P>I do not have a specific timeframe for such an update, but I can say that it is all being discussed and figured out. And I will not be shy about talking about it when (a) there is something to talk about and (b) I am allowed to do so. :-) </P>
<P>In the meantime, if you are interested in MSKLC and in perhaps testing out such an update aimed at Vista issues like either the ones in this post or <STRONG><A href="http://archives.miloush.net/michkap/archive/2006/06/27/648723.html">this one</A></STRONG> or <STRONG><A href="http://archives.miloush.net/michkap/archive/2005/11/28/497320.html">this one</A></STRONG> or <STRONG><A href="http://archives.miloush.net/michkap/archive/2006/06/27/648618.html">this one</A></STRONG> or <A href="http://archives.miloush.net/michkap/archive/2005/10/06/477930.html"><STRONG>this one</STRONG></A>&nbsp;(or any other MSKLC under Vista or under 64-bit type of issue), then please feel free to send me a note via the <A href="http://archives.miloush.net/michkap/archive/2004/11/01/280092.html">Contacting&nbsp;Me...</A>&nbsp;link. It won't be a list of people being contacted immediately, but it won't be forgotten, either. :-)</P>
<P>&nbsp;</P>
<P><FONT color=#ff1493><EM>This post brought to you by</EM> <STRONG><FONT face="Microsoft Yi Baiti" size=6>ê€¦</FONT></STRONG> <EM>(<A href="http://www.fileformat.info/info/unicode/char/a026">U+a026</A>, a.k.a. YI SYLLABLE BOX)</EM></FONT></P></FONT>
<hr/><p><a id="754910" href="#754910">#</a> <strong>Michael Dunn_</strong> on 14 Sep 2006 7:17 PM:</p><div style="margin-left: 1em">The ReplaceFile() API might come in handy when doing the save, no? That would remove the need to do separate delete and save steps, and if an error happens doing the replace, the app can detect it and save the data elsewhere.</div>
<p><a id="754997" href="#754997">#</a> <strong>Michael S. Kaplan</strong> on 14 Sep 2006 8:31 PM:</p><div style="margin-left: 1em">Potentially, yes. Of course that is not happening now, and when fixing the work to do the elevate op will likely be the highest item on the list. :-)</div>
<p><a id="758616" href="#758616">#</a> <strong>Omi</strong> on 17 Sep 2006 2:22 AM:</p><div style="margin-left: 1em">Michael,<br>I cannot say MSKLC doesn't work in Vista at all. It works in the testing window dramatically.<br><br>:)<br><br>Omi</div>
<p><a id="758660" href="#758660">#</a> <strong>Michael S. Kaplan</strong> on 17 Sep 2006 3:11 AM:</p><div style="margin-left: 1em">Well, if you feel that is all you need then I shant argue the point. :-)</div>
<hr/><p><em>referenced by</em></p><div style="margin-left: 1em"><p>2006/11/17 <a href="http://archives.miloush.net/michkap/archive/2006/11/17/1097666.html">What happened on Thursday morning?</a></p></div><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2006/09/13/752377.html" title="Who would win in a fight between VK_DECIMAL and LOCALE_SDECIMAL?">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2006/09/12/750218.html" title="Converting, but not all at once?">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2006-09">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2006-09-13">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2006/09/13/752086.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:39 GMT -->
</html>