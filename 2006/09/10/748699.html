<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2006/09/10/748699.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:39 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>How are the file names encoded?</title></head><body>
<h1>How are the file names encoded?</h1>
<p><em>by Michael S. Kaplan, published on 2006/09/10 11:53 -04:00, original URI: http://blogs.msdn.com/b/michkap/archive/2006/09/10/748699.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<FONT face=Tahoma>
<P>So, the question that Dixon asked was: </P>
<BLOCKQUOTE dir=ltr style="MARGIN-RIGHT: 0px">
<P><FONT size="Times New Roman">Can you tell me how window XP encoding its filename/directory name? Is it already UTF-8? </FONT></P></BLOCKQUOTE>
<P>(I assume we are talking about NTFS here)</P>
<P>It is definitely not in UTF-8. </P>
<P>Furthermore, it is not in UCS-2, since you can have a filename with a supplementary character in it. </P>
<P>And it isn't in UTF-16, since it allows any sequence of unsigned short values which are not limited to valid Unicode characters and</P>
<P>So in one sense you could call it <STRONG>UTF-16 Plus</STRONG>&nbsp;since it basically adds a whole bunch of characters, though it is obviously less cool than actually using UTF-16 so perhaps it would be better to think of it as more of a <STRONG>UTF-16 Minus</STRONG>? </P>
<P>Or even better we just keep in mind that it isn't really a true Unicode encoding, just one that supports a lot of Unicode's characteristics and features and properties, while not really having a larger understanding of it....</P>
<P>&nbsp;</P>
<P><FONT color=#ff1493><EM>This post brought to you by</EM> <STRONG><FONT face=Code2001 size=6>êíÖ</FONT></STRONG> <EM>(<A href="http://www.fileformat.info/info/unicode/char/10485">U+10485</A>, a.k.a. OSMANYA LETTER KHA)</EM></FONT></P></FONT>
<hr/><p><a id="748962" href="#748962">#</a> <strong>Adam</strong> on 10 Sep 2006 6:54 PM:</p><div style="margin-left: 1em">&quot;[NTFS] allows any sequence of unsigned short values [as a filename]&quot;<br><br>Interesting. I've heard that NTFS and the NT kernel have much looser restrictions on things like filename and path length than the Win32 layer above them - so it wouldn't surprise me to know that they allow more characters also.<br><br>But I'd be surprised to find out that even 0x0000, 0x005c (\) and 0x002f (/) are allowed at the kernel/NTFS level. Even Unix systems disallow the bytes 0x00 and 0x2f in filenames.<br><br>However, I'm not sure about 0x0001 - 0x001F, 0x002a (*), 0x003f (?) and 0x007c (|). Do you have any idea which of these are allowed in filenames at the kernel/fs level? I know Win32 (and .NET) will barf on them all, but it'd be interesting to have an idea of which layer those restrictions are fundamentally at.</div>
<p><a id="749025" href="#749025">#</a> <strong>Michael S. Kaplan</strong> on 10 Sep 2006 8:53 PM:</p><div style="margin-left: 1em">There are specific characters that are disallowed at various levels for reasons that have very little to do with Unicode support, of course. I am not sure which ones are under Win32 and which are lower, though....</div>
<p><a id="749565" href="#749565">#</a> <strong>Tom Gewecke</strong> on 11 Sep 2006 11:23 AM:</p><div style="margin-left: 1em">Can you provide the url of any detailed explanation of the XP filename encoding system? &nbsp; It would be useful for me to compare it with the Mac system. &nbsp;Various compatibility issues arise when transferring files, some of which depend on normalization (OS X must have everything decomposed).</div>
<p><a id="749656" href="#749656">#</a> <strong>Michael S. Kaplan</strong> on 11 Sep 2006 12:32 PM:</p><div style="margin-left: 1em">I don't know of a URL, though I am working on a post to do here eventually and I can point you at that when it is done. :-)<br><br>NTFS does no Unicode normalization at all, which can definitely cause compat issues if you are transferring files between any system that does normalize, such as OS X.</div>
<p><a id="749746" href="#749746">#</a> <strong>Tom Gewecke</strong> on 11 Sep 2006 2:09 PM:</p><div style="margin-left: 1em">Thanks! &nbsp; The Mac info is found here, in case it's of interest:<br><br><a rel="nofollow" target="_new" href="http://developer.apple.com/technotes/tn/tn1150.html#UnicodeSubtleties">http://developer.apple.com/technotes/tn/tn1150.html#UnicodeSubtleties</a></div>
<p><a id="1176523" href="#1176523">#</a> <strong>Matt Seitz</strong> on 30 Nov 2006 2:47 AM:</p><div style="margin-left: 1em"><p>If NTFS allows any unsigned short, would it be more accurate to say that NTFS does not do any encoding? &nbsp;Should one instead say it is the Win32 subsystem which encodes and decodes characters as UTF-16, and then stores them in and reads them from the raw NTFS file name buffer?</p></div>
<p><a id="1176692" href="#1176692">#</a> <strong>Michael S. Kaplan</strong> on 30 Nov 2006 3:34 AM:</p><div style="margin-left: 1em"><P>Well, perhaps. I doubt I could convince anyone to update the documentation to say it that way, though. :-)</P></div>
<hr/><p><em>referenced by</em></p><div style="margin-left: 1em"><p>2006/12/05 <a href="http://archives.miloush.net/michkap/archive/2006/12/05/1212917.html">Validation of Unicode text is growing up</a></p><p>2006/09/24 <a href="http://archives.miloush.net/michkap/archive/2006/09/24/769540.html">NTFS and Unicode?</a></p></div><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2006/09/10/748742.html" title="Further proof that VkKeyScanEx sucks">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2006/09/06/742245.html" title="Why bother putting the size in the name if it&#39;s not always right?">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2006-09">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2006-09-10">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2006/09/10/748699.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:39 GMT -->
</html>