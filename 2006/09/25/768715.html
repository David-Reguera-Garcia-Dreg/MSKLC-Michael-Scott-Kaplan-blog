<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2006/09/25/768715.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:39 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>Why don't all the half forms sort right?</title></head><body>
<h1>Why don't all the half forms sort right?</h1>
<p><em>by Michael S. Kaplan, published on 2006/09/25 03:01 -04:00, original URI: http://blogs.msdn.com/b/michkap/archive/2006/09/25/768715.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<FONT face=Tahoma>
<P>George asked via the Contacting Me... link: </P>
<BLOCKQUOTE dir=ltr style="MARGIN-RIGHT: 0px">
<P><FONT size=2>I tried to use the Unicode method of creating half forms in Devanagari on Windows. It worked, but then once I did it the sorting seemed to not work correctly for the half form. What am I doing wrong?</FONT></P></BLOCKQUOTE>
<P>George, you did nothing wrong, this one is all us. </P>
<P>First, I should explain for everyone else what we are talking about, what you meant when you mentioned 'the Unicode method of creating half forms in Devanagari'.</P>
<P>It starts with U+200c and U+200d, the ZERO WIDTH NON-JOINER and ZERO-WIDTH JOINER that I have discussed <A href="http://archives.miloush.net/michkap/archive/2006/02/15/532394.html"><STRONG>previously</STRONG></A>, and the effect that these characters can have in Indic scripts. </P>
<P>The effect is best described in the Unicode FAQ on Indic Scripts and Languages and its question #17 (<A href="http://www.unicode.org/faq/indic.html#17">I cannot find on Unicode charts the "half forms" of Devanagari letters (or any other Indic script). These characters are needed to form words such as "patni".</A>)</P>
<P>The three forms, which you will be able to see if you have a conformant browser are:</P>
<BLOCKQUOTE dir=ltr style="MARGIN-RIGHT: 0px"><FONT face="Consolas,Courier New" size=2>
<P><STRONG><FONT size=4>त्न</FONT></STRONG>&nbsp;&nbsp;<A href="http://www.fileformat.info/info/unicode/char/0924">U+0924</A> <A href="http://www.fileformat.info/info/unicode/char/094d">U+094d</A> <A href="http://www.fileformat.info/info/unicode/char/0928">U+0928</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -- Devanagari <STRONG>tna</STRONG> using the <STRONG>tna</STRONG> ligature</P>
<P><STRONG><FONT size=4>त्‍न</FONT></STRONG> <A href="http://www.fileformat.info/info/unicode/char/0924">U+0924</A> <A href="http://www.fileformat.info/info/unicode/char/094d">U+094d</A> <A href="http://www.fileformat.info/info/unicode/char/200d">U+200d</A> <A href="http://www.fileformat.info/info/unicode/char/0928">U+0928</A> -- Devanagari <STRONG>tna</STRONG> with a half <STRONG>ta</STRONG> and a full <STRONG>na</STRONG></P>
<P><STRONG><FONT size=4>त्‌न</FONT></STRONG> <A href="http://www.fileformat.info/info/unicode/char/0924">U+0924</A> <A href="http://www.fileformat.info/info/unicode/char/094d">U+094d</A> <A href="http://www.fileformat.info/info/unicode/char/200c">U+200c</A> <A href="http://www.fileformat.info/info/unicode/char/0928">U+0928</A> -- Devanagari <STRONG>tna</STRONG> with a full <STRONG>ta</STRONG>, a visible virama, and a full <STRONG>na</STRONG></P></FONT></BLOCKQUOTE>
<P>&nbsp;&nbsp;&nbsp;(if you don't see three different forms then you can look at that Unicode FAQ link)</P>
<P>So that part is easy enough. </P>
<P>And one part of the collation story on Windows -- the fact that both ZERO WIDTH NON-JOINER and ZERO WIDTH JOINER both are characters that <STRONG><A href="http://archives.miloush.net/michkap/archive/2005/01/18/355210.html">intentionally have no weight</A></STRONG>, is also there, as one would expect.</P>
<P>The place where all is not perfectly well is in the compression part -- and there are many defined compressions for languages like Hindi when consonants and independent vowels combine with Candrabindu, Anusvara, Visarga, and Nukta. George must have been trying to get a half form with one of these compression cases like with a nukta, which will work, although it will make it sort in a slightly incorrect way. :-(</P>
<P>As luck would have it, this is not going to be a very common problem since it will sort very close to where it should be and you would only notice the difference if you were doing a test for equality or had do many entries all together (like in a dictionary) where such differences are more easily noticed....</P>
<P>Good catch, George! Of course since the fix for this would require changing the results of strings that valid according to the <A href="http://msdn.microsoft.com/library/en-us/intl/nls_19ev.asp">IsNLSDefinedString</A> function, it would mean a major version change (even if only for specific locales like the Indic ones). Which is the kind of change that can only usually be done in a major version. Really too late for Vista, but this is definitely something to look at for next version....</P>
<P>(In my mind this counts as the sort of bug that I am sorry to see us ship, though I understand why it happened; it solidified in my mind the importance of our close engagement with the Unicode Standard!)</P>
<P>&nbsp;</P>
<P><EM><FONT color=#ff1493>This post brought to you by</EM> <A href="http://www.fileformat.info/info/unicode/char/200c">U+200c</A> <EM>and</EM> <A href="http://www.fileformat.info/info/unicode/char/200d">U+200d</A> <EM>(a.k.a. ZERO WIDTH NON-JOINER and ZERO WIDTH JOINER)</FONT></EM></P></FONT>
<hr/><div style="margin-left: 1em"><em>no comments</em></div><hr/><p><em>referenced by</em></p><div style="margin-left: 1em"><p>2010/10/08 <a href="http://archives.miloush.net/michkap/archive/2010/10/08/10073124.html">Off by one what, exactly?</a></p><p>2010/07/16 <a href="http://archives.miloush.net/michkap/archive/2010/07/16/10038421.html">Which form to use if the form keeps changing?</a></p><p>2007/12/16 <a href="http://archives.miloush.net/michkap/archive/2007/12/16/6781186.html">Why my IUC31 talks were presented on Vista (even though running on a MacBook Pro)</a></p><p>2007/08/26 <a href="http://archives.miloush.net/michkap/archive/2007/08/26/4570979.html">Blame Kannada! (ಕನ್ನಡ)</a></p></div><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2006/09/25/771330.html" title="And then came Inuktitut (ᐃᓄᒃᑎᑐᑦ)">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2006/09/25/768648.html" title="&#39;Cette phrase en français est difficile à traduire en anglais&#39;">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2006-09">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2006-09-25">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2006/09/25/768715.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:39 GMT -->
</html>