<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2006/09/28/774957.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:39 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>If you just don't think you can hold it (64-bit style!)</title></head><body>
<h1>If you just don't think you can hold it (64-bit style!)</h1>
<p><em>by Michael S. Kaplan, published on 2006/09/28 06:01 -07:00, original URI: http://blogs.msdn.com/michkap/archive/2006/09/28/774957.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostOld -->
<FONT face=Tahoma>
<P>I can actually say <STRONG><A href="http://archives.miloush.net/michkap/archive/2006/01/26/517728.html">again</A></STRONG> and <STRONG><A href="http://archives.miloush.net/michkap/archive/2005/06/17/430391.html">again</A></STRONG> and <STRONG><A href="http://archives.miloush.net/michkap/archive/2005/08/05/448006.html">again</A></STRONG> and <STRONG><A href="http://archives.miloush.net/michkap/archive/2005/10/06/477930.html">again</A></STRONG> that although 64-bit keyboards are important to Microsoft and to the GIFT team and how there will be an update at some point that it has not happened just yet....</P>
<P>The truth is that sometimes, some people just don't want to wait. </P>
<P>I just got email from such a person yesterday, in fact! :-)</P>
<P><A href="http://levicki.blogspot.com/">Igor Levicki</A> is&nbsp;that person, and in his post (<A href="http://levicki.blogspot.com/2006/09/how-to-build-keyboard-layouts-for.html">How to build keyboard layouts for Windows x64?</A>) he describes his spluenking efforts to find the 64-bit support that was partially completed but not yet&nbsp;finished in the <A href="http://www.microsoft.com/globaldev/tools/msklc.mspx">Microsoft Keyboard Layout Creator</A> (and as he noticed we did not ship the cross-compilers since we weren't supporting the&nbsp;platforms yet&nbsp;anyway!).</P>
<P>Now of course the real support plan will include the real setup, and will also include the WOW64 dll as well (Mr Levicki's does not, which will cause some headaches for 32-bit applications running on 64-bit). Also the version of the tools we would have shipped would have worked okay with the original settings, meaning that Igor figured out the diffs needed for the later tools, as well.</P>
<P><STRONG>Note to&nbsp;anyone from Microsoft who is reading this</STRONG>:&nbsp;someone may want to try and find out if&nbsp;Mr.&nbsp;Levicki&nbsp;might want to look into interviewing with&nbsp;Microsoft.</P>
<P><STRONG>And note to&nbsp;Igor Levicki</STRONG> -- if we ever find ourselves in the same (or a similar) place, let me know. I'd love to buy you&nbsp;a drink and we&nbsp;maybe talk about some of the cooler aspects your efforts! :-)</P>
<P>&nbsp;</P>
<P><FONT color=#ff1493><EM>This post brought to you by</EM> <STRONG><FONT face="Arial Unicode MS,MS UI Gothic,Code2000" size=6>♔</FONT></STRONG> <EM>(<A href="http://www.fileformat.info/info/unicode/char/2654">U+2654</A>, a.k.a. WHITE CHESS KING)</EM></FONT></P></FONT>
<hr/><p><a id="775503" href="#775503">#</a> <strong>Centaur</strong> on Thursday, September 28, 2006 10:35 AM:</p><div style="margin-left: 1em">That’s a pretty impressive bit of reverse engineering. You might want to include this into the MSKLC documentation, as an “unofficial guide”, until there is a universal 32/64-bit version.</div>
<p><a id="775541" href="#775541">#</a> <strong>Michael S. Kaplan</strong> on Thursday, September 28, 2006 11:04 AM:</p><div style="margin-left: 1em">Hi Centaur, <br><br>The docs would not be updated until the tool is, and when that happens the functionality will be built in....</div>
<p><a id="776459" href="#776459">#</a> <strong>Igor</strong> on Thursday, September 28, 2006 11:02 PM:</p><div style="margin-left: 1em">Michael,<br><br>I am glad you liked my article. Feel free to send me an email if you have some spare time and we can disscuss whatever details you want. I would like to hear about wow64.dll and those &quot;headaches for 32-bit applications&quot; if it is not classified of course.<br><br>About the possible interview, I certainly wouldn't mind.<br><br>I am a software engineer and I am sort of a low-level guy. I work with C, considerably less with C++, and quite a lot with x86 assembler. I am familiar with all SIMD extensions up to SSE4 and with 64-bit ABI and register calling convention.<br><br>Code optimization is usually the kind of work I do for hire over Internet:<br><a rel="nofollow" target="_new" href="http://www.intel.com/cd/ids/developer/asmo-na/eng/dc/code/languages/194751.htm">http://www.intel.com/cd/ids/developer/asmo-na/eng/dc/code/languages/194751.htm</a><br><br>I also love reverse-engineering (you learned about that already) so disassembler and debugger are some of my favorite tools.<br><br>About that drink, I will remember your kind offer if we ever meet in person. In the meantime, have fun reading this article:<br><br><a rel="nofollow" target="_new" href="http://levicki.blogspot.com/2006/01/annoying-windows-xp-feature-aka-make.html">http://levicki.blogspot.com/2006/01/annoying-windows-xp-feature-aka-make.html</a><br><br>Have a nice day.<br></div>
<p><a id="776511" href="#776511">#</a> <strong>Michael S. Kaplan</strong> on Friday, September 29, 2006 12:30 AM:</p><div style="margin-left: 1em">Ah, the WOW64 problem is briefly discussed here in <STRONG><A href="http://archives.miloush.net/michkap/archive/2005/10/06/477930.html">this post</A></STRONG> -- it is the need for keyboard DLLs (just like kernel32.dll and a few select other binaries) that need a 64-bit pointer representation in a 32-bit binary to work properly....</div>
<p><a id="776518" href="#776518">#</a> <strong>igor_levicki</strong> on Friday, September 29, 2006 12:45 AM:</p><div style="margin-left: 1em">Ah but I solved it unintentionaly!!!<br><br>I compiled a 32-bit DLL and put it there but when I was disassembling one of the shipped layouts to find the correct base address for linker I noticed that the exported function differs by one instruction:<br><br>.data:5FFF2188 ; __stdcall KbdLayerDescriptor()<br>.data:5FFF2188 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; public _KbdLayerDescriptor@0<br>.data:5FFF2188 _KbdLayerDescriptor@0 proc near<br>.data:5FFF2188 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mov &nbsp; &nbsp; eax, offset off_5FFF2090<br>.data:5FFF218D &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cdq<br>.data:5FFF218E &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; retn<br>.data:5FFF218E _KbdLayerDescriptor@0 endp<br><br>It was the CDQ (Convert Double to Quad) and I figured out that mine should have it too so I just patched the DLL I made with a hex editor and fixed its checksum by a tool I wrote for that purpose some time ago.<br><br>In the end it would probably work without patching depending on the contents of the EDX register on entry to exported function. CDQ just sign extends EAX into EDX:EAX thus returning 64-bit pointer whose high part is always zero in this case.<br><br>I guess that now I will have to update the post.<br></div>
<p><a id="776600" href="#776600">#</a> <strong>Michael S. Kaplan</strong> on Friday, September 29, 2006 2:32 AM:</p><div style="margin-left: 1em">That does indeed take care of the issue. :-) <br><br>Though of course it will not scale as a generic solution, at least not as effectively as doing it as part of the compilation/link process.... <br><br>You can actually see the same types of differences (only many more of them) if you compare system32\kernel32.dll with syswow64\kernel32.dll. Thankfully keyboards are much simpler to deal with, though.</div>
<p><a id="777008" href="#777008">#</a> <strong>igor_levicki</strong> on Friday, September 29, 2006 11:47 AM:</p><div style="margin-left: 1em">Well, because I hate to leave things half-finished I dug out the right way to deal with that issue during compilation :)<br><br>It is just a matter of compiling using 32-bit compiler with -DBUILD_WOW6432.<br><br>So now I have the complete solution.<br></div>
<p><a id="777145" href="#777145">#</a> <strong>Michael S. Kaplan</strong> on Friday, September 29, 2006 1:25 PM:</p><div style="margin-left: 1em">Yep, that's the change. Perfect!</div>
<p><a id="777170" href="#777170">#</a> <strong>igor_levicki</strong> on Friday, September 29, 2006 1:46 PM:</p><div style="margin-left: 1em">I have updated the post to include the complete solution:<br><br><a rel="nofollow" target="_new" href="http://levicki.blogspot.com/2006/09/how-to-build-keyboard-layouts-for.html">http://levicki.blogspot.com/2006/09/how-to-build-keyboard-layouts-for.html</a><br><br>Now if I only knew how to add the new layout to the registry without having to replace an existing one...<br></div>
<p><a id="777188" href="#777188">#</a> <strong>Michael S. Kaplan</strong> on Friday, September 29, 2006 1:54 PM:</p><div style="margin-left: 1em">That last part likely needs the MSKLC update itself, I think (the logic in the setup custom action that adds the reg. keys and such). But the hard part of the dev. end of this is covered in your solution....<br><br>The setup solution is surmountable but takes a little thought (building a setup that can install both 64-bit and 32-bit components is a bit of a challenge, but it is not impossible to do!).</div>
<p><a id="777218" href="#777218">#</a> <strong>igor_levicki</strong> on Friday, September 29, 2006 2:21 PM:</p><div style="margin-left: 1em">I know how to disable System folder redirection using API from 32-bit APP so I could even write a setup but I don't know which keys I need to add (depends on the layout language id I guess).<br></div>
<p><a id="777231" href="#777231">#</a> <strong>Michael S. Kaplan</strong> on Friday, September 29, 2006 2:33 PM:</p><div style="margin-left: 1em">I was actually thinking more about doing it in the Windows Installer... creating a single setup that would include all for keyboard layout DLLs, install the correct ones based on platform and add the reg keys. :-)</div>
<p><a id="777242" href="#777242">#</a> <strong>igor_levicki</strong> on Friday, September 29, 2006 2:42 PM:</p><div style="margin-left: 1em">Well, I would leave that up to you Michael. I haven't dealt with Windows Installer yet (although I am familiar with Orca).</div>
<p><a id="778999" href="#778999">#</a> <strong>Michael S. Kaplan</strong> on Sunday, October 01, 2006 12:43 AM:</p><div style="margin-left: 1em">And Igor, if you were looking for info on why defining BUILD_WOW6432 changes what it does, you can see the following at the top of kbd.h: <BR><BR><FONT face="Consolas,Courier New">#if defined(BUILD_WOW6432) <BR>&nbsp; &nbsp;#define KBD_LONG_POINTER __ptr64 <BR>#else <BR>&nbsp; &nbsp;#define KBD_LONG_POINTER <BR>#endif </FONT><BR><BR>And it all comes together.... :-)</div>
<p><a id="779572" href="#779572">#</a> <strong>igor_levicki</strong> on Sunday, October 01, 2006 11:55 AM:</p><div style="margin-left: 1em">Yes and you could have read that in my post two days ago ;-)<br></div>
<p><a id="779808" href="#779808">#</a> <strong>Michael S. Kaplan</strong> on Sunday, October 01, 2006 3:22 PM:</p><div style="margin-left: 1em">Heh, that is true -- I had not read the update yet. You did have the info there already! :-)</div>
<p><a id="780144" href="#780144">#</a> <strong>igor_levicki</strong> on Sunday, October 01, 2006 8:47 PM:</p><div style="margin-left: 1em">There is one more thing here completely unrelated to the layouts but nevertheless very interesting.<br><br>As far as I know any 32-bit user mode code usually doesn't get base address above 2GB so I guess it would it be safe to assume (for those thunking DLLs in SYSWOW64 at least) that the __ptr64 is unsigned?<br><br>It means that for user mode code simple XOR EDX, EDX would suffice instead of a bit slower CDQ which does sign instead of zero extension to 64 bits.<br><br>Anyway, memory pointers should be treated as unsigned, right? I believe that maybe Kevin Frei and his team would like to think about this for a while. If not, then at least I would like to find out the logic behind it. Can't help myself with this inquiring mind :)<br></div>
<p><a id="780147" href="#780147">#</a> <strong>Michael S. Kaplan</strong> on Sunday, October 01, 2006 8:54 PM:</p><div style="margin-left: 1em">Another excellent question that I remember asking back in the day. :-) <br><br>Actually, these DLLs are loaded in kernel mode by the userk subsystem, so they can indeed end up with base addresses above the user mode boundary.... <br><br>In theory, since all they do is export a function that takes a struct, all of this could be re-archirected to be handled in a very different way that would not have such semi-unique requirements. But that would break backcompat with all existing layouts (which has never been explicitly promised but without a convincing reason I doubt they would ever be willing to break, especially with MSKLC out there).</div>
<p><a id="780154" href="#780154">#</a> <strong>igor_levicki</strong> on Sunday, October 01, 2006 9:07 PM:</p><div style="margin-left: 1em">Hmm...<br>But there is no point in sign-extending a pointer?<br>If you have 0x8123ABCD by sign-extending it you will get 0xFFFFFFFF8123ABCD which is not exactly a valid address anywhere, right?<br></div>
<p><a id="780159" href="#780159">#</a> <strong>Michael S. Kaplan</strong> on Sunday, October 01, 2006 9:17 PM:</p><div style="margin-left: 1em">Well, we have to assume that the code on both sides knows how to handle the sign extension as needed. <br><br>I wish that they had never made the pointer type signed, myself. It makes everything much more complicated....</div>
<p><a id="780163" href="#780163">#</a> <strong>Michael S. Kaplan</strong> on Sunday, October 01, 2006 9:24 PM:</p><div style="margin-left: 1em">Also, you can look at my post <STRONG><A href="http://archives.miloush.net/michkap/archive/2006/08/01/684909.html">32 bit vs. 64 bit HKLs?</A></STRONG> for more info here....</div>
<p><a id="780165" href="#780165">#</a> <strong>igor_levicki</strong> on Sunday, October 01, 2006 9:26 PM:</p><div style="margin-left: 1em">Having signed pointers is downright crazy and I must admit that I can't understand a logic (if any?) behind that.<br><br>I really must remember to ask Kevin why __ptr64 is signed.<br></div>
<p><a id="780177" href="#780177">#</a> <strong>Michael S. Kaplan</strong> on Sunday, October 01, 2006 9:34 PM:</p><div style="margin-left: 1em">Probably to be consistent with the 32 bit pointer (which is also signed). <br><br>Which leads to the real question -- why did they make the 32-bit pointer signed? That just leads to later insanity!</div>
<p><a id="780179" href="#780179">#</a> <strong>igor_levicki</strong> on Sunday, October 01, 2006 9:37 PM:</p><div style="margin-left: 1em">I checked that out. It is crazy and even though it is not a bug it is a bad design which fosters errors.<br><br>For example, if you have some API which returns -1 on failure and other valid return values get sign extended all applications which did this:<br><br>rv = SomeAPI();<br>if (rv &lt; 0) { // instead of explicitly comparing rv to -1<br> &nbsp; &nbsp;fail();<br>} else {<br> &nbsp; &nbsp;pass();<br>}<br><br>will start to fail randomly if they get sign extended values.<br></div>
<p><a id="780181" href="#780181">#</a> <strong>Michael S. Kaplan</strong> on Sunday, October 01, 2006 9:41 PM:</p><div style="margin-left: 1em">Agree++ on that. Not to mention that sign extension is not well understood enough to doc in a non-confusing way for most developers -- so there is no easy way to educate people out of it....</div>
<p><a id="780188" href="#780188">#</a> <strong>igor_levicki</strong> on Sunday, October 01, 2006 9:49 PM:</p><div style="margin-left: 1em">Well, Google is our friend.<br>Read this for an explanation, (and some wise comments why it is bad idea too):<br><a rel="nofollow" target="_new" href="http://blogs.msdn.com/texblog/archive/2005/10/31/487436.aspx">http://blogs.msdn.com/texblog/archive/2005/10/31/487436.aspx</a></div>
<p><a id="780229" href="#780229">#</a> <strong>igor_levicki</strong> on Sunday, October 01, 2006 10:30 PM:</p><div style="margin-left: 1em">And this shows the results of a bad design --whoever thought out __ptr64 (which is non-standard anyway) should get his Darwin reward now:<br><a rel="nofollow" target="_new" href="http://www.thrashmaster.com/home/?p=3">http://www.thrashmaster.com/home/?p=3</a><br></div>
<p><a id="780335" href="#780335">#</a> <strong>Michael S. Kaplan</strong> on Sunday, October 01, 2006 11:48 PM:</p><div style="margin-left: 1em">Hey, no argument from me. :-) <br><br>It seems slightly worse from managed code (to me) mainly because it is even less well-documented there. But it is easy to end up with bugs all the way around, I agree.</div>
<p><a id="780398" href="#780398">#</a> <strong>igor_levicki</strong> on Monday, October 02, 2006 12:57 AM:</p><div style="margin-left: 1em">Sorry for &quot;arguing&quot; with you about this when you said you agree but I just can't believe that someone decided to make pointers signed instead of changing HWND_TOPMOST to something other than -1. That is what I would call a serious value system disorder.</div>
<p><a id="780407" href="#780407">#</a> <strong>Michael S. Kaplan</strong> on Monday, October 02, 2006 1:05 AM:</p><div style="margin-left: 1em">I understand, and I agree with you. But there isn't much I personally can do about it. :-)<br><br>FWIW, I'm also not 100% convinced that this was the only reason. I think it was an example of a more widespread tendency that predated 64-bit computing. It is still a bad thing in my opinion, but oit's a bit late to do anything about it now.</div>
<p><a id="780815" href="#780815">#</a> <strong>Igor</strong> on Monday, October 02, 2006 10:39 AM:</p><div style="margin-left: 1em">Michael,<br/>When we are at the subject of 64 bits, I have few questions because documentation is vague:<br/><br/>Wow64DisableWow64FsRedirection()<br/><br/>1. Does this API really disable redirection just for the calling thread or for the process (or for the calling threads and all the threads created after the call to the above API)?<br/>2. Does calling the above API affect LoadLibrary() in any way?<br/><br/>This is really important to know.</div>
<p><a id="781080" href="#781080">#</a> <strong>Michael S. Kaplan</strong> on Monday, October 02, 2006 1:09 PM:</p><div style="margin-left: 1em"><p>Not my area, but as far as I know Wow64DisableWow64FsRedirection is per thread only. </p>
<p>My understanding is that it will affect all file system stuff run in the thread, though I haven't tested it extensively....</p></div>
<p><a id="786131" href="#786131">#</a> <strong>Igor</strong> on Tuesday, October 03, 2006 11:48 AM:</p><div style="margin-left: 1em">Houston, we have a problem.<br/><br/>I have tested it and here is what happens.<br/><br/>If you have an application such as file manager which uses plugins and it is 32-bit and it doesn't have any benefits from going 64-bit, it would be nice to turn the filesystem redirection off at the process start so that user can manipulate files in real system32 folder and not in syswow64.<br/><br/>Now suppose I load the plugin dll from the file manager and then call an exported function from the plugin.<br/><br/>If the plugin has a code snippet like this one:<br/><br/>	HMODULE	my_dll;<br/>	TCHAR	szPath[MAX_PATH];<br/><br/>	GetSystemDirectory(szPath, MAX_PATH);<br/><br/>	_tcscat(szPath, _T("\\my_dll.dll"));<br/><br/>	my_dll = LoadLibrary(szPath);<br/><br/>IT WILL FAIL!!!<br/><br/>Why? Because GetSystemDirectory() doesn't honor the redirection state.<br/><br/>Now you can argue that:<br/><br/>1. Redirection is supposed to be restored immediately after you obtain a handle<br/>2. GetSystemDirectory() is obsolete<br/><br/>But in reality:<br/><br/>1. It would be too complicated to turn it on and off all the time before you call any plugin.<br/>2. Is not in the code you have any influence over.<br/><br/>So, I suggest a fix for this:<br/><br/>Make GetSystemDirectory() honor redirection state:<br/><br/>If in 64-bit process:<br/>- always return \windows\System32<br/><br/>If in 32-bit process, redirection on:<br/>- return \windows\System32<br/><br/>If in 32-bit process, redirection off:<br/>- return \windows\Syswow64</div>
<p><a id="786178" href="#786178">#</a> <strong>Michael S. Kaplan</strong> on Tuesday, October 03, 2006 12:09 PM:</p><div style="margin-left: 1em"><p>Of course, we are getting more than a little bit off-topic, but anyone who is writing a 32-bit file manager that they expect to run on 64-bit windows with naught but minimal changes actually knows exactly where the source of problems is, if they put their mind to it. :-) </p>
<p>But I am not an expert in 64-bit programming issues, so its just my [limited] opinion....</p></div>
<p><a id="792880" href="#792880">#</a> <strong>Igor</strong> on Thursday, October 05, 2006 1:25 AM:</p><div style="margin-left: 1em"><P><STRONG><FONT color=#ff0000>[EDITED to add some line breaks to the continuous paragraph submitted --michkap]</FONT></STRONG></P>
<P>Sorry for that offtopci, I have contacted Raymond and he promised to forward this to the right team. I just hope they won't turn the blind eye on it. <BR><BR>There are five obvious solutions I could come up on such a short notice: </P>
<OL>
<LI>Turn redirection off, get a handle to system32, then turn it back on. Use the handle as needed later. But what if the \Windows is on a network share and the connection is lost? </LI>
<LI>Call Wow64DisableWow64FsRedirection() before each plugin call and re-enable it afterwards. Even though Microsoft originally intended the API to be used that way (e.g. disable/get handle/enable) that is not good solution performance wise. What if you need to call plugin function numerous times for example to enumerate files in a large folder? You will waste cycles by turning redirection on and off. You will also have to keep track from which thread you called it and if user attempts to change into system32 while plugin is doing say background archiving he may end up either in system32 or in syswow64.</LI>
<LI>Use separate thread to call plugins. Although better, it is not practical to implement and it may require quite a lot of synchronisation code to be added.</LI>
<LI>Ask plugin authors to remove GetSystemDirectory references. Not practical and in some cases not possible. </LI>
<LI>Have Microsoft fix the GetSystemDirectory() to honor redirection state and when redirection is _off_ return \Windows\SysWow64 instead of \windows\System32. </LI></OL>
<P>IMO #5 would be the best and even righteous solution because it seems like they forgot about GetSystemDirectory() when they invented redirection. I believe someone should be thanking me for pointing that out ;) </P></div>
<p><a id="792893" href="#792893">#</a> <strong>Michael S. Kaplan</strong> on Thursday, October 05, 2006 1:38 AM:</p><div style="margin-left: 1em"><p>I certainly wouldn't mind forwarding it on myself, but I honestly doubt they could change the behavior without breaking apps that are relying on what happens now. Once you have established a function's behavior, changing it is guaranteed to break someone....</p></div>
<p><a id="794313" href="#794313">#</a> <strong>Igor</strong> on Thursday, October 05, 2006 2:20 PM:</p><div style="margin-left: 1em">>EDITED to add some line breaks to the continuous paragraph submitted --michkap<br/><br/>Not my fault Michael, I use paragraph breaks but this box is ignoring them somehow.</div>
<p><a id="839149" href="#839149">#</a> <strong>Partybwal</strong> on Wednesday, October 18, 2006 11:05 AM:</p><div style="margin-left: 1em"><p>So, when can I expect to be able to use my custom keyboard layout in x64? It's a variant of Dvorak with swedish letters.</p>
<p>I could fix it myself, if only MSKLC would build 64-bit compatible layouts. But since x64 ships with lots of layouts, howcome there is no such tool, or even just a converter? How did MS create them?</p></div>
<p><a id="839236" href="#839236">#</a> <strong>Michael S. Kaplan</strong> on Wednesday, October 18, 2006 11:31 AM:</p><div style="margin-left: 1em"><p>Hi Partybawl, </p>
<p>I have already the answered the 'when' question in this blog more times than one could really count, at least as much as I can. It is important, and as Igor proved the underlying tools can and do support the notion, but the integrated experience is not available yet.... </p></div>
<hr/><p><em>referenced by</em></p><div style="margin-left: 1em"><p>2012/08/16 <a href="http://archives.miloush.net/michkap/archive/2012/08/16/10340297.html">In the land of the unsupported, previous blogs and tools can be king</a></p><p>2010/05/04 <a href="http://archives.miloush.net/michkap/archive/2010/05/04/10003033.html">The wacky world of WOW64 keyoards, un-leashed, un-locked, un-something-or-other</a></p><p>2008/03/10 <a href="http://archives.miloush.net/michkap/archive/2008/03/10/8120567.html">What's wrong with one of GetNumberFormat's callers? And what's wrong with GetNumberFormat?</a></p></div><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2006/09/29/776495.html" title=".NET is too busy being consistent with Windows to be consistent with itself....">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2006/09/28/774885.html" title="When they move everything around and change the signs">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2006-09">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2006-09-28">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2006/09/28/774957.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:39 GMT -->
</html>