<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2006/10/05/792859.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:39 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>Why Michael's cool keyboard doesn't work</title></head><body>
<h1>Why Michael's cool keyboard doesn't work</h1>
<p><em>by Michael S. Kaplan, published on 2006/10/05 00:11 -07:00, original URI: http://blogs.msdn.com/michkap/archive/2006/10/05/792859.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostOld -->
<FONT face=Tahoma size=3>
<P>The question Abdul asked me (via the Contact link) was: </P><FONT face="Times New Roman,Times" size=2>
<BLOCKQUOTE>
<P>Sir, I installed msklc after severe frustration as you know it requires v1.1 of .net, even if v2.0 is installed. I knew this after much time.<BR><BR>Now I created the first ever keyboard for Siraiki language (spoken by 14m people in pakistan, which is part of Unicode v5.0). But when i build the dll and setup package, it builds the dll but not the windows installer package, saying "keyboard layout creator was unable to create the windows installer package".<BR><BR>I searched the net for help regarding this error message, but in vain. I hope you are the only person who can help.<BR><BR>Thanks in anticipation of reply!</P></BLOCKQUOTE></FONT>
<P mce_keep="true">First let me apologize about <STRONG><A class="" href="http://archives.miloush.net/michkap/archive/2006/06/27/648723.html" mce_href="http://archives.miloush.net/michkap/archive/2006/06/27/648723.html">that 1.1/2.0 thing</A></STRONG>, I can promise you that it is high on the list of things I am nagging people about these days (my very next opportunity to do so is mere hours away!).</P>
<P mce_keep="true">Now there are very few things that can cause the attempt to build the setup package to fail (all it is doing is running a series of queries to insert the needed rows into the .MSI file). In&nbsp;fact, assuming you are not trying to build the file into a read-only location and&nbsp;without seeing the <A class="" href="http://www.microsoft.com/globaldev/tools/msklc.mspx" mce_href="http://www.microsoft.com/globaldev/tools/msklc.mspx">MSKLC</A> file (and trying to channel some of Raymond's powers of psychic debugging!), the only thing I can think of would be&nbsp;a string be added from this dialog:</P>
<P mce_keep="true"><IMG src="http://trigeminal.fmsinc.com/images/KbdProps.png">&nbsp;</P>
<P mce_keep="true">that contains a ' (U+0027, a.k.a. APOSTROPHE)&nbsp;and thus when the attempt was made to insert the row into the Windows Installer database file (the .MSI file), the insert that unfortunately did not properly escape the character failed and returned this error:</P>
<P mce_keep="true"><IMG src="http://trigeminal.fmsinc.com/images/KbdError.png"></P>
<P mce_keep="true">A better error message would be nice here, of course.</P>
<P mce_keep="true">Better validation that warned of the actual problem would be even nicer.</P>
<P mce_keep="true">And proper escaping of these characters to let the insert succeed and the layout build would be the nicest thing that could happen....</P>
<P mce_keep="true">Anyway, assuming this is the problem, sorry about this one too. If this isn't it, I need to know a bit more about this keyboard, and possibly get a copy of the .KLC file (let me know if your trouble is not being caused by the above)....</P>
<P mce_keep="true"><EM><FONT size=2>(Credit also to Erich Barnstedt in Ireland, who separately reported the same problem in the not too distant past and reactivated the bug report that had been closed after this bug had been fixed a long time ago but apparently regressed! However, Abdul's scenario of a <A class="" href="http://www.ethnologue.com/show_language.asp?code=skr" mce_href="http://www.ethnologue.com/show_language.asp?code=skr">Seraiki</A> (a.k.a. Siraiki) keyboard is a much more interesting one to me!)</FONT></EM></P>
<P mce_keep="true">&nbsp;</P>
<P mce_keep="true"><FONT color=#ff00ff><EM>This post brought to you by</EM> <STRONG><FONT size=4>'</FONT></STRONG> <EM>(<A class="" href="http://www.fileformat.info/info/unicode/char/0027" mce_href="http://www.fileformat.info/info/unicode/char/0027">U+0027</A>, a.k.a. APOSTROPHE)</EM></FONT></P></FONT>
<hr/><p><a id="793987" href="#793987">#</a> <strong>Heath Stewart</strong> on Thursday, October 05, 2006 11:40 AM:</p><div style="margin-left: 1em"><p>You'll have a problem if you're using MsiDatabaseOpenView to pass in the SQL-like expressions: you can't escape single quotes. Instead, you have to select or (or a single, depending on what you do next) records from the table using MsiDatabaseOpenView, then construct a record using MsiCreateRecord with the right number of fields - including your text with the single quote - then use MsiViewModify to &quot;set&quot; the record in your view.</p></div>
<p><a id="794222" href="#794222">#</a> <strong>Michael S. Kaplan</strong> on Thursday, October 05, 2006 1:13 PM:</p><div style="margin-left: 1em"><p>Believe it or not, the MsiCreateRecord route is mostly what we use now, for unrelated reasons. I think these ones were just missed? </p>
<p>And, since we fixed the problem at one point, some other change re-introduced it and the regression was not caught. </p>
<p>Something to fix for next time, I suppose. :-)</p></div>
<p><a id="794620" href="#794620">#</a> <strong>Björn</strong> on Thursday, October 05, 2006 4:56 PM:</p><div style="margin-left: 1em"><p>(Hijacking an sort of unrelated entry)</p>
<p>While reading this entry the particles of inspiration hit me: why not try to &quot;fix&quot; the keyboard mapping of my notebook to a) get rid of the caps lock key a b) get an easier to reach &quot;Context menu&quot; key (the original one is located atop of the F9 key), just to find out that neither seems possible.</p>
<p>So, these questions arose:</p>
<p>1) Is it possible to deactivate the caps lock key through MSKLC or if not, is there another (easy) way to get rid of it?</p>
<p>2) Can one utilize non standard keys (my laptop [like many other] has an extra Fn key) in MSKLC? Or do I need to hack a custom keyboard driver to get Fn+Left Alt send the WM_CONTEXTMENU message?</p></div>
<p><a id="794623" href="#794623">#</a> <strong>Björn</strong> on Thursday, October 05, 2006 5:00 PM:</p><div style="margin-left: 1em"><p>I should have read [1] before posting the above comment. It pretty much looks like I need to do my own keyboard thingy :)</p>
<p>[1] <a rel="nofollow" target="_new" href="http://archives.miloush.net/michkap/archive/2005/08/05/448225.html">http://blogs.msdn.com/michkap/archive/2005/08/05/448225.aspx</a></p></div>
<p><a id="795005" href="#795005">#</a> <strong>Dean Harding</strong> on Thursday, October 05, 2006 8:42 PM:</p><div style="margin-left: 1em"><p>Bj&#246;rn: I'm not a fan of caps lock either. I never use it, and I always seem to inadvertently hit it...</p></div>
<p><a id="796386" href="#796386">#</a> <strong>Björn</strong> on Friday, October 06, 2006 9:57 AM:</p><div style="margin-left: 1em"><p>Dean, yeah, that is the reason why I want to get rid of it - and I am soooo happy that my MS keyboards software on the desktop allows me to disable it :)</p></div>
<p><a id="796879" href="#796879">#</a> <strong>ReallyEvilCanine</strong> on Friday, October 06, 2006 2:25 PM:</p><div style="margin-left: 1em"><STRONG><FONT color=#ff0000>[Edited to&nbsp;turn the evil dog's HTML (which is not supported by commenters as the page mentioned!) into actual HTML -- next time I'll probably just assume it is spam (it was detected as such) and delete, and make him repost. Nothing personal! :-) -- michkap]</FONT></STRONG><BR><BR><A class="" href="http://www.annoyances.org/exec/forum/winxp/r1017256194" mce_href="http://www.annoyances.org/exec/forum/winxp/r1017256194">How to disable capslock</A> <BR><BR>The short version:<BR><BR>1) Go to HKLM\SYSTEM\CurrentControlSet\Control\Keyboard Layout<BR>2) Create a REG_BINARY entry called <STRONG>Scancode Map</STRONG><BR>3) Give the value data: <STRONG>00000000 00000000 0200000000 2A003A00 00000000<BR></STRONG>4) Reboot <EM>(ARGH!!!!!)<BR></EM><BR>Me, I just rip the damned thing off every keyboard I own. It's only a problem when playing GTA but you can remap the keys in that. Horn goes on the left shift where it used to be in GTA3 and GTA:VC.</div>
<p><a id="797113" href="#797113">#</a> <strong>Michael S. Kaplan</strong> on Friday, October 06, 2006 3:25 PM:</p><div style="margin-left: 1em"><P>Hopefully people will understand why MSKLC (a tool developed by folks on a Windows International team) would not specifially target this scenario. </P>
<P>:-)</P></div>
<p><a id="797497" href="#797497">#</a> <strong>ReallyEvilCanine</strong> on Friday, October 06, 2006 5:12 PM:</p><div style="margin-left: 1em">Thanks for fixing the comment. There's no preview and I can't see the results immediately so I didn't know. Is there some guideline to the allowed code for posting?<br/><br/>Also, I really DON'T know why you don't just kludge in an option to kill or reassign the craplock key. Yes, at the hardware level it's hadled by the keyboard but since the KLC works at the scan code level, why isn't NULL-assigning that hellish key a possibility?<br/><br/>The last time I used the key for anything other than an office weapon whenever getting a replacement keyboard (about once every three months) was in 1998 as I did some COBOL Y2K work.</div>
<p><a id="797628" href="#797628">#</a> <strong>Michael S. Kaplan</strong> on Friday, October 06, 2006 5:20 PM:</p><div style="margin-left: 1em"><p>If you read the text right above the comment line in &nbsp;browser, it lays out what works and what does not.</p>
<p>Of course no one ever reads it before they leave a comment. :-)</p>
<p>As for the CAPS LOCK key, asked and answered. But if you want more:</p>
<p>Not everyone hates and some keyboard use SGCAPS and need it. It is not an internationalization issue and so it is not a part of MSKLC's mandate to do something with.</p></div>
<p><a id="798105" href="#798105">#</a> <strong>ReallyEvilCanine</strong> on Friday, October 06, 2006 5:36 PM:</p><div style="margin-left: 1em">You're not /. -- I actually do try to read everything. Didn't notice any HTML guide.<br/><br/>Not to belabour the point but there is some I18N aspect to the craplock key: in some locales it's a toggle whereas in others one must hit the left shift to shut it off in keeping with the typewriter convention on which it's based.</div>
<p><a id="798194" href="#798194">#</a> <strong>Michael S. Kaplan</strong> on Friday, October 06, 2006 5:41 PM:</p><div style="margin-left: 1em"><P>Have you <STRONG>run</STRONG> MSKLC before? :-)</P>
<P>Those aspects of CAPSLOCK are related to language support and are specifically configurable. One can design a layout that causes the CAPSLOCK to have no effect. </P>
<P>But MSKLC is for per layout changes, and not for a "destroy the key on all layouts" functionality. Even if there were a language argument for it -- which there is not. </P>
<P>More to belabor? Or can we get back to the actual topic? :-)</P></div>
<p><a id="799015" href="#799015">#</a> <strong>Random note in passing</strong> on Friday, October 06, 2006 8:49 PM:</p><div style="margin-left: 1em">Same solution as the Apple II reset key:  Pry it off with a screwdriver.  And thinking of those bad old days ... wasn't it shortly thereafter when a universal fog of amnesia caused everybody to forget to escape delimiters?  Practically every application I use these days that claims to export and import data as text fails to even round-trip its own files correctly.</div>
<p><a id="799058" href="#799058">#</a> <strong>Michael S. Kaplan</strong> on Friday, October 06, 2006 9:03 PM:</p><div style="margin-left: 1em"><p>Amazing how many people need to keep this offtopic thread going. </p>
<p>People, move it over to the other post, or I start deleting. LAST WARNING!!! :-)</p></div>
<p><a id="1062411" href="#1062411">#</a> <strong>Daan Nusman</strong> on Sunday, November 12, 2006 7:18 AM:</p><div style="margin-left: 1em"><p>Thanks for the tip! That indeed fixed the error message I got &nbsp;:)</p></div>
<hr/><p><em>referenced by</em></p><div style="margin-left: 1em"><p>2006/10/06 <a href="http://archives.miloush.net/michkap/archive/2006/10/06/798751.html">If you hate the CAPS LOCK key, please read this!</a></p></div><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2006/10/05/792889.html" title="The fonts are no charge, but the OS they are in has to cost something">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2006/10/04/788747.html" title="Will I C U at the IUC? (Redux)">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2006-10">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2006-10-05">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2006/10/05/792859.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:39 GMT -->
</html>