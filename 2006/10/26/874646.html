<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2006/10/26/874646.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:39 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>'Managing' [List] Separator Anxiety</title></head><body>
<h1>'Managing' [List] Separator Anxiety</h1>
<p><em>by Michael S. Kaplan, published on 2006/10/26 03:31 -04:00, original URI: http://blogs.msdn.com/b/michkap/archive/2006/10/26/874646.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<FONT face=Tahoma size=3>
<P>Now I have praised the folks in GIFT Ireland in the past, like in <A class="" href="http://archives.miloush.net/michkap/archive/2005/07/12/437916.html" mce_href="http://archives.miloush.net/michkap/archive/2005/07/12/437916.html"><STRONG>this post</STRONG></A> and also <A class="" href="http://archives.miloush.net/michkap/archive/2005/08/20/454114.html" mce_href="http://archives.miloush.net/michkap/archive/2005/08/20/454114.html"><STRONG>this one</STRONG></A>, for example. </P>
<P>But when you are not talking to someone every day, you sometimes forget they are there. Luckily, sometimes they find a way to remind you that makes you really happy about their presence. This post is an example of that....</P>
<P>The other day, John Caffrey (an SDET across the puddle) sent the following in mail: </P>
<BLOCKQUOTE><FONT face="Times New Roman,Times" size=2>
<P>Hi guys,</P>
<P>Quick question if that’s ok… so during the testing of Locale Builder, we’ve noticed that the CARIB ignores the list separator data when loading it from an LDML file (for a replacement locale).</P>
<P>Is this a known issue with the CARIB? If so, can you maybe send me the relevant bug # so I can link our bug?</P>
<P>Thanks!</P>
<P>J.</FONT>&nbsp;</P></BLOCKQUOTE>
<P mce_keep="true">There was a brief pause because I had not seen the mail at first and both <A class="" href="http://blogs.msdn.com/shawnste/" mce_href="http://blogs.msdn.com/shawnste/">Shawn</A> and Tarek were out that day, but by the next day I had looked at the code and was able to comment:</P>
<BLOCKQUOTE><FONT face="Times New Roman,Times" size=2>This is an unintentional bundling of a user overridable setting (the list separator) with a non overridable setting (the code pages) -- no one noticed this to copy the setting over.<BR><BR>Worth putting a bug in and easy enough to fix, though I'm not sure where it would be triaged...</FONT></BLOCKQUOTE>
<P mce_keep="true">In my mind I was thinking that the code in the <A class="" href="http://msdn2.microsoft.com/en-us/library/system.globalization.cultureandregioninfobuilder.aspx" mce_href="http://msdn2.microsoft.com/en-us/library/system.globalization.cultureandregioninfobuilder.aspx">CultureAndRegionInfoBuilder</A> dates back to the original stuff I had written, which meant that (a) this bug was probably my fault though (b) this at least partially mitigated by the fact that many people had modified and tested the code since and no one had noticed. :-)</P>
<P mce_keep="true">Since it was not intentional, I assumed that problem would be limited to trying to set <A class="" href="http://msdn2.microsoft.com/en-us/library/system.globalization.cultureandregioninfobuilder.textinfo.aspx" mce_href="http://msdn2.microsoft.com/en-us/library/system.globalization.cultureandregioninfobuilder.textinfo.aspx">CultureAndRegionInfoBuilder.TextInfo</A> (which fails in replacement cultures) but that setting the <A class="" href="http://msdn2.microsoft.com/en-us/library/system.globalization.cultureandregioninfobuilder.textinfo.aspx" mce_href="http://msdn2.microsoft.com/en-us/library/system.globalization.cultureandregioninfobuilder.textinfo.aspx">CultureAndRegionInfoBuilder.TextInfo</A>'s actual <A class="" href="http://msdn2.microsoft.com/en-us/library/system.globalization.textinfo.listseparator.aspx" mce_href="http://msdn2.microsoft.com/en-us/library/system.globalization.textinfo.listseparator.aspx">TextInfo.ListSeparator</A> property should work just fine. I had not actually tried it yet or anything like that before Erich Barnstedt (a dev from the Ireland team) responded to&nbsp;my&nbsp;reply to John's&nbsp;mail:</P>
<BLOCKQUOTE><FONT face="Times New Roman,Times" size=2>
<P>Yeah, that was my hunch since it sits in TextInfo. We’ll work around it in Locale Builder by reading the value directly from LDML and re-applying it to the CARIB after loading from LDML. Thanks for the quick response,<BR><BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Erich</P></FONT></BLOCKQUOTE>
<P mce_keep="true">Things I think about in my head but don't share with others do not count as ideas, and I certainly didn't put any thought into what to do with this information, so Erich's public statement of the idea&nbsp;really allows him to be credited with inspiring me to write the following code that tests the theory (while Erich put the actual fix into the <A class="" href="http://archives.miloush.net/michkap/archive/2006/02/21/535813.html" mce_href="http://archives.miloush.net/michkap/archive/2006/02/21/535813.html">MS Locale Builder</A> code):</P>
<BLOCKQUOTE><FONT face="Consolas,Courier New,Lucida Console,Courier" size=2><B>
<P mce_keep="true">using System;<BR>using System.Globalization;<BR><BR>namespace Testing {<BR>&nbsp; class oooo {<BR>&nbsp;&nbsp;&nbsp; [STAThread]<BR>&nbsp;&nbsp;&nbsp; static void Main(string[] args) {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CultureInfo ci;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; string stCulture;<BR><BR><FONT color=#009900>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // First figure out the name<BR></FONT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if(args.Length &gt; 0) {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; stCulture = args[0];<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } else {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; stCulture = CultureInfo.CurrentCulture.Name;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<BR><BR><FONT color=#009900>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // Create the culture and say what it is<BR></FONT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ci = new CultureInfo(stCulture, false);<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Console.WriteLine("\r\nUsing the following culture: '{0}' ({1})\r\n", ci.DisplayName, ci.Name);<BR><BR><FONT color=#009900>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // Create the replacement and fill it</FONT><BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CultureAndRegionInfoBuilder carib = new CultureAndRegionInfoBuilder(stCulture, CultureAndRegionModifiers.Replacement);<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; carib.LoadDataFromCultureInfo(ci);<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; carib.LoadDataFromRegionInfo(new RegionInfo(stCulture));<BR><BR><FONT color=#009900>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // Change the list separator as appropriate<BR></FONT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if(args.Length &gt; 1) {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; carib.TextInfo.ListSeparator = args[1];<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } else {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; carib.TextInfo.ListSeparator = ";";<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<BR><BR><FONT color=#009900>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // Return some status</FONT><BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Console.WriteLine("List separator value");<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Console.WriteLine("&nbsp; ...in the old ci: '{0}'", ci.TextInfo.ListSeparator);<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Console.WriteLine("&nbsp; ...in the carib:&nbsp; '{0}'", carib.TextInfo.ListSeparator);<BR><BR><FONT color=#009900>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // Register the replacement<BR></FONT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; carib.Register();<BR><BR><FONT color=#009900>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // More status</FONT><BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ci = new CultureInfo(stCulture, false);<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Console.WriteLine("&nbsp; ...in the new ci: '{0}'", ci.TextInfo.ListSeparator);<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ci = null;<BR><BR><FONT color=#009900>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // Unregister -- cleanup is important in samples<BR></FONT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CultureAndRegionInfoBuilder.Unregister(stCulture);<BR><BR><FONT color=#009900>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // Even more status</FONT><BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ci = new CultureInfo(stCulture, false);<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Console.WriteLine("&nbsp; ...after removal: '{0}'", ci.TextInfo.ListSeparator);<BR>&nbsp;&nbsp;&nbsp; }<BR>&nbsp; }<BR>}</P></B></FONT></BLOCKQUOTE>
<P mce_keep="true">So if you have .NET 2.0 on your machine you can stick this code into a file named carib.cs and compiled it from the .NET command line as follows:</P>
<P mce_keep="true"><STRONG><FONT face="courier new,courier">&nbsp;csc carib.cs /r:sysglobl.dll</FONT></STRONG></P>
<P mce_keep="true">The command line syntax&nbsp;is easy enough:<BR></P>
<P mce_keep="true"><STRONG><FONT face="courier new,courier" size=2>&nbsp;carib.exe - uses the current culture and changes the separator to a semicolon</FONT></STRONG></P>
<P mce_keep="true"><STRONG><FONT face="courier new,courier" size=2>&nbsp;carib.exe &lt;culturename&gt; - uses the specified culture and changes the separator to a semicolon</FONT></STRONG></P>
<P mce_keep="true"><STRONG><FONT face="courier new,courier" size=2>&nbsp;carib.exe &lt;culturename&gt;&nbsp;&lt;separator&gt; - uses the specified culture and changes the separator&nbsp;to what is specified&nbsp;</FONT></STRONG></P>
<P mce_keep="true">On my machine (which is set to a default user locale of en-AU to look at issues that <A class="" href="http://msmvps.com/blogs/thinice/Default.aspx" mce_href="http://msmvps.com/blogs/thinice/Default.aspx">this guy</A> has been talking about!):</P>
<BLOCKQUOTE>
<P mce_keep="true"><FONT face="Consolas,Courier New,Lucida Console,Courier" size=2><STRONG>e:\test&gt;csc carib.cs /r:sysglobl.dll<BR>Microsoft (R) Visual C# 2005 Compiler version 8.00.50727.42<BR>for Microsoft (R) Windows (R) 2005 Framework version 2.0.50727<BR>Copyright (C) Microsoft Corporation 2001-2005. All rights reserved.<BR></STRONG></FONT><FONT face="Consolas,Courier New,Lucida Console,Courier" size=2><BR><STRONG>e:\test&gt;carib.exe<BR><BR></STRONG></FONT><FONT face="Consolas,Courier New,Lucida Console,Courier" size=2><STRONG>Using the following culture: 'English (Australia)' (en-AU)<BR><BR></STRONG></FONT><STRONG><FONT face="Consolas,Courier New,Lucida Console,Courier" size=2>List separator value<BR>&nbsp; ...in the old ci: ','<BR>&nbsp; ...in the carib:&nbsp; ';'<BR>&nbsp; ...in the new ci: ';'<BR>&nbsp; ...after removal: ','<BR><BR></FONT><FONT face="Consolas,Courier New,Lucida Console,Courier" size=2>e:\test&gt;</P></BLOCKQUOTE></STRONG></FONT></STRONG>
<P mce_keep="true">So there you have it.... an easy workaround for the oversight about the list separator (which at this point pretty much everyone wishes were just a part of <A class="" href="http://msdn2.microsoft.com/en-us/library/system.globalization.cultureinfo.aspx" mce_href="http://msdn2.microsoft.com/en-us/library/system.globalization.cultureinfo.aspx">CultureInfo</A> rather than <A class="" href="http://msdn2.microsoft.com/en-us/library/system.globalization.textinfo.aspx" mce_href="http://msdn2.microsoft.com/en-us/library/system.globalization.textinfo.aspx">TextInfo</A> anyway, since the latter is supposed to be about the writing system and the list separator is defnitely more of a cultural preference!). And in the meantime it will be addressed in the final release of the Locale Builder when it goes out.</P>
<P mce_keep="true">Special thanks to both John and Erich for not only finding my bug but also thinking ahead to the fix and making the Locale Builder behave more intuitively! :-)</P>
<P mce_keep="true">&nbsp;</P>
<P mce_keep="true"><FONT color=#ff00ff><EM>This post brought to you by </EM>&nbsp;<FONT size=4><STRONG>,</STRONG></FONT>&nbsp; <EM>(U+002c, a.k.a. COMMA)</EM></FONT></P></FONT>
<hr/><div style="margin-left: 1em"><em>no comments</em></div><hr/><p><em>referenced by</em></p><div style="margin-left: 1em"><p>2012/06/20 <a href="http://archives.miloush.net/michkap/archive/2012/06/20/10322015.html">Not giving someone their space can lead to SA (Separator Anxiety)</a></p></div><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2006/10/26/878226.html" title="Suggest a Topic!">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2006/10/26/872539.html" title="It feels good to help others, doesn&#39;t it?">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2006-10">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2006-10-26">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2006/10/26/874646.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:39 GMT -->
</html>