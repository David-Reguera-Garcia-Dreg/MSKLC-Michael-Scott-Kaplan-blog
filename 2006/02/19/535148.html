<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2006/02/19/535148.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:40 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>Making a mark in code windows</title></head><body>
<h1>Making a mark in code windows</h1>
<p><em>by Michael S. Kaplan, published on 2006/02/19 17:29 -05:00, original URI: http://blogs.msdn.com/b/michkap/archive/2006/02/19/535148.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<P><FONT face=Tahoma>Takes you right back to <A href="http://archives.miloush.net/michkap/archive/2006/01/19/514718.html"><STRONG>What are directional marks -- chumps who point?</STRONG></A>&nbsp;but t</FONT><FONT face=Tahoma>he other day, <A HREF="http://blogs.msdn.com/cyrusn">Cyrus Najmabadi</A> asked on an internal alias </FONT><FONT face=Tahoma>about one of those interesting mixed LTR an&nbsp;RTL text that cause so much grief such as a function signature in Visual Studio like:</FONT></P>
<BLOCKQUOTE dir=ltr style="MARGIN-RIGHT: 0px">
<P><FONT face="Courier New"><STRONG>void على‎&lt;على‎&gt;‎(على على‎)<BR></STRONG></FONT></P></BLOCKQUOTE>
<P><FONT face=Tahoma>The string above has LRM (U+200e) inserted before all&nbsp;the neutral characters such as <STRONG>&lt;</STRONG>, <STRONG>&gt;</STRONG>, <STRONG>(</STRONG>, and <STRONG>)</STRONG>.</FONT></P>
<P><FONT face=Tahoma>The problem that was coming up was all the times that the wrong string would come up in a left to right context, then&nbsp;(due to not having those characters),&nbsp;if Uniscribe support was turned on it would look something like the following:</FONT></P>
<BLOCKQUOTE dir=ltr style="MARGIN-RIGHT: 0px">
<P><SPAN dir=ltr><FONT face="Courier New"><STRONG>void على&lt;على&gt;(على على)</STRONG></FONT></SPAN><FONT face="Courier New"><BR></FONT></P></BLOCKQUOTE>
<P><FONT face=Tahoma>Or if you take my "fixed" string above and put it in a right to left context, it turns out to also have problems:</FONT></P><FONT face=Tahoma>
<BLOCKQUOTE dir=ltr style="MARGIN-RIGHT: 0px">
<P><FONT face="Courier New"><SPAN dir=rtl><STRONG>void على‎&lt;على‎&gt;‎(على على‎)<BR></STRONG></FONT></FONT></SPAN></P></BLOCKQUOTE>
<P><FONT face=Tahoma>Which leads me to make&nbsp;two observations and ask one question of everyone who is reading this....</FONT></P>
<P><FONT face=Tahoma>The first observation is that this display issue does not affect the behavior -- you will not have code that does not compile.</FONT></P>
<P><FONT face=Tahoma>This of course leads to the second observation, which is that if the code looks this bad, it does not seem terribly useful or usable, whether it works or not.</FONT></P>
<P><FONT face=Tahoma>This leads to the question -- how do you think the problem should be solved (and you cannot use "disallow other languages" as a suggested solution!)....</FONT></P>
<P><FONT face=Tahoma>Now if you respond, you can describe the solution (if you have trouble entedring it do to comments limitations!).</FONT></P>
<P><FONT face=Tahoma></FONT>&nbsp;</P>
<P><EM><FONT face=Tahoma color=#ff1493>This post brought to you by </FONT></EM><A href="http://www.fileformat.info/info/unicode/char/200e"><EM><FONT face=Tahoma>U+200e</FONT></EM></A><EM><FONT face=Tahoma color=#ff1493>, LEFT-TO-RIGHT MARKER</FONT></EM></P>
<hr/><p><a id="535188" href="#535188">#</a> <strong>Dean Harding</strong> on 19 Feb 2006 7:14 PM:</p><div style="margin-left: 1em">If &lt; &gt; ( and ) were not neutral, but strictly left-to-right, would that look right? Of course, this means that VS.NET would have to have extra custom procressing to ensure that they're counted as strictly left-to-right, and knowing what I know about Uniscibe (i.e. nothing) I don't know how feasible that is... or if it would even work!</div>
<p><a id="535203" href="#535203">#</a> <strong>Michael S. Kaplan</strong> on 19 Feb 2006 8:04 PM:</p><div style="margin-left: 1em">Hi Dean,<br><br>Well, putting LRM before the neutral characters effectively makes them all LTR -- which is why that solution works for LTR contexts. The problem is that it will not work in a pure RTL context....<br><br>So how would one deal with the ambiguity, is the question.</div>
<p><a id="535597" href="#535597">#</a> <strong>Mihai</strong> on 20 Feb 2006 1:39 PM:</p><div style="margin-left: 1em">I think we should first check with a programmer using a RTL language. He would expect a RTL environment, or a LTR one.<br><br>Where do we need Arabic in a program code?<br> - variable/class/etc names<br> - comments<br>I consider hard-coded strings, which is bad, bad, bad, English, Arabic, or Klingon, I don’t care!<br><br>My feeling is that a LTR is more appropriate, since we are talking a program (mostly English keywords and separators) with Arabic variable names, not an Arabic document with some English quotation. But I might be wrong :-)<br><br>Now, if we say LTR environment, where do we have the problem? Both strings look like this “void arabic‎&lt;arabic‎&gt;‎(arabic arabic‎)” (only that in the “fixed” string the Unicode character is visible).<br>I cannot reproduce it in Dev. Studio 2003 or 2005. I can reproduce it in Notepad, but this is not the issue, is it?<br>So, what is his/your environment? I am trying in Dev Studio 2003 and 2005, Windows XP SP2, English OS, English UI, user and system locales set to English US. (and I agree this is not what an Arab programmer would use).<br><br>The other thing: I would change the example to use different strings for function name, template parameter, argument and argument type.<br>The way it is not visible if the argument and argument types get switched.<br>void aaa&lt;bbb&gt;(ccc ddd) or void aaa&lt;bbb&gt;(ddd ccc)<br><br>And once we get some idea what is expected, we can also tackle the digits in that context aaa&lt;bbb&gt;(ccc ddd12 = 1234) :-)<br></div>
<p><a id="535622" href="#535622">#</a> <strong>Mihai</strong> on 20 Feb 2006 2:32 PM:</p><div style="margin-left: 1em">Correction:<br>&lt;&lt;I consider hard-coded strings, which is bad, bad&gt;&gt;<br>should be<br>&lt;&lt;I don't consider hard-coded strings, which is bad, bad&gt;&gt;</div>
<p><a id="536310" href="#536310">#</a> <strong>Nick Lamb</strong> on 21 Feb 2006 3:17 PM:</p><div style="margin-left: 1em">As with Mihai, I feel that it's wrong to allow either Microsoft's &quot;reading order&quot; flags or the UAX #9 paragraph level rule to decide the high level flow of text which is essentially structured rather than natural language.<br><br>You probably want LTR flow here as a matter of policy, and you also want to avoid treating whole source code lines or blocks as UAX #9 paragraphs, the language grammar is probably the right place to decide blocks, and conveniently it's also the unit used by the syntax highlighting, so you should be able to get this working with minimal performance hit (e.g. in a Pango system you'd just add explicit runs along with the coloring for different pieces of syntax).<br><br>The result would be (usual conventions)<br><br>in memory: void FOO&lt;BAR&gt;(BAZ QUX)<br>on screen: void OOF&lt;RAB&gt;(ZAB XUQ)<br><br>This retains readability for individual symbol names that are RTL, while retaining the visual semblance of the grammar, which is important to anyone inspecting the code, regardless of their native or adopted reading order.<br><br>If someone develops a popular language in which the keywords and grammar are naturally expressed RTL you'd want to re-visit for that specific language. I don't expect any such language to appear.<br><br>A similar problem on a smaller scale with URIs has been discussed by an IETF WG (I think) many moons ago, traces of it should be in bidi@unicode.org if Michael is a subscriber.</div>
<p><a id="536343" href="#536343">#</a> <strong>Michael S. Kaplan</strong> on 21 Feb 2006 4:12 PM:</p><div style="margin-left: 1em">It is easy (well, it is onvenient) to take a position that:<br><br>1) things are complicated<br>2) they should be simpler<br>3) it should be done the way I prefer it.<br><br>It is not going to be a defensible position that either Unicode or Microsoft will accept, given existing legacy practice which does not match this attempted simplifcation.<br><br>To see if it is fair or not, work with the oppsote default for a week; you will see what you are asking people to put up with....</div>
<p><a id="536462" href="#536462">#</a> <strong>Nick Lamb</strong> on 21 Feb 2006 6:39 PM:</p><div style="margin-left: 1em">Michael, I don't understand your explanation. Did you miss out a paragraph?<br><br>You write that you have a solution that's the way you prefer it, and then you mention Unicode.org and Microsoft won't accept it, but you don't explain what this solution is.<br><br>The reference to &quot;if it is fair or not&quot; and &quot;oppsote default&quot; is unclear, perhaps about reading order flags again?<br><br>Did you find the IETF discussion? Were any of the proposals similar to your own idea?</div>
<p><a id="536495" href="#536495">#</a> <strong>Michael S. Kaplan</strong> on 21 Feb 2006 7:53 PM:</p><div style="margin-left: 1em">Actually Nick, I was referring to your idea of changing both what MS does and what Unicode does, and how it is impractical and would NEVER happen.<br><br>I also pointed how out that it was easy to ferret the issue out -- how someone who uses principally LTR thinks LTR should be the default for everyone.<br><br>It was a critique -- and an explanation for how you can prove yourself wrong -- by living with the opposite as your default for a week.</div>
<p><a id="536547" href="#536547">#</a> <strong>Nick Lamb</strong> on 21 Feb 2006 10:21 PM:</p><div style="margin-left: 1em">You asked &quot;how do you think the problem should be solved&quot; in reference to C++ source code and I explained how it would be solved in accordance with the principles outlined by Unicode.org and UAX #9. You don't seem to have understood, and space in this comment widget forbids a substantially more detailed explanation, why is why I thought the IETF material might be useful. If you try to position this as a problem for the natural language BiDi algorithm to solve then you set off in the wrong direction.<br><br>You may be right that (if chosen for use in Visual Studio) my suggested approach obliges Microsoft to make some changes, perhaps API changes or wholesale updates to their text renderer, although I doubt that there's really a lot of work needed if you already support a higher level markup for text style in the renderer.<br><br>Since my preferred desktop OS implements UAX #9 in full the only noteworthy consequence of &quot;changing the default&quot; as you describe it, is to push the cursor to the other edge of the text area when starting a new paragraph. I don't see why I should live with that for a week to prove some abstract point, either to you or to me, especially since your demand seems to be based on a misunderstanding.</div>
<p><a id="536623" href="#536623">#</a> <strong>Michael S. Kaplan</strong> on 22 Feb 2006 12:15 AM:</p><div style="margin-left: 1em">Um, Nick -- you also suggested avoiding rules within UAX #9 -- to wit, allowing one to treat lines as paragraphs.<br><br>Microsoft has more legacy built on RTL scripts than just sbout anyone else in the world, so you will have to forgive Microsoft for wanting to find a solution that does not change behavior but still allows display to worlk properly.<br><br>If you would like me to take judicial note of your solution that kind of ignores that legacy, I will do so.<br><br>Since I have apparently once again failed to understand your point I will simply assume I am not quite bright enough to fathom your approach....</div>
<hr/><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2006/02/20/535260.html" title="Mirroring and Keyboards are complicated">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2006/02/19/535071.html" title="Seeing Duncan Sheik at The Triple Door">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2006-02">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2006-02-19">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2006/02/19/535148.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:40 GMT -->
</html>