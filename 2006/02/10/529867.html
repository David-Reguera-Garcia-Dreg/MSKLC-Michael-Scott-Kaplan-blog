<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2006/02/10/529867.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:40 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>Installing supplemental langauge support programatically</title></head><body>
<h1>Installing supplemental langauge support programatically</h1>
<p><em>by Michael S. Kaplan, published on 2006/02/10 17:16 -05:00, original URI: http://blogs.msdn.com/b/michkap/archive/2006/02/10/529867.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<P><FONT face=Tahoma>Paul Langton asked via the contact link:</FONT></P>
<BLOCKQUOTE dir=ltr style="MARGIN-RIGHT: 0px">
<P><FONT face="Times New Roman" size=2><EM>Gday Michael,</EM></FONT></P>
<P><FONT face="Times New Roman" size=2><EM>Firstly, love the blog and though a lot of it is waaaay over my head its always a great read, I'd go so far to say the best of all the MSDN blogs that I've sampled.</EM></FONT></P>
<P><FONT face="Times New Roman" size=2><EM>OK suck up out of the way, I have a VB script that does the same function as ticking the two tickboxes in "Supplemental language support" - i.e. "Install files for complex script and right to left languages (including Thai)" and "Install Files for East Asian Languages":</EM></FONT></P>
<BLOCKQUOTE dir=ltr style="MARGIN-RIGHT: 0px">
<P><FONT face="Courier New" size=2>Dim oShell ' Windows Scripting Host shell<BR>Dim oFSO ' File system object<BR>Dim sCurDir ' Script path<BR>Dim sWinDir ' Windows root path</FONT></P>
<P><FONT face="Courier New" size=2>'=======================================================================<BR>' Main<BR>'On Error Resume Next</FONT></P>
<P><FONT face="Courier New" size=2>Set oShell = CreateObject("WScript.Shell")<BR>Set oFSO = CreateObject("Scripting.FileSystemObject")</FONT></P>
<P><FONT face="Courier New" size=2>sCurDir = Left(WScript.ScriptFullName, InStrRev(WScript.ScriptFullName, "\") - 1)<BR>sWinDir = oShell.ExpandEnvironmentStrings ("%WinDir%")</FONT></P>
<P><FONT face="Courier New" size=2>' Install "Supplemental Language Support"</FONT></P>
<P><FONT face="Courier New" size=2>oShell.Run sWinDir &amp; "\system32\rundll32.exe advpack.dll,LaunchINFSection " &amp; sCurDir &amp; "\intl.inf,LANGUAGE_COLLECTION.COMPLEX.INSTALL", 1, 1</FONT></P>
<P><FONT face="Courier New" size=2>oShell.Run sWinDir &amp; "\system32\rundll32.exe advpack.dll,LaunchINFSection " &amp; sCurDir &amp; "\intl.inf,LANGUAGE_COLLECTION.EXTENDED.INSTALL", 1, 1</FONT></P></BLOCKQUOTE>
<P><FONT face="Times New Roman" size=2><EM>My question is - what is the best way to detect if these are already enabled so when it is run it doesn't reinstall all this stuff?</EM></FONT></P>
<P><EM><FONT face="Times New Roman" size=2>Rgds,<BR></FONT><FONT face="Times New Roman" size=2>Paul</FONT></EM></P></BLOCKQUOTE>
<P><FONT face=Tahoma>Ok, first of all -- Paul, don't ever do this!</FONT></P>
<P><FONT face=Tahoma>The code that does the installation of these components does indeed perform these steps, but it also does more than that -- and if you&nbsp;do only these things then you&nbsp;will probably&nbsp;findout at some point that not everything works as you want it to.</FONT></P>
<P><FONT face=Tahoma>This is obviously bad.</FONT></P>
<P><FONT face=Tahoma>The way to get this done is to use the method given in KB article <A href="http://support.microsoft.com/kb/289125">289125</A>. Just install one of the East Asian and one of the Complex script locales and it will perform ALL of the installation steps, rather than just the ones you want.</FONT></P>
<P><FONT face=Tahoma>And now to the actual question -- how to know when to skip this due to the installation already happening?</FONT></P>
<P><FONT face=Tahoma>Well, you can actually use the old <A href="http://msdn.microsoft.com/library/en-us/intl/nls_74dh.asp">IsValidLocale</A> function on any of the locales that is within one of the language groups in question (e.g. 0x0411 which is Japanese or 0x041e which is Thau) using the LCID_INSTALLED flag, or the <A href="http://msdn.microsoft.com/library/en-us/intl/nls_001c.asp">IsValidLanguageGroup</A> function to check the actual language groups and see if they are installed.</FONT></P>
<P><FONT face=Tahoma>Now all of this is useful to remember, especially in the context of </FONT><A id=_ctl0____ctl0___BlogSearcher___SearchPostList___EntryItems__ctl0_PostTitle HREF="http://archives.miloush.net/michkap/archive/2005/05/27/422458.html"><STRONG><FONT face=Tahoma>What isn't in the default install for NLS</FONT></STRONG></A><FONT face=Tahoma>&nbsp;and </FONT><A id=_ctl0____ctl0___BlogSearcher___SearchPostList___EntryItems__ctl1_PostTitle HREF="http://archives.miloush.net/michkap/archive/2005/02/16/374450.html"><STRONG><FONT face=Tahoma>Language groups -- the vestigial tail of NLS</FONT></STRONG></A><FONT face=Tahoma>, especially since they give some use for language groups. :-)</FONT></P>
<P><FONT face=Tahoma>But please try to avoid depending on anything in the INFs, since that is undocumented, unsupported, subject to change, and is changing massively in Vista....</FONT></P>
<P><FONT face=Tahoma></FONT>&nbsp;</P>
<P><FONT face=Tahoma color=#ff1493><EM>This post brought to you by</EM> "‡´ê" <EM>(<A href="http://www.fileformat.info/info/unicode/char/0ad0">U+0ad0</A>, a.k.a. GUJARATI OM)</EM></FONT></P>
<hr/><p><a id="529949" href="#529949">#</a> <strong>Paul Langton</strong> on 10 Feb 2006 7:26 PM:</p><div style="margin-left: 1em">Hmmm, not sure the link you gave me will help in my situation, that is for how to create an unattended installation of Windows that includes these things. I have various boxes already installed out there that need to have these two checkboxes enabled. Rebuilding them/reinstalling Windows isn't an option (of course, that would be waaaaay too easy).<br><br>I should also say, I'm not a vb programmer, I'm an &quot;application packager&quot; (MSI stuff) so vbscript is probably the extend of my coding &quot;skills&quot;, so using the IsValidLocale is beyond my skill set (unless you can call it via VBscript, which it doesn't look like you can)</div>
<p><a id="530003" href="#530003">#</a> <strong>Michael S. Kaplan</strong> on 10 Feb 2006 9:49 PM:</p><div style="margin-left: 1em">Hi Paul,<br><br>The link I gave you will work just fine -- the unattend syntax works for post-setup scenarios just fine -- try it if you don't believe me.... it works very well!<br><br>For the other, there are many programming languages that are supported in the MSI framework, and lots of them support LCIDs and locales -- you can look to many of VBScript's methods like SetLocale that will fail on invalid LCIDs (for example) to get the job done.<br><br>But stay away for the INF -- it simply is a really bad way to go!</div>
<p><a id="530633" href="#530633">#</a> <strong>Paul</strong> on 12 Feb 2006 7:22 PM:</p><div style="margin-left: 1em">Hi Michael,<br><br>Sorry to bother you with this continually... <br><br>I've read various people trying this with success, but I'm not having any luck - I'm assuming that its because where I work, we don't give users direct access to the i386 directory (you'll notice in my vbscript I specify the path to the i386 directory). I have to assume this is the problem, as there are no errors presented, it just runs and does nothing.<br><br>Is there an extra option for the &quot;rundll32.exe shell32,Control_RunDLL intl.cpl,,/f:&quot;c:\regopts.txt&quot;&quot; where I can tell it where to find the i386 directory?<br><br>Rgds<br><br>Paul</div>
<p><a id="530640" href="#530640">#</a> <strong>Michael S. Kaplan</strong> on 12 Feb 2006 7:38 PM:</p><div style="margin-left: 1em">Hi Paul,<br><br>You can use the /s param to give a pointer to the dir where the install files would be found....</div>
<p><a id="530657" href="#530657">#</a> <strong>Paul</strong> on 12 Feb 2006 8:13 PM:</p><div style="margin-left: 1em">Again, sorry to bother you but I still can't get this working, whats the syntax you specify the path... I've tried with &quot;&quot; without &quot;&quot;, UNC, non-UNC and still not having any luck. Do I point it to the root of the i386 directory or the directory that contains the i386 directory I've tried both of these too to no avail).<br><br>Does it keep a log somewhere of what its trying to do and any errors it encounters?<br><br>Also, I've noted that if the user has the Regional Settings control panel open then this command line totally fails, it just brings that window to the front. I really need an enterprise solution to this issue, and this seems like something that hasn't been thought through. Any more hints?<br><br></div>
<p><a id="530660" href="#530660">#</a> <strong>Michael S. Kaplan</strong> on 12 Feb 2006 8:20 PM:</p><div style="margin-left: 1em">Paul, the files it is looking for are not in the i386 directory, they are in the lang subdirectory of the i386 directory. That is where you should point it to.<br><br>As for the rest, in the enterprise scenario it is done at logon or in unattended setup, none of which have an intl.cpl loaded already. So it is well thought out for the scenarios where it is intended</div>
<p><a id="530681" href="#530681">#</a> <strong>Paul</strong> on 12 Feb 2006 9:57 PM:</p><div style="margin-left: 1em">Hi Michael,<br><br>I'm saying this with the utmost respect for your work, I really do love your blog and the effort and dedication you have for what you do is truly inspiring, and I do appreciate your very quick feedback to my lack of knowledge :) <br><br>But in my mind, to have the deployment options limited to logon or unattended setup, relying on (as far as I'm aware) undocumented command line options (I still haven't seen an example of the /s option) isn't exactly what I'd call an enterprise solution.<br><br>But its more than likely this stems from my own ignorance rather than any issue with the technology.<br><br>Thanks again for your help, I'll continue plugging away (still having issues with the /s option)<br><br>Cheers<br><br>Paul</div>
<p><a id="530692" href="#530692">#</a> <strong>Paul</strong> on 12 Feb 2006 10:16 PM:</p><div style="margin-left: 1em">Actually I'll provide exact details on what I'm doing and perhaps you can point out my stupidity to me :) I know I'm doing something really really wrong but I've no idea what.<br><br>I've created a text file called c:\regopts.txt that is trying to install Japanese (I got the input locale code from <a rel="nofollow" target="_new" href="http://www.microsoft.com/globaldev/reference/winxp/xp-lcid.mspx">http://www.microsoft.com/globaldev/reference/winxp/xp-lcid.mspx</a>)<br><br><br>[RegionalSettings]<br>LanguageGroup=1,2,3,4,5<br>SystemLocale=e0010411<br>UserLocale=e0010411<br>InputLocale=0411:e0010411<br><br>I have a copy of the i386 directory on I:\i386<br><br>the command lines I have tried are:<br><br>rundll32.exe shell32,Control_RunDLL intl.cpl,/s:&quot;I:\I386\lang&quot;,/f:&quot;c:\regopts.txt&quot;<br><br>rundll32.exe shell32,Control_RunDLL intl.cpl,,/f:&quot;c:\regopts.txt&quot;,/s:&quot;I:\Install\I386\lang&quot;<br><br>rundll32.exe shell32,Control_RunDLL intl.cpl,,/f:&quot;c:\regopts.txt&quot; /s:&quot;I:\I386\lang&quot;<br><br>rundll32.exe shell32,Control_RunDLL intl.cpl,/s:&quot;\\server\share\I386\lang&quot;,/f:&quot;c:\regopts.txt&quot;<br><br>Plus lots of other various combinations, all with no luck. I've tried Filemon and regmon on the process to see if its trying to access a file/regkey but can't see anything obvious in there.<br><br>Or should I be taking this to Microsoft Support that my company pays for rather than bother you about this?</div>
<p><a id="530697" href="#530697">#</a> <strong>Michael S. Kaplan</strong> on 12 Feb 2006 10:30 PM:</p><div style="margin-left: 1em">Well, to start with the system locale and user locale in your unattend file arae both invalid -- those are not locales -- try 00000411 here.<br><br>The input locale is correct.<br><br>But looking at the settings, you are not just installing EA lang sdupport -- you are setting it across the board to Japanese. This seldom szeems a good idea in a post-install enterprise scenario so I hope this is just you testing things out rather than the official plan....<br><br>Beyond that, as I said you only need to include one language group to cover EA langs and one to cover complex scripts (assuming it is XP or Server 2003). You never need to specify five of them.<br><br>Beyond THAT, I'd be more convinced about the respect thing if you assumed you had missed something before you questioned the professional nature of the product. :-)<br><br>Unattend files do not need to commonly use that particular param since with the exception of international support, most of what someone needs is always in the i386 dir. But it is not unheard of in any of these cases to need to specify a dir.<br><br>I guess if you are not convinced that this is the solution to use then you can just not get a solution that has been tested by the team that owns the component. I will leave the decision to you....</div>
<p><a id="530719" href="#530719">#</a> <strong>Paul</strong> on 12 Feb 2006 11:23 PM:</p><div style="margin-left: 1em">I do apologise, I never meant my comments of the product to reflect on yourself. You have certainly gone out of your way to assist me and I am truly appreciative, and I've obviously failed to express that coherently. The errors I am experiencing are to do with my lack of skills rather than any shortcoming on either your part or that of your team.<br><br>I am convinced this is the solution I should be using, I'm just actually trying to use it. There is no doubt that you and your team are vastly more experienced and knowledgable in this matter than I, hence me asking for assistance (and I'll have to learn me some manners when asking for help!).<br><br>I'll soldier on.</div>
<p><a id="530723" href="#530723">#</a> <strong>Michael S. Kaplan</strong> on 12 Feb 2006 11:27 PM:</p><div style="margin-left: 1em">No apology needed, Paul. Thats why I had that smiley thing on the &quot;respect&quot; line. Just having a little fun on a Sunday. :-)<br><br>I honestly should have thought to ask you for the &nbsp;contents of your unattend file first, since the last four times someone was having trouble that is where the trouble turned out to be (and where I think it is now)....</div>
<p><a id="530729" href="#530729">#</a> <strong>Paul</strong> on 13 Feb 2006 12:00 AM:</p><div style="margin-left: 1em">HI Michael,<br><br>No the problem is't there, I've even copied other examples you've posted on newsgroups (<a rel="nofollow" target="_new" href="http://groups.google.com.au/group/microsoft.public.win32.programmer.international/browse_frm/thread/188b7396d0d6bd74/63754ad9ee134170?lnk=st&amp;q=regopts.txt&amp;rnum=2&amp;hl=en#63754ad9ee134170">http://groups.google.com.au/group/microsoft.public.win32.programmer.international/browse_frm/thread/188b7396d0d6bd74/63754ad9ee134170?lnk=st&amp;q=regopts.txt&amp;rnum=2&amp;hl=en#63754ad9ee134170</a>)<br>to no avail... it still starts and then stops and doesn't add any languages.<br><br>I'm reasonably sure I'm not using the /s command line option properly, but as I don't have an example to go off and I've tried every combination I can think of I'm just trying the same things over and over again.<br><br>A good nights sleep might help. The only alternative solution I can think of is to do a vbscript that does sendkeys to emulate clicking on those two checkboxes, I'd really rather avoid doing that though...</div>
<p><a id="530732" href="#530732">#</a> <strong>Michael S. Kaplan</strong> on 13 Feb 2006 12:13 AM:</p><div style="margin-left: 1em">Well, how about starting small -- like with one settingg. Maybe one that does not require files to be installed. And then work your way up from there?<br><br>The current file you listed is trying to do everything (which is probably not what you needed to do anyway). We can track down what is happening here....<br><br><br><br></div>
<p><a id="531217" href="#531217">#</a> <strong>Paul</strong> on 13 Feb 2006 4:10 PM:</p><div style="margin-left: 1em">Hi Michael,<br><br>The other issue is definately my own ignorance, I have no idea what some of the settings in the setopts.txt file do...<br><br>From the KB article:<br><br>[RegionalSettings]<br>Language = locale ID<br>LanguageGroup = language group ID, language group ID<br>SystemLocale = locale ID<br>UserLocale = locale ID<br>InputLocale = locale ID:keyboard layout ID, locale ID:keyboard layout ID<br>UserLocale_DefaultUser = locale ID<br>InputLocale_DefaultUser = locale ID:keyboard layout ID<br><br>Language is reasonable obvious (even though I got it wrong)<br>LanguageGroup escapes me totally, it describes this as:<br><br>LanguageGroup - This setting specifies the language support that is installed on the computer. If this setting is specified, it provides the default settings for the InputLocale, SystemLocale, and UserLocale settings.<br><br>But what do I actually put in there? It seems to be numbers, but I've no idea how to tell it what numbers equal what language (or languages)<br><br>System locale I assume changes the default system locale?<br><br>User Locale I assume changes the locale for the user you are running the command as.<br><br>Input locale specifies the input and keyboard combinations, this is the setting I guess I want to add Japanese (or any other Asian language) and also a left to right language (arabic perhaps?)<br><br>The other settings look like I don't want to play with them.<br><br>So, what I would think, to add Japanese to a PC that has English Australian and English US installed I should have a regopts.txt file like so:<br><br>[RegionalSettings]<br>LanguageGroup=?? (as I didn't know what to do here, I put 1, 2, 3, 4 ,5)<br>SystemLocale=00000409<br>UserLocale=00000409 <br>InputLocale=0409:00000409;0411:e0010411<br><br>And then run:<br><br>rundll32.exe shell32,Control_RunDLL intl.cpl,,/f:&quot;c:\regopts.txt&quot;<br><br>With my myriad of combinations of /s.<br><br>How is that looking?<br><br>Rgds<br><br>Paul</div>
<p><a id="531227" href="#531227">#</a> <strong>Michael S. Kaplan</strong> on 13 Feb 2006 4:25 PM:</p><div style="margin-left: 1em">As I said, try setting ONE thing, not four of them, for starters. You do not need to set SystemLocale, UserLocale, and InputLocale, most likely -- such changes on an enterprise are a huge mistake.<br><br>See <a rel="nofollow" target="_new" href="http://archives.miloush.net/michkap/archive/2005/02/16/374450.html">http://blogs.msdn.com/michkap/archive/2005/02/16/374450.aspx</a> for more on language groups, which includes info about the actual numbers and what they mean....</div>
<p><a id="531255" href="#531255">#</a> <strong>Paul</strong> on 13 Feb 2006 4:39 PM:</p><div style="margin-left: 1em">Wow that link should be a KB article...<br><br>And I now know that the fileds in the regopts.txt are optional... another piece of the puzzle...<br><br>I assume going to English (New Zealand) won't install any files? (fingers crossed, its not easy for the layperson to actually tell what will and won't require access to the i386 directory)...<br><br>So I try the following:<br><br>[RegionalSettings]<br>LanguageGroup=1<br>InputLocale=0409:00000409;1409:00000409<br><br>I'm still a little in the dark as to what to put in for the input locale, I'm copying the above from <a rel="nofollow" target="_new" href="http://www.microsoft.com/globaldev/reference/winxp/xp-lcid.mspx">http://www.microsoft.com/globaldev/reference/winxp/xp-lcid.mspx</a><br><br>The above didn't appear to work, so I'm obviously waaaay off track...</div>
<p><a id="531259" href="#531259">#</a> <strong>Paul</strong> on 13 Feb 2006 4:41 PM:</p><div style="margin-left: 1em">But hold the phone... I changed the regopts.txt to:<br><br>[RegionalSettings]<br>LanguageGroup=1<br>InputLocale=1409:00000409<br><br>And hooray, it worked. :) I now have English US, English Australian and English New Zealand installed.</div>
<p><a id="531266" href="#531266">#</a> <strong>Paul</strong> on 13 Feb 2006 4:51 PM:</p><div style="margin-left: 1em">And changing it to:<br><br>[RegionalSettings]<br>LanguageGroup=7<br>InputLocale=0411:e0010411<br><br>And it worked! Installed Japanese (it prompted for the files though, but I'll play around with the /s setting).<br><br>Can't thank you enough, your patience has been extraordinary through this. I'm sure its been as annoying for you as it has been challenging for me :) If I could send an email of commendation to those above you I would.<br><br>Again, thanks for your assistance. That link explaining the language groups is incredibly useful, I really should have thought to have searched your blog for that information.</div>
<p><a id="531398" href="#531398">#</a> <strong>Michael S. Kaplan</strong> on 13 Feb 2006 8:35 PM:</p><div style="margin-left: 1em">Hey, no problems -- and I was not annoyed. I just wanted to see you helped. :-) <BR><BR>(And your very kind message via Robert Scoble made it to my boss, so that worked out, too!). <BR><BR>Re: the /s option -- the one you want is the third one, where they are both in that last parameter.....</div>
<p><a id="532095" href="#532095">#</a> <strong>Paul</strong> on 14 Feb 2006 5:12 PM:</p><div style="margin-left: 1em">Might be worth noting that this process does create a logfile, by default in c:\windows\regopt.log that has content like the following:<br><br><br>************************************************************<br>Region and Languages Options Unattended Mode Log &nbsp;<br>************************************************************<br><br>/f:&quot;c:\regopts.txt&quot; /s:&quot;I:\I386&quot;<br><br>Switch /F detected!<br>Switch /S detected!<br>&lt;--- Unattended file log start----&gt;<br>[RegionalSettings]<br>LanguageGroup=11<br>InputLocale=041e:0000041e<br>&lt;--- &nbsp;Unattended file log end ----&gt;<br>Language group installation requested: 11<br>No valid Language settings found, look for individual keywords.<br>Input locale installation requested.<br>Keyboard Layout installation requested: 041e<br><br>The best thing is when you get it wrong (e.g. specify the wrong language group for the locale you are requesting etc) it actually tells you what you are doing wrong.<br><br>Also, with the /S switch, you point it at the i386 directory level, not the LANG level, it finds LANG etc by itself :)<br><br>Hope that comes of use to someone!</div>
<p><a id="532247" href="#532247">#</a> <strong>Michael S. Kaplan</strong> on 14 Feb 2006 9:22 PM:</p><div style="margin-left: 1em">Hey Paul,<br><br>Oops! I forgot about that part. Sorry, that would have made things easier, I'm sure....</div>
<p><a id="532758" href="#532758">#</a> <strong>Ivan Petrov</strong> on 15 Feb 2006 4:17 PM:</p><div style="margin-left: 1em">Hi Michael ;-)<br><br>I've a question!:<br><br>What will replace this 2 files:<br><br>'intl.inf' and 'font.inf',<br><br>in Windows Vista?<br><br>And also one more question:<br><br>Will it be possible to customize so easy the new system, that replaced this 2 files, like nowadays we can customize this 2 *.inf files!?<br><br>Regards,<br>Ivan.<br><br></div>
<p><a id="533398" href="#533398">#</a> <strong>Ivan Petrov</strong> on 16 Feb 2006 12:35 PM:</p><div style="margin-left: 1em">Hi Michael.<br><br>With the previous questions I meant:<br><br>If for example I've a CUSTOM c_?.nls file (Codepage conversion table created by me) and I want to add it to Windows, in Windows XP I've to:<br>1) copy the c_?.nls file to the System32 folder;<br>2) edit the 'intl.inf' file and make some modifications in it, one of which is in the [Strings] section of this file to add something like this:<br>CP? &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = &quot;? (Some Description Here)&quot;<br>which make it appear the codepage Description under the Advanced tab in Regional and Language Options in the Codepage conversion tables Checkbox List.<br>3) If I want the Command Prompt Window to support my c_?.nls encoding, I've to edit the 'font.inf' file and add some additional lines and copy some c_?.nls related custom *.fon fonts into the Fonts folder.<br><br>So, I'm wondering how will look now all this process in Windows Vista, as I saw that many entries from the 'intl.inf' file are disappeared from there!<br><br>Best regards,<br>Ivan.<br></div>
<p><a id="533414" href="#533414">#</a> <strong>Michael S. Kaplan</strong> on 16 Feb 2006 12:45 PM:</p><div style="margin-left: 1em">Hmmm... you know that these updates are undocumented and unsupported, right?<br><br>So you are essentially asking me what is the new way to do something undocumented and unsupported if thed old way to do something undocumented and unsupported is broken by the new supported designs of the OS.<br><br>I think the answer is implied in the question, sorry. :-(</div>
<p><a id="533516" href="#533516">#</a> <strong>Ivan Petrov</strong> on 16 Feb 2006 2:31 PM:</p><div style="margin-left: 1em">Ok, thanks Michael.<br><br>I understand.<br><br>I hope some day, it will be possible to add custom Codepage conversion tables in Windows, because, as we can see here:<br><br><a rel="nofollow" target="_new" href="http://www-03.ibm.com/servers/eserver/iseries/software/globalization/codepages.html">http://www-03.ibm.com/servers/eserver/iseries/software/globalization/codepages.html</a>, <br><br>and here:<br><br><a rel="nofollow" target="_new" href="http://www.i18nguy.com/unicode/codepages.html">http://www.i18nguy.com/unicode/codepages.html</a><br><br>there're too many Codepages not supported by Microsoft. And if someone wants to migrate to UNICODE, he will need such mechanisms on system level to convert the data into UNICODE in the applications.<br><br>Regards,<br>Ivan.</div>
<p><a id="533541" href="#533541">#</a> <strong>Michael S. Kaplan</strong> on 16 Feb 2006 3:05 PM:</p><div style="margin-left: 1em">Hi Ivan,<br><br>Never fear, I will be posting about this issue soon! :-)</div>
<p><a id="533553" href="#533553">#</a> <strong>Ivan Petrov</strong> on 16 Feb 2006 3:23 PM:</p><div style="margin-left: 1em">Ok, 10x in advance Michael.<br><br>I'll be waiting for this posts with great interest and enthusiasm ;-)<br><br>Regards,<br>Ivan.</div>
<p><a id="572485" href="#572485">#</a> <strong>Paul C</strong> on 10 Apr 2006 9:52 AM:</p><div style="margin-left: 1em">As they say: &quot;Learning from mistakes&quot;, this article pointed me the way (and the links) to finally get my unattended install configured in such a way that it automatically adds support for Korean and Thai without user interaction.</div>
<p><a id="572778" href="#572778">#</a> <strong>Ivan Petrov</strong> on 10 Apr 2006 4:48 PM:</p><div style="margin-left: 1em">Hi Michael.<br><br>I'm still waiting to post something about this issue above.<br><br>Regards,<br>Ivan.</div>
<p><a id="572860" href="#572860">#</a> <strong>Michael S. Kaplan</strong> on 10 Apr 2006 7:03 PM:</p><div style="margin-left: 1em">Well, they haven't fired me yet, so hang in there....</div>
<p><a id="573157" href="#573157">#</a> <strong>Ivan Petrov</strong> on 11 Apr 2006 2:41 AM:</p><div style="margin-left: 1em">Hi,<br><br>Ok, I'll wait ...<br><br></div>
<p><strong>Drewfus</strong> on 11 Feb 2010 1:17 PM:</p><div style="margin-left: 1em"><p>Michael,</p>
<p>regarding KB article 289125, if UserLocale_DefaultUser and InputLocale_DefaultUser create settings for the default user, what user's does UserLocale and InputLocale effect - all current accounts?</p>
<p>If UserLocale_DefaultUser and InputLocale_DefaultUser are not used in an unattended setup, UserLocale and InputLocale will update the default users settings regardless. Correct?</p>
<p>Although 289125 is a well written article, it doesn't seem quite clear to me in what contexts both pairs of settings should, or do not need to be supplied.</p></div>
<p><strong>Michael S. Kaplan</strong> on 12 Feb 2010 3:17 PM:</p><div style="margin-left: 1em"><p>The current user account is the one that is not the default user.</p>
</div>
<p><strong>Drewfus</strong> on 13 Feb 2010 10:02 PM:</p><div style="margin-left: 1em"><P><A href="http://technet.microsoft.com/en-us/library/cc721887(WS.10).aspx">http://technet.microsoft.com/en-us/library/cc721887(WS.10).aspx</A></P>
<P>The section "Changing country/region and language options" explains it well enough...</P>
<P>The format of the answer file specified in a silent configuration is exactly the same as that used during setup. This means that all of the country/region setting options can be changed silently after the initial installation. The following is an example of a silent configuration that:</P>
<P>* Adds the "German to German" input language for the current user.</P>
<P>* Adds the "German to Swiss German" input language to the list of input languages for the default user.</P>
<P>* Configures the language for non-Unicode programs to German.</P>
<P>Copy Code [RegionalSettings]</P>
<P>InputLocale="0407:00000407"</P>
<P>InputLocale_DefaultUser="0407:00000807"</P>
<P>SystemLocale="0407"</P>
<P>If you specify multiple input languages for the InputLocale and InputLocale_DefaultUser keys, the first value specified will be set as the default for that particular user. In the following example, the InputLocale will set "German to German" as the default input language for the current user while making "German to Swiss German" available as an input language.</P>
<P>Copy Code [RegionalSettings]</P>
<P>InputLocale="0407:00000407", "0407:00000807"</P></div>
<p><strong>Muhammad S. Attari</strong> on 4 Jun 2012 10:10 AM:</p><div style="margin-left: 1em"><p>I want a code in a project sample of vb6 that automatically installs supplemental files (support for complex script and right-to-left languages in windows xp.</p>
<p>please help me.</p>
<p>Reards!</p>
</div>
<p><strong>Michael S. Kaplan</strong> on 4 Jun 2012 10:45 AM:</p><div style="margin-left: 1em"><p>There is only one supported way to do that -- and it is covered here already....</p>
</div>
<p><strong>Muhammad S. Attari</strong> on 4 Jun 2012 9:06 PM:</p><div style="margin-left: 1em"><p>It is true that the topic covers in detail the problem, but I am unable to do that. If I copy and paste the code given above, it shows an error &quot;cant find the INF file&quot;.</p>
<p>So please I request you to please send me a visual basic 6 project file with code for this purpose on my e-mail address: </p>
<p>mshakeelattari@hotmail.com</p>
<p>I shall be thankful to you!</p>
</div>
<p><strong>Michael S. Kaplan</strong> on 4 Jun 2012 9:44 PM:</p><div style="margin-left: 1em"><p>Please READ the article,and read KB 289125. Do *not* run the code sample, as the blog explains, and do not use VB6 for this, it is the wrong tool for the job....</p></div>
<p><strong>Muhammad S. Attari</strong> on 7 Jun 2012 8:25 PM:</p><div style="margin-left: 1em"><p>OK,</p>
<p>Then what method should be used for this purpose, please?</p>
<p>Is there any activeX control, or any thing that may be embedded in the project to do this job?</p>
</div>
<p><strong>M.Shakeel</strong> on 20 Jun 2012 5:24 PM:</p><div style="margin-left: 1em"><p>Rspected Michael!</p>
<p>Is there any other way for installing supplemental langauge support programatically?</p>
</div>
<p><strong>Michael S. Kaplan</strong> on 20 Jun 2012 6:30 PM:</p><div style="margin-left: 1em"><p>Via script, as described in that KB article.</p>
</div>
<p><strong>garrenq</strong> on 8 Nov 2012 4:13 PM:</p><div style="margin-left: 1em"><p>When I run this:</p>
<p> &nbsp;rundll32.exe shell32,Control_RunDLL intl.cpl,,/f:&quot;c:\temp\NORDIC.txt&quot; /s:&quot;W:\Software\Win2k3Standard\I386&quot;</p>
<p>I get the install fine on the account I used to install it (Local Administrator, in this case). &nbsp;But when I login as a different user on the same system, it doesn&#39;t show the languages that I installed. &nbsp;How can I get the install to show for all users that login through this server?</p>
<p>NORDIC.txt has this in it:</p>
<p>[RegionalSettings] </p>
<p>LanguageGroup=1</p>
<p>InputLocale=0409:00000409,081d:0000041d,041d:0000041d,0414:00000414,0814:00000414</p>
</div>
<hr/><p><em>referenced by</em></p><div style="margin-left: 1em"><p>2007/10/19 <a href="http://archives.miloush.net/michkap/archive/2007/10/19/5519238.html">Supplemental on XP? You may need the CD.</a></p><p>2007/06/14 <a href="http://archives.miloush.net/michkap/archive/2007/06/14/3288145.html">The one-way trip of installing supplemental language support</a></p><p>2006/05/30 <a href="http://archives.miloush.net/michkap/archive/2006/05/30/610505.html">Unattend for Regional and Language Options in Vista</a></p><p>2006/05/20 <a href="http://archives.miloush.net/michkap/archive/2006/05/20/602745.html">How to REALLY handle the unattended version of Regional and Language Options</a></p></div><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2006/02/11/530289.html" title="Knowing English as a second language? A third? Or at all?">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2006/02/09/528696.html" title="It is all backwards!">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2006-02">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2006-02-10">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2006/02/10/529867.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:40 GMT -->
</html>