<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2006/02/22/536877.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:40 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>And the digits just keep on coming</title></head><body>
<h1>And the digits just keep on coming</h1>
<p><em>by Michael S. Kaplan, published on 2006/02/22 09:01 -05:00, original URI: http://blogs.msdn.com/b/michkap/archive/2006/02/22/536877.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<P><FONT face=Tahoma>I have definitely talked about digit substitution many times since I <A HREF="http://archives.miloush.net/michkap/archive/2005/04/24/411329.html"><STRONG>started</STRONG></A><STRONG> </STRONG><A HREF="http://archives.miloush.net/michkap/archive/2004/12/01/272864.html"><STRONG>with</STRONG></A><STRONG> </STRONG><A HREF="http://archives.miloush.net/michkap/archive/2005/09/09/462920.html"><STRONG>this</STRONG></A><STRONG> </STRONG><A HREF="http://archives.miloush.net/michkap/archive/2005/07/09/437071.html"><STRONG>blog</STRONG></A>.</FONT></P>
<P><FONT face=Tahoma>And then I posted about my disillunsioned realization that Uniscribe was simply not doing as much as it could in the post <A href="http://archives.miloush.net/michkap/archive/2006/01/18/514171.html"><STRONG>Digits -- there is no substitute</STRONG></A>.</FONT></P>
<P><FONT face=Tahoma>Unfortunately, it gets worse.</FONT></P>
<P><FONT face=Tahoma>The <A href="http://msdn.microsoft.com/library/en-us/intl/uniscrib_1cq6.asp">ScriptRecordDigitSubstitution</A> function, while seeming perfectly innocent and useful, has an interesting note in&nbsp;its Platform SDK topic:</FONT></P>
<BLOCKQUOTE dir=ltr style="MARGIN-RIGHT: 0px">
<P><FONT face="Times New Roman" size=2><EM>Note that context digit substitution is supported only in Arabic and Persian locales. In other locales, context digit substitution is mapped to no substitution.</EM></FONT></P></BLOCKQUOTE>
<P><FONT face=Tahoma>You may think when you see this text that it was euphamistically talking about all Arabic script locales.</FONT></P>
<P><FONT face=Tahoma>I could make fun of your idealistic misperception, but it's what I thought too, so that would not be in my best interests. Instead I'll just commiserate with you for a bit. :-)</FONT></P>
<P><FONT face=Tahoma>That is right, the <A href="http://msdn.microsoft.com/library/en-us/intl/uniscrib_1cq6.asp">ScriptRecordDigitSubstitution</A> function is using <A href="http://msdn.microsoft.com/library/en-us/intl/nls_80o5.asp">ConvertDefaultLocale</A> (that 'internal' </FONT><FONT face=Tahoma>function I have talked about <A href="http://archives.miloush.net/michkap/archive/2005/07/05/435885.html"><STRONG>before</STRONG></A>) and then getting the <A href="http://msdn.microsoft.com/library/en-us/intl/nls_9c84.asp">PRIMARYLANGID</A> from the result.</FONT></P>
<P><FONT face=Tahoma>And then it uses whether that little dance returns LANG_ARABIC or LANG_FARSI to know whether to support 'context' style digit substitution (it also puts that value into <A href="http://msdn.microsoft.com/library/en-us/intl/uniscrib_962a.asp">SCRIPT_DIGITSUBSTITUTE</A>.TraditionalDigitLanguage for your viewing pleasure).</FONT></P>
<P><FONT face=Tahoma>This is really kind of disappointing; just as with that post that ruined my idealistic view of digit substitution intially, Uniscribe is potentially&nbsp;</FONT><FONT face=Tahoma>ignoring a&nbsp;user preference -- like if I wanted Thai digits and&nbsp; context style substitution, shouldn't I be able to have that?</FONT></P>
<P><FONT face=Tahoma>To look at from a more "glass is half full" point of view for a moment, t</FONT><FONT face=Tahoma>here is definitely a lot of room for improvement here in the future!</FONT></P>
<P><FONT face=Tahoma>In the meantime, you can muck about a bit with the <A href="http://msdn.microsoft.com/library/en-us/intl/uniscrib_962a.asp">SCRIPT_DIGITSUBSTITUTE</A>&nbsp;structure that <A href="http://msdn.microsoft.com/library/en-us/intl/uniscrib_1cq6.asp">ScriptRecordDigitSubstitution</A>&nbsp;returns and modify it before calling <A href="http://msdn.microsoft.com/library/en-us/intl/uniscrib_8azy.asp">ScriptApplyDigitSubstitution</A>. You do not have complete freedom to fix everything, but you have the opportunity to help make up for some of the shortcomings of <A href="http://msdn.microsoft.com/library/en-us/intl/uniscrib_1cq6.asp">ScriptRecordDigitSubstitution</A>&nbsp;I talk about here</FONT><FONT face=Tahoma>, at least.</FONT></P>
<P><FONT face=Tahoma>This will not help with all of the problems, but at the very least it will work around this Arabic/Farsi only thing. And help meet the linguistic expectations of users since we took the trouble to ask them to detail those expectations in Regional Options.</FONT></P>
<P><FONT face=Tahoma>Which by the way might explain why I am so torqued about this problem -- we are the ones exposing the settings, which means it is the </FONT><FONT face=Tahoma>GIFT team that is sitting in role of 'user car salesmen' who make promises that the car itself has no plan to deliver.</FONT></P>
<P><FONT face=Tahoma>But to put a positive spin on <STRONG>that</STRONG>, it is an even better motivator for change, at some point.</FONT></P>
<P><FONT face=Tahoma>To put a slightly more positive spin on the whole situation, Avalon (a.k.a. Windows Presentation Foundation) does a much better job, in part due to the hard work of some of the same people who wrote the original Uniscribe 'logic' (to use a term loosely!). Which is I think good proof that we are getting better here! :-)</FONT></P>
<P><FONT face=Tahoma></FONT>&nbsp;</P>
<P><FONT face=Tahoma color=#ff1493><EM>This post brought to you by</EM> "à­§" <EM>(<A href="http://www.fileformat.info/info/unicode/char/0b67">U+0b67</A>, a.k.a. ORIYA DIGIT ONE)</EM></FONT></P>
<hr/><div style="margin-left: 1em"><em>no comments</em></div><hr/><p><em>referenced by</em></p><div style="margin-left: 1em"><p>2010/11/12 <a href="http://archives.miloush.net/michkap/archive/2010/11/12/10088056.html">Suddenly, in a bit more time than a blink of an eye, "standards support" becomes "less i18n support"</a></p><p>2008/10/02 <a href="http://archives.miloush.net/michkap/archive/2008/10/02/8971896.html">When swimming in a sea of CONTEXT, applications can drown (and there is no lifeguard)</a></p><p>2008/06/16 <a href="http://archives.miloush.net/michkap/archive/2008/06/16/8603298.html">Sometimes, GDI respects users (even if no one else does!)</a></p><p>2007/02/14 <a href="http://archives.miloush.net/michkap/archive/2007/02/14/1675303.html">Nothing seems to be parsing the crap out of *this* number</a></p><p>2006/06/18 <a href="http://archives.miloush.net/michkap/archive/2006/06/18/636180.html">The Phantom of the Digits</a></p></div><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2006/02/22/537269.html" title="Keep off the grass">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2006/02/21/535813.html" title="What about the Microsoft Custom Locale Builder?">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2006-02">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2006-02-22">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2006/02/22/536877.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:40 GMT -->
</html>