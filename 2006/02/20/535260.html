<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2006/02/20/535260.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:40 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>Mirroring and Keyboards are complicated</title></head><body>
<h1>Mirroring and Keyboards are complicated</h1>
<p><em>by Michael S. Kaplan, published on 2006/02/20 03:01 -05:00, original URI: http://blogs.msdn.com/b/michkap/archive/2006/02/20/535260.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<P><FONT face=Tahoma>The other day, Shou-Ching Schilling (LAM) asked me via email:</FONT></P>
<BLOCKQUOTE dir=ltr style="MARGIN-RIGHT: 0px">
<P><FONT face="Times New Roman" size=2>Hi, you have helped me with many keyboards questions before, so I thought you might know the answer to this one or know who else to contact.</FONT></P>
<P><FONT face="Times New Roman"><FONT face="Times New Roman" size=2>I am doing some testing on Arabic keyboards.&nbsp; Sometimes the layout for ( ) and &lt; &gt; (or anything that have left and right version) are in the same order as in English in the label and sometimes they are not. Are there some rules or a different set of resources I can refer to?</FONT></FONT></P></BLOCKQUOTE>
<P><FONT face=Tahoma>It all starts because there is the idea of mirroring explained in UAX #9 (<A href="http://www.unicode.org/reports/tr9/">The Bidrectional Algorithm</A>). Section 6, entitled Mirroring, goes as follows:</FONT></P>
<BLOCKQUOTE dir=ltr style="MARGIN-RIGHT: 0px">
<P><FONT face="Times New Roman" size=2><EM>The mirrored property is important to ensure that the correct character codes are used for the desired semantic. This is of particular importance where the name of a character does not indicate the intended semantic, such as with U+0028 "(" LEFT PARENTHESIS. While the name indicates that it is a left parenthesis, the character really expresses an open parenthesis — the leading character in a parenthetical phrase, not the trailing one. </EM></FONT></P>
<P><FONT face="Times New Roman" size=2><EM>Note that in some contexts, some of the characters that have the mirrored property are sometimes not rendered with mirrored glyphs. A higher level protocol can limit mirroring action (rule L4) to a subset of those with the mirroring property. See also Section 4.3 Higher-Level Protocols. Except in such cases, mirroring must be done by an application of rule L4, to ensure that the correct character code is used to express the intended semantic of the character.</EM></FONT></P>
<P><FONT face="Times New Roman" size=2><EM>Implementing rule L4 calls for mirrored glyphs. These glyphs may not be exact graphical mirror images. For example, clearly an italic parenthesis is not an exact mirror image of another: "(" vs ")". Instead, mirror glyphs are those acceptable as mirrors within the normal parameters of the font in which they are represented.</EM></FONT></P>
<P><FONT face="Times New Roman" size=2><EM>In implementation, sometimes pairs of characters are acceptable mirrors for one another: for example, U+0028 "(" LEFT PARENTHESIS and U+0029 ")" RIGHT PARENTHESIS or U+22E0 "⋠" DOES NOT PRECEDE OR EQUAL and U+22E1 "⋡" DOES NOT SUCCEED OR EQUAL. Other characters such as U+2231 "∱" CLOCKWISE INTEGRAL do not have corresponding characters that can be used for acceptable mirrors. The informative Bidi Mirroring data file [Data], lists the paired characters with acceptable mirror glyphs. A comment in the file indicates where the pairs are "best fit": they should be acceptable in rendering, although ideally the mirrored glyphs may have somewhat different shapes.</EM></FONT></P></BLOCKQUOTE>
<P><FONT face=Tahoma>Ok, so basically what it means is the glyphs will be expected to "flip" under some circumstances.</FONT></P>
<P><FONT face=Tahoma>And they even give you a <A href="http://www.unicode.org/Public/UNIDATA/BidiMirroring.txt">BidiMirroring.txt</A>&nbsp;file in the <A href="http://www.unicode.org/ucd/">Uncode Character Database</A>&nbsp;</FONT><FONT face=Tahoma>that gives you&nbsp;a simple data file you can use for the mirrorings.</FONT></P>
<P><FONT face=Tahoma>Seems easy enough, right?</FONT></P>
<P><FONT face=Tahoma>Well, if you just said 'yes' then you probably have not thought too much about the consequences of characters that will simply flip depending on the context of what is around them.</FONT></P>
<P><FONT face=Tahoma>As one learns growing up, peer pressure of that sort is seldom easy.</FONT></P>
<P><FONT face=Tahoma>But okay, I'll take you at your word.</FONT></P>
<P><FONT face=Tahoma>Now let's add keyboards to the mix.</FONT></P>
<P><FONT face=Tahoma><EM>(many of the examples I give below use the Hebrew keyboard, but the same basic issues come up with the Arabic, Persian (a.k.a. Farsi), and Urdu keyboards, ignoring the multilingual nature of the Hebrew layout with its uppercase English)</EM></FONT></P>
<P><FONT face=Tahoma>If you up to the Windows Keyboard Layouts site to&nbsp;look at&nbsp;the Hebrew keyboard, you will get a small dynamic layout that can be used to display the following&nbsp;five available&nbsp;"shift" states:</FONT></P>
<P><FONT face=Tahoma><IMG src="http://trigeminal.fmsinc.com/images/kbdheb_base.jpg"></FONT></P>
<P><FONT face=Tahoma><IMG src="http://trigeminal.fmsinc.com/images/kbdheb_capsshift.jpg"></FONT></P>
<P><FONT face=Tahoma><IMG src="http://trigeminal.fmsinc.com/images/kbdheb_altgr.jpg"></FONT></P>
<P><FONT face=Tahoma><IMG src="http://trigeminal.fmsinc.com/images/kbdheb_shift.jpg"></FONT></P>
<P><FONT face=Tahoma><IMG src="http://trigeminal.fmsinc.com/images/kbdheb_caps.jpg"></P></FONT>
<P><FONT face=Tahoma>Note first how the square brackets <STRONG>[</STRONG> and <STRONG>]</STRONG> (<A href="http://www.fileformat.info/info/unicode/char/005b">U+005b</A> and <A href="http://www.fileformat.info/info/unicode/char/005d">U+005d</A>) actually seem to flip on the keyboard layout depending on whether you are in the English or the Hebrew "mode" of the layout?</FONT></P>
<P><FONT face=Tahoma>Well, remember that what is displayed will entirely depend on the context of what is around it, and then try to type a word like שלום surrounded by parentheses.</FONT></P>
<P><FONT face=Tahoma>Incidentally, that&nbsp;is the word for hello, goodbye, and peace in Hebrew. By the time you play with this for a bit you will not know what is coming or going on this keyboard and you will want to be left alone in peace. Which makes it a great word for our current purposes.</FONT></P>
<P><FONT face=Tahoma>If you are using a US keyboard you would type <STRONG>A K U O</STRONG> to get the word (just to save some of the experimentation). So now, armed with all of this knowledge, try to type the following in Notepad:</FONT></P>
<P><FONT face=Tahoma size=5><STRONG>שלום (שלום) שלום</STRONG></FONT></P>
<P><FONT face=Tahoma>Then for giggles, <A href="http://archives.miloush.net/michkap/archive/2005/11/04/489013.html">flip the reading order</A> and see what it looks like. Then start over with the other reading order and try to type it again.</FONT></P>
<P><FONT face=Tahoma>And this is an easy word since get a completely Hebrew context around the parentheses when you are done. Imagine what would happen if you had to type something that ended with a parenthesis....</FONT></P>
<P><FONT face=Tahoma>It is amazing how little what is painted on the faces of a Hebrew keyboard layout has </FONT><FONT face=Tahoma>to do with what appears to be typed. While this may be something that a native typist in a languge can understand, it is clearly learned behavior as there is no way on earth to consider any of this to be intuitive.</FONT></P>
<P><FONT face=Tahoma>Especially considering the fact that the parentheses <STRONG>(</STRONG> and <STRONG>)</STRONG> (<A href="http://www.fileformat.info/info/unicode/char/0028">U+0028</A> and <A href="http://www.fileformat.info/info/unicode/char/0029">U+0029</A>) are only on the "English" shift states of this keyboard so you don't even get the behavior approaching intuitive that some might argue the brackets have.</FONT></P>
<P><FONT face=Tahoma>Imagine if that <A href="http://archives.miloush.net/michkap/archive/2005/07/20/441227.html">Ultimate Keyboard</A> were more than fictional -- if it is hard typing certain types of punctuation&nbsp;with&nbsp;a static&nbsp;keyboard, imagine how much harder it would be to handle one based on a constantly changing one -- especially at the end of text. I hope that it would stay stable, for that reason....</FONT></P>
<P><FONT face=Tahoma>This of course indirectly answers some related non-fictional questions around the <A href="http://www.microsoft.com/windows2000/en/advanced/help/osk_overview.htm">OSK (On-Screen Keyboard) and the Tablet PC Soft Keyboard</A>. You probably would not want to try to make them change whether the mirrored or unmirrored glyph should appear, based on what would be about to be typed.</FONT></P>
<P><FONT face=Tahoma>Perhaps you disagree. Hey, no worries, people often disagree with me.</FONT></P>
<P><FONT face=Tahoma>So how do you determine which glyph to show, since you are so sure I am mistaken? :-)</FONT></P>
<P><FONT face=Tahoma>You will find that you are&nbsp;basically re-implementing the Unicode Bidirectional Algorithm so you can tell what level you are currently at. For any text, any time a cursor is inserted somewhere, any time you are using a Hebrew, Ararbic, Persian, or Urdu keyboard.</FONT></P>
<P><FONT face=Tahoma>Oh wait -- what about when you are typing parentheses from the French keyboard in the middle of Arabic text? I guess you had better make this happen at all times, for all keyboard layouts.</FONT></P>
<P><FONT face=Tahoma>How comfortable would you be trying to create such a system?</FONT></P>
<P><FONT face=Tahoma>And then ask yourself how comfortable people would be trying to type in such a situation, again?</FONT></P>
<P><FONT face=Tahoma>I am going to go lie down for a bit, my head is hurting and I need some שלום.</FONT></P>
<P><FONT face=Tahoma></FONT>&nbsp;</P>
<P><FONT face=Tahoma color=#ff1493><EM>This post brought to you by</EM> "<FONT size=6>﴾</FONT>" <EM>(<A href="http://www.fileformat.info/info/unicode/char/fd3e">U+fd3e</A>, a.k.a.&nbsp;ORNATE LEFT PARENTHESIS)<BR><FONT size=1>(As you may have guessed, the ornate parentheses are nor mirrored. If you ever meet me in person feel free to ask me why!)</FONT></EM></FONT></P>
<hr/><p><a id="535463" href="#535463">#</a> <strong>Nick Lamb</strong> on 20 Feb 2006 10:39 AM:</p><div style="margin-left: 1em">Once again the example you've used just repeats a single word, and so it's more confusing/ less instructive than real Hebrew text. You've also increased the confusion by relying on the &quot;flip reading order&quot; pseudo-feature, it would again be much better if Microsoft implemented UAX #9 fully and deprecated &quot;reading order&quot; flags.<br><br>In reality for all but the simplest BiDi tasks users tend to rely on trial and error to get the computer to do what they want. UAX #9 if implemented fully does at least produce consistent results across many computers and operating systems, which is a blessing.</div>
<p><a id="535474" href="#535474">#</a> <strong>Michael S. Kaplan</strong> on 20 Feb 2006 10:49 AM:</p><div style="margin-left: 1em">Sigh....<br><br>Nick, the Hebrew WORDS here mean nothing -- I could have used the RLM and gotten the same result. The point is about the parens, and if you are not a native typist then there is no way that those parens will not be confusing.<br><br>And this has nothing to do with the feature of the reading order, otherthan the fact this IS a feasture that is important. Not mentioning it to try to make things sound less confusing is an exercise in denial.<br><br>As for UAX#9, if it were easy an intuitive then the Bidi discusssion list hosted by Unicode woul not be as difficult to get easy answers from, and we would not spend as long with Bidi issues as we do in the UTC when they come up. NONE of this is easy or intuitive....</div>
<p><a id="535541" href="#535541">#</a> <strong>Michael S. Kaplan</strong> on 20 Feb 2006 12:21 PM:</p><div style="margin-left: 1em">For people who truly feel cheated at the &quot;confusing&quot; nature of the repeated word, the string<br><br>אבגד (הוזח) טיכל<br><br>should suffice (of course you'll have to go figure how to type it!).</div>
<p><a id="535652" href="#535652">#</a> <strong>Michael Dunn_</strong> on 20 Feb 2006 3:05 PM:</p><div style="margin-left: 1em">About 2-3 weeks ago on TWiT, they mentioned that the Optimus keyboard was actually going to be produced. They theorized that the cost would be too high for mass market production, but still, you'll be able to get one (eventually).</div>
<p><a id="535682" href="#535682">#</a> <strong>Michael S. Kaplan</strong> on 20 Feb 2006 4:05 PM:</p><div style="margin-left: 1em">Hmmmm.... I will remain skeptical about Optimus for the reasons previously indicated. :-)</div>
<p><a id="535690" href="#535690">#</a> <strong>Michael S. Kaplan</strong> on 20 Feb 2006 4:12 PM:</p><div style="margin-left: 1em">Note also that TWiT added nothing new -- they are quoting the FAQ that has been up there since shortly after I posted....</div>
<p><strong>My new virtual hebrew keyboard</strong> on 8 Aug 2010 6:23 AM:</p><div style="margin-left: 1em"><p>Hi,</p>
<p>I`ve created a new mikledet ( hebrew keyboard ) at <a rel="nofollow" target="_new" href="http://hebrew-keyboard.com/">http://hebrew-keyboard.com</a> </p>
<p>Nice one with multiple skins...</p>
</div>
<p><strong>Michael S. Kaplan</strong> on 8 Aug 2010 7:32 AM:</p><div style="margin-left: 1em"><p>Are you saying it solves this problem? If so, how does it do it?</p>
</div>
<hr/><p><em>referenced by</em></p><div style="margin-left: 1em"><p>2008/08/25 <a href="http://archives.miloush.net/michkap/archive/2008/08/25/8893033.html">The Bidi Algorithm's own SEP Field</a></p><p>2008/08/16 <a href="http://archives.miloush.net/michkap/archive/2008/08/16/8871262.html">Optimus: from science fiction to fiction to frustration to geek porn, in just 24 months</a></p><p>2006/05/28 <a href="http://archives.miloush.net/michkap/archive/2006/05/28/609369.html">Mirror, mirror... before whom I fuss, does mirroring work well in GDI+?</a></p></div><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2006/02/20/535291.html" title="A chance for me to give practical advice!">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2006/02/19/535148.html" title="Making a mark in code windows">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2006-02">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2006-02-20">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2006/02/20/535260.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:40 GMT -->
</html>