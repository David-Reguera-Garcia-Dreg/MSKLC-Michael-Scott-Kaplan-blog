<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2006/05/13/596971.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:39 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>Which language strings to load? How to load them?</title></head><body>
<h1>Which language strings to load? How to load them?</h1>
<p><em>by Michael S. Kaplan, published on 2006/05/13 13:15 -04:00, original URI: http://blogs.msdn.com/b/michkap/archive/2006/05/13/596971.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<P><FONT face=Tahoma>The SZ (a.k.a. Steffen) asked in the suggestion box: </FONT></P>
<BLOCKQUOTE dir=ltr style="MARGIN-RIGHT: 0px">
<P><FONT face="Times New Roman" size=2>What is the prefered way to select the "most usefull" language in a multi language app? <BR><BR>If I'm using "LoadString" I'm getting the os language <BR>If I'm using "GetUserDefaultUILanguage" I'm getting the os language if no mui pack is installed. <BR><BR>I know there are are a lot of posts about the trillions of different language api's. I know windows doesn't have a "I wanna that the apps are talking 'german'" setting. But a german user on a english os will set something or all possible settings in the control panel to something german. <BR><BR>Currently I'm using GetUserDefaultLangID. <BR><BR>Steffen </FONT></P></BLOCKQUOTE>
<P><FONT face=Tahoma>Actually, the <A href="http://msdn.microsoft.com/library/en-us/winui/winui/windowsuserinterface/resources/strings/stringreference/stringfunctions/loadstring.asp">LoadString</A> function is a simple wrapper around <A href="http://msdn.microsoft.com/library/en-us/winui/winui/windowsuserinterface/resources/introductiontoresources/resourcereference/resourcefunctions/findresource.asp">FindResource</A>, which uses the user UI language provided by <A href="http://msdn.microsoft.com/library/en-us/intl/nls_5c85.asp">GetUserDefaultUILanguage</A>. Before the Multilingual User Interface existed, this was always the OS install language, but now it is completely configurable to whatever language th operating system is set to.</FONT></P>
<P><FONT face=Tahoma>While it makes a good default (there is an obvious good faith basis that a developer can assume that a user knows the language into which the OS is translated, at least&nbsp;well enough to navigate to an installed application!), it is always possible that an application might be translated into more languages than are actually available in the UI language list.</FONT></P>
<P><FONT face=Tahoma>In such cases, an application might still wish to use the UI language provided by <A href="http://msdn.microsoft.com/library/en-us/intl/nls_5c85.asp">GetUserDefaultUILanguage</A>&nbsp;as a starting point, it may make sense to provide a custom user interface to allow language selection that diverges from the operating system list....</FONT></P>
<P><FONT face=Tahoma>Of course, going down the <A href="http://msdn.microsoft.com/library/en-us/winui/winui/windowsuserinterface/resources/introductiontoresources/resourcereference/resourcefunctions/findresourceex.asp">FindResourceEx</A>/<A href="http://msdn.microsoft.com/library/en-us/winui/winui/windowsuserinterface/resources/introductiontoresources/resourcereference/resourcefunctions/loadresource.asp">LoadResource</A>/<A href="http://msdn.microsoft.com/library/en-us/winui/winui/windowsuserinterface/resources/introductiontoresources/resourcereference/resourcefunctions/lockresource.asp">LockResource</A> route starts off easily enough but gets more complicated after that, which is one of the reasons that <A href="http://msdn.microsoft.com/library/en-us/winui/winui/windowsuserinterface/resources/strings/stringreference/stringfunctions/loadstring.asp">LoadString</A>&nbsp;is so appealing as a function, and why a LoadStringEx that takes a language would really be a sensible addition to the platform.</FONT></P>
<P><FONT face=Tahoma>The format of string resources is described in the MS Knowledge Base (<A href="http://support.microsoft.com/support/kb/articles/q196/7/74.asp">196774</A>) and <A href="http://blogs.msdn.com/oldnewthing/">Raymond Chen</A> posted a good sample on how to actually use this knowledge in his post <A href="http://blogs.msdn.com/oldnewthing/archive/2004/01/30/65013.aspx">The Format of String Resources</A>. It saves me from posting such a function here, so I will just go ahead and riff on Raymond a bit. :-)</FONT></P>
<P><FONT face=Tahoma>You can also look to him for an explanation of why UnlockResource and <A href="http://msdn.microsoft.com/library/en-us/winui/winui/windowsuserinterface/resources/introductiontoresources/resourcereference/resourcefunctions/freeresource.asp">FreeResource</A> are no longer&nbsp;needed in his post <A href="http://blogs.msdn.com/oldnewthing/archive/2004/02/02/66159.aspx">The management of memory for resources in 16-bit Windows</A>.</FONT></P>
<P><FONT face=Tahoma>In truth, all that <A href="http://msdn.microsoft.com/library/en-us/winui/winui/windowsuserinterface/resources/introductiontoresources/resourcereference/resourcefunctions/lockresource.asp">LockResource</A> currently does in a cast from an HGLOBAL to an LPVOID (as others have noticed, they both seem to have the same pointer), but this is a time when it is best to take as hint from the documentation and keep calling it, in case that ever changes....</FONT></P>
<P><FONT face=Tahoma></FONT>&nbsp;</P>
<P><FONT face=Tahoma color=#ff1493><EM>This post brought to you by</EM> "‡™ç" <EM>(<A href="http://www.fileformat.info/info/unicode/char/0a8d">U+0a8d</A>, a.k.a. GUJARATI VOWEL CANDRA E)</EM></FONT></P>
<hr/><p><a id="597063" href="#597063">#</a> <strong>Mihai</strong> on 13 May 2006 4:37 PM:</p><div style="margin-left: 1em">&lt;&lt;going down the FindResourceEx/LoadResource/LockResource route starts off easily enough but gets more complicated&gt;&gt;<br><br>This is one of the reasons why resource only DLLs with one language per DLL is better.<br></div>
<p><a id="597068" href="#597068">#</a> <strong>Michael S. Kaplan</strong> on 13 May 2006 4:42 PM:</p><div style="margin-left: 1em">Very true, Mihai!<br><br>Though if you look at the Vista model, they are looking to get the best of both worlds. More on this, soon. :-)</div>
<p><a id="597080" href="#597080">#</a> <strong>Mihai</strong> on 13 May 2006 5:35 PM:</p><div style="margin-left: 1em">&lt;&lt;if you look at the Vista model, they are looking to get the best of both worlds&gt;&gt;<br>I think this is rethorical :-) You know I did already :-)<br><br>But I would go beyond the technical part (API and such).<br>As user experience, I would prefer to allow the user to select the language per application.<br>So I would say the user should get a list with all languages in which the application is available (which is completely independent of the OS) plus an extra option &quot;Match the OS UI Language&quot;<br>The user can sort the list as he prefers, and this is is.<br><br>For instance:<br> &nbsp;French<br> &nbsp;Match the system<br> &nbsp;English<br> &nbsp;Italian<br>will allways show French<br><br>Example 2<br> &nbsp;Match the system<br> &nbsp;French<br> &nbsp;English<br> &nbsp;Italian<br>Will show French if OS UI is French<br>Will show English if OS UI is English<br>Will show Italian if OS UI is Italian<br>Will show French if OS UI is anything else<br></div>
<p><a id="597087" href="#597087">#</a> <strong>Michael S. Kaplan</strong> on 13 May 2006 6:05 PM:</p><div style="margin-left: 1em">Well, like I said I'll be talking about the changes to the model for Vista that support this notion more fully.... <br><br>Hang in there, it is coming soon!</div>
<p><a id="597612" href="#597612">#</a> <strong>Dean Harding</strong> on 14 May 2006 8:42 PM:</p><div style="margin-left: 1em">Yeah, I remember doing the string-table parsing myself, once. It was for a server product where the client sent their language ID over a custom protocol we had. I was really wishing there was a LoadStringEx then :)</div>
<p><a id="597812" href="#597812">#</a> <strong>Centaur</strong> on 15 May 2006 3:40 AM:</p><div style="margin-left: 1em">I absolutely hate it when applications detect that I have Russian locale set, forget to check my default UI language, and try to talk to me in Russian. Sadly, there are still many of those, and I suppose a major reason is that GetUserDefaultUILanguage did not exist before XP, and those developers cannot be bothered to write OS-specific language detection code.</div>
<hr/><p><em>referenced by</em></p><div style="margin-left: 1em"><p>2007/07/13 <a href="http://archives.miloush.net/michkap/archive/2007/07/13/3852677.html">GetLocaleInfo for other languages?</a></p></div><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2006/05/13/597205.html" title="We mimicked the display rather than the actual data">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2006/05/13/596774.html" title="Font embedding -- the intro">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2006-05">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2006-05-13">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2006/05/13/596971.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:39 GMT -->
</html>