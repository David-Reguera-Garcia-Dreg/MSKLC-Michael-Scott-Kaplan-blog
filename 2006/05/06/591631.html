<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2006/05/06/591631.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:39 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>Keyboards and time zones have something in common</title></head><body>
<h1>Keyboards and time zones have something in common</h1>
<p><em>by Michael S. Kaplan, published on 2006/05/06 15:41 -04:00, original URI: http://blogs.msdn.com/b/michkap/archive/2006/05/06/591631.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<P><FONT face=Tahoma>Earlier today I talked about <STRONG><A href="http://archives.miloush.net/michkap/archive/2006/05/06/591174.html">Getting the real (localized) name of the keyboard</A></STRONG>.</FONT></P>
<P><FONT face=Tahoma>In that post, I talked about how the change happened in XP to move from using <STRONG>Layout Text</STRONG> to using <STRONG>Layout Display Name</STRONG>, which on the whole was a good idea (the hard-coded localized strings in the registry being&nbsp;a bad way to manage the names since they would not work well with MUI).</FONT></P>
<P><FONT face=Tahoma>But I didn't mention the way this broke some components, basically anybody who was relying on the <STRONG>Layout Text</STRONG> to represent the localized keyboard name.</FONT></P>
<P><FONT face=Tahoma>Now I don't include the <A href="http://msdn.microsoft.com/library/en-us/cpref/html/frlrfsystemwindowsformsinputlanguageclasstopic.asp">InputLanguage</A> in that category, since although it was technically broken running on XP as compared to running on Windows 2000, even the first version of the .NET Framework could have fixed this problem if it wanted to (it is fixed for version 2.0). But certainly any other application getting keyboard names that are localized is broken since now they will always get English....</FONT></P>
<P><FONT face=Tahoma>(this is an issue I hinted about ages ago in <A href="http://archives.miloush.net/michkap/archive/2004/12/06/275506.html">this</A> post)</FONT></P>
<P><FONT face=Tahoma>The same problem happens again in Vista, with the time zone names, stored in HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Time Zones\ on NT-based machines. Each time zone has a <STRONG>Dlt</STRONG> string for daylight savings time and an <STRONG>Std</STRONG> string for standard time.</FONT></P>
<P><FONT face=Tahoma>This is really the same problem all over&nbsp;again, where <STRONG>Pacific Standard Time</STRONG> is given the two strings <STRONG>Pacific Standard Time</STRONG> and <STRONG>Pacific Daylight Time</STRONG>, and then localized in each language SKU. There is even a <STRONG>Display</STRONG> string I forgot to mention, <STRONG>(GMT-08:00) Pacific Time (US &amp; Canada)</STRONG>.</FONT></P>
<P><FONT face=Tahoma>Not very MUI-friendly, is it?</FONT></P>
<P><FONT face=Tahoma>So now in Vista these strings will all be in English all the time, and three new values (<STRONG>MUI_Display</STRONG>, <STRONG>MUI_Dlt</STRONG>, and <STRONG>MUI_Std</STRONG>) will contain strings in <A href="http://msdn.microsoft.com/library/en-us/shellcc/platform/shell/reference/shlwapi/string/shloadindirectstring.asp">SHLoadIndirectString</A>-friendly format, so they can be loaded from a DLL.</FONT></P>
<P><FONT face=Tahoma><EM>(As a by-the-way, </EM><A href="http://msdn.microsoft.com/library/en-us/shellcc/platform/shell/reference/shlwapi/string/shloadindirectstring.asp"><EM>SHLoadIndirectString</EM></A><EM>&nbsp;is well designed in terms of backcompat since if the string passed in is not in the specific format, the same string is returned -- so people adding their own items will not see anything break!)</EM></FONT></P>
<P><FONT face=Tahoma>So, all is well and good and much more MUI-friendly, though it does mean there will be problems in the BCL time zone sample I mentioned <A href="http://archives.miloush.net/michkap/archive/2006/04/03/567489.html">here</A>. Though more importantly, there are all of the appliactions like Microsoft Outlook that depend on the localized strings for their own UI. Oops!</FONT></P>
<P><FONT face=Tahoma>Of course it is not like these applications are using documented means to get at the strings, so although there will of course likely be an effort to shim pre-existing applications, new ones will need to make the change to get the names the new way....</FONT></P>
<P><FONT face=Tahoma>Getting the last few issues related to differences between localized versions and MUI is a very expensive process -- this kind of backcompat issue is just one example of the expense (and much of the Windows project can be thought of as a good negative example on how to not localize software, given how expensive these later fixes can get!).</FONT></P>
<P><FONT face=Tahoma></FONT>&nbsp;</P>
<P><FONT face=Tahoma color=#ff1493><EM>This post brought to you by</EM> "à°ˆ" <EM>(<A href="http://www.fileformat.info/info/unicode/char/0c08">U+0c08</A>, a.k.a. TELUGU LETTER II)</EM></FONT></P>
<hr/><div style="margin-left: 1em"><em>no comments</em></div><hr/><p><em>referenced by</em></p><div style="margin-left: 1em"><p>2011/12/27 <a href="http://archives.miloush.net/michkap/archive/2011/12/27/10251232.html">You don't waste my time if you 'reinvent the wheel' but you often waste yours!</a></p></div><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2006/05/07/591771.html" title="That songwriters round I was at">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2006/05/06/591174.html" title="Getting the real (localized) name of the keyboard">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2006-05">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2006-05-06">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2006/05/06/591631.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:39 GMT -->
</html>