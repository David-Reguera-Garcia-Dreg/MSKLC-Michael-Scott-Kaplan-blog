<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2006/05/05/590504.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:39 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>UI language of the LocalSystem account (which almost never shows UI)</title></head><body>
<h1>UI language of the LocalSystem account (which almost never shows UI)</h1>
<p><em>by Michael S. Kaplan, published on 2006/05/05 04:01 -04:00, original URI: http://blogs.msdn.com/b/michkap/archive/2006/05/05/590504.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<P><FONT face=Tahoma>I have talked about the notion of the language SKU specific nature of <A href="http://archives.miloush.net/michkap/archive/2005/03/20/399322.html" mce_href="http://archives.miloush.net/michkap/archive/2005/03/20/399322.html">both</A> <STRONG><A href="http://archives.miloush.net/michkap/archive/2006/03/18/554308.html" mce_href="http://archives.miloush.net/michkap/archive/2006/03/18/554308.html">MS Shell Dlg</A></STRONG> and <A href="http://archives.miloush.net/michkap/archive/2006/04/28/585735.html" mce_href="http://archives.miloush.net/michkap/archive/2006/04/28/585735.html">of DEFAULT_GUI_FONT</A>, but technically I was at least partially speaking of a bygone era.</FONT></P>
<P><FONT face=Tahoma>Back in the before time, in the long long ago, GDI would load its resources based on information&nbsp;in the registry that would never change. The information in the registry was different in several of the various language SKUs of Windows. And it never changed.</FONT></P>
<P><FONT face=Tahoma>At the same time, some of the other functionality (such as <A href="http://archives.miloush.net/michkap/archive/2005/10/01/476022.html" mce_href="http://archives.miloush.net/michkap/archive/2005/10/01/476022.html">GDI font linking</A>) was based on the default system locale, a bizarre setup that no one really can explain other to say that they couldn't think of anything else to base it on, and it would help some of those legacy Win9x applications with specific code page assumptions and matching font assumptions....</FONT></P>
<P><FONT face=Tahoma>Then in Windows 2000, when the Windows Multilingual User Interface (MUI) was first put out there, the notion of the UI language of the system account (which happened to match the SKU language since it could never be changed) was added, and at some point the GDI code starting using this setting during its session initialization routines. No one quite new when/why this was done, though it was suggested that convenience was the main driving factor. :-)</FONT></P>
<P><FONT face=Tahoma>Of course one of the interesting features that was added in was the notion of applying Regional and Language Options choices to the "Default User Account Settings"....</FONT></P>
<P><IMG style="WIDTH: 404px; HEIGHT: 478px" height=478 src="http://www.i18nwithvb.com/images/RLO_Tab3.jpg" width=404 mce_src="http://www.i18nwithvb.com/images/RLO_Tab3.jpg"></P>
<P><FONT face=Tahoma>I have talked before about just one of the interesting featurelets that this exposed (<A href="http://archives.miloush.net/michkap/archive/2005/01/07/348944.html" mce_href="http://archives.miloush.net/michkap/archive/2005/01/07/348944.html"><STRONG>changing the keyboard in the logon dialog</STRONG></A>). One of the other intersting features it helped out with was applying settings such as the UI language to all of the following places:</FONT></P>
<UL>
<LI><FONT face=Tahoma>The NetworkService profile</FONT></LI>
<LI><FONT face=Tahoma>The LocalService profile</FONT></LI>
<LI><FONT face=Tahoma>The Default User&nbsp;profile (used as the template for all new user accounts created on the machine)</FONT></LI>
<LI><FONT face=Tahoma>The .DEFAULT profile (used for the LocalSystem account)</FONT></LI></UL>
<P><FONT face=Tahoma>Now that last setting had an interesting consequence on our GDI story, since changing the UI language and clicking that checkbox on the advanced tab would change many of the actual places that the code was using to get the language SKU settings -- in essence, changing many facets that were used to determine what the original install language was.</FONT></P>
<P><FONT face=Tahoma>Luckily it never occurred to them to call the <A href="http://msdn.microsoft.com/library/en-us/intl/nls_2ip1.asp" mce_href="http://msdn.microsoft.com/library/en-us/intl/nls_2ip1.asp">GetSystemDefaultUILanguage</A> function, whose value does not change when this new notion of the "<STRONG>UI language of the LocalSystem account&nbsp;(which almost never shows UI)</STRONG>" does. Because if they had, then we wouldn't have this whole budding area of&nbsp;bizarre functionality!</FONT></P>
<P><FONT face=Tahoma>I suppose this new setting needs some kind of shorter name (since saying that whole phrase over and over again would really wear me down). Maybe the <STRONG>.DEFAULT UI Language</STRONG> (<EM>pronounced dot-default-yoo-eye-language</EM>). What do you think?</FONT></P>
<P><FONT face=Tahoma>Is inventing new terminology like this a linguistic issue? Or am I stretching?</FONT></P>
<P><FONT face=Tahoma>In fact, there is no function to get this [somewhat interesting, though rather obscure] setting, currently. I will talk more about this setting, what it does, and what it causes to happen,&nbsp;in future posts.... :-)</FONT></P>
<P><FONT face=Tahoma></FONT>&nbsp;</P>
<P><FONT face=Tahoma color=#ff1493><EM>This post brought to you by</EM> "<FONT size=6>êƒ†</FONT>" <EM>(<A href="http://www.fileformat.info/info/unicode/char/a0c6" mce_href="http://www.fileformat.info/info/unicode/char/a0c6">U+a0c6</A>, a.k.a. YI SYLLABLE MUP)</EM></FONT></P>
<hr/><p><a id="603675" href="#603675">#</a> <strong>John</strong> on 22 May 2006 5:33 AM:</p><div style="margin-left: 1em">Intersting information. I was wondering where LocalSystem got its settings because I needed to change them.</div>
<p><a id="652162" href="#652162">#</a> <strong>Aidan Corey</strong> on 30 Jun 2006 7:47 AM:</p><div style="margin-left: 1em">You say that the &quot;apply to default&quot; checkbox also causes changes to be applied to the NetworkService and LocalService profiles.<br><br>On Win2003 this does not appear to be the case (as evidenced both by the behaviour of my application which is running under NetworkService, and the fact that HKU\S-1-5-20\Control Panel\International still contains the previous locale settings).<br><br>Is there a recommended way to change regional settings for these profiles?</div>
<p><a id="652220" href="#652220">#</a> <strong>Michael S. Kaplan</strong> on 30 Jun 2006 9:15 AM:</p><div style="margin-left: 1em">Hi Aidan, <br><br>Like I said above, until Vista the setting changed for these accounts is mainly just UI language (.DEFAULT and Default User gets a bit more than that). Although FWIW this does change in Vista, I believe.<br><br>As for how to change settings, have you tried running intl.cpl in unattend mode from the account you want to change? Or calling SetLocaleInfo?</div>
<hr/><p><em>referenced by</em></p><div style="margin-left: 1em"><p>2012/01/31 <a href="http://archives.miloush.net/michkap/archive/2012/01/31/10261506.html">Sometimes things are extended in the wrong direction....</a></p><p>2010/08/01 <a href="http://archives.miloush.net/michkap/archive/2010/08/01/10044632.html">It's not a localization bug; it's a core bug in the way they do their globalization and resource loading</a></p><p>2008/11/13 <a href="http://archives.miloush.net/michkap/archive/2008/11/13/9065195.html">On reverting unexplained spontaneous alteration of language</a></p><p>2008/08/05 <a href="http://archives.miloush.net/michkap/archive/2008/08/05/8833203.html">On describing poorly (and on not listening)</a></p><p>2007/10/25 <a href="http://archives.miloush.net/michkap/archive/2007/10/25/5660564.html">Is it a Unicode issue? A non-Unicode issue? What the hell is it? (aka Beware former [Font ]Associations)</a></p><p>2007/09/21 <a href="http://archives.miloush.net/michkap/archive/2007/09/21/5025885.html">If you had gotten there first, you might have staked your claim too!</a></p><p>2007/06/16 <a href="http://archives.miloush.net/michkap/archive/2007/06/16/3345079.html">You don't have to trust Microsoft's choices about fonts</a></p><p>2006/11/29 <a href="http://archives.miloush.net/michkap/archive/2006/11/29/1170815.html">Where'd *that* language come from?</a></p><p>2006/06/12 <a href="http://archives.miloush.net/michkap/archive/2006/06/12/627185.html">More problems with the Shell's 'ultimate font' solutions</a></p></div><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2006/05/06/591174.html" title="Getting the real (localized) name of the keyboard">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2006/05/05/590465.html" title="You&#39;ve never heard of Access .MDX files?">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2006-05">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2006-05-05">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2006/05/05/590504.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:39 GMT -->
</html>