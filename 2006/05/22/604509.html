<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2006/05/22/604509.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:39 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>UI language != input language (at least not always!)</title></head><body>
<h1>UI language != input language (at least not always!)</h1>
<p><em>by Michael S. Kaplan, published on 2006/05/22 23:50 -07:00, original URI: http://blogs.msdn.com/michkap/archive/2006/05/22/604509.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostOld -->
<P><FONT face=Tahoma>Rune <A href="http://archives.miloush.net/michkap/archive/2006/05/20/602745.html#604435">asked</A> (in <A HREF="http://archives.miloush.net/michkap/archive/2006/05/20/602745.html">this</A> post):</FONT></P>
<BLOCKQUOTE dir=ltr style="MARGIN-RIGHT: 0px">
<P><FONT face="Times New Roman" size=2>Michael, on a related note, could you shed some light on language vs input locale? <BR><BR>I typically use a Norwegian keyboard layout, but many applications seem to think this means I also want Norwegian language in the UI. The most frustrating example is installing Intel's NIC drivers on a server. Half of the UI is in English and the rest in Norwegian. Confusing to say the least and certainly annoying. <BR><BR>I've been looking for a separate value that indicates the preferred language of the user, but all I can find is the input locale. <BR><BR>Rather silly if this is the case, but I do see many apps that makes this assumption, so... <BR><BR>There's nothing wrong with Norwegian, but the community is too small to warrant translation of computer terms. Someone have of course tried, but we all ignore their efforts. </FONT></P></BLOCKQUOTE>
<P><FONT face=Tahoma>Reading this was a horrifying experience for me, Rune....</FONT></P>
<P><FONT face=Tahoma>It is one thing for people to misuse or misunderstand the differences between user locale, system locale, and UI language. And I have seen applications where one or&nbsp;both of the first two are mistaken for the third.</FONT></P>
<P><FONT face=Tahoma>After all, the functions (<A href="http://msdn.microsoft.com/library/en-us/intl/nls_08tg.asp">GetUserDefaultLCID</A>, <A href="http://msdn.microsoft.com/library/en-us/intl/nls_85yc.asp">GetSystemDefaultLCID</A>, and <A href="http://msdn.microsoft.com/library/en-us/intl/nls_5c85.asp">GetUserDefaultUILanguage</A>) are so easy to confuse, especially with confusing text like what is in <A href="http://msdn.microsoft.com/library/en-us/intl/nls_08tg.asp">GetUserDefaultLCID</A>:</FONT></P>
<BLOCKQUOTE dir=ltr style="MARGIN-RIGHT: 0px">
<BLOCKQUOTE dir=ltr style="MARGIN-RIGHT: 0px">
<H4><FONT size=2>Remarks</FONT></H4>
<P><FONT size=2>On single-user systems, the return value is the same as that returned by </FONT><A href="http://msdn.microsoft.com/library/en-us/intl/nls_85yc.asp"><B><FONT size=2>GetSystemDefaultLCID</FONT></B></A><FONT size=2>.</FONT></P></BLOCKQUOTE></BLOCKQUOTE>
<P><FONT face=Tahoma>But any application or driver that mixes up the input locale up with any of these is one that I would probably be pretty quick to uninstall. For me that just crosses a line....</FONT></P>
<P><FONT face=Tahoma>Say it ain't so, Rune! Please! :-)</FONT></P>
<P><FONT face=Tahoma></FONT>&nbsp;</P>
<P><FONT face=Tahoma color=#ff1493><EM>This post brought to you by</EM> "<FONT size=6>ê€¹</FONT>" <EM>(<A href="http://www.fileformat.info/info/unicode/char/a039">U+a039</A>, a.k.a. YI SYLLABLE PIX)</EM></FONT></P>
<hr/><p><a id="604532" href="#604532">#</a> <strong>dono</strong> on Tuesday, May 23, 2006 3:30 AM:</p><div style="margin-left: 1em">I can relate.<br>My English-language XP system has the non-Unicode program setting set to Japanese. The Dell-installed system help files are in Japanese. The laptop pointer startup insists on a Japanese UI. The Java compiler insists on spitting out error messages in Japanese. Switching the non-Unicode support to English (US) fixes all of this. However, then I can not run the majority of my Japanese-lanaguage software (which unfortuately is mostly not Unicode-enabled). A little annoying, but I have learned to live with it.</div>
<p><a id="604567" href="#604567">#</a> <strong>Malcolm</strong> on Tuesday, May 23, 2006 4:33 AM:</p><div style="margin-left: 1em">@dono<br><br>Have you tried the AppLocale tool. &nbsp;It can set the non-unicode locale on a per-application basis. Not guaranteed to work, but might be worth a try:<br><br><a rel="nofollow" target="_new" href="http://www.microsoft.com/globaldev/tools/apploc.mspx">http://www.microsoft.com/globaldev/tools/apploc.mspx</a></div>
<p><a id="604617" href="#604617">#</a> <strong>dono</strong> on Tuesday, May 23, 2006 5:47 AM:</p><div style="margin-left: 1em">Malcolm,<br><br>Thanks. Yes, I am familiar with and have have tried the AppLocale tool, however with limited success. I experimented with various options a few years ago, but none were very satisfactory. I do not mind putting up with it anymore; it's just a pet-peeve.</div>
<p><a id="604623" href="#604623">#</a> <strong>The SZ</strong> on Tuesday, May 23, 2006 6:03 AM:</p><div style="margin-left: 1em">Nice to read all your blames to the developer, but what should we do?<br><br>Give me an example which functions I should use! Starting from 95 to Vista!<br><br>I'm using GetUserDefaultLangID to decided which language I will display in my apps. The GetUserDefaultUILanguage function sucks because it always returns the system language if no mui is installed!<br><br>Steffen</div>
<p><a id="604630" href="#604630">#</a> <strong>Christian</strong> on Tuesday, May 23, 2006 6:07 AM:</p><div style="margin-left: 1em">&gt; Give me an example which functions I should use! Starting from 95 to Vista! <br><br>I second that.<br><br>Ch.<br></div>
<p><a id="604685" href="#604685">#</a> <strong>Rune</strong> on Tuesday, May 23, 2006 8:10 AM:</p><div style="margin-left: 1em">Wow, that was a very fast follow-up Michael, thanks!<br><br>I was about to ask where I can set the UI Language, but Steffen's comment above seem to cover it.<br><br>I.e., since I haven't installed a MUI, the UI Language is English, right?<br><br>(Come to think of it, we're probably using the wrong method ourselves in our own application ;) )</div>
<p><a id="604779" href="#604779">#</a> <strong>Michael S. Kaplan</strong> on Tuesday, May 23, 2006 10:35 AM:</p><div style="margin-left: 1em">Sorry Steffen and Christian and Rune, but GetUserDefaultUILanguage is the right function to call when it is available -- because *that* is the UI language of Windows itself. It is therefore of the language of everything that appears for the user before they launch your application, and a reasonable first guess for a language they will know? <BR><BR>You can certainly provide your own UI to let them make another choice beyond that, but it is the first, best guess. <BR><BR>Also -- note that the UI language will not be English, it will be the UI lang of Windows, which itself ships in many different languages....</div>
<p><a id="605327" href="#605327">#</a> <strong>Jonas</strong> on Tuesday, May 23, 2006 6:25 PM:</p><div style="margin-left: 1em">One of the most prominent offenders is Sun with Java. I filed Bug 6380839 for that and it was marked as a duplicate of a 4-year-old RFE.<br><br><a rel="nofollow" target="_new" href="http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=6380839">http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=6380839</a><br><br>It's so bad that for some Java applications I need to break their EULAs and go through their .jar-archives and delete all foreign-language ResourceBundles, just to let our developers use english-language UIs with their German keyboards.</div>
<p><a id="605703" href="#605703">#</a> <strong>pelleplutt</strong> on Wednesday, May 24, 2006 3:23 AM:</p><div style="margin-left: 1em">*rant*<br><br>I'm sorry but I have to say this is Microsoft's fault by removing the UI Language choice from single-language OS versions.<br><br>What I mean is that many users in countries such as Sweden use an English Windows installation but given a choice they would prefer a 100% Swedish UI in their applications.<br>The UI choice in Regional Settings, however, is only available in the special multi-language Windows version that I've yet to encounter anywhere (every version of Mac OS X on the other hand is multi-language from start). I think it even costs more and I don't think any PC vendor OEM's it. Actually I don't think many poeple know it exists. And isn't there a multi-language Office version as well?<br><br>So what are we application developers to do - well we have to resort to ugly hacks such as checking the other regional settings such as &quot;Standards and Formats&quot; to abide to our users wishes. <br>I.e. if the default UI language is English and the user has selected to use Swedish numbers, dates and times, we set the UILanguage of our apps to Swedish. Probably what Java does as well and I can understand them.<br><br>I wonder if the single-language Vista versions keep this annoying behavior of removing a user setting that many apps would like to be able to depend on but can't.</div>
<p><a id="605719" href="#605719">#</a> <strong>dono</strong> on Wednesday, May 24, 2006 3:43 AM:</p><div style="margin-left: 1em">pelleplutt,<br><br>MUIs are unfortuately only available through volumn licensing programs:<br><a rel="nofollow" target="_new" href="http://www.microsoft.com/globaldev/DrIntl/faqs/MUIFaq.mspx#MUIques6">http://www.microsoft.com/globaldev/DrIntl/faqs/MUIFaq.mspx#MUIques6</a><br><br>[Off topic]<br>Speaking of which, Michael, are you familiar with the reasons behind this decision? I have been puzzled about it for a while. I know that I would like to get a hold of a few MUIs. If available for resell, I would most likely buy a few. LIPs are available, but not in the languages that I want. Is there any hope for general availablility (download or purchase) of MUIs in the future?</div>
<p><a id="605789" href="#605789">#</a> <strong>Rune</strong> on Wednesday, May 24, 2006 5:56 AM:</p><div style="margin-left: 1em">OK, I've been thinking about this some more. When you buy a computer from e.g. Dell Norway, you end up with Norwegian Windows. There's little choice (or not an obvious choice) and the user is more or less stuck with it.<br><br>Now, we just migrated to Exchange server, and when these users imported their old personal folders, they end up with two inboxes. One called &quot;Innboks&quot; and the old one &quot;Inbox&quot;. Why? Because Outlook now thinks it is important to translate these special folder names since the user is obviously using Norwegian Windows...<br><br>By hiding the language choice from the user, we developers are tricked into using &quot;alternative&quot; (i.e. wrong) methods to discover the user's preferred language. And even when using the right method, some users (me :) ) will still be offended.<br><br>I hope the Vista team can come up with a sleaker approach to this problem. ;)<br><br>-- <br>Rune</div>
<p><a id="605798" href="#605798">#</a> <strong>The SZ</strong> on Wednesday, May 24, 2006 6:06 AM:</p><div style="margin-left: 1em">I have installed english windows and set all regional settings to german. &nbsp;So which language do I expect? There is a reason why I set it to german. Because I'm in germany and speak german.<br><br>Of course, you can argue that I have to install a german version. But some people outside have installed a non-mother-tongue windows version. And only about these people we are talking. So my decision for GetUserDefaultLangID seems correct, because this function is returning german on my system.<br><br>In case of mui, GetUserDefaultLangID will probably return the same as GetUserDefaultUILanguage. (No user will install a english windows, install mui, set mui to swedish and locals to tonga)<br><br>Steffen</div>
<p><a id="606114" href="#606114">#</a> <strong>Mihai</strong> on Wednesday, May 24, 2006 12:32 PM:</p><div style="margin-left: 1em">&quot;LIPs are available, but not in the languages that I want.&quot;<br><br>From what I can see, only Slovenian is MUI only, everything else is MUI+LIP or LIP only.<br></div>
<p><a id="606120" href="#606120">#</a> <strong>Mihai</strong> on Wednesday, May 24, 2006 12:36 PM:</p><div style="margin-left: 1em">&lt;&lt;Give me an example which functions I should use!&gt;&gt;<br><br>&lt;&lt;I have installed X windows and set all regional settings to Y. So which language do I expect?&gt;&gt;<br><br><a rel="nofollow" target="_new" href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/intl/nls_0ddl.asp">http://msdn.microsoft.com/library/default.asp?url=/library/en-us/intl/nls_0ddl.asp</a><br><a rel="nofollow" target="_new" href="http://support.microsoft.com/default.aspx?scid=kb;en-us;258047">http://support.microsoft.com/default.aspx?scid=kb;en-us;258047</a><br></div>
<p><a id="606318" href="#606318">#</a> <strong>KJK::Hyperion</strong> on Wednesday, May 24, 2006 4:11 PM:</p><div style="margin-left: 1em">Don't quote me on this, but... if you have a legit Windows license, just pirate an English-language Windows, and pirate the MUI package (you can find a - slightly outdated - huge ISO with all languages, supporting all the way from Windows 2000 to Windows Server 2003). Microsoft can hardly accuse you of anything for doing that - consider it as giving them a big middle finger of feedback<br><br>Windows Vista will remove the need to pirate the English-language version, and introduces a new MUI API that is incompatible with the old one (but documented and much better) and the old MUI packs will probably stop working. I really hope language packs will then be available as free downloads, because the whole situation sucks</div>
<p><a id="606371" href="#606371">#</a> <strong>Michael S. Kaplan</strong> on Wednesday, May 24, 2006 4:55 PM:</p><div style="margin-left: 1em">Hi Steffen,<br><br>The mixed settings case is not as uncommon as you might think, whether it woul be something that you personally would want or not.<br><br>KJK::Hyperion -- no comment, other than to say that you are mostly incorrect, though no one from MS will have to hunt you down for piracy since the system will be unbootable.</div>
<p><a id="607771" href="#607771">#</a> <strong>Rune</strong> on Friday, May 26, 2006 2:20 AM:</p><div style="margin-left: 1em">OK, final thought: The WHQL certification should make sure drivers use these APIs appropriately. If I download the full &quot;international&quot; version of nVidia's approved drivers, I get the Norwegian UI (with confusing translation). The WHQL guys don't even bother testing PAE support, so recent (8x.xx) nVidia drivers won't work with &gt;4GB systems running 32-bit Win2003 either...<br><br>-- <br>Rune</div>
<hr/><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2006/05/23/604580.html" title="Hebrew punctuation on the keyboard layout?">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2006/05/21/603425.html" title="What&#39;s Next?">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2006-05">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2006-05-22">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2006/05/22/604509.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:39 GMT -->
</html>