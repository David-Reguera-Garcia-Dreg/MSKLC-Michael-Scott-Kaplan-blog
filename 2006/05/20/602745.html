<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2006/05/20/602745.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:39 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>How to REALLY handle the unattended version of Regional and Language Options</title></head><body>
<h1>How to REALLY handle the unattended version of Regional and Language Options</h1>
<p><em>by Michael S. Kaplan, published on 2006/05/20 13:20 -04:00, original URI: http://blogs.msdn.com/b/michkap/archive/2006/05/20/602745.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<P><FONT face=Tahoma>I have talked about the Microsoft Knowledge Base article that describes how to run Regional and Language Options in unattend mode (<A href="http://support.microsoft.com/default.aspx?scid=kb;en-us;289125">289125</A>), like in <A HREF="http://archives.miloush.net/michkap/archive/2006/02/10/529867.html"><STRONG>these</STRONG></A> <A HREF="http://archives.miloush.net/michkap/archive/2006/03/10/548670.html"><STRONG>three</STRONG></A> <A HREF="http://archives.miloush.net/michkap/archive/2006/02/23/538455.html"><STRONG>posts</STRONG></A>.</FONT></P>
<P><FONT face=Tahoma>In all three, I used a technique akin to the following to start the control panel applet, just as the KB article does:</FONT></P>
<BLOCKQUOTE dir=ltr style="MARGIN-RIGHT: 0px">
<P><STRONG><FONT face="Consolas,Courier New" size=4>rundll32.exe shell32,Control_RunDLL intl.cpl</FONT></STRONG></P></BLOCKQUOTE>
<P><FONT face=Tahoma>Allow me to point out at this point that I was incorrect, and so is that KB article.</FONT></P>
<P><FONT face=Tahoma>As Raymond Chen has <A HREF="http://blogs.msdn.com/oldnewthing/archive/2006/01/09/510781.aspx">pointed</A> <A HREF="http://blogs.msdn.com/oldnewthing/archive/2006/04/24/582152.aspx">out</A>, the right way to do it (unless you are working for Microsoft and trying to debug the bleeding control panel applet) is via control.exe:</FONT></P><FONT face=Tahoma>
<BLOCKQUOTE dir=ltr style="MARGIN-RIGHT: 0px">
<P><STRONG><FONT face=Consolas size=4>control.exe&nbsp;intl.cpl</FONT></STRONG></P></BLOCKQUOTE></FONT>
<P><FONT face=Tahoma>This is even the documented way to do things, as is described <A href="http://msdn.microsoft.com/library/en-us/shellcc/platform/shell/programmersguide/shell_adv/conpanel.asp">here</A>:</FONT></P><FONT face=Tahoma>
<BLOCKQUOTE dir=ltr style="MARGIN-RIGHT: 0px">
<P><STRONG><FONT face="Consolas,Courier New" size=4>control.exe&nbsp;International</FONT></STRONG></P></BLOCKQUOTE></FONT>
<P><FONT face=Tahoma>This is obviously much easier to remember and use than anything involving rundll32....</FONT></P>
<P><FONT face=Tahoma>And as reader Paul <A HREF="http://archives.miloush.net/michkap/archive/2006/02/10/529867.html#532095">pointed out</A>&nbsp;(posted again here so it can have more visibility!):</FONT></P>
<BLOCKQUOTE dir=ltr style="MARGIN-RIGHT: 0px">
<BLOCKQUOTE dir=ltr style="MARGIN-RIGHT: 0px">
<P><FONT size=2>Might be worth noting that this process does create a logfile, by default in c:\windows\regopt.log that has content like the following: </FONT></P>
<BLOCKQUOTE dir=ltr style="MARGIN-RIGHT: 0px">
<BLOCKQUOTE dir=ltr style="MARGIN-RIGHT: 0px">
<P><FONT size=2><FONT face="Consolas,Courier New" size=1><STRONG>************************************************************ <BR>Region and Languages Options Unattended Mode Log &nbsp; <BR>************************************************************ <BR><BR>/f:"c:\regopts.txt" /s:"I:\I386" <BR><BR>Switch /F detected! <BR>Switch /S detected! <BR>&lt;--- Unattended file log start----&gt; <BR>[RegionalSettings] <BR>LanguageGroup=11 <BR>InputLocale=041e:0000041e <BR>&lt;--- &nbsp;Unattended file log end ----&gt; <BR>Language group installation requested: 11 <BR>No valid Language settings found, look for individual keywords. <BR>Input locale installation requested. <BR>Keyboard Layout installation requested: 041e </STRONG></FONT></FONT></P></BLOCKQUOTE></BLOCKQUOTE>
<P><FONT size=2>The best thing is when you get it wrong (e.g. specify the wrong language group for the locale you are requesting etc) it actually tells you what you are doing wrong. <BR><BR>Also, with the /S switch, you point it at the i386 directory level, not the LANG level, it finds LANG etc by itself :) <BR><BR>Hope that comes of use to someone! </FONT></P></BLOCKQUOTE></BLOCKQUOTE>
<P><FONT face=Tahoma>In addition to all of this, let me add that I will be posting soon about the new Vista features related to running <STRONG>Regional and Language Options</STRONG> in an unattended mode, including some of the changes that have to be made to scripts here....</FONT></P>
<P><FONT face=Tahoma>Enjoy!</FONT></P>
<P><FONT face=Tahoma></FONT>&nbsp;</P>
<P><FONT face=Tahoma color=#ff1493><EM>This post brought to you by</EM> "<FONT size=6>áˆ¬</FONT>" <EM>(<A href="http://www.fileformat.info/info/unicode/char/122c">U+122c</A>, a.k.a. ETHIOPIC SYLLABLE REE)</EM></FONT></P>
<hr/><p><a id="602771" href="#602771">#</a> <strong>Ivan Petrov</strong> on 20 May 2006 2:35 PM:</p><div style="margin-left: 1em">Hi Michael.<br><br>Did you know how to start the 'Customize Regional Options' window using 'rundll32.exe' or 'control.exe' ?<br><br>Thanks in advance.<br><br>Regards,<br>Ivan.<br></div>
<p><a id="602785" href="#602785">#</a> <strong>Michael S. Kaplan</strong> on 20 May 2006 3:05 PM:</p><div style="margin-left: 1em">Sorry Ivan, there is actually no way to start it and open the customize dialog, other than to have some sort of UI automation press the button, etc.</div>
<p><a id="604435" href="#604435">#</a> <strong>Rune</strong> on 23 May 2006 1:38 AM:</p><div style="margin-left: 1em">Michael, on a related note, could you shed some light on language vs input locale?<br><br>I typically use a Norwegian keyboard layout, but many applications seem to think this means I also want Norwegian language in the UI. The most frustrating example is installing Intel's NIC drivers on a server. Half of the UI is in English and the rest in Norwegian. Confusing to say the least and certainly annoying.<br><br>I've been looking for a separate value that indicates the preferred language of the user, but all I can find is the input locale.<br><br>Rather silly if this is the case, but I do see many apps that makes this assumption, so...<br><br>There's nothing wrong with Norwegian, but the community is too small to warrant translation of computer terms. Someone have of course tried, but we all ignore their efforts. <br><br>-- <br>Rune</div>
<p><a id="633951" href="#633951">#</a> <strong>Anna</strong> on 16 Jun 2006 7:13 AM:</p><div style="margin-left: 1em">Ivan, in Vista there is a way to start the Customize Regional Options by calling <br><br>control.exe intl.cpl,, /p:&quot;numbers&quot;</div>
<p><strong>Drewfus</strong> on 11 Feb 2010 1:34 PM:</p><div style="margin-left: 1em"><p>In the c:\windows\regopt.log listed, what does &quot;No valid Language settings found, look for individual keywords&quot; mean?</p>
<p>What settings could be included in the input file to prevent this warning?</p></div>
<p><strong>Michael S. Kaplan</strong> on 12 Feb 2010 4:41 PM:</p><div style="margin-left: 1em"><p>If you don't give more info including what is in your unattend file it is hard to comment....</p>
</div>
<hr/><p><em>referenced by</em></p><div style="margin-left: 1em"><p>2009/09/01 <a href="http://archives.miloush.net/michkap/archive/2009/09/01/9889829.html">For language settings, Walmart ain't all that; 7-Eleven is what gets it done!</a></p><p>2008/05/23 <a href="http://archives.miloush.net/michkap/archive/2008/05/23/8537281.html">When the LANGID in the LOWORD of the KLID doesn't match the LANGID you want keyboard under?</a></p><p>2007/06/05 <a href="http://archives.miloush.net/michkap/archive/2007/06/05/3111075.html">Launching the keyboard layouts dialog directly?</a></p><p>2006/05/30 <a href="http://archives.miloush.net/michkap/archive/2006/05/30/610505.html">Unattend for Regional and Language Options in Vista</a></p><p>2006/05/22 <a href="http://archives.miloush.net/michkap/archive/2006/05/22/604509.html">UI language != input language (at least not always!)</a></p></div><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2006/05/20/603011.html" title="Love Monkey was [also] a book">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2006/05/19/601823.html" title="MSLU doesn&#39;t support wininet.dll">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2006-05">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2006-05-20">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2006/05/20/602745.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:39 GMT -->
</html>