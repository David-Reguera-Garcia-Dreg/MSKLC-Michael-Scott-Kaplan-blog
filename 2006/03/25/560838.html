<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2006/03/25/560838.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:40 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>Enumerating available localized language resources in .NET</title></head><body>
<h1>Enumerating available localized language resources in .NET</h1>
<p><em>by Michael S. Kaplan, published on 2006/03/25 12:01 -05:00, original URI: http://blogs.msdn.com/b/michkap/archive/2006/03/25/560838.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<P><FONT face=Tahoma><A href="http://musingmarc.blogspot.com/">Marc Brooks</A> asked in the Suggestion Box:</FONT></P>
<BLOCKQUOTE dir=ltr style="MARGIN-RIGHT: 0px">
<P><FONT face="Times New Roman" size=2>In an ASP.Net 2.0 application, I want to fill a combobox (and my own internal lists) with the list of CultureInfo.<BR><BR>That's easy.<BR><BR>But how can I only include the ones whose localized resources (e.g. the correct version of the .Net runtime) has been installed?<BR><BR>I want my application to automatically "offer" the ones that will have localized Framework UI available.</FONT></P></BLOCKQUOTE>
<P><FONT face=Tahoma>It's funny, until I looked into Mark's question, I had no idea that there was not a way to enumerate the language resources in managed code (akin to the unmanaged <A href="http://msdn.microsoft.com/library/en-us/winui/WinUI/WindowsUserInterface/Resources/IntroductiontoResources/ResourceReference/ResourceFunctions/EnumResourceLanguages.asp">EnumResourceLanguages</A>, with the managed resource model in mind).</FONT></P>
<P><FONT face=Tahoma>But after spending a little time it was clear that there was nothing like this in the <A href="http://msdn.microsoft.com/library/en-us/cpref/html/frlrfsystemresources.asp">System.Resources</A> or related namespaces (that I could find, at least). The resource model clearly seems to rely on more of a "let the user choose and fall back p.r.n." mechanism than an "enumerate and choose" mechanism.</FONT></P>
<P><FONT face=Tahoma>This&nbsp;seems mildly ironic to me given the fact that the <A href="http://msdn.microsoft.com/library/en-us/cpref/html/frlrfsystemglobalizationcultureinfoclasscurrentuiculturetopic.asp">CurrentUICulture</A> in client apps relies on the UI language in Windows -- which is explicitly enumerated for the user, who gets to&nbsp;choose a language from that enumeration. :-)</FONT></P>
<P><FONT face=Tahoma>But I am stubborn, so I kept digging and came up with the following:</FONT></P>
<BLOCKQUOTE dir=ltr style="MARGIN-RIGHT: 0px">
<P><FONT face="Courier New" size=2><STRONG>using System;<BR>using System.IO;<BR>using System.Reflection;<BR>using System.Globalization;</STRONG></FONT></P>
<P><FONT face="Courier New" size=2><STRONG>namespace Test<BR>{<BR>&nbsp;&nbsp;&nbsp; class ResourceEnum {<BR><BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [STAThread]<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; static void Main() {<BR><FONT color=#008000>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // Grab a type that&nbsp;we know is in mscorlib</FONT><BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Type type = Type.GetType("System.Object");<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Assembly assembly = Assembly.GetAssembly(type);<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Console.WriteLine(assembly.CodeBase);</STRONG></FONT></P>
<P><FONT face="Courier New" size=2><STRONG><FONT color=#008000>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // Enum through all the&nbsp;languages .NET&nbsp;may be&nbsp;localized into</FONT><BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; foreach(CultureInfo ci in CultureInfo.GetCultures</STRONG></FONT><FONT face="Courier New" size=2><STRONG>(CultureTypes.SpecificCultures | CultureTypes.NeutralCultures)) {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; try {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Assembly satellite = </STRONG></FONT><FONT face="Courier New" size=2><STRONG>assembly.GetSatelliteAssembly(ci);<BR><BR><FONT color=#008000>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // If we made it this far, we have the resources</FONT><BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Console.WriteLine("\t" + ci.Name);<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; catch(FileNotFoundException) {<BR><FONT color=#008000>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // Swallow this exception, it means no </FONT></STRONG></FONT><FONT face="Courier New" size=2><STRONG><FONT color=#008000>such&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // resources exist for the given language</FONT><BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<BR>&nbsp;&nbsp;&nbsp; }<BR>}</STRONG></FONT></P></BLOCKQUOTE>
<P><FONT face=Tahoma>Since I already had all of the <A href="http://www.microsoft.com/downloads/details.aspx?FamilyId=04DBAF2E-61ED-43F4-8D2A-CCB2BAB7B8EB&amp;displaylang=en"><STRONG>1.1</STRONG></A> and <A href="http://www.microsoft.com/downloads/details.aspx?familyid=39C8B63B-F64B-4B68-A774-B64ED0C32AE7&amp;displaylang=en"><STRONG>2.0</STRONG></A> .NET language packs installed, the above code gave me a nice list:</FONT></P>
<BLOCKQUOTE dir=ltr style="MARGIN-RIGHT: 0px">
<P><FONT face="Courier New" size=2><STRONG>E:\test&gt;csc resource.cs<BR>Microsoft (R) Visual C# 2005 Compiler version 8.00.50727.42<BR>for Microsoft (R) Windows (R) 2005 Framework version 2.0.50727<BR>Copyright (C) Microsoft Corporation 2001-2005. All rights reserved.</STRONG></FONT></P>
<P><BR><FONT face="Courier New" size=2><STRONG>E:\test&gt;resource.exe<BR></STRONG></FONT><A href="file:///C:/WINDOWS/Microsoft.NET/Framework/v2.0.50727/mscorlib.dll"><FONT face="Courier New" size=2><STRONG>file:///C:/WINDOWS/Microsoft.NET/Framework/v2.0.50727/mscorlib.dll</STRONG></FONT></A><BR><FONT face="Courier New" size=2><STRONG>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ar<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; zh-CHS<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; cs<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; da<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; de<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; el<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; es<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; fi<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; fr<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; he<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; hu<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; it<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ja<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ko<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; nl<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; no<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pl<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sv<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tr<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pt-BR<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pt-PT<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; zh-CHT</STRONG></FONT></P></BLOCKQUOTE><FONT face=Tahoma>
<P>Now the code is tied to mscorlib.dll, but it could be generalized into any assembly (by picking a different type, or using <A href="http://msdn.microsoft.com/library/en-us/cpref/html/frlrfsystemreflectionassemblyclassgetexecutingassemblytopic.asp">GetExecutingAssembly</A> to get the application itself).</FONT><FONT face=Tahoma></P>
<P>There are probably more clever ways to do some of this, if someone knows what they are they should point them out!</P>
<P><FONT face=Tahoma><FONT face=Tahoma><EM>The above is my first real foray into this area, I hope I did not embarrass myself too much. :-)</EM></FONT></FONT></P>
<P><FONT face=Tahoma>Enjoy!</FONT></P>
<P><FONT face=Tahoma></FONT>&nbsp;</P>
<P><FONT color=#ff1493><EM>This post brought to you by</EM> "<FONT face="Times New Roman">áŒ‚</FONT>" <EM>(<A href="http://www.fileformat.info/info/unicode/char/1302">U+1302</A>, a.k.a. ETHIOPIC SYLLABLE JI)</EM></FONT></FONT></P>
<hr/><p><a id="560930" href="#560930">#</a> <strong>Marc Brooks</strong> on 25 Mar 2006 2:51 PM:</p><div style="margin-left: 1em">You ROCK! &nbsp;That's so simple I'm embarrassed that I didn't find it.<br><br>Thanks,<br> &nbsp;Marc</div>
<p><a id="560938" href="#560938">#</a> <strong>Michael S. Kaplan</strong> on 25 Mar 2006 3:05 PM:</p><div style="margin-left: 1em">No need to be embarrassed, Marc. I'm actually a little embarrassed that I spelled your name wrong! :-)<br><br>We're all trying to figure how to do stuff -- and this particular feature ought to be built in. We need to save our &quot;cleverness&quot; for the real hard stuff, not things that should just work....</div>
<p><a id="560979" href="#560979">#</a> <strong>orcmid</strong> on 25 Mar 2006 4:47 PM:</p><div style="margin-left: 1em">So, like, well, I'm sure I don't know what is happening here, and I will treasure all of your code, but uh, golly, where are en and ru and such?</div>
<p><a id="560993" href="#560993">#</a> <strong>Michael S. Kaplan</strong> on 25 Mar 2006 5:04 PM:</p><div style="margin-left: 1em">Hi Dennis!<br><br>Ah, the RU lack was because I did not have that one installed! I just installed it now and it is on the list.<br><br><br>As for EN, that is not on the list because there is no &quot;EN&quot; language pack. If you try to install one you get the message at this link: <a rel="nofollow" target="_new" href="http://download.microsoft.com/download/b/6/7/b675c24f-5c1c-458f-a5f4-e34bbaf099cf/readme.htm">http://download.microsoft.com/download/b/6/7/b675c24f-5c1c-458f-a5f4-e34bbaf099cf/readme.htm</a> which says:<br><br>Microsoft .NET Framework Redistributable Package Version 2.0 <br><br>There is no language pack for the English version of this redistributable package. If you wish to install the language pack for a different language, please return to the Microsoft Download Center page where you found this download and select a different language. </div>
<p><a id="562137" href="#562137">#</a> <strong>Marc Brooks</strong> on 27 Mar 2006 1:09 PM:</p><div style="margin-left: 1em">While where talking about embarassment and the downloads for the language pack... how bogus is it that you can't read the download page &nbsp;or installation information (like the EULA I'm implicitly agreeing to) when downloading a different language pack? &nbsp;How is it that nobody at MS thinks this is silly (e.g. the &quot;display language&quot; != the pack language to be installed).<br><br>See my rant here:<br><a rel="nofollow" target="_new" href="http://musingmarc.blogspot.com/2006/01/somebody-needs-to-understand-page.html">http://musingmarc.blogspot.com/2006/01/somebody-needs-to-understand-page.html</a></div>
<p><a id="562202" href="#562202">#</a> <strong>Michael S. Kaplan</strong> on 27 Mar 2006 2:17 PM:</p><div style="margin-left: 1em">Hmmm.... actually I have no problems with this approach -- it falls under the theory of &quot;if you can't read it, then why the hell are you clicking on it!!!&quot;</div>
<p><a id="562463" href="#562463">#</a> <strong>Marc Brooks</strong> on 27 Mar 2006 7:13 PM:</p><div style="margin-left: 1em">I've posted my further adventures on my blog.</div>
<p><a id="562467" href="#562467">#</a> <strong>Marc Brooks</strong> on 27 Mar 2006 7:14 PM:</p><div style="margin-left: 1em">So how am I, as a WebServer administrator supposed to install these language packs?</div>
<p><a id="562486" href="#562486">#</a> <strong>Michael S. Kaplan</strong> on 27 Mar 2006 7:36 PM:</p><div style="margin-left: 1em">Hmmm... they are all downloadable files (though they did not have the foresight to give them different names, you'll have to do THAT part!).<br><br>Just install them on the web server like you would any update....</div>
<p><strong>Craig Fisher</strong> on 30 May 2008 12:57 PM:</p><div style="margin-left: 1em"><P>Very handy. Thanks!</P></div>
<p><strong>Timur</strong> on 13 Nov 2008 4:31 AM:</p><div style="margin-left: 1em"><p>Thank you very much!</p></div>
<hr/><p><em>referenced by</em></p><div style="margin-left: 1em"><p>2007/01/02 <a href="http://archives.miloush.net/michkap/archive/2007/01/02/1396598.html">Right behavior, wrong scenario</a></p><p>2006/12/29 <a href="http://archives.miloush.net/michkap/archive/2006/12/29/1378466.html">By design? Well, not beautifully so....</a></p></div><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2006/03/25/560869.html" title="Unicode Character Names">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2006/03/25/560416.html" title="I need my SPACE, symbolically speaking">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2006-03">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2006-03-25">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2006/03/25/560838.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:40 GMT -->
</html>