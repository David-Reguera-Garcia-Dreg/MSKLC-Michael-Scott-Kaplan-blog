<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2006/03/23/558674.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:40 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>Getting all you can out of a keyboard layout, Part #1</title></head><body>
<h1>Getting all you can out of a keyboard layout, Part #1</h1>
<p><em>by Michael S. Kaplan, published on 2006/03/23 04:01 -05:00, original URI: http://blogs.msdn.com/b/michkap/archive/2006/03/23/558674.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<P><EM><FONT face=Tahoma>(Be sure to grab the KeysEx enumeration from <A href="http://archives.miloush.net/michkap/archive/2006/03/23/558658.html">Part #1</A> of this series; I'll tell you where it needs to go!)</FONT></EM></P>
<P><FONT face=Tahoma>We will start in the most elemental place, with the Scan Codes.</FONT></P>
<P><FONT face=Tahoma>These are the numbers that the keyboard hardware sends to the computer, the ones that are mapped to Virtual Keys, and sometimes even to characters.</FONT></P>
<P><FONT face=Tahoma>We will need the following functions from the Win32 API to start off.</FONT></P>
<UL>
<LI><FONT face=Tahoma><A href="http://msdn.microsoft.com/library/en-us/winui/winui/windowsuserinterface/userinput/keyboardinput/keyboardinputreference/keyboardinputfunctions/loadkeyboardlayout.asp">LoadKeyboardLayout</A>&nbsp;- to load whatever random keyboard we need</FONT> 
<LI><FONT face=Tahoma><A href="http://msdn.microsoft.com/library/en-us/winui/winui/windowsuserinterface/userinput/keyboardinput/keyboardinputreference/keyboardinputfunctions/unloadkeyboardlayout.asp">UnloadKeyboardLayout</A> - to unload that keyboard when we are done</FONT> 
<LI><FONT face=Tahoma><A href="http://msdn.microsoft.com/library/en-us/winui/winui/windowsuserinterface/userinput/keyboardinput/keyboardinputreference/keyboardinputfunctions/mapvirtualkeyex.asp">MapVirtualKeyEx</A> - to map between VK and SC values, as needed</FONT> 
<LI><FONT face=Tahoma><A href="http://msdn.microsoft.com/library/en-us/winui/winui/windowsuserinterface/userinput/keyboardinput/keyboardinputreference/keyboardinputfunctions/tounicodeex.asp">ToUnicodeEx</A> - to translate the VK, SC, and keyboard state to actual characters</FONT></LI></UL>
<P><FONT face=Tahoma>Basically, here is our algorithm:</FONT></P>
<UL>
<LI><FONT face=Tahoma>Load the keyboard passed into our console application;</FONT> 
<LI><FONT face=Tahoma>Scroll through all the Scan Code values;</FONT> 
<LI><FONT face=Tahoma>Map each Scan Code to a&nbsp;Virtual Key;</FONT> 
<LI><FONT face=Tahoma>Get the character value from that information;</FONT> 
<LI><FONT face=Tahoma>Unload the keyboard.</FONT></LI></UL>
<P><FONT face=Tahoma>Nice and simple, right? Ok, here goes:</FONT></P>
<P><FONT face="Courier New" size=1><STRONG>using System;<BR>using System.Text;<BR>using System.Windows.Forms;<BR>using System.Runtime.InteropServices;</STRONG></FONT></P>
<P><FONT face="Courier New" size=1><STRONG>namespace KeyboardLayouts {<BR>&nbsp;&nbsp;&nbsp; class Class1 {</STRONG></FONT></P>
<P><FONT face="Courier New" size=1><STRONG>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <FONT color=#008000>//&nbsp; You'll want to insert that enumeration here!</FONT></STRONG></FONT></P>
<P><FONT face="Courier New" size=1><STRONG>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; internal const uint KLF_NOTELLSHELL&nbsp; = 0x00000080;</STRONG></FONT></P>
<P><FONT face="Courier New" size=1><STRONG>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [DllImport("user32.dll", CharSet=CharSet.Unicode, EntryPoint="MapVirtualKeyExW", ExactSpelling=true)]<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; internal static extern uint MapVirtualKeyEx(<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; uint uCode, <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; uint uMapType, <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; IntPtr dwhkl);</STRONG></FONT></P>
<P><FONT face="Courier New" size=1><STRONG>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [DllImport("user32.dll", CharSet=CharSet.Unicode, EntryPoint="LoadKeyboardLayoutW", ExactSpelling=true)]<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; internal static extern IntPtr LoadKeyboardLayout(string pwszKLID, uint Flags);</STRONG></FONT></P>
<P><FONT face="Courier New" size=1><STRONG>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [DllImport("user32.dll", ExactSpelling=true)]<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; internal static extern bool UnloadKeyboardLayout(IntPtr hkl);</STRONG></FONT></P>
<P><FONT face="Courier New" size=1><STRONG>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [DllImport("user32.dll", CharSet=CharSet.Unicode, ExactSpelling=true)]<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; internal static extern int ToUnicodeEx(<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; uint wVirtKey,<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; uint wScanCode,<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; KeysEx[] lpKeyState,<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; StringBuilder pwszBuff,<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; int cchBuff,<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; uint wFlags,<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; IntPtr dwhkl);</STRONG></FONT></P>
<P><FONT face="Courier New" size=1><STRONG>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [STAThread]<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; static void Main(string[] args) {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; IntPtr hkl = LoadKeyboardLayout(args[0], KLF_NOTELLSHELL);<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if(hkl == IntPtr.Zero) {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Console.WriteLine("Sorry, that keyboard does not seem to be valid.");<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; KeysEx[] lpKeyState = new KeysEx[256];</STRONG></FONT></P>
<P><FONT face="Courier New" size=1><STRONG>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; for(uint sc = 0x01; sc &lt;= 0x7f; sc++) {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; uint vk = MapVirtualKeyEx(sc, 1, hkl);<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if(vk != 0) {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; StringBuilder sb = new StringBuilder(10);<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; int rc = ToUnicodeEx(vk, sc, lpKeyState, sb, sb.Capacity, 0, hkl);<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if(rc == 1) {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Console.WriteLine("{0:x2}\t{1:x4}\t{2:x2}\t{3}\t{4}", <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sc, ((ushort)sb.ToString()[0]), vk, ((KeysEx)vk).ToString(), ((Keys)vk).ToString());<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<BR></STRONG></FONT><FONT face="Courier New" size=1><STRONG>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; UnloadKeyboardLayout(hkl);<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<BR></STRONG></FONT><FONT face="Courier New" size=1><STRONG>&nbsp;&nbsp;&nbsp; }<BR>}</STRONG></FONT></P>
<P><FONT face=Tahoma>And here is what it printed out for me:</FONT></P>
<BLOCKQUOTE dir=ltr style="MARGIN-RIGHT: 0px">
<P><FONT face="Courier New" size=1><STRONG>C:\Sample\KeyboardLayouts\bin\Debug&gt;KeyboardLayouts.exe 0000409<BR>01&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 001b&nbsp;&nbsp;&nbsp; 1b&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; VK_ESCAPE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Escape<BR>02&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0031&nbsp;&nbsp;&nbsp; 31&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; VK_1&nbsp;&nbsp;&nbsp; D1<BR>03&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0032&nbsp;&nbsp;&nbsp; 32&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; VK_2&nbsp;&nbsp;&nbsp; D2<BR>04&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0033&nbsp;&nbsp;&nbsp; 33&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; VK_3&nbsp;&nbsp;&nbsp; D3<BR>05&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0034&nbsp;&nbsp;&nbsp; 34&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; VK_4&nbsp;&nbsp;&nbsp; D4<BR>06&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0035&nbsp;&nbsp;&nbsp; 35&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; VK_5&nbsp;&nbsp;&nbsp; D5<BR>07&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0036&nbsp;&nbsp;&nbsp; 36&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; VK_6&nbsp;&nbsp;&nbsp; D6<BR>08&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0037&nbsp;&nbsp;&nbsp; 37&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; VK_7&nbsp;&nbsp;&nbsp; D7<BR>09&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0038&nbsp;&nbsp;&nbsp; 38&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; VK_8&nbsp;&nbsp;&nbsp; D8<BR>0a&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0039&nbsp;&nbsp;&nbsp; 39&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; VK_9&nbsp;&nbsp;&nbsp; D9<BR>0b&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0030&nbsp;&nbsp;&nbsp; 30&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; VK_0&nbsp;&nbsp;&nbsp; D0<BR>0c&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 002d&nbsp;&nbsp;&nbsp; bd&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; VK_OEM_MINUS&nbsp;&nbsp;&nbsp; OemMinus<BR>0d&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 003d&nbsp;&nbsp;&nbsp; bb&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; VK_OEM_PLUS&nbsp;&nbsp;&nbsp;&nbsp; Oemplus<BR>0e&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0008&nbsp;&nbsp;&nbsp; 08&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; VK_BACK Back<BR>0f&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0009&nbsp;&nbsp;&nbsp; 09&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; VK_TAB&nbsp; Tab<BR>10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0071&nbsp;&nbsp;&nbsp; 51&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; VK_Q&nbsp;&nbsp;&nbsp; Q<BR>11&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0077&nbsp;&nbsp;&nbsp; 57&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; VK_W&nbsp;&nbsp;&nbsp; W<BR>12&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0065&nbsp;&nbsp;&nbsp; 45&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; VK_E&nbsp;&nbsp;&nbsp; E<BR>13&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0072&nbsp;&nbsp;&nbsp; 52&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; VK_R&nbsp;&nbsp;&nbsp; R<BR>14&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0074&nbsp;&nbsp;&nbsp; 54&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; VK_T&nbsp;&nbsp;&nbsp; T<BR>15&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0079&nbsp;&nbsp;&nbsp; 59&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; VK_Y&nbsp;&nbsp;&nbsp; Y<BR>16&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0075&nbsp;&nbsp;&nbsp; 55&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; VK_U&nbsp;&nbsp;&nbsp; U<BR>17&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0069&nbsp;&nbsp;&nbsp; 49&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; VK_I&nbsp;&nbsp;&nbsp; I<BR>18&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 006f&nbsp;&nbsp;&nbsp; 4f&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; VK_O&nbsp;&nbsp;&nbsp; O<BR>19&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0070&nbsp;&nbsp;&nbsp; 50&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; VK_P&nbsp;&nbsp;&nbsp; P<BR>1a&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 005b&nbsp;&nbsp;&nbsp; db&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; VK_OEM_4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; OemOpenBrackets<BR>1b&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 005d&nbsp;&nbsp;&nbsp; dd&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; VK_OEM_6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; OemCloseBrackets<BR>1c&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 000d&nbsp;&nbsp;&nbsp; 0d&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; VK_RETURN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Enter<BR>1e&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0061&nbsp;&nbsp;&nbsp; 41&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; VK_A&nbsp;&nbsp;&nbsp; A<BR>1f&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0073&nbsp;&nbsp;&nbsp; 53&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; VK_S&nbsp;&nbsp;&nbsp; S<BR>20&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0064&nbsp;&nbsp;&nbsp; 44&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; VK_D&nbsp;&nbsp;&nbsp; D<BR>21&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0066&nbsp;&nbsp;&nbsp; 46&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; VK_F&nbsp;&nbsp;&nbsp; F<BR>22&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0067&nbsp;&nbsp;&nbsp; 47&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; VK_G&nbsp;&nbsp;&nbsp; G<BR>23&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0068&nbsp;&nbsp;&nbsp; 48&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; VK_H&nbsp;&nbsp;&nbsp; H<BR>24&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 006a&nbsp;&nbsp;&nbsp; 4a&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; VK_J&nbsp;&nbsp;&nbsp; J<BR>25&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 006b&nbsp;&nbsp;&nbsp; 4b&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; VK_K&nbsp;&nbsp;&nbsp; K<BR>26&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 006c&nbsp;&nbsp;&nbsp; 4c&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; VK_L&nbsp;&nbsp;&nbsp; L<BR>27&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 003b&nbsp;&nbsp;&nbsp; ba&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; VK_OEM_1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; OemSemicolon<BR>28&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0027&nbsp;&nbsp;&nbsp; de&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; VK_OEM_7&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; OemQuotes<BR>29&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0060&nbsp;&nbsp;&nbsp; c0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; VK_OEM_3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Oemtilde<BR>2b&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 005c&nbsp;&nbsp;&nbsp; dc&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; VK_OEM_5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; OemPipe<BR>2c&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 007a&nbsp;&nbsp;&nbsp; 5a&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; VK_Z&nbsp;&nbsp;&nbsp; Z<BR>2d&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0078&nbsp;&nbsp;&nbsp; 58&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; VK_X&nbsp;&nbsp;&nbsp; X<BR>2e&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0063&nbsp;&nbsp;&nbsp; 43&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; VK_C&nbsp;&nbsp;&nbsp; C<BR>2f&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0076&nbsp;&nbsp;&nbsp; 56&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; VK_V&nbsp;&nbsp;&nbsp; V<BR>30&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0062&nbsp;&nbsp;&nbsp; 42&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; VK_B&nbsp;&nbsp;&nbsp; B<BR>31&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 006e&nbsp;&nbsp;&nbsp; 4e&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; VK_N&nbsp;&nbsp;&nbsp; N<BR>32&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 006d&nbsp;&nbsp;&nbsp; 4d&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; VK_M&nbsp;&nbsp;&nbsp; M<BR>33&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 002c&nbsp;&nbsp;&nbsp; bc&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; VK_OEM_COMMA&nbsp;&nbsp;&nbsp; Oemcomma<BR>34&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 002e&nbsp;&nbsp;&nbsp; be&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; VK_OEM_PERIOD&nbsp;&nbsp; OemPeriod<BR>35&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 002f&nbsp;&nbsp;&nbsp; bf&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; VK_OEM_2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; OemQuestion<BR>37&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 002a&nbsp;&nbsp;&nbsp; 6a&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; VK_MULTIPLY&nbsp;&nbsp;&nbsp;&nbsp; Multiply<BR>39&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0020&nbsp;&nbsp;&nbsp; 20&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; VK_SPACE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Space<BR>4a&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 002d&nbsp;&nbsp;&nbsp; 6d&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; VK_SUBTRACT&nbsp;&nbsp;&nbsp;&nbsp; Subtract<BR>4e&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 002b&nbsp;&nbsp;&nbsp; 6b&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; VK_ADD&nbsp; Add<BR>56&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 005c&nbsp;&nbsp;&nbsp; e2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; VK_OEM_102&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; OemBackslash<BR>7c&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0009&nbsp;&nbsp;&nbsp; 09&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; VK_TAB&nbsp; Tab</STRONG></FONT></P></BLOCKQUOTE>
<P><FONT face=Tahoma>Ok, there is obviously a lot missing here, for example:</FONT></P>
<UL>
<LI><FONT face=Tahoma>this code will unload the keyboard even if it is already loaded, which kind of sucks and you should never do this in an application you are giving to anyone you don't hate intensely.</FONT> 
<LI><FONT face=Tahoma>this code does not handle ligatures.</FONT> 
<LI><FONT face=Tahoma>this code does not handle dead keys.</FONT> 
<LI><FONT face=Tahoma>this code does not handle shift states, either the easier ones or the harder ones.</FONT> 
<LI><FONT face=Tahoma>Caps lock key information? Keep dreaming!</FONT>
<LI><FONT face=Tahoma>And lots more!</FONT></LI></UL>
<P><FONT face=Tahoma>But that is what future posts are for, right? :-)</FONT></P>
<P><FONT face=Tahoma>Stay tuned!</FONT></P>
<P><FONT face=Tahoma></FONT>&nbsp;</P>
<P><FONT color=#ff1493><FONT face=Tahoma><EM>This post brought to you by</EM> "1" </FONT></FONT><EM><FONT color=#ff1493><FONT face=Tahoma>(<A href="http://www.fileformat.info/info/unicode/char/0031">U+0031</A>, DIGIT ONE)<BR><FONT size=1>A Unicode character that is in the very small family of those whose VK value is the same as it's code point!</FONT></FONT></FONT></EM></P>
<hr/><p><a id="558750" href="#558750">#</a> <strong>geoff.appleby</strong> on 23 Mar 2006 4:40 AM:</p><div style="margin-left: 1em">&gt;A Unicode character that is in the very small family <br>&gt;of those whose VK value is the same as it's code point!<br><br>And what are the rest? :)</div>
<p><a id="558753" href="#558753">#</a> <strong>Michael S. Kaplan</strong> on 23 Mar 2006 4:46 AM:</p><div style="margin-left: 1em">Actually, they are pretty much all in the output table there, other than the fact that its lowercase letters instead of uppercase ones (until I add shift states to the mix, in a future post!).</div>
<hr/><p><em>referenced by</em></p><div style="margin-left: 1em"><p>2008/02/11 <a href="http://archives.miloush.net/michkap/archive/2008/02/11/7611812.html">Who assigns the VK_OEM_* values in keyboards?</a></p><p>2006/04/22 <a href="http://archives.miloush.net/michkap/archive/2006/04/22/581107.html">Getting all you can out of a keyboard layout, Part #10a</a></p><p>2006/04/13 <a href="http://archives.miloush.net/michkap/archive/2006/04/13/575500.html">Getting all you can out of a keyboard layout, Part #9b</a></p><p>2006/04/12 <a href="http://archives.miloush.net/michkap/archive/2006/04/12/575080.html">Getting all you can out of a keyboard layout, Part #9a</a></p><p>2006/04/10 <a href="http://archives.miloush.net/michkap/archive/2006/04/10/570570.html">Getting all you can out of a keyboard layout, Part #8</a></p><p>2006/04/06 <a href="http://archives.miloush.net/michkap/archive/2006/04/06/569632.html">Getting all you can out of a keyboard layout, Part #7</a></p><p>2006/03/31 <a href="http://archives.miloush.net/michkap/archive/2006/03/31/565407.html">Getting all you can out of a keyboard layout, Part #6</a></p><p>2006/03/28 <a href="http://archives.miloush.net/michkap/archive/2006/03/28/561541.html">Getting all you can out of a keyboard layout, Part #5</a></p><p>2006/03/27 <a href="http://archives.miloush.net/michkap/archive/2006/03/27/561353.html">Getting all you can out of a keyboard layout, Part #4</a></p><p>2006/03/24 <a href="http://archives.miloush.net/michkap/archive/2006/03/24/559169.html">Getting all you can out of a keyboard layout, Part #3</a></p><p>2006/03/24 <a href="http://archives.miloush.net/michkap/archive/2006/03/24/558715.html">Getting all you can out of a keyboard layout, Part #2</a></p></div><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2006/03/23/559460.html" title="Not so ambiguous [to me!]">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2006/03/23/558658.html" title="Getting all you can out of a keyboard layout, Part #0">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2006-03">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2006-03-23">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2006/03/23/558674.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:40 GMT -->
</html>