<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2006/03/18/554517.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:40 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>Just in case you thought I was blathering. :-)</title></head><body>
<h1>Just in case you thought I was blathering. :-)</h1>
<p><em>by Michael S. Kaplan, published on 2006/03/18 14:20 -05:00, original URI: http://blogs.msdn.com/b/michkap/archive/2006/03/18/554517.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<P><FONT face=Tahoma>Making sure that you use consistent casing behavior is really important.</FONT></P>
<P><FONT face=Tahoma>A good example is a bug that is fixed in the CTP release of SQL Server 2005 SP1. As mentioned by <A HREF="http://blogs.msdn.com/bobmeyers/archive/2006/03/18/554468.aspx">Bob Myers</A>:</FONT></P><FONT face=Tahoma>
<BLOCKQUOTE dir=ltr style="MARGIN-RIGHT: 0px">
<P><FONT face=Arial size=2>The most critical issue is related to report processing and database collation. Model-based queries were incorrectly returning some entity key grouping values that differed only by case. Because case-insensitive report processing (the default) would combine any such rows, some reports would not actually display all the rows returned by the query. For a variety of reasons, many reports were unaffected by this issue, but some reports that display data from a large table with an auto-increment primary key could fail to display a significant number of rows returned by the query.</FONT></P>
<P><FONT face=Arial size=2>Even with SP1, if you are creating any report in Visual Studio Report Designer, you can get yourself into this situation by specifying an incorrect value for the dataset's <A href="http://msdn2.microsoft.com/en-us/library/ms154642.aspx">CaseSensitivity</A> property. If the value you specify does not result in a match between the behavior of report processing and the underlying database, you can expect subtle inconsistencies in your data.</FONT></P></BLOCKQUOTE></FONT>
<P><FONT face=Tahoma></FONT></P>
<P><FONT face=Tahoma>Note that the original problem I complained about related to SQLCLR -- the inconsistencies in results between SQL Server and the CLR that led to my post <A HREF="http://archives.miloush.net/michkap/archive/2005/06/09/427293.html"><STRONG>String.Compare is for sissies (not for people who want SQLCLR consistency)</STRONG></A> -- is&nbsp;not something that&nbsp;is really being addressed here.</FONT></P>
<P><FONT face=Tahoma>Now I agree that the bug they fixed is more important -- dropping rows in a report is a big deal.</FONT></P>
<P><FONT face=Tahoma>But as long as SQL Server and the CLR handle things like collation&nbsp;and case insensitivity in two different ways yet try to interoperate, we are pretty much destined to have a smaller group of issues come up in any applications make significant use of SQLCLR features and assume they will have consistent results....</FONT></P>
<hr/><div style="margin-left: 1em"><em>no comments</em></div><hr/><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2006/03/19/554539.html" title="weblog incendre">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2006/03/18/554308.html" title="What about logical fonts?">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2006-03">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2006-03-18">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2006/03/18/554517.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:40 GMT -->
</html>