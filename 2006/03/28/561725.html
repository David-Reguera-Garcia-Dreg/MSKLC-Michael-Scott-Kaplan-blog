<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2006/03/28/561725.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:40 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>Only ONE WCHAR per dead key</title></head><body>
<h1>Only ONE WCHAR per dead key</h1>
<p><em>by Michael S. Kaplan, published on 2006/03/28 03:01 -05:00, original URI: http://blogs.msdn.com/b/michkap/archive/2006/03/28/561725.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<P><FONT face=Tahoma>Regular reader Ivan Petrov asked the following in the Suggestion Box:</FONT></P>
<BLOCKQUOTE dir=ltr style="MARGIN-RIGHT: 0px">
<BLOCKQUOTE dir=ltr style="MARGIN-RIGHT: 0px">
<P><FONT face="Times New Roman" size=2><EM>Hi Michael <BR><BR>I've the following problem: <BR><BR>In MSKLC in the 'Control state' of the keyboard (when the Control key is pressed) I'm trying to make VK_OEM_3 a Dead Key. So, I assign to it &nbsp;'U+0060 (') GRAVE ACCENT' and then I set it as Dead key. To this point everythig goes ok! Then I go into the Dead key dialog box. And here is the BIG problem. What I mean: <BR>I want to do the following: <BR>When I press "Ctrl" + "`" &nbsp;followed by one of this vowels in the Bulgarian alphabet: <BR>"а", "е", "и", "о", "у", "ъ", "ю" and "я", <BR>the keyboard layout to produce one of this results: <BR><BR>а̀ &nbsp;(0430 + 0300) <BR>ѐ &nbsp;0450 or (0435 + 0300) <BR>ѝ &nbsp;045d or (0438 + 0300) <BR>о̀ &nbsp;(043e + 0300) <BR>у̀ &nbsp;(0443 + 0300) <BR>ъ̀ &nbsp;(044a + 0300) <BR>ю̀ &nbsp;(044e + 0300) <BR>я̀ &nbsp; (044f &nbsp;+ 0300) <BR><BR>And finally the problem: <BR><BR>Let's take for example the first vowel "а": <BR>In the Ded Key dialog box in the Base (code point) field I type "а". Then in the Composite (code point) field I type "U+0430 U+0300" and then MSKLC says that "The value must be either a single character or code point." So, this is the problem! <BR><BR>Can you help, how to deal with this. <BR><BR>I've no problem with the two precomposed letters "ѐ" and "ѝ", but the rest ... ;-( <BR><BR>Thank you in advance. <BR>Regards, <BR>Ivan Petrov. </EM></FONT></P></BLOCKQUOTE></BLOCKQUOTE>
<P><FONT face=Tahoma>Hmmm.... maybe Ivan was not reading often enough. :-(</FONT></P>
<P><FONT face=Tahoma>The problem that he is reporting on has no solution. As I pointed out back in December of 2004 when I mentioned that <STRONG><A href="http://archives.miloush.net/michkap/archive/2004/12/17/323257.html">Dead keys are not intuitive</A></STRONG>, and then a few <A href="http://archives.miloush.net/michkap/archive/2005/11/11/491349.html"><STRONG>times</STRONG></A> <A href="http://archives.miloush.net/michkap/archive/2005/11/15/492200.html"><STRONG>since</STRONG></A> <A href="http://archives.miloush.net/michkap/archive/2005/08/05/448006.html"><STRONG>then</STRONG></A>&nbsp;-- the end result of a dead key transaction must be s single UTF-16 code unit.</FONT></P>
<P><FONT face=Tahoma>This is also explained in the MSKLC help file, as is the explanation that the dead key architecture is one that is around for legacy purposes only, and not generally for the creation of new keyboards.</FONT></P>
<P><FONT face=Tahoma>Even if this ever were changed in a future release of Windows, it could not be used on existing versions due to the backcompat break that this would cause -- and the future version of MSKLC would have to support different keyboard layout DLLs for different versions of Windows. Which as I am sure people can imagine is not a terribly popular plan....</FONT></P>
<P><FONT face=Tahoma>For solutions, there are two obvious ones:</FONT></P>
<UL>
<LI><FONT face=Tahoma>You can add each sequence to its own key on the keyboard, or</FONT> 
<LI><FONT face=Tahoma>You can add the combining character and then type letter plus combining character on the keyboard</FONT></LI></UL>
<P><FONT face=Tahoma>Either of these plans will allow the characters to be supported....</FONT></P>
<P><FONT face=Tahoma></FONT>&nbsp;</P>
<P><FONT face=Tahoma color=#ff1493><EM>This post brought to you by</EM> "у" <EM>(<A href="http://www.fileformat.info/info/unicode/char/0443">U+0443</A>, a.k.a. CYRILLIC SMALL LETTER U)</EM></FONT></P>
<hr/><p><a id="562818" href="#562818">#</a> <strong>Ivan Petrov</strong> on 28 Mar 2006 4:42 AM:</p><div style="margin-left: 1em">Thank you Michael for the quick response! :-)<br><br>Please, correct 'comining' to 'combining' in the second solution ;-)<br><br>Best regards,<br>Ivan.</div>
<p><a id="571847" href="#571847">#</a> <strong>Ivan Petrov</strong> on 9 Apr 2006 8:37 AM:</p><div style="margin-left: 1em">Hi Michael.<br><br>How do you think, is the above question a good reason to be proposed for encoding in Unicode in the Precomposed form the following grave stressed vowels in the Bulgarian language?:<br><br>а, о, у, ъ, ю, я<br>А, О, У, Ъ, Ю, Я<br><br><br>As you know from my previous posts, they're needed for the Bulgarian written language, see:<br><br>1.(see the comments)<br>How does Microsoft assign new collation weights?<br><a rel="nofollow" target="_new" href="http://archives.miloush.net/michkap/archive/2005/09/12/463483.html">http://blogs.msdn.com/michkap/archive/2005/09/12/463483.aspx</a><br><br>2.(see the whole post)<br>Can I get my characters into Unicode?<br><a rel="nofollow" target="_new" href="http://archives.miloush.net/michkap/archive/2005/02/06/367985.html">http://blogs.msdn.com/michkap/archive/2005/02/06/367985.aspx</a><br><br>Regards,<br>Ivan.</div>
<p><a id="571856" href="#571856">#</a> <strong>Michael S. Kaplan</strong> on 9 Apr 2006 9:47 AM:</p><div style="margin-left: 1em">Given the fact that dead keys are a legacy technology, I think it would be a uphill battle....</div>
<p><a id="571864" href="#571864">#</a> <strong>Ivan Petrov</strong> on 9 Apr 2006 10:23 AM:</p><div style="margin-left: 1em">Ok, thanks again Michael.<br><br>One more question:<br><br>In the second sollution:<br><br> &nbsp; &nbsp;* You can add the combining character and then type letter plus combining character on the keyboard,<br><br>I see something wich bothers me! What I mean? I mean that after the user is typing a letter, than he can stroke as many times as he wish the key on wich is assigned the combining character (in our case the grave accent). Visually we will have a letter and grave accent, but in practice there will be a letter plus many grave accents! And also one more fact: as we've a key on which is assigned a combining character (in our case the grave accent), then the user can type every letter wich supports the keyboard layot plus the combining character! This is undesired in our case, because we want to type only the grave accented Bulgaraian vowels.<br><br>So can you suggest how to deal with this issue if I choose to use the second sollution you've proposed?<br><br>Thank you in advance.<br>Best regards,<br>Ivan.</div>
<p><a id="571871" href="#571871">#</a> <strong>Michael S. Kaplan</strong> on 9 Apr 2006 11:01 AM:</p><div style="margin-left: 1em">Well, I have talked about stacked diacritics in the past.<br><br>But I do not believe it is common that people will type a letter, a diacritic, and then keep typing diacritics -- once they get what they want they move on to the next character.<br><br>People are much more likely to hit a dead key, see nothing, and so type the dead key again -- which will cause them to see the wrong thing. I have seen people do it, and think it would be a much more common problem from a usability standpoint.</div>
<hr/><p><em>referenced by</em></p><div style="margin-left: 1em"><p>2010/09/28 <a href="http://archives.miloush.net/michkap/archive/2010/09/28/10068553.html">Like one of those standards that can't/won't be fully implemented</a></p><p>2009/06/18 <a href="http://archives.miloush.net/michkap/archive/2009/06/18/9773077.html">Those keys aren't going to be extended; they're dead!</a></p></div><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2006/03/29/562606.html" title="Is the CAPS LOCK on?">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2006/03/28/561541.html" title="Getting all you can out of a keyboard layout, Part #5">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2006-03">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2006-03-28">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2006/03/28/561725.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:40 GMT -->
</html>