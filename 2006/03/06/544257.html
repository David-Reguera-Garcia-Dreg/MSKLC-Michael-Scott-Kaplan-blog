<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2006/03/06/544257.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:40 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>Grouping and Sorting in a ListView</title></head><body>
<h1>Grouping and Sorting in a ListView</h1>
<p><em>by Michael S. Kaplan, published on 2006/03/06 05:01 -05:00, original URI: http://blogs.msdn.com/b/michkap/archive/2006/03/06/544257.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<P><FONT face=Tahoma>The other day Al asked me via the Contacting Me link:</FONT></P>
<BLOCKQUOTE dir=ltr style="MARGIN-RIGHT: 0px">
<P><FONT size=2><EM>Hi Michael,<BR><BR>My question has nothing to do with internationalization, but it has something to do with sorting. I hope this makes it interesting enough!</EM></FONT></P>
<P><EM><FONT size=2>When I group in a ListView, I cannot sort within the groups. Is that a bug?</FONT></EM></P></BLOCKQUOTE>
<P><FONT face=Tahoma>The <A href="http://msdn2.microsoft.com/en-us/library/s2edxtd5.aspx">ListView class</A> is a managed wrapper around the Shell ListView common control. When you use instances of the <A href="http://msdn2.microsoft.com/en-us/library/system.windows.forms.listviewgroup.aspx">ListViewGroup class</A> to set up groupings, the setting of the <A href="http://msdn2.microsoft.com/en-us/library/system.windows.forms.listview.sorting.aspx">Sorting property</A> is ignored.</FONT></P>
<P><FONT face=Tahoma>Although at first glance it may&nbsp;look&nbsp;like the native Shell <A href="http://msdn.microsoft.com/library/en-us/shellcc/platform/commctls/listview/macros/listview_insertgroupsorted.asp">ListView_InsertGroupSorted macro</A>/<A href="http://msdn.microsoft.com/library/en-us/shellcc/platform/commctls/listview/messages/lvm_insertgroupsorted.asp">LVM_INSERTGROUPSORTED message</A>, might be helpful, this is actually referring to sorting between groups, rather than within them....</FONT></P><FONT face=Tahoma>
<P><FONT face=Tahoma>In practice this can cause real usability problems for very large lists (since one would definitely want to be able to show a large number of items in some kind of sensible order).</FONT></P>
<P><FONT face=Tahoma>The&nbsp;easiest&nbsp;workaround here (unfortunately)&nbsp;seems to be&nbsp;to add them in the correct order.</FONT></P>
<P>I am hoping that I am missing something here in either the managed or unmanaged implementations. If I am I won't feel too bad since it's not really one of those 'international' questions, so if you know the answer, don't be shy. :-)</P>
<P>&nbsp;</P></FONT>
<P><FONT face=Tahoma color=#ff1493><EM>This post brought to you by</EM> "<FONT size=6>á¸ </FONT>" <EM>(<A href="http://www.fileformat.info/info/unicode/char/1e20">U+1e20</A>, a.k.a. LATIN CAPITAL LETTER G WITH MACRON)</EM></FONT></P>
<hr/><p><a id="544486" href="#544486">#</a> <strong>swautier</strong> on 6 Mar 2006 9:47 AM:</p><div style="margin-left: 1em">My experience with the some of the new features of listview controls such as groups and background images is that they were implemented 'just enough' to fit the Windows Explorer team requirements.<br><br>Regarding sorting of grouped lists, it makes sense to me to provide such 'sorted by group' behaviour. But Windows Explorer never really needs it since groups depends on the selected column, hence groups are re-created from scratch each time user clicks a column). Hence sort just plain doesn't work with gropus, although I have not seen it documented anywhere.<br><br>Some documented feature(s) are not implemented (such as LVM_MOVEITEMTOGROUP). Some implemented features are not documented (such as watermarks. Thanks Spy++, you saved me...).<br><br>Quite a mess, I must say, which is a shame because these advanced listview features are very interesting and help make apps nice. But hadn't I taken it as a challenge to make them work, I would have given up very soon. :-(</div>
<p><strong>Christophe Hannosset</strong> on 1 Apr 2010 8:18 PM:</p><div style="margin-left: 1em"><P>I have been adding groups and list view item in alphabetic order... The groups are at 80% sorted as well as the items. Of course sorting is deactivated...</P>
<P>Apparently the control is reorganizing the group display sequence, I really do not know why but that operation seem to cause the issue...</P>
<P>I did not have e3xperience that previously (maybe lucky....) but also the amount of groups were significantly reduced.</P></div>
<hr/><p><em>referenced by</em></p><div style="margin-left: 1em"><p>2007/05/24 <a href="http://archives.miloush.net/michkap/archive/2007/05/24/2839957.html">How to do more sorting and grouping by 9am than most ListViews do all day</a></p></div><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2006/03/07/545097.html" title="Everybody&#39;s doing the wraparound....">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2006/03/06/544251.html" title="chcp can&#39;t do everything">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2006-03">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2006-03-06">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2006/03/06/544257.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:40 GMT -->
</html>