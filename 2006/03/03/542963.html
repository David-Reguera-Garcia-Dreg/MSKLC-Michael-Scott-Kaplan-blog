<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2006/03/03/542963.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:40 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>How To [NOT] detect that a locale is bidi</title></head><body>
<h1>How To [NOT] detect that a locale is bidi</h1>
<p><em>by Michael S. Kaplan, published on 2006/03/03 08:15 -08:00, original URI: http://blogs.msdn.com/michkap/archive/2006/03/03/542963.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostOld -->
<P><FONT face=Tahoma>I thought I'd give a healthy sample of examples of how NOT to get the answer to the question "Is this a locale&nbsp;whose language&nbsp;uses bidirectional text?". All of these examples have actually been used&nbsp;at various points in Microsoft products, though they are [usually] being replaced as fast as they are found....</FONT></P>
<P><FONT face=Tahoma>The names of the functions and identifying comments have been changed to protect the guilty (and the embarrassed).</FONT></P>
<P><FONT face=Tahoma>Hopefully you have none of these in your own code -- or at the very least you hopefully will have none within a day or two of reading this post! :-)</FONT></P>
<BLOCKQUOTE dir=ltr style="MARGIN-RIGHT: 0px"><FONT face="Courier New" size=2>
<P><FONT face="Courier New" size=2><FONT face="Courier New" size=2>BOOL IsBidi(LANGID langid) {<BR></FONT><FONT face="Courier New" size=2>&nbsp;&nbsp;&nbsp; switch(langid) {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; case 1025: // Arabic<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; case 1037: // Hebrew<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; case 1065: // Farsi<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return true;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;default:<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return false;<BR>&nbsp;&nbsp;&nbsp; }<BR>}</FONT></P>
<P>&nbsp;</P>
<P>BOOL IsBidi(LCID lcid) {<BR></FONT><FONT face="Courier New" size=2>&nbsp;&nbsp;&nbsp; return (PRIMARYLANGID(lcid) == LANG_ARABIC ||<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PRIMARYLANGID(lcid) == LANG_HEBREW)<BR></FONT><FONT face="Courier New" size=2>}</FONT></P></FONT>
<P><FONT face="Courier New" size=2></FONT>&nbsp;</P>
<P><FONT face="Courier New" size=2>BOOL IsBiDiLcid(LCID lcid)<BR>{<BR>&nbsp;&nbsp;&nbsp; if (lcid == 0x0859 ||&nbsp;&nbsp;//Sindhi (Arabic script) <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; lcid == 0x0460)&nbsp;&nbsp;&nbsp;&nbsp;//Kashmiri (Arabic script)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return TRUE;&nbsp;&nbsp;&nbsp; </FONT></P>
<P><FONT face="Courier New" size=2>&nbsp;&nbsp;&nbsp; switch (PRIMARYLANGID(lcid))<BR>&nbsp;&nbsp;&nbsp; {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; case LANG_ARABIC:<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; case LANG_HEBREW:<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; case LANG_URDU:<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; case LANG_FARSI:<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; case LANG_PASHTO:<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; case LANG_UIGHUR:<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; case LANG_SYRIAC:<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; case LANG_DIVEHI:<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return TRUE;<BR>&nbsp;&nbsp;&nbsp; }</FONT></P>
<P><FONT face="Courier New" size=2>&nbsp;&nbsp;&nbsp; return FALSE;<BR>}</FONT></P>
<P><FONT face="Courier New" size=2></FONT>&nbsp;</P>
<P><FONT face="Courier New" size=2>BOOL GetBidiStatus(LANGID langid) {</FONT></P>
<P><FONT face="Courier New" size=2>&nbsp;&nbsp;&nbsp; WCHAR szDayName[80] = {0};<BR>&nbsp;&nbsp;&nbsp; WORD&nbsp; ctype = 0;</FONT></P>
<P><FONT face="Courier New" size=2>&nbsp;&nbsp;&nbsp; GetLocaleInfo( langid,<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; LOCALE_SDAYNAME1,<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; szDayName,<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sizeof(szDayName] / sizeof(WCHAR) );</FONT></P>
<P><FONT face="Courier New" size=2>&nbsp;&nbsp;&nbsp; GetStringType( CT_CTYPE2,<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &amp;szDayName[0],<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1,<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &amp;ctype );</FONT></P>
<P><FONT face="Courier New" size=2>&nbsp;&nbsp;&nbsp; return( ctype &amp; C2_RIGHTTOLEFT );<BR></FONT><FONT face="Courier New" size=2>}</FONT></P>
<P><FONT face="Courier New" size=2></FONT>&nbsp;</P>
<P><FONT face="Courier New" size=2>BOOL IsBidiLocale(LCID locale)<BR>{<BR>&nbsp;&nbsp;&nbsp; DWORD layout;</FONT></P>
<P><FONT face="Courier New" size=2>&nbsp;&nbsp;&nbsp; return(GetProcessDefaultLayout(&amp;layout) &amp;&amp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (layout &amp; LAYOUT_RTL));</FONT><FONT size=+0><BR><FONT face="Courier New" size=2>}</FONT></FONT></P>
<P><FONT face="Courier New" size=2></FONT>&nbsp;</P>
<P><FONT face="Courier New" size=2>BOOL IsBidirectional(LCID lcid) {<BR>&nbsp;&nbsp;&nbsp; LOCALESIGNATURE signature;</FONT></P>
<P><FONT face="Courier New" size=2>&nbsp;&nbsp;&nbsp; GetLocaleInfoW(lcid,<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOCALE_FONTSIGNATURE<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (LPWSTR)&amp;signature,<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sizeof(signature));</FONT></P>
<P><FONT face="Courier New" size=2>&nbsp;&nbsp;&nbsp; if(signature.lsCsbSupported[0] &amp; 0x60) {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return(TRUE);<BR>&nbsp;&nbsp;&nbsp; else<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return(FALSE);<BR>&nbsp;&nbsp;&nbsp; }</FONT><FONT size=+0><BR><FONT face="Courier New" size=2>}</FONT></FONT></P>
<P><FONT face="Courier New" size=2></FONT>&nbsp;</P>
<P><FONT face="Courier New" size=2>BOOL FDetectBidi(LCID lcid) {<BR>&nbsp;&nbsp;&nbsp; FONTSIGNATURE fontsignature;</FONT></P>
<P><FONT face="Courier New" size=2>&nbsp;&nbsp;&nbsp; GetLocaleInfoW(lcid,<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOCALE_FONTSIGNATURE<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (LPWSTR)&amp;fontsignature,<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sizeof(fontsignature));</FONT></P>
<P><FONT face="Courier New" size=2>&nbsp;&nbsp;&nbsp; return(fontsignature.fsUsb[0] &amp; 0x2800));</FONT><FONT size=+0><BR><FONT face="Courier New" size=2>}</FONT></FONT></P></BLOCKQUOTE>
<P><FONT face=Tahoma></FONT>&nbsp;</P>
<P><FONT face=Tahoma>The number of problems with the above is HUGE. Buffer overruns, wrong parameters,&nbsp;not checking for return values, ignoring the LCID, making the wrong checks. It is enough to make you want to tear your hair out. Or, if you are a bit more clear-headed, enough to make you want to tear out the hair of some other developers whose name appeared on the SLM logs checking in the code....</FONT></P>
<P><FONT face=Tahoma>Though I thought the use of a locale&nbsp;field like SDAYNAME1 (several other examples along this line with different values were also around) was somewhat clever (especially in downlevel cases where the preferred solution is not available).</FONT></P>
<P><FONT face=Tahoma>Though I worry about the cases where the field chosen may not start with a strong right-to-left character....</FONT></P>
<P><FONT face=Tahoma>Anyway, t<FONT face=Tahoma>he&nbsp;best solution&nbsp;is to use the mystical bit #123 of the <A href="http://msdn.microsoft.com/library/en-us/intl/unicode_63ub.asp">Unicode subset bitfields</A> of the <A href="http://msdn.microsoft.com/library/en-us/intl/unicode_5ppu.asp">LOCALESIGNATURE</A> which is defined as "Layout progress: horizontal from right to left" and which is around in Windows 2000 and later. H</FONT></FONT><FONT face=Tahoma>ere is an example of that best approach:</FONT></P>
<BLOCKQUOTE dir=ltr style="MARGIN-RIGHT: 0px">
<P><FONT face="Courier New" size=2>&nbsp;&nbsp;&nbsp; WCHAR wchLCIDFontSig[16];<BR>&nbsp;&nbsp;&nbsp;&nbsp;<BR>&nbsp;&nbsp;&nbsp; if (GetLocaleInfoW(lcid,<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOCALE_FONTSIGNATURE,<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;wchLCIDFontSig[0],<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(sizeof(wchLCIDFontSig)/sizeof(WCHAR))) &amp;&amp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (wchLCIDFontSignature[7] &amp; (WCHAR)0x0800))</FONT></P></BLOCKQUOTE>
<P><FONT face=Tahoma>or if you prefer to work with the actual locale signature rather than the bytes of a WCHAR array that are actually a locale signature underneath, it would be something more like the following (assuming my bit math is not faulty!):</FONT></P>
<BLOCKQUOTE dir=ltr style="MARGIN-RIGHT: 0px">
<P><FONT face="Courier New" size=2>&nbsp;&nbsp;&nbsp;&nbsp;LOCALESIGNATURE localesig;<BR>&nbsp;&nbsp;&nbsp;&nbsp;<BR>&nbsp;&nbsp;&nbsp; if (GetLocaleInfoW(lcid,<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOCALE_FONTSIGNATURE,<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(LPWSTR)&amp;localesig,<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(sizeof(localesig)/sizeof(WCHAR))) &amp;&amp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (localesig.lsUsb[3] &amp; 0x08000000))</FONT></P></BLOCKQUOTE><FONT face=Tahoma>
<P><FONT face=Tahoma>What I find most impressive about the wide array of the different attempts people made is</FONT></P>
<UL>
<LI><FONT face=Tahoma>the inginuity of some people even when they are quite simply wrong;</FONT> 
<LI><FONT face=Tahoma>the number of random code mistakes that one can find in&nbsp;those examples;</FONT> 
<LI><FONT face=Tahoma>how clear it is that we need a LOCALE_IRIGHTTOLEFT <A href="http://msdn.microsoft.com/library/en-us/intl/nls_8rse.asp">LCType</A> in the future for <A href="http://msdn.microsoft.com/library/en-us/intl/nls_34rz.asp">GetLocaleInfo</A>!</FONT></LI></UL>
<P>Do you have a favorite? :-)</P>
<P>&nbsp;</P>
<P><FONT color=#ff1493><EM>This post brought to you by</EM> "ת" <EM>(<A href="http://www.fileformat.info/info/unicode/char/05ea">U+05ea</A>, a.k.a. HEBREW LETTER TAV)</EM></FONT></FONT></P>
<hr/><p><a id="542971" href="#542971">#</a> <strong>Maurits</strong> on Friday, March 03, 2006 11:25 AM:</p><div style="margin-left: 1em">Huh? &nbsp;Surely NO language uses bidirectional text. &nbsp;Locales are either left-to-right, which is one direction; or right-to-left, which is also one direction.</div>
<p><a id="542975" href="#542975">#</a> <strong>Michael S. Kaplan</strong> on Friday, March 03, 2006 11:28 AM:</p><div style="margin-left: 1em">Actually, if you look at Hebrew, numbers are actually LTR. And there is always *some* other text shown or entered in a locale (file name extensions, if nothing else!), and in that case you are dealing with a locale that expects bidirectional text....</div>
<p><a id="543022" href="#543022">#</a> <strong>Nick Lamb</strong> on Friday, March 03, 2006 12:30 PM:</p><div style="margin-left: 1em">There are two levels of confusion here, because of course there's no such thing as a &quot;Bi-directional&quot; locale, only bi-directional text. Firstly Microsoft has this system-wide confusion because they artificially override UAX #9 paragraph level. Michael can probably tell us how many of his examples come from code doing that.<br><br>So there's a lot of code which is doing something that's fundamentally wrong, no matter how it goes about it, and that code just shouldn't exist. From the sounds of things that's not going to get fixed this decade (e.g. in Vista), and so users who care about it will (as with other things Michael's mentioned like the correct Unicode encoding of currency symbols or working font fallback) have to migrate away.<br><br>Secondly, there's a smaller scale confusion, when trying to figure out what the user's expectations are, for example at the start of a new document, should the cursor appear on the right or the left? This is a locale issue, and it does need some code, but naming the predicate &quot;isBiDi?&quot; or similar in this context betrays a lack of understanding. The real question is &quot;Direction?&quot; and the answers are either LTR (cursor starts on the left) or RTL. (starts on the right).<br><br>You can see all of this done right elsewhere, just not in Windows.</div>
<p><a id="543042" href="#543042">#</a> <strong>Michael S. Kaplan</strong> on Friday, March 03, 2006 12:59 PM:</p><div style="margin-left: 1em">Hi Nick,<br><br>I understand you have strong feelings about the particular way that Microsoft implements UAX #9 (by now I am sure anyone who reads the comments on this blog understands *that*), the fact that UAX#9 hs been moving closer to Microsoft's implementation in properties of course non-withstanding.<br><br>But I am pretty sure any developer who deals with bidi understands the fact that knowing whether to expect large amounts of RTL and Bidi text by default, and further that talking about a &quot;bidi locale&quot; is just shorthand for for that. and it is not confusing to anyone really, except for people who choose to be confused.<br><br>It is something seen beyond Windows, as you mention, but mainly because this is understood by a LOT of people. And it is only confusing to us if we allow it to be. The only platforms that do not have this understanding are the ones that do not support Bidi anyway.... :-)<br><br>As for the intent of the code being wrong, there is honestly no way to guess that from the samples since they do not explain where the locale is coming from -- I gave examples of the complexities there in <a rel="nofollow" target="_new" href="http://archives.miloush.net/michkap/archive/2006/02/08/527375.html">http://blogs.msdn.com/michkap/archive/2006/02/08/527375.aspx</a> and other posts, and that is really understandable, too -- choosing the locale upon which to make such decisions is a complex issue.<br><br>For the record, in most cases the intent and use of the function was actually correct, it was only the method by which the function worked that was wrong. So if you want an excuse to migrate away from Microsoft products you'll have to find another one. :-)</div>
<p><a id="543095" href="#543095">#</a> <strong>Maurits</strong> on Friday, March 03, 2006 2:10 PM:</p><div style="margin-left: 1em">&gt; numbers are actually LTR<br><br>Really? &nbsp;Or are they little-endian? &nbsp;How do Hebrew users write numbers, or read numbers allowed?<br><br>What about grouped numbers, like phone numbers? &nbsp;Do they read the groups RTL and the numbers in each group LTR?<br><br>Oy, I'm confused.<br><br>Exercise: Translate the title of this song into a Hebrew locale...<br><br><a rel="nofollow" target="_new" href="http://en.wikipedia.org/wiki/867-5309/Jenny">http://en.wikipedia.org/wiki/867-5309/Jenny</a></div>
<p><a id="543103" href="#543103">#</a> <strong>Serge Wautier</strong> on Friday, March 03, 2006 2:24 PM:</p><div style="margin-left: 1em">IIRC, the font signature method was not available on NT4 (don't remember for 9x).<br>Therefore, the good Dr Intl recommends adding a platform check and fallback on comparing PRIMARYLANGID() with LANG_HEBREW, LANG_ARABIC and LANG_FARSI on pre W2K platforms.<br><br><a rel="nofollow" target="_new" href="http://www.microsoft.com/globaldev/DrIntl/columns/003/default.mspx#EDAA">http://www.microsoft.com/globaldev/DrIntl/columns/003/default.mspx#EDAA</a><br></div>
<p><a id="543109" href="#543109">#</a> <strong>Maurits</strong> on Friday, March 03, 2006 2:34 PM:</p><div style="margin-left: 1em">&quot;read numbers allowed&quot; =&gt; &quot;read numbers aloud&quot;</div>
<p><a id="543238" href="#543238">#</a> <strong>Nick Lamb</strong> on Friday, March 03, 2006 5:17 PM:</p><div style="margin-left: 1em">“But I am pretty sure any developer who deals with bidi understands the fact that knowing whether to expect large amounts of RTL and Bidi text by default, and further that talking about a &quot;bidi locale&quot; is just shorthand for for that. and it is not confusing to anyone really, except for people who choose to be confused.”<br><br>This paragraph seems incomplete or has some typographical problem. I guess the intent is to say that Microsoft developers are testing for a &quot;bidi locale&quot; purely as an optimisation. If that's right. can you give a brief example of such an optimisation from real code Michael?<br><br>If that's not what you meant, can you rephrase?</div>
<p><a id="543273" href="#543273">#</a> <strong>Michael S. Kaplan</strong> on Friday, March 03, 2006 5:56 PM:</p><div style="margin-left: 1em">I am saying that the question being asked that these functions try to ask is a valid one that is only confusing to those who wish to be confused. The locale model is real and is often used to tag resources and content, and the return of this function is in no way a Microsoft-specfic construct or a confusing construct.<br><br>And the question is of use to people outside of Microsoft.<br><br>Your opinions about Microsoft a-la-UAX #9 are noted, as always, but are not relevant to the current discussion. :-)</div>
<p><a id="543402" href="#543402">#</a> <strong>Mihai</strong> on Friday, March 03, 2006 9:25 PM:</p><div style="margin-left: 1em">The real problem is &quot;Windows 2000 and later&quot;<br><br>As Serge noticed, even Dr Intl recommends one of the (now) wrong methods above. What was one supposed to do, except following the best practices of the time.<br><br>I don't say &quot;this should have been there in Win 3.0&quot;, but if the code is old, it is not fair to pick on it too much.<br><br>In fact, once in a while I see some of my old code. And, man, is crappy. But this is good. If today I would write code like I did 3 years ago, it means I have learned nothing.</div>
<p><a id="543503" href="#543503">#</a> <strong>Michael S. Kaplan</strong> on Saturday, March 04, 2006 2:26 AM:</p><div style="margin-left: 1em">Well, to be honest, I actually think the GetStringType solution is a better (and more scalable) one then hard coding LCIDs, but that is just one man's opinion....</div>
<p><a id="543537" href="#543537">#</a> <strong>Shoshannah</strong> on Saturday, March 04, 2006 5:01 AM:</p><div style="margin-left: 1em">Maurits- Numbers in Hebrew are read LTR, even phone numbers (which are grouped) are read LTR.<br>I'm looking at a (Hebrew) ad for Domino's Pizza which happens to be next to me- it has:<br>HEBREW HEBREW HEBREW 1-700-70-70-70 HEBREW HEBREW<br>The Hebrew is RTL, the number is read LTR.</div>
<p><a id="589079" href="#589079">#</a> <strong>Ben Yeomans</strong> on Wednesday, May 03, 2006 8:50 AM:</p><div style="margin-left: 1em">What about Divehi (locale ID 0x0465)?<br><br>This uses the Thaana script which is written Right-to-Left, but your recommended method does not recognise this as an RTL locale.<br><br>There is also a bug in the second version of the recommended method. It should be:<br> &nbsp; &nbsp; &nbsp; &nbsp;(localesig.lsUsb[3] &amp; 0x8000000))<br><br>Personally I like the GetStringType solution, especially as I am working mainly with Windows CE which doesn't appear to support the recommended method. I have adapted it slightly to scan the whole string, not just the first character, and changed the test from ( ctype &amp; C2_RIGHTTOLEFT ) to ( ctype == C2_RIGHTTOLEFT ).<br></div>
<hr/><p><em>referenced by</em></p><div style="margin-left: 1em"><p>2012/01/16 <a href="http://archives.miloush.net/michkap/archive/2012/01/16/10256752.html">I'm reasonably certain that those who disagree with me here are wrong!</a></p><p>2010/04/19 <a href="http://archives.miloush.net/michkap/archive/2010/04/19/9997912.html">The sad sad tale of the BARREE YEH</a></p><p>2006/12/21 <a href="http://archives.miloush.net/michkap/archive/2006/12/21/1331650.html">It's not right when IsRightToLeft is wrong</a></p><p>2006/09/01 <a href="http://archives.miloush.net/michkap/archive/2006/09/01/735817.html">Cue the smarter version of GetDateFormat... ok, it's a wrap!</a></p><p>2006/07/12 <a href="http://archives.miloush.net/michkap/archive/2006/07/12/663013.html">How To detect that a culture is bidi</a></p></div><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2006/03/05/544063.html" title="That handicapped placard">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2006/03/02/542489.html" title="When macros obfuscate in a way that encourages bugs....">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2006-03">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2006-03-03">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2006/03/03/542963.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:40 GMT -->
</html>