<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2006/04/27/584439.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:39 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>The disunification of Norwegian and Danish sorting</title></head><body>
<h1>The disunification of Norwegian and Danish sorting</h1>
<p><em>by Michael S. Kaplan, published on 2006/04/27 03:01 -04:00, original URI: http://blogs.msdn.com/b/michkap/archive/2006/04/27/584439.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<P><FONT face=Tahoma>A few days ago, I wrote a post entitled <STRONG><A href="http://archives.miloush.net/michkap/archive/2006/04/25/583307.html">Why do we call w 'double u' -- doesn't it look more like a 'double v' ?</A></STRONG></FONT></P>
<P><FONT face=Tahoma>The post itself had nothing to do with the title; it was actually about the <A href="http://www.svenskaakademien.se/">Swedish Academy</A> changes to consider 'w' and 'v' to be separate letters, as well as some of the potential consequences for Microsoft products if such a change is reflected in actual customer usage that needs to be captured in the future.</FONT></P>
<P><FONT face=Tahoma><EM>(the title was actually a little experiment to see whether a catchy title would get more attention in comments than the substance of the post; you can look for yourself what was proven in that experiment.)</EM></FONT></P>
<P><FONT face=Tahoma>Anyway, in the process of my speculation on products and what they&nbsp;might do in the future, I forgot that Vista already has such a change, in a country that is quite near to Sweden and Finland!</FONT></P>
<P><FONT face=Tahoma>It has to do with the use of "<STRONG>aa</STRONG>" in Danish and Norwegian.</FONT></P>
<P><FONT face=Tahoma>Both languages have the same basic alphabet -- the 26 latin letters used in English and most places, plus <STRONG>æ</STRONG>, <STRONG>ø</STRONG>, and <STRONG>å</STRONG>. Though in earlier days the letters <STRONG>aa</STRONG> were used instead of <STRONG>å</STRONG> (in fact in Danish this letter was not added until a spelling reform that happened in&nbsp;the late 1940s&nbsp;-- it was already widely used in both&nbsp;Norwegian and Swedish).</FONT></P>
<P><FONT face=Tahoma>Now the&nbsp;Danish and Norwegian sort in Microsoft products was using the special sorting of the <STRONG>aa</STRONG> as a unique letter after <STRONG>z</STRONG> that was basically equal to <STRONG>å</STRONG>. </FONT></P>
<P><FONT face=Tahoma>But while this was a (relatively) recent addition for Danish, it has been in Norwegian for much longer. And feedback had come in from customers such as the following:</FONT></P><FONT face=Tahoma>
<DIR><FONT size=1>
<P><FONT face="Times New Roman" size=2>If you take a Norwegian dictionary you would in fact find the German town Aachen as one of the first entries under the letter A, but Explorer will put it at the end after the letter Z. <BR><BR>As I pointed out earlier Aa is never interpreted as Å for anything but family names dating pre-1917, and even then it is not uncommon in Norway to sort those names as double A. A person with the name Aalberg might frown to see his name listed at the top, but would be far from surprised. However a person searching for the town Aachen would not understand why Explorer put it at the end.</FONT></P></DIR></FONT></FONT>
<P><FONT face=Tahoma>Feedback such as this led to some more investigation and the final assesment was made that the time had come to remove the <STRONG>aa</STRONG> entries from the compression tables for Norwegian.</FONT></P>
<P><FONT face=Tahoma>"But Michael," you might be asking, "What about Danish?"</FONT></P>
<P><FONT face=Tahoma>Well, the answer there is that it is still too common to expect it to be treated as a letter -- and there are way too many textbooks and websites that put an extra <STRONG>(aa)</STRONG> at the end of the alphabet. Danish&nbsp;could not make the same change that Norwegian needed.</FONT></P>
<P><FONT face=Tahoma>So, in Vista, the Norwegian tables have had <A href="http://archives.miloush.net/michkap/archive/2005/07/17/439742.html"><STRONG>the three variants</STRONG></A> of the <STRONG>aa</STRONG> compression removed, while the Danish (and also the Greenlandic, which uses the same sort as Denmark) have not. Therefore, these formerly unified sorts&nbsp;will now been disunified.</FONT></P><FONT face=Tahoma>
<P><FONT face=Tahoma>That theoretical question I posed <A href="http://archives.miloush.net/michkap/archive/2006/04/25/583307.html">the other day</A> has become decidely non-theoretical! :-)</FONT></P>
<P>You may be filled with one or more of the following questions:</FONT></P>
<OL>
<LI><FONT face=Tahoma>What does this mean for prior versions of Windows and the .NET Framework?</FONT> 
<LI><FONT face=Tahoma>What does this mean for&nbsp;Microsoft Access&nbsp;(7.0 - 11.0) and&nbsp;their Norwegian/Danish sorts?</FONT> 
<LI><FONT face=Tahoma>What does this mean for DAO 3.5/3.6 and their dbLangNorwDan/dbSortNorwdan enumeration members?</FONT> 
<LI><FONT face=Tahoma>What does it mean for the Norwegian/Danish sort in SQL Server 7.0?</FONT> 
<LI><FONT face=Tahoma>What does it mean for the DANISH_NORWEGIAN_* collations in SQL Server 2000 and 2005?</FONT> 
<LI><FONT face=Tahoma>What does this mean for Windows Vista?</FONT> 
<LI><FONT face=Tahoma>What does it mean for future versions of Access, Jet, and SQL Server?</FONT> 
<LI><FONT face=Tahoma>What does it mean for WinFS?</FONT> 
<LI><FONT face=Tahoma>What does it mean for future versions of the .NET Framework?</FONT></LI></OL>
<P><FONT face=Tahoma>The answer for questions 1-5 is simple -- not a bleeding thing. We can't change those prior version results.</FONT></P>
<P><FONT face=Tahoma>The answer for question 6 is also simple -- it is going to be changed. The two sorts with the two different LCIDs (<STRONG>0x0406</STRONG> versus <STRONG>0x0414</STRONG>/<STRONG>0x0814</STRONG>) and different names (<STRONG>da-DK</STRONG> versus <STRONG>nb-NO</STRONG>/<STRONG>nn-NO</STRONG>) will return two different results.</FONT></P>
<P><FONT face=Tahoma>The answer for questions 7-9 is also simple (though that may change at some point!)&nbsp;-- I do not have a freaking clue. But you can bet your lunch money that I will be asking people some questions about this issue for WinFS and for the next version of SQL Server and for the upcoming version of Access that ships with Office 12.</FONT></P>
<P><FONT face=Tahoma></FONT>&nbsp;</P>
<P><FONT face=Tahoma color=#ff1493><EM>This post brought to you by</EM> "ø" <EM>(<A href="http://www.fileformat.info/info/unicode/char/00f8">U+00f8</A>, a.k.a. LATIN SMALL LETTER O WITH STROKE)</EM></FONT></P>
<hr/><p><a id="585082" href="#585082">#</a> <strong>charless</strong> on 27 Apr 2006 10:36 AM:</p><div style="margin-left: 1em">So, I have been reading your blog off and on for a while. This post did prompt one additional question for me though. Why was it not sponsered by the letter &#229;? :^)</div>
<p><a id="585101" href="#585101">#</a> <strong>Michael S. Kaplan</strong> on 27 Apr 2006 11:00 AM:</p><div style="margin-left: 1em">Well, &#229; has already been getting a lot of ad time in other posts, so I figured &#248; deserved a little time, too. :-)</div>
<hr/><p><em>referenced by</em></p><div style="margin-left: 1em"><p>2010/03/15 <a href="http://archives.miloush.net/michkap/archive/2010/03/15/9974423.html">Thus the problems resist solution, and the workarounds are often inadequate</a></p><p>2010/03/03 <a href="http://archives.miloush.net/michkap/archive/2010/03/03/9971878.html">Nordic duck duck goose -- Bokmål, Bokmål, Bokmål, Nynorsk!</a></p><p>2009/02/18 <a href="http://archives.miloush.net/michkap/archive/2009/02/18/9430335.html">In search of the Swedish Tipping Point....</a></p><p>2008/03/27 <a href="http://archives.miloush.net/michkap/archive/2008/03/27/8338664.html">The disunification of Norwegian and Danish sorting ( SQL Server 2008 Edition!)</a></p><p>2007/10/25 <a href="http://archives.miloush.net/michkap/archive/2007/10/25/5686727.html">Not all in sync quite yet (aka SQL and the CLR and Windows and .NET)</a></p><p>2007/09/16 <a href="http://archives.miloush.net/michkap/archive/2007/09/16/4937196.html">A&P of Sort Keys, part 6 (aka Relax, be calm, and deCOMPRESS if you are feeling out of sorts)</a></p><p>2007/07/31 <a href="http://archives.miloush.net/michkap/archive/2007/07/31/4154107.html">See that version there? It is going down, man! #2 (aka Everybody WYNNs)</a></p><p>2007/06/18 <a href="http://archives.miloush.net/michkap/archive/2007/06/18/3374502.html">If you don't always preserve case, you don't always preserve meaning</a></p><p>2006/08/26 <a href="http://archives.miloush.net/michkap/archive/2006/08/26/712848.html">The myth of cross-product compatibility</a></p></div><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2006/04/27/584859.html" title="&#39;Doctor, it hurts when I do this.&#39; Well, don&#39;t do that!">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2006/04/26/583390.html" title="How to NOT Parse Unicode Digits, or How to: Parse Unicode Digits... NOT!">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2006-04">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2006-04-27">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2006/04/27/584439.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:39 GMT -->
</html>