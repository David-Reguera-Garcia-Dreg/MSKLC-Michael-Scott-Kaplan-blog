<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2006/04/12/575080.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:40 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>Getting all you can out of a keyboard layout, Part #9a</title></head><body>
<h1>Getting all you can out of a keyboard layout, Part #9a</h1>
<p><em>by Michael S. Kaplan, published on 2006/04/12 12:01 -04:00, original URI: http://blogs.msdn.com/b/michkap/archive/2006/04/12/575080.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<P><FONT face=Tahoma>(Previous posts in this series: Parts <A HREF="http://archives.miloush.net/michkap/archive/2006/03/23/558658.html"><STRONG>0</STRONG></A>, <A HREF="http://archives.miloush.net/michkap/archive/2006/03/23/558674.html"><STRONG>1</STRONG></A>, <A HREF="http://archives.miloush.net/michkap/archive/2006/03/24/558715.html"><STRONG>2</STRONG></A>, <A HREF="http://archives.miloush.net/michkap/archive/2006/03/24/559169.html"><STRONG>3</STRONG></A>, <A HREF="http://archives.miloush.net/michkap/archive/2006/03/27/561353.html"><STRONG>4</STRONG></A>, <A HREF="http://archives.miloush.net/michkap/archive/2006/03/28/561541.html"><STRONG>5</STRONG></A>, <A HREF="http://archives.miloush.net/michkap/archive/2006/03/31/565407.html"><STRONG>6</STRONG></A>, <A HREF="http://archives.miloush.net/michkap/archive/2006/04/06/569632.html"><STRONG>7</STRONG></A>, and <STRONG><A HREF="http://archives.miloush.net/michkap/archive/2006/04/10/570570.html">8</A></STRONG>)</FONT></P>
<P><FONT face=Tahoma>Today, we're going to take a look at the more complex shift states -- like when a keyboard layout takes the Control, Alt, and/or Shift keys on the right side of the keyboard and give yourself up to three additional "shift" keys. This gives you a theoretical total of up to 62 potential shift states (64 - 2, since we&nbsp;do not use the LEFT ALT or the LEFT ALT+LEFT SHIFT).</FONT></P>
<P><FONT face=Tahoma>Think of the X1, X2, and X3 below as being the three RIGHT shift state keys (without forcing the identity of any of them, specifically):</FONT></P>
<P><FONT face="Courier New" size=1><STRONG>&nbsp; _T("&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"),&nbsp;&nbsp;&nbsp;/* 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; */<BR>&nbsp; _T("LS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"),&nbsp;&nbsp;&nbsp;/* 1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; */<BR>&nbsp; _T("&nbsp;&nbsp; LC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"),&nbsp;&nbsp;&nbsp;/* 2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; */<BR>&nbsp; _T("LS+LC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"),&nbsp;&nbsp;&nbsp;/* 3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; */<BR>&nbsp; _T("&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; LA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"),&nbsp;&nbsp;&nbsp;/* 4:not used&nbsp; */<BR>&nbsp; _T("LS+&nbsp;&nbsp; LA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"),&nbsp;&nbsp;&nbsp;/* 5:not used&nbsp; */<BR>&nbsp; _T("&nbsp;&nbsp; LC+LA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "),&nbsp;&nbsp;&nbsp;/* 6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; */<BR>&nbsp; _T("LS+LC+LA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "),&nbsp;&nbsp;&nbsp;/* 7&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; */<BR>&nbsp; _T("&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; X1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "),&nbsp;&nbsp; /* 8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; */<BR>&nbsp; _T("LS+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; X1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "),&nbsp;&nbsp; /* 9&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; */<BR>&nbsp; _T("&nbsp;&nbsp; LC+&nbsp;&nbsp; X1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "),&nbsp;&nbsp; /* 10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; */<BR>&nbsp; _T("LS+LC+&nbsp;&nbsp; X1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "),&nbsp;&nbsp; /* 11&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; */<BR>&nbsp; _T("&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; LA+X1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "),&nbsp;&nbsp; /* 12&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; */<BR>&nbsp; _T("LS+&nbsp;&nbsp;&nbsp;LA+X1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "),&nbsp;&nbsp; /* 13&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; */<BR>&nbsp; _T("&nbsp;&nbsp; LC+LA+X1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "),&nbsp;&nbsp; /* 14&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; */<BR>&nbsp; _T("LS+LC+LA+X1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "),&nbsp;&nbsp; /* 15&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; */<BR>&nbsp; _T("&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; X2&nbsp;&nbsp; "),&nbsp;&nbsp; /* 16&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; */<BR>&nbsp; _T("LS+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; X2&nbsp;&nbsp; "),&nbsp;&nbsp; /* 17&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; */<BR>&nbsp; _T("&nbsp;&nbsp;&nbsp;LC+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; X2&nbsp;&nbsp; "),&nbsp;&nbsp; /* 18&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; */<BR>&nbsp; _T("LS+LC+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; X2&nbsp;&nbsp; "),&nbsp;&nbsp; /* 19&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; */<BR>&nbsp; _T("&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; LA+&nbsp;&nbsp; X2&nbsp;&nbsp; "),&nbsp;&nbsp; /* 20&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; */<BR>&nbsp; _T("LS+&nbsp;&nbsp; LA+&nbsp;&nbsp;&nbsp;X2&nbsp;&nbsp; "),&nbsp;&nbsp; /* 21&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; */<BR>&nbsp; _T("&nbsp;&nbsp; LC+LA+&nbsp;&nbsp; X2&nbsp;&nbsp; "),&nbsp;&nbsp; /* 22&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; */<BR>&nbsp; _T("LS+LC+LA+&nbsp;&nbsp; X2&nbsp;&nbsp; "),&nbsp;&nbsp; /* 23&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; */<BR>&nbsp; _T("&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; X1+X2&nbsp;&nbsp; "),&nbsp;&nbsp; /* 24&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; */<BR>&nbsp; _T("LS+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; X1+X2&nbsp;&nbsp; "),&nbsp;&nbsp; /* 25&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; */<BR>&nbsp; _T("&nbsp;&nbsp; LC+&nbsp;&nbsp; X1+X2&nbsp;&nbsp; "),&nbsp;&nbsp; /* 26&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; */<BR>&nbsp; _T("LS+LC+&nbsp;&nbsp; X1+X2&nbsp;&nbsp; "),&nbsp;&nbsp; /* 27&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; */<BR>&nbsp; _T("&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; LA+X1+X2&nbsp;&nbsp; "),&nbsp;&nbsp; /* 28&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; */<BR>&nbsp; _T("LS+&nbsp;&nbsp; LA+X1+X2&nbsp;&nbsp; "),&nbsp;&nbsp; /* 29&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; */<BR>&nbsp; _T("&nbsp;&nbsp; LC+LA+X1+X2&nbsp;&nbsp; "),&nbsp;&nbsp; /* 30&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; */<BR>&nbsp; _T("LS+LC+LA+X1+X2&nbsp;&nbsp; "),&nbsp;&nbsp; /* 31&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; */<BR>&nbsp; _T("&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; X3"),&nbsp;&nbsp; /* 32&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; */<BR>&nbsp; _T("LS+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; X3"),&nbsp;&nbsp; /* 33&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; */<BR>&nbsp; _T("&nbsp;&nbsp; LC+ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; X3"),&nbsp;&nbsp; /* 34&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; */<BR>&nbsp; _T("LS+LC+&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; X3"),&nbsp;&nbsp; /* 35&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; */<BR>&nbsp; _T("&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; LA+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; X3"),&nbsp;&nbsp; /* 36&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; */<BR>&nbsp; _T("LS+&nbsp;&nbsp; LA+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; X3"),&nbsp;&nbsp; /* 37&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; */<BR>&nbsp; _T("&nbsp;&nbsp; LC+LA+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; X3"),&nbsp;&nbsp; /* 38&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; */<BR>&nbsp; _T("LS+LC+LA+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; X3"),&nbsp;&nbsp; /* 39&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; */<BR>&nbsp; _T("&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; X1+&nbsp;&nbsp; X3"),&nbsp;&nbsp; /* 40&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; */<BR>&nbsp; _T("LS+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; X1+&nbsp;&nbsp; X3"),&nbsp;&nbsp; /* 41&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; */<BR>&nbsp; _T("&nbsp;&nbsp; LC+&nbsp;&nbsp; X1+&nbsp;&nbsp; X3"),&nbsp;&nbsp; /* 42&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; */<BR>&nbsp; _T("LS+LC+&nbsp;&nbsp; X1+&nbsp;&nbsp; X3"),&nbsp;&nbsp; /* 43&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; */<BR>&nbsp; _T("&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; LA+X1+&nbsp;&nbsp; X3"),&nbsp;&nbsp; /* 44&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; */<BR>&nbsp; _T("LS+&nbsp;&nbsp; LA+X1+&nbsp;&nbsp; X3"),&nbsp;&nbsp; /* 45&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; */<BR>&nbsp; _T("&nbsp;&nbsp; LC+LA+X1+&nbsp;&nbsp; X3"),&nbsp;&nbsp; /* 46&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; */<BR>&nbsp; _T("LS+LC+LA+X1+&nbsp;&nbsp; X3"),&nbsp;&nbsp; /* 47&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; */<BR>&nbsp; _T("&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; X2+X3"),&nbsp;&nbsp; /* 48&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; */<BR>&nbsp; _T("LS+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; X2+X3"),&nbsp;&nbsp; /* 49&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; */<BR>&nbsp; _T("&nbsp;&nbsp; LC+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; X2+X3"),&nbsp;&nbsp; /* 50&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; */<BR>&nbsp; _T("LS+LC+ &nbsp;&nbsp;&nbsp;&nbsp; X2+X3"),&nbsp;&nbsp; /* 51&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; */<BR>&nbsp; _T("&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; LA+&nbsp;&nbsp; X2+X3"),&nbsp;&nbsp; /* 52&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; */<BR>&nbsp; _T("LS+&nbsp;&nbsp; LA+&nbsp;&nbsp; X2+X3"),&nbsp;&nbsp; /* 53&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; */<BR>&nbsp; _T("&nbsp;&nbsp; LC+LA+ &nbsp; X2+X3"),&nbsp;&nbsp; /* 54&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; */<BR>&nbsp; _T("LS+LC+LA+&nbsp;&nbsp; X2+X3"),&nbsp;&nbsp; /* 55&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; */<BR>&nbsp; _T("&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; X1+X2+X3"),&nbsp;&nbsp; /* 56&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; */<BR>&nbsp; _T("LS+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; X1+X2+X3"),&nbsp;&nbsp; /* 57&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; */<BR>&nbsp; _T("&nbsp;&nbsp; LC+&nbsp;&nbsp; X1+X2+X3"),&nbsp;&nbsp; /* 58&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; */<BR>&nbsp; _T("LS+LC+&nbsp;&nbsp; X1+X2+X3"),&nbsp;&nbsp; /* 59&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; */<BR>&nbsp; _T("&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; LA+X1+X2+X3"),&nbsp;&nbsp; /* 60&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; */<BR>&nbsp; _T("LS+&nbsp;&nbsp; LA+X1+X2+X3"),&nbsp;&nbsp; /* 61&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; */<BR>&nbsp; _T("&nbsp;&nbsp; LC+LA+X1+X2+X3"),&nbsp;&nbsp; /* 62&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; */<BR>&nbsp; _T("LS+LC+LA+X1+X2+X3"),&nbsp;&nbsp; /* 63&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; */</STRONG></FONT></P>
<P><FONT face=Tahoma>And thus we have 64 shift states. I left X1, X2, and X3 defined as there is no standard for the order, and the only keyboard that has them defined uses the RIGHT CONTROL character, which is not exactly reflecting the order on the left side....</FONT></P>
<P><FONT face=Tahoma>Now&nbsp;I mentioned that this is a theoretical limit, and my belief is based on several factors:</FONT></P>
<UL>
<LI><FONT face=Tahoma>No human could comfortably type in all these different shift states comfortably;</FONT></LI>
<LI><FONT face=Tahoma>No human could really remember all of these shift states;</FONT></LI>
<LI><FONT face=Tahoma>Factors like ALTGR would interfere ptretty heavily in many cases....</FONT></LI>
<LI><FONT face=Tahoma>Only two additional shift states have ever shipped with Windows, so by </FONT><FONT face=Tahoma>aplying the first </FONT><A HREF="http://archives.miloush.net/michkap/archive/2005/11/12/491519.html"><FONT face=Tahoma><STRONG>Tester's Axiom</STRONG></FONT></A><FONT face=Tahoma>&nbsp;(if you have not tested it, assume it is broken), it is likely that they won't all work;</FONT></LI>
<LI><FONT face=Tahoma>The following comment exists in the tool that creates the layouts:<BR></FONT><FONT face="Courier New" size=2><STRONG>&nbsp;&nbsp; // <BR>&nbsp;&nbsp; // Note that we do not really document additional state labels<BR>&nbsp;&nbsp; // past 7 very well. But this may actually be a good thing.<BR>&nbsp;&nbsp; //</STRONG></FONT></LI>
<LI><FONT face=Tahoma>And no, MSKLC does not support any of this. :-)</FONT></LI></UL>
<P><FONT face=Tahoma>Anticipating another question -- I am not covering how to create such keyboards in this post; I am still trying to figure out how to interrogate a layout to get the information from it....</FONT></P>
<P><FONT face=Tahoma>So, I talked about <A href="http://msdn.microsoft.com/library/en-us/winui/winui/windowsuserinterface/userinput/keyboardinput/keyboardinputreference/keyboardinputfunctions/vkkeyscan.asp">VkKeyScan</A> and <A href="http://msdn.microsoft.com/library/en-us/winui/winui/windowsuserinterface/userinput/keyboardinput/keyboardinputreference/keyboardinputfunctions/vkkeyscanex.asp">VkKeyScanEx</A> <A HREF="http://archives.miloush.net/michkap/archive/2006/03/26/560595.html">recently</A>, so let's make some good use of it. If I load up the Canadian Multilingual Standard keyboard and call <A href="http://msdn.microsoft.com/library/en-us/winui/winui/windowsuserinterface/userinput/keyboardinput/keyboardinputreference/keyboardinputfunctions/vkkeyscanex.asp">VkKeyScanEx</A> to ask for some of the characters that are only in those shift states, here is what comes back:</FONT></P>
<UL>
<LI><FONT face=Tahoma>U+007c (AltGR+OEM_7) -- 0x06de</FONT></LI>
<LI><FONT face=Tahoma>U+00b9 (Rt. CTRL+1) -- 0x0831</FONT></LI>
<LI><FONT face=Tahoma>U+00b3 (Rt. CTRL+3) -- 0x0833</FONT></LI>
<LI><FONT face=Tahoma>U+00a1 (SHFT+Rt. CTRL+1) -- 0x0931</FONT></LI></UL>
<P><FONT face=Tahoma>So, the VkKeyScanEx docs got it wrong again -- it was right about that&nbsp;0x06 in the high byte is CRTL+ALT or AltGR, but </FONT><FONT face=Tahoma>that 0x08 and 0x09 in the high byte are not Hankaku an SHFT+Hankaku! They are both defined by the keyboard layout.</FONT></P>
<P><FONT face=Tahoma>But, trying to set the "pressed" bit on VK_RCONTROL in our FillKeyState function created in prior posts does not create these characters. So how can we get at them?</FONT></P>
<P><FONT face=Tahoma>The trick is in the way the keyboard actually remaps to another VK value and makes <STRONG>it</STRONG> the one that will act as the shifting key. Then, using <A href="http://msdn.microsoft.com/library/en-us/winui/winui/windowsuserinterface/userinput/keyboardinput/keyboardinputreference/keyboardinputfunctions/mapvirtualkeyex.asp">MapVirtualKeyEx</A> and two of it's amazing uMapType values:</FONT></P>
<UL>
<LI><FONT face=Tahoma><STRONG>1</STRONG> -- uCode is a scan code and is translated into a virtual-key code that does not distinguish between left- and right-hand keys. If there is no translation, the function returns 0.</FONT></LI>
<LI><FONT face=Tahoma><STRONG>3</STRONG> -- Windows NT/2000/XP: uCode is a scan code and is translated into a virtual-key code that distinguishes between left- and right-hand keys. If there is no translation, the function returns 0.</LI></UL></FONT>
<P><FONT face=Tahoma>And running code like the following:</FONT></P>
<BLOCKQUOTE dir=ltr style="MARGIN-RIGHT: 0px">
<P><FONT face="Courier New" size=2>for(KeysEx vk = KeysEx.None; vk &lt;= KeysEx.VK_OEM_CLEAR; vk++) {<BR>&nbsp;&nbsp;&nbsp; uint sc = VirtualKey.MapVirtualKeyEx((uint)vk, 0, hkl);<BR>&nbsp;&nbsp;&nbsp; uint vkL = VirtualKey.MapVirtualKeyEx(sc, 1, hkl);<BR>&nbsp;&nbsp;&nbsp; uint vkR = VirtualKey.MapVirtualKeyEx(sc, 3, hkl);<BR>&nbsp;&nbsp;&nbsp; if(vkL != vkR) {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if((uint)vk != vkL) {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Console.WriteLine("{0}\t{1:x2}\t{2}\t{3}", <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; vk.ToString(), <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sc, <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ((KeysEx)vkL).ToString(), <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ((KeysEx)vkR).ToString());<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<BR>&nbsp;&nbsp;&nbsp; }<BR>}</FONT></P></BLOCKQUOTE>
<P><FONT face=Tahoma>The following output gets produced on the US and most other keyboards:</FONT></P>
<BLOCKQUOTE dir=ltr style="MARGIN-RIGHT: 0px">
<P><FONT face="Courier New"><STRONG>VK_LSHIFT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2a&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; VK_SHIFT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; VK_LSHIFT<BR>VK_RSHIFT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 36&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; VK_SHIFT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; VK_RSHIFT<BR>VK_LCONTROL&nbsp;&nbsp;&nbsp;&nbsp; 1d&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; VK_CONTROL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; VK_LCONTROL<BR>VK_RCONTROL&nbsp;&nbsp;&nbsp;&nbsp; 1d&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; VK_CONTROL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; VK_LCONTROL<BR>VK_LMENU&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 38&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; VK_MENU VK_LMENU<BR>VK_RMENU&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 38&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; VK_MENU VK_LMENU</STRONG></FONT></P></BLOCKQUOTE>
<P><FONT face=Tahoma>Notice how the first column, which lists the original VK,&nbsp;shows only six VKs that will not roundtrip the same way between a regular VK-&gt;SC-&gt;VK mapping and one that distinguishes between the left and right hand keys? And it is exactly the ones we expected!</FONT></P>
<P><FONT face=Tahoma>If you look carefully at the VK_RMENU and VK_RCONTROL virtual keys, you will see that they are mapped to their left handed counterparts; this is due to the fact that they do not haved defined scan codes that are different other than by being EXTENDED scan codes, and <A href="http://msdn.microsoft.com/library/en-us/winui/winui/windowsuserinterface/userinput/keyboardinput/keyboardinputreference/keyboardinputfunctions/mapvirtualkeyex.asp">MapVirtualKeyEx</A>&nbsp;strips out the extended bit for reasons that have never been adequately explained to me....</FONT></P>
<P><FONT face=Tahoma>But that is okay -- we just need to know the identity of the six keys; it is only of secondary importance to distinguish them from each other....</FONT></P>
<P><FONT face=Tahoma>Anyway, running that same code again, the following output gets produced on the Canadian Multilingual Standard keyboard:</FONT></P>
<BLOCKQUOTE dir=ltr style="MARGIN-RIGHT: 0px">
<P><FONT face="Courier New"><STRONG>VK_LSHIFT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2a&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; VK_SHIFT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; VK_LSHIFT<BR>VK_RSHIFT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 36&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; VK_SHIFT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; VK_RSHIFT<BR>VK_LCONTROL&nbsp;&nbsp;&nbsp;&nbsp; 1d&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; VK_CONTROL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; VK_LCONTROL<BR>VK_LMENU&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 38&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; VK_MENU VK_LMENU<BR>VK_RMENU&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 38&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; VK_MENU VK_LMENU<BR>VK_OEM_8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1d&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; VK_CONTROL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; VK_LCONTROL</STRONG></FONT></P></BLOCKQUOTE>
<P><FONT face=Tahoma>Do you see what happened? The VK_RCONTROL is no longer returning different results, as the VK_OEM_8 key has been mapped to it. If we treat the VK_OEM_8 key as our shifting key in the FillKeyState&nbsp;function, then we suddenly have access to those two new shift states!</FONT></P>
<P><FONT face=Tahoma>So what we would have to theoretically do here would be to look back at the list of shift states from earlier and assume that we now had 16 shift states (the 8 old ones and now 8 new ones), but I'm going to just pick up the additional two since I know that is all that is in the keyboard.</FONT></P>
<P><FONT face=Tahoma>It is important to remember that first tester's axiom and not write a bunch of code that I can't really test effectively....</FONT></P>
<P><FONT face=Tahoma>I'll post the updated version of our code later today (in Part #9b), along with the full version that gets spit out with the Canadian Multilingual Standard keyboard....</FONT></P>
<hr/><div style="margin-left: 1em"><em>no comments</em></div><hr/><p><em>referenced by</em></p><div style="margin-left: 1em"><p>2010/09/28 <a href="http://archives.miloush.net/michkap/archive/2010/09/28/10068553.html">Like one of those standards that can't/won't be fully implemented</a></p><p>2008/02/02 <a href="http://archives.miloush.net/michkap/archive/2008/02/02/7385461.html">[Confusing functionality] + [New features] = [Documentation that can be confusing]</a></p><p>2006/08/29 <a href="http://archives.miloush.net/michkap/archive/2006/08/29/729476.html">When you think it couldn't get any harder, it gets easier</a></p><p>2006/04/22 <a href="http://archives.miloush.net/michkap/archive/2006/04/22/581107.html">Getting all you can out of a keyboard layout, Part #10a</a></p><p>2006/04/13 <a href="http://archives.miloush.net/michkap/archive/2006/04/13/575500.html">Getting all you can out of a keyboard layout, Part #9b</a></p></div><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2006/04/13/575500.html" title="Getting all you can out of a keyboard layout, Part #9b">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2006/04/11/572943.html" title="I daresay it is often &lt;= -1">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2006-04">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2006-04-12">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2006/04/12/575080.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:40 GMT -->
</html>