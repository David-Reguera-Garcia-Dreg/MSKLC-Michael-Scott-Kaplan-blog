<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2006/04/21/580316.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:39 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>'universal-character-name encountered in source'</title></head><body>
<h1>'universal-character-name encountered in source'</h1>
<p><em>by Michael S. Kaplan, published on 2006/04/21 03:01 -04:00, original URI: http://blogs.msdn.com/b/michkap/archive/2006/04/21/580316.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<P><FONT face=Tahoma>The compiler error is C4428: universal-character-name encountered in source. The description of it <A href="http://msdn2.microsoft.com/en-us/library/ttw8abkd(VS.80).aspx">in MSDN</A> has a few problems in regard to understandability:</FONT></P><FONT face=Tahoma>
<BLOCKQUOTE dir=ltr style="MARGIN-RIGHT: 0px">
<BLOCKQUOTE dir=ltr style="MARGIN-RIGHT: 0px">
<DIV class=topic><FONT size=2>Visual C++ Concepts: Building a C/C++ Program<BR></FONT><FONT size=4>Compiler Warning (level 4) C4428&nbsp;&nbsp; </FONT></DIV>
<BLOCKQUOTE dir=ltr style="MARGIN-RIGHT: 0px">
<DIV class=topic><FONT size=2><STRONG>Error Message <BR></STRONG>universal-character-name encountered in source</FONT></DIV></BLOCKQUOTE>
<DIV class=topic>The compiler issues C4428 when it detects at least one universal character name in a source code file. To fix this warning, use the Unicode equivalent of the universal character name.<BR></DIV>
<DIV class=topic>This warning is only issued once per compiland.<BR></DIV>
<DIV class=topic>The following sample generates C4428:</DIV>
<DIV class=topic><BR></FONT><FONT face="Courier New" size=2><STRONG>&nbsp; // C4428.cpp<BR>&nbsp; // compile with: /W4 /c<BR>&nbsp; int \u20ac = 0;&nbsp; // C4428 universal character name<BR>&nbsp; /// The following line is the Unicode equivalent of&nbsp;\u20ac:<BR>&nbsp; // int&nbsp; = 0;</STRONG></FONT></DIV></BLOCKQUOTE></BLOCKQUOTE>
<P><FONT face=Tahoma>Now we'll start with the code sample that won't compile -- obviously they meant put "// int € = 0;" but there is no character there -- it is just a space.</FONT></P>
<P><FONT face=Tahoma>And of course there is the unclear error message -- 'universal-character-name encountered in source' -- as if including a Unicode UTF-16 code unit in source has anything whatsoever to do with character names in either Unicode or ISO 10616.</FONT></P>
<P><FONT face=Tahoma>Moving deeper, a currency symbol like the Euro&nbsp;is a&nbsp;symbol (just like the space, as I pointed out <A HREF="http://archives.miloush.net/michkap/archive/2006/03/25/560416.html"><STRONG>here</STRONG></A>) so if using a random Unicode character with a Unicode <A href="http://www.fileformat.info/info/unicode/category">General Category</A> of <A href="http://www.fileformat.info/info/unicode/category/Sc/index.htm">Sc</A> (<A href="http://www.fileformat.info/info/unicode/category/Sc/index.htm">Symbol, Currency</A>) is a valid variable name then that is just poor compiler design (and not conformant with the current design for identifiers being considered by the C/C++ committees). Plus if you look at the current rules for <A href="http://msdn2.microsoft.com/en-us/library/c5fb70sw(VS.80).aspx">identifiers in Microsoft C/C++</A>:</FONT></P>
<BLOCKQUOTE dir=ltr style="MARGIN-RIGHT: 0px">
<P><FONT face="Courier New" size=2>identifier: <BR>nondigitidentifier nondigitidentifier digit</FONT></P>
<P><FONT face="Courier New"><FONT size=2><STRONG>nondigit:</STRONG> one of <BR></FONT>_ a b c d e f g h i j k l m n o p q r s t u v w x y z<BR>A B C D E F G H I J K L M N O P Q R S T U V W X Y Z</FONT></P>
<P><FONT face="Courier New"><FONT size=2><STRONG>digit</STRONG>: one of <BR></FONT>0 1 2 3 4 5 6 7 8 9</FONT></P></BLOCKQUOTE>
<P><FONT face=Tahoma>So unless I am missing something you can't have U+20ac as a&nbsp;variable name&nbsp;anyway right now in C or C++....</FONT></P>
<P><FONT face=Tahoma>Ok, moving past the terrible example (broken on the levels of both saying the wrong thing and saying it poorly), there is having this warning at all.</FONT></P>
<P><FONT face=Tahoma>Why is the \u syntax worthy of level 4 warning? It is actually something perfectly acceptable to do, and unless you are a native speaker of a language it is a hell of a lot more useful than putting random characters into source code.</FONT></P>
<P><FONT face=Tahoma>I have a colleague who made a huge push to get our piece of the Windows project compiling with /w4 and I'd feel like that kind of a push was a lot 'symbolically' more useful if the compiler stuck with the warnings that had a real purpose.</FONT></P>
<P><FONT face=Tahoma>This one is&nbsp;only slightly more useful than&nbsp;a warning for identifiers with an odd number of characters in it!</FONT></P>
<P><FONT face=Tahoma>Anyway, do not feel badly about&nbsp;supressing this warning -- it is begging for supression, truly.</FONT></P>
<P><FONT face=Tahoma></FONT>&nbsp;</P>
<P><SPAN><FONT color=#ff1493><FONT face=Tahoma><EM>This post brought to you by </EM>"€"<EM>&nbsp;(<A href="http://www.fileformat.info/info/unicode/char/20ac">U+20ac</A>, a.k.a. EURO SIGN)</EM></FONT></FONT></SPAN></P>
<hr/><p><a id="580484" href="#580484">#</a> <strong>Andrew West</strong> on 21 Apr 2006 5:35 AM:</p><div style="margin-left: 1em">So if I try to compile<br><br>int € = 0;<br><br>in a C++ program with Visual Studio 7.1 I get<br><br>error C3209: ' ' : Unicode identifiers are not yet supported<br><br>and the documentation for this error implies that you should use UCNs. And sure enough the following line compiles OK.<br><br>int \u20ac = 0;<br><br>However I do not get the C4428 warning (even with Warning Level 4 set), and C4428 is not even in my local copy of MSDN, so I guess it must be a new (and really stupid) warning.<br><br>But one thing that I did notice is that the '€' character is replaced by '?' in the following (expected) warning:<br><br>warning C4189: '?' : local variable is initialized but not referenced<br><br>I think that it is pretty lame that the build log cannot cope with Unicode (the HTML version explicitly uses Windows-1252), when all the other Visual Studio components support Unicode. Do you know if that will be fixed soon?<br></div>
<p><a id="580579" href="#580579">#</a> <strong>Michael S. Kaplan</strong> on 21 Apr 2006 8:58 AM:</p><div style="margin-left: 1em">The error is new for 8.0, so I suspect the behavior will change slightly with the upgrade....<br><br>Of course, since identifiers still cannot be outside of that ASCII range, the C3209 will still be there. And the build log being fixed may have to wait for the point where the identifiers are actuaslly supported, since updating the log without that functionality is pretty limited?</div>
<p><a id="580683" href="#580683">#</a> <strong>Maurits [MSFT]</strong> on 21 Apr 2006 11:31 AM:</p><div style="margin-left: 1em">&gt; identifier: nondigitidentifier nondigitidentifier digit<br><br>This is, obviously, horribly wrong. <br><br>It should be:<br><br>identifier:<br>.. identifier-nondigit<br>.. identifier identifier-nondigit<br>.. identifier digit</div>
<p><a id="580686" href="#580686">#</a> <strong>Maurits [MSFT]</strong> on 21 Apr 2006 11:34 AM:</p><div style="margin-left: 1em">Looks like missing linebreaks are the culprit.<br>Put linebreaks where the *s are and it's right:<br><br>identifier:*nondigit*identifier nondigit*identifier digit </div>
<p><a id="580701" href="#580701">#</a> <strong>Maurits [MSFT]</strong> on 21 Apr 2006 11:58 AM:</p><div style="margin-left: 1em">On the &quot;symbol&quot; note...<br><br>int _ = 0;<br><br>also compiles, and fits the syntax.<br><br>_ isn't a &quot;symbol&quot;, but it is &quot;punctuation&quot;<br><a rel="nofollow" target="_new" href="http://www.fileformat.info/info/unicode/category/Pc/list.htm">http://www.fileformat.info/info/unicode/category/Pc/list.htm</a><br><br>Luckily, it's a special &quot;connector&quot; kind of punctuation (unlike, say, &quot;.&quot;, which is just &quot;Punctuation, Other&quot;)<br><br>Even more luckily, all other &quot;Punctuation, Connector&quot; characters look suitable for use in identifiers...<br><br>So perhaps identifier-digit and identifier-nondigit can be determined purely in terms of Unicode categories!<br><br>(With identifier-nondigit including [Pc] purely for the benefit of &quot;_&quot; and co.)</div>
<p><a id="580716" href="#580716">#</a> <strong>Maurits [MSFT]</strong> on 21 Apr 2006 12:12 PM:</p><div style="margin-left: 1em">This page gets the line breaks right, thankfully.<br><br><a rel="nofollow" target="_new" href="http://msdn2.microsoft.com/en-us/library/e7f8y25b.aspx">http://msdn2.microsoft.com/en-us/library/e7f8y25b.aspx</a></div>
<p><a id="580767" href="#580767">#</a> <strong>Mihai</strong> on 21 Apr 2006 12:46 PM:</p><div style="margin-left: 1em">&quot;So unless I am missing something you can't have U+20ac as a variable name anyway right now in C or C++....&quot;<br><br>You might be right about MS C++, but not about C++ standard:<br> &nbsp; identifier::= nondigit #( nondigit | digit).<br> &nbsp; nondigit::= universal_character_name | ASCII.letter | ASCII.underscore.<br> &nbsp; universal_character_name::= backslash &quot;u&quot; hex_quad | backslash &quot;U&quot; hex_quad^2.<br><br>This means \u20ac or \U000020ac are fine.<br><br>I was able to find something here: <a rel="nofollow" target="_new" href="http://www.csci.csusb.edu/dick/c++std/syntax.html">http://www.csci.csusb.edu/dick/c++std/syntax.html</a><br>(for some reason the standard itself is not available online, and I cannot post Stroustrup's hardcover edition of &quot;The C++ Programming Language&quot; :-)<br></div>
<p><a id="580816" href="#580816">#</a> <strong>Maurits [MSFT]</strong> on 21 Apr 2006 1:54 PM:</p><div style="margin-left: 1em">&gt; for some reason the standard itself is not available online<br><br>That's because the ISO likes to charge for their standards.<br><br>The latest C++ standard is CHF 352,00<br><br><a rel="nofollow" target="_new" href="http://www.iso.org/iso/en/CatalogueDetailPage.CatalogueDetail?CSNUMBER=38110&amp;ICS1=35&amp;ICS2=60&amp;ICS3=">http://www.iso.org/iso/en/CatalogueDetailPage.CatalogueDetail?CSNUMBER=38110&amp;ICS1=35&amp;ICS2=60&amp;ICS3=</a></div>
<p><a id="580824" href="#580824">#</a> <strong>Michael S. Kaplan</strong> on 21 Apr 2006 2:06 PM:</p><div style="margin-left: 1em">I was indeed referring to MS-specific C/C++ (and the whole post is about an MS-specific compile error and its troubled documentation....</div>
<p><a id="580837" href="#580837">#</a> <strong>Maurits [MSFT]</strong> on 21 Apr 2006 2:15 PM:</p><div style="margin-left: 1em">&gt; ISO likes to charge for their standards<br><br>Drafts, on the other hand, are usually made publically available for the purposes of review.<br><br>For example, C0x is available here:<br><a rel="nofollow" target="_new" href="http://c0x.coding-guidelines.com/">http://c0x.coding-guidelines.com/</a><br><br>See in particular<br><a rel="nofollow" target="_new" href="http://c0x.coding-guidelines.com/">http://c0x.coding-guidelines.com/</a>6.4.2.1.html<br><a rel="nofollow" target="_new" href="http://c0x.coding-guidelines.com/">http://c0x.coding-guidelines.com/</a>6.4.3.html<br><br>including a list of disallowed code points</div>
<p><a id="580991" href="#580991">#</a> <strong>Michael Dunn_</strong> on 21 Apr 2006 5:16 PM:</p><div style="margin-left: 1em">On a sort-of-related topic, try this in VC:<br> <br>int $a = 1;<br> <br>I got a laugh out of that a couple years ago when I accidentally discovered that VC allows $ in variable names. Make your C look like Perl! (I found that using VC6, not sure if later versions accept it.)</div>
<p><a id="580998" href="#580998">#</a> <strong>Maurits [MSFT]</strong> on 21 Apr 2006 5:29 PM:</p><div style="margin-left: 1em">Ah, so that's why 6.4.3 allows $, @, and ` in \u-ish code points<br><br>I wonder how far this can be pushed...<br><br>/* perl.h */<br><br>#define my int<br>#define use using<br>#define elsif else if<br>#define until(x) while(!(x))<br>...<br></div>
<p><a id="581050" href="#581050">#</a> <strong>Mike Dimmick</strong> on 21 Apr 2006 7:02 PM:</p><div style="margin-left: 1em">Maurits: if you want the C++ standard you can buy it from ANSI, in PDF format, for $30. It's gone up a bit, it was $18 when I bought my copy. You don't need to be based in the US.<br><br><a rel="nofollow" target="_new" href="http://webstore.ansi.org/ansidocstore/product.asp?sku=INCITS%2FISO%2FIEC+14882%2D2003">http://webstore.ansi.org/ansidocstore/product.asp?sku=INCITS%2FISO%2FIEC+14882%2D2003</a></div>
<p><a id="581073" href="#581073">#</a> <strong>Maurits [MSFT]</strong> on 21 Apr 2006 7:51 PM:</p><div style="margin-left: 1em">Sweet... that's about 90% off the ISO price.</div>
<p><a id="581163" href="#581163">#</a> <strong>josh</strong> on 22 Apr 2006 12:41 AM:</p><div style="margin-left: 1em">Chars like $ and @ are often used in generated code, particularly for C where you can't just namespace things off.</div>
<hr/><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2006/04/21/580328.html" title="Every character has a story #20: U+210e (PLANCK CONSTANT)">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2006/04/20/579579.html" title="Sample code for getting ELK cultures on other platforms">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2006-04">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2006-04-21">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2006/04/21/580316.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:40 GMT -->
</html>