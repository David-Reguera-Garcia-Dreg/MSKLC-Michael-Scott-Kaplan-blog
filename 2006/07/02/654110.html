<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2006/07/02/654110.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:39 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>About the Fonts folder in Windows, Part 2 (aka Adding Fonts)</title></head><body>
<h1>About the Fonts folder in Windows, Part 2 (aka Adding Fonts)</h1>
<p><em>by Michael S. Kaplan, published on 2006/07/02 03:01 -04:00, original URI: http://blogs.msdn.com/b/michkap/archive/2006/07/02/654110.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<p><font face="Tahoma">You may have read the first post I wrote about this, titled <b><a href="http://archives.miloush.net/michkap/archive/2006/06/25/646701.html" mce_href="http://archives.miloush.net/michkap/archive/2006/06/25/646701.html">About the Fonts folder in Windows, Part 1 (aka What are we talking about?)</a></b>. I won't say that it is all downhill from there, but this post is definitely going to see us spending a little time in the valley....</font></p>

<p><font face="Tahoma">You see, there is one thing about the Fonts folder that just about <b>everyone</b> can agree about -- the lovers of Microsoft, the haters of it, and everyone in between. </font></p>

<p><font face="Tahoma">And that is that they can't stand the UI for adding fonts.</font></p>

<p><font face="Tahoma">There are even <a href="http://www.microsoft.com/resources/documentation/windows/xp/all/proddocs/en-us/windows_fonts_addnew.mspx?mfr=true" mce_href="http://www.microsoft.com/resources/documentation/windows/xp/all/proddocs/en-us/windows_fonts_addnew.mspx?mfr=true">instructions</a> for it,&nbsp;though those instructions do not include pictures (probably put together by someone who was embarrassed about the whole thing).</font></p>

<p><font face="Tahoma">Luckily the folks on the Typography team include <a href="http://www.microsoft.com/typography/TrueTypeInstallWin95.mspx" mce_href="http://www.microsoft.com/typography/TrueTypeInstallWin95.mspx">a little art</a> here.&nbsp;It is true that&nbsp;they haven't updated the instructions for the last few versions. But that is okay -- because the UI has not been updated either. :-)</font></p>

<p><font face="Tahoma">And if you want art, the folks at Adobe give instructions with art <a href="http://www.adobe.com/cfusion/knowledgebase/index.cfm?id=tn_3649" mce_href="http://www.adobe.com/cfusion/knowledgebase/index.cfm?id=tn_3649">here</a> and <a href="http://www.adobe.com/cfusion/knowledgebase/index.cfm?id=tn_15817" mce_href="http://www.adobe.com/cfusion/knowledgebase/index.cfm?id=tn_15817">here</a>, the first link having the extra info on using the Adobe Type Manager for all of those Type 1 fonts (ATM is not needed for the later versions).</font></p>

<p><font face="Tahoma">Most people I talk to never even knew this ridiculous dialog that looks like a reject they forgot to update from Windows 3.1 even existed; they simply open the&nbsp;Fonts folder and drag the font files to it. Most people don't even realize there is a right-click menu option for fonts to install them, either.</font></p>

<p><font face="Tahoma">And lots of other people put up sites explaining how much cooler all of this is on a Mac (like <a href="http://www.xvsxp.com/system/fonts_manage.php" mce_href="http://www.xvsxp.com/system/fonts_manage.php">this X vs. VP one</a>). I won't comment except to say that there are some times that Microsoft appears to be clueless about UI. And this is one of them.</font></p>

<p><font face="Tahoma">But the reason for the dialog existing was explained by the owner of it not too long ago:</font></p>

<blockquote dir="ltr" style="margin-right: 0px;">
<blockquote dir="ltr" style="margin-right: 0px;">
<p><font size="2" face="Tahoma">The current install font dialog presents a list of fonts that are present in a directory to install and it lists them by font name.&nbsp; These come in roughly 3 categories:</font></p>

<ol>
<li><font size="2" face="Tahoma"><b>individual fonts</b> - truetype, opentype, raster - eg foo.ttf.&nbsp; There is a 1-1 mapping of fonts to fonts that get displayed in the install font dialog.&nbsp; The only way to get the name of the font is by opening the font file and reading the font name from it - the file names almost never contain a good enough name, and the file names aren't localized.</font> 
</li>
<li><font size="2" face="Tahoma"><b>.inf installs</b> - you can specify a catalog of fonts that span media in a .inf file.&nbsp; There is a 1-many mapping of .inf files to available fonts to install, the only way to generate the list of fonts is to parse the .inf file.</font> 
</li>
<li><font size="2" face="Tahoma"><b>Type 1 fonts, eg foo.pf*</b> -&nbsp;There is a 2-1 mapping of font files to fonts, each type 1 font has 2 files (sometimes 3) associated with it, at a minimum a .pfb and .pfm file.</font></li>
</ol>

<p><font size="2" face="Tahoma">There isn't another dialog in the system that can take such a set of input and produce the proper list of items.&nbsp; Many people say this should just use the common file open dialog, however unfortunately the requirements imposed by 1-3 above aren't supported in any way by the common dialogs, its a very unusual case.</font></p>
</blockquote>
</blockquote>

<p><font face="Tahoma">Now I am going to say that (<b>speaking just for me and not at all for Microsoft or anyone who owns the dialog or the folder or even the functionality</b>) that this explanation does not really ring true for me.</font></p>

<p><font face="Tahoma">I mean, a common file open dialog can handle both multiple file types (.INF, .TTF,&nbsp;.PFB, .PFM, etc.)&nbsp;and multiple files at the same time. If they don't select all the files that are needed for a Type 1 font then an error can be put up just like they selected a corrupted file or one that is already installed.</font></p>

<p><font face="Tahoma">Sure it's a complicated little bit of code, I won't argue about that. And a tester&nbsp;would&nbsp;probably find it to be a target rich environment when looking for bugs. But it isn't impossible; it's just intricate.</font></p>

<p><font face="Tahoma">So it seems like an update here ought to be possible. If that were the only reason, I mean.</font></p>

<p><font face="Tahoma">But in the end,&nbsp;I think the real story is a bit more involved --&nbsp;one of those weird situations where the people who own the functionality (the font folks, the rendering folks, the other font folks) are not the owners of the UI. And they don't have the resources to take the ownership. And the folks who own it don't really have a ton of resources either, so this turns into one of those sacrificial features that can get cut each version (on one version because there is no time left and on the next because we already shipped it before, right?).</font></p>

<p><font face="Tahoma">When everything is said and done, the story here is not nearly as impressive as it probably ought to be. Or even as impressive as it could be. It really does scream for someone to take all that info I put in the first post about what is involved with the install and just putting something together, doesn't it? :-)</font></p>

<p><font face="Tahoma">The story continues, in both more impressive and less impressive ways. Stay tuned....</font></p>

<p><font face="Tahoma"></font>&nbsp;</p>

<p><font color="#ff1493" face="Tahoma"><i>This post brought to you by</i> <font size="8"><b>ï¼¦</b></font><i>(<a href="http://www.fileformat.info/info/unicode/char/ff26" mce_href="http://www.fileformat.info/info/unicode/char/ff26">U+ff26</a>, a.k.a. FULLWIDTH LATIN CAPITAL LETTER F)</i></font></p>
<hr/><p><a id="654186" href="#654186">#</a> <strong>Rosyna</strong> on 2 Jul 2006 3:41 AM:</p><div style="margin-left: 1em">Alternatively, selecting one of the files could select all the rest of the required files automatically. IE, search the directory for the rest. Then there's no reason to deal with the mappings of a font requiring multiple files.<br><br>How does it deal with ttc files?<br></div>
<p><a id="654241" href="#654241">#</a> <strong>Gabe</strong> on 2 Jul 2006 5:36 AM:</p><div style="margin-left: 1em">I understand that using a standard dialog is more or less impossible for the &quot;Add Fonts&quot; feature. However, I don't understand why they don't make a new dialog that just uses Explorer's Font Folder listview code. It shouldn't be too hard to make a dialog that looks like a common Open dialog, only it would show fonts instead of files.</div>
<p><a id="654375" href="#654375">#</a> <strong>Michael S. Kaplan</strong> on 2 Jul 2006 9:16 AM:</p><div style="margin-left: 1em">Hi Gabe,<br><br>I don't disagree here at all -- but that's just a detail (the minimum they would need is something that can do all of the parsing I talked about). <br><br>Ideally a new dialog would do it all before selection along the lines you are talking about, but since it has not been significasntly updated in over 15 years, I would not want to get too greedy in my request. :-)</div>
<p><a id="654376" href="#654376">#</a> <strong>Michael S. Kaplan</strong> on 2 Jul 2006 9:18 AM:</p><div style="margin-left: 1em">Hi Rosyna,<br><br>The current dialog? You just select them, and it adds the multiple fonts? I haven't ever seen TTC files that were not produced by MS, though -- have you?</div>
<p><a id="654393" href="#654393">#</a> <strong>Ruben</strong> on 2 Jul 2006 9:34 AM:</p><div style="margin-left: 1em">The story with Type 1 fonts is even more convoluted when you look at the way the drag &amp; drop functionality works for the Fonts folder.<br><br>- If you drag in a .pfm file, the .pfb fle is copied also, where it seems some intelligence is used to locate it. (The .pfm and .pfb files do not need to be in the same folder for drag &amp; drop to work! Neighbouring folders seem to be taken into account as well.)<br><br>- If you drag the .inf file, the .pfb and .pfm files are copied.<br><br>- If you drag only the .pfb file or both the .pfb and .pfm files, you'll get an error: the font file is damaged or not valid. (Rough translation from Dutch Windows here.)<br><br>Note that .pfm files are pretty much Windows-specific; other systems use .pfb and .afm. (Always at least two files it seems.) The actual font resides inside .pfb file, the .pfm file is mainly for metrics, and I think some GDI/TrueType compatibility. Type 1 being a member of the mostly-but-not-quite 8-bit freestyle/chaos encoding club*, and TrueType being Unicode(ish).<br><br>I believe Adobe and MS have their hopes on Type 1 dying quickly, though.<br><br>* Type 1 fonts tend to to be accessed in 8-bit encodings, but no-one could agree on the actual encoding. So you've got Cyrillic fonts using Latin 1 encoding slots. Yummy. And some fonts support 256 characters (or more), but you'll only be able to access characters 32-255 on Windows or Mac (which used a different encoding vector, IIRC). To give you characters not present in Latin 1 or Mac Roman, you've got 'expert' fonts that provide characters at random code points in the 32-255 range. Including A-Z small caps. Sometimes. And old style figures. But just that, so you'll need to switch fonts continuously if you want to use these features in running text. So Windows is a little erratic with Type 1 fonts, but that's nothing compared to the mess that is called Type 1.</div>
<p><a id="654625" href="#654625">#</a> <strong>Michael S. Kaplan</strong> on 2 Jul 2006 3:28 PM:</p><div style="margin-left: 1em">Hi Ruben, <BR><BR>And this is the format that you don't want to die a quick death? :-) <BR><BR><BR>In this blog, <STRONG>if it's not Unicode then it sucks!</STRONG></div>
<p><a id="655638" href="#655638">#</a> <strong>Ruben</strong> on 3 Jul 2006 8:09 PM:</p><div style="margin-left: 1em">I do want Type 1 to die a quick death. It's outstayed its welcome for nearly a decade, as far as I am concerned. So I do want it to die (one of those freak accidents involving a printing press, preferably). Just not it's replacement: OpenType/CFF :-)<br><br>Now, if only font vendors would replace their Type 1 fonts with OpenType versions for free...</div>
<p><a id="655786" href="#655786">#</a> <strong>Michael S. Kaplan</strong> on 4 Jul 2006 1:53 AM:</p><div style="margin-left: 1em">Folks I have talked to over here in MS Typography say that CFF outlines are supported, as are many other parts of OpenType. Just so you know. :-)</div>
<p><a id="656277" href="#656277">#</a> <strong>Ruben</strong> on 4 Jul 2006 4:50 PM:</p><div style="margin-left: 1em">Yup, knew that.<br><br>Do you know whether those horrible line art .fon fonts from Windows 16 bits are still supported in the Vista era? (Roman and Modern they were called, I believe.)<br><br>And why bitmap font files are OEM code page based? (Read: worse than Type 1.) Simply legacy?<br><br>(Should probably have put this in the questions area.)</div>
<p><a id="669335" href="#669335">#</a> <strong>Ivan Petrov</strong> on 18 Jul 2006 2:22 AM:</p><div style="margin-left: 1em"><a rel="nofollow" target="_new" href="http://bink.nu/Article7771.bink">http://bink.nu/Article7771.bink</a><br><br>Regards,<br>Ivan.</div>
<p><a id="670881" href="#670881">#</a> <strong>legolas</strong> on 19 Jul 2006 7:23 AM:</p><div style="margin-left: 1em">Ruben, if OpenType/CFF lives, you still have a Type1 font (in CFF format) inside an Opentype wrapper. How is that better than just plain Type1 as far as encoding goes?<br><br>Oh and there are extensions to allow Type1 in CFF format to contain more than an 8 bit encoding... Although this involves using Adobes CID sets as an 'encoding'.<br><br>Michael: Hope to see the next installment of this series soon!</div>
<p><a id="762797" href="#762797">#</a> <strong>LostFont</strong> on 19 Sep 2006 7:17 PM:</p><div style="margin-left: 1em">Does Microsoft have a download for MS Windows core fonts (eg. Arial, Times New Roman) that support the MAC_CHARSET?<br><br>Our application uses a file-type converter that relies on the GDI library to parse content. &nbsp;Currently our server running Win2003 has tons of fonts that support numerous character sets, but not a single font that supports the MAC_CHARSET. &nbsp;We need to be able to support uploaded files from both Mac and Windows OS users.<br><br></div>
<p><a id="762988" href="#762988">#</a> <strong>Michael S. Kaplan</strong> on 19 Sep 2006 10:48 PM:</p><div style="margin-left: 1em">There are no downloads that I know of for core fonts that would be more recent than &nbsp;what the platform you are running has, no. Just make sure to keep both kinds of files in Unicode and everything will work.... :-)</div>
<p><a id="6143924" href="#6143924">#</a> <strong>Jan KuÄera</strong> on 12 Nov 2007 11:55 AM:</p><div style="margin-left: 1em"><p>Hi Michael, I'm going to take advantage of open comments today. :-) Great posts, indeed. &nbsp;What I would like to ask is, if the fonts do not have to be in the Fonts folder, where they could be? I mean, Would \\fontserver\ path work in the registry? Would http:// path work?</p>
<p>Is there any notificiation, that the registry font item failed to load?</p>
<p>Jan</p>
</div>
<p><a id="6147252" href="#6147252">#</a> <strong>Michael S. Kaplan</strong> on 12 Nov 2007 1:53 PM:</p><div style="margin-left: 1em"><p>These are bigger questions, probably better for a suggestion box item or two....</p>
</div>
<hr/><p><em>referenced by</em></p><div style="margin-left: 1em"><p>2008/10/09 <a href="http://archives.miloush.net/michkap/archive/2008/10/09/8992849.html">About the Fonts folder in Windows, Part 5 (Nothing personal!)</a></p><p>2008/03/21 <a href="http://archives.miloush.net/michkap/archive/2008/03/21/8328509.html">Did UnC "My name is URL" on TV the other day? Fontastic!</a></p><p>2007/11/06 <a href="http://archives.miloush.net/michkap/archive/2007/11/06/5928970.html">Like a mattress tag, the rule is DO NOT REMOVE</a></p><p>2007/09/25 <a href="http://archives.miloush.net/michkap/archive/2007/09/25/5111148.html">*Not* new in Vista SP1 -- the Add font dialog....</a></p><p>2007/05/26 <a href="http://archives.miloush.net/michkap/archive/2007/05/26/2909957.html">On installing fonts</a></p><p>2006/08/27 <a href="http://archives.miloush.net/michkap/archive/2006/08/27/726378.html">About the Fonts folder in Windows, Part 3 (aka What changes in Vista?)</a></p></div><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2006/07/02/654166.html" title="Support of &#39;Cross Language Support&#39;">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2006/07/02/654110.html" title="About the Fonts folder in Windows, Part 2 (aka Adding Fonts)">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2006-07">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2006-07-02">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2006/07/02/654110.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:39 GMT -->
</html>