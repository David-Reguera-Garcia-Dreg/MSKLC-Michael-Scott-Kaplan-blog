<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2006/07/02/654110.040100.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:39 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>About the Fonts folder in Windows, Part 2 (aka Adding Fonts)</title></head><body>
<h1>About the Fonts folder in Windows, Part 2 (aka Adding Fonts)</h1>
<p><em>by Michael S. Kaplan, published on 2006/07/02 04:01 +00:00, original URI: http://blogs.msdn.com/michkap/archive/2006/07/02/654110.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostGoogleFeed -->
<p><font face="Tahoma">You may have read the first post I wrote about this, titled <strong><a href="http://archives.miloush.net/michkap/archive/2006/06/25/646701.html">About the Fonts folder in Windows, Part 1 (aka What are we talking about?)</a></strong>. I won't say that it is all downhill from there, but this post is definitely going to see us spending a little time in the valley....</font></p>
<p><font face="Tahoma">You see, there is one thing about the Fonts folder that just about <strong>everyone</strong> can agree about -- the lovers of Microsoft, the haters of it, and everyone in between. </font></p>
<p><font face="Tahoma">And that is that they can't stand the UI for adding fonts.</font></p>
<p><font face="Tahoma">There are even <a href="http://www.microsoft.com/resources/documentation/windows/xp/all/proddocs/en-us/windows_fonts_addnew.mspx?mfr=true">instructions</a> for it, though those instructions do not include pictures (probably put together by someone who was embarrassed about the whole thing).</font></p>
<p><font face="Tahoma">Luckily the folks on the Typography team include <a href="http://www.microsoft.com/typography/TrueTypeInstallWin95.mspx">a little art</a> here. It is true that they haven&#39;t updated the instructions for the last few versions. But that is okay -- because the UI has not been updated either. :-)</font></p>
<p><font face="Tahoma">And if you want art, the folks at Adobe give instructions with art <a href="http://www.adobe.com/cfusion/knowledgebase/index.cfm?id=tn_3649">here</a> and <a href="http://www.adobe.com/cfusion/knowledgebase/index.cfm?id=tn_15817">here</a>, the first link having the extra info on using the Adobe Type Manager for all of those Type 1 fonts (ATM is not needed for the later versions).</font></p>
<p><font face="Tahoma">Most people I talk to never even knew this ridiculous dialog that looks like a reject they forgot to update from Windows 3.1 even existed; they simply open the Fonts folder and drag the font files to it. Most people don&#39;t even realize there is a right-click menu option for fonts to install them, either.</font></p>
<p><font face="Tahoma">And lots of other people put up sites explaining how much cooler all of this is on a Mac (like <a href="http://www.xvsxp.com/system/fonts_manage.php">this X vs. VP one</a>). I won't comment except to say that there are some times that Microsoft appears to be clueless about UI. And this is one of them.</font></p>
<p><font face="Tahoma">But the reason for the dialog existing was explained by the owner of it not too long ago:</font></p>
<blockquote dir="ltr" style="MARGIN-RIGHT:0px">
<blockquote dir="ltr" style="MARGIN-RIGHT:0px">
<p><font face="Tahoma" size="2">The current install font dialog presents a list of fonts that are present in a directory to install and it lists them by font name.  These come in roughly 3 categories:</font></p>
<ol>
<li><font face="Tahoma" size="2"><strong>individual fonts</strong> - truetype, opentype, raster - eg foo.ttf.  There is a 1-1 mapping of fonts to fonts that get displayed in the install font dialog.  The only way to get the name of the font is by opening the font file and reading the font name from it - the file names almost never contain a good enough name, and the file names aren&#39;t localized.</font> 
<li><font face="Tahoma" size="2"><strong>.inf installs</strong> - you can specify a catalog of fonts that span media in a .inf file.  There is a 1-many mapping of .inf files to available fonts to install, the only way to generate the list of fonts is to parse the .inf file.</font> 
<li><font face="Tahoma" size="2"><strong>Type 1 fonts, eg foo.pf*</strong> - There is a 2-1 mapping of font files to fonts, each type 1 font has 2 files (sometimes 3) associated with it, at a minimum a .pfb and .pfm file.</font></li></li></li></ol>
<p><font face="Tahoma" size="2">There isn&#39;t another dialog in the system that can take such a set of input and produce the proper list of items.  Many people say this should just use the common file open dialog, however unfortunately the requirements imposed by 1-3 above aren&#39;t supported in any way by the common dialogs, its a very unusual case.</font></p></blockquote></blockquote>
<p><font face="Tahoma">Now I am going to say that (<strong>speaking just for me and not at all for Microsoft or anyone who owns the dialog or the folder or even the functionality</strong>) that this explanation does not really ring true for me.</font></p>
<p><font face="Tahoma">I mean, a common file open dialog can handle both multiple file types (.INF, .TTF, .PFB, .PFM, etc.) and multiple files at the same time. If they don&#39;t select all the files that are needed for a Type 1 font then an error can be put up just like they selected a corrupted file or one that is already installed.</font></p>
<p><font face="Tahoma">Sure it&#39;s a complicated little bit of code, I won&#39;t argue about that. And a tester would probably find it to be a target rich environment when looking for bugs. But it isn&#39;t impossible; it&#39;s just intricate.</font></p>
<p><font face="Tahoma">So it seems like an update here ought to be possible. If that were the only reason, I mean.</font></p>
<p><font face="Tahoma">But in the end, I think the real story is a bit more involved -- one of those weird situations where the people who own the functionality (the font folks, the rendering folks, the other font folks) are not the owners of the UI. And they don&#39;t have the resources to take the ownership. And the folks who own it don&#39;t really have a ton of resources either, so this turns into one of those sacrificial features that can get cut each version (on one version because there is no time left and on the next because we already shipped it before, right?).</font></p>
<p><font face="Tahoma">When everything is said and done, the story here is not nearly as impressive as it probably ought to be. Or even as impressive as it could be. It really does scream for someone to take all that info I put in the first post about what is involved with the install and just putting something together, doesn't it? :-)</font></p>
<p><font face="Tahoma">The story continues, in both more impressive and less impressive ways. Stay tuned....</font></p>
<p><font face="Tahoma"></font> </p>
<p><font face="Tahoma" color="#ff1493"><em>This post brought to you by</em> <font size="8"><strong>Ｆ</strong></font><em>(<a href="http://www.fileformat.info/info/unicode/char/ff21">U+ff21</a>, a.k.a. FULLWIDTH LATIN CAPITAL LETTER F)</em></font></p>
<hr/><div style="margin-left: 1em"><em>comments not archived</em></div><hr/><p><em>referenced by</em></p><div style="margin-left: 1em"><p>2008/10/09 <a href="http://archives.miloush.net/michkap/archive/2008/10/09/8992849.html">About the Fonts folder in Windows, Part 5 (Nothing personal!)</a></p><p>2008/03/21 <a href="http://archives.miloush.net/michkap/archive/2008/03/21/8328509.html">Did UnC "My name is URL" on TV the other day? Fontastic!</a></p><p>2007/11/06 <a href="http://archives.miloush.net/michkap/archive/2007/11/06/5928970.html">Like a mattress tag, the rule is DO NOT REMOVE</a></p><p>2007/09/25 <a href="http://archives.miloush.net/michkap/archive/2007/09/25/5111148.html">*Not* new in Vista SP1 -- the Add font dialog....</a></p><p>2007/05/26 <a href="http://archives.miloush.net/michkap/archive/2007/05/26/2909957.html">On installing fonts</a></p><p>2006/08/27 <a href="http://archives.miloush.net/michkap/archive/2006/08/27/726378.html">About the Fonts folder in Windows, Part 3 (aka What changes in Vista?)</a></p></div><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2006/07/02/654110.html" title="About the Fonts folder in Windows, Part 2 (aka Adding Fonts)">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2006/07/01/653971.html" title="Just enough negation to fail to confuse">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2006-07">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2006-07-02">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2006/07/02/654110.040100.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:39 GMT -->
</html>