<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2006/07/20/671835.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:39 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>Return of the Unicode IME</title></head><body>
<h1>Return of the Unicode IME</h1>
<p><em>by Michael S. Kaplan, published on 2006/07/20 03:01 -04:00, original URI: http://blogs.msdn.com/b/michkap/archive/2006/07/20/671835.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<P><FONT face=Tahoma>I have previously (like in <STRONG><A href="http://archives.miloush.net/michkap/archive/2005/05/18/419117.html">Typing in random Unicode code points</A></STRONG>) talked about using the Unicode IME as a way to input random Unicode code points by their code point values. It was therefore something of a shock&nbsp;to me when Lionel Fourquaux mentioned a few months ago that: </FONT></P>
<BLOCKQUOTE dir=ltr style="MARGIN-RIGHT: 0px">
<BLOCKQUOTE dir=ltr style="MARGIN-RIGHT: 0px">
<P><FONT face="Times New Roman" size=2>I have been unable to find the Unicode IME in Vista (build 5308). Was it removed? If so, why? I'm missing it.</FONT></P></BLOCKQUOTE></BLOCKQUOTE>
<P><FONT face=Tahoma>I looked, and yes, this IME had been removed! :-(</FONT></P>
<P><FONT face=Tahoma>I talked to some of the folks on the Input Method Editor&nbsp;(IME) team and on the Text Services Framework (TSF) team, and the removal was intentional. There was a concerted effort to assist with maintainability of the IMEs to make sure that they were using TSF rather than the old IMM mechanisms, and since this IME was kind of built in to all of the other ones, there just wasn't a strong advantage to having a standalone one that did the same thing....</FONT></P>
<P><FONT face=Tahoma>And of course just having something mentioned here in this blog is not a compelling enough reason, either. :-(</FONT></P>
<P><FONT face=Tahoma>However, after working with some of the folks on the TSF team I have a beta version that may eventually be a great sample of a new type of TSF TIP that is entirely text based, which can be used to replace the Unicode IME. </FONT></P>
<P><FONT face=Tahoma>With the permission of that group, I am making this beta available to those who want to try it out. All you need to participate is a somewhat recent build of Vista and to be reader of this blog (how else will you know about it?).</FONT></P>
<P><FONT face=Tahoma>Don't forget&nbsp;the disclaimer text: "<FONT face="Times New Roman">Postings are provided <B>as is</B> with no warranties, and confer no rights.</FONT>" To that I would add the same text in Hebrew is something like "<SPAN lang=en-au><FONT face="Times New Roman">הודעה זו מסופקת "כפי שהיא" ללא כל אחריות או חיובים, ואינה נותנת לך זכויות כלשהן</FONT></SPAN>".</FONT></P>
<P><FONT face=Tahoma>For those of you who are using Vista who want to try it out, you can download the 1.6 mb text file <A href="http://trigeminal.com/samples/IME/TableTextServiceUnicode.txt">here</A> (or the 166 kb zipped version <A href="http://trigeminal.com/samples/IME/TableTextServiceUnicode.zip">here</A>!), then follow these instructions</FONT></P>
<P><FONT face=Tahoma>1) Copy the text file to <STRONG>\Program Files\Windows NT\TableTextService</STRONG> on your Vista machine (if the "Program Files" on your machine is another language, use that directory, do not create a new one!).</FONT></P>
<P><FONT face=Tahoma>2) Open an elevated command prompt and navigate to that directory.</FONT></P>
<P><FONT face=Tahoma>3) Run the following from that command prompt: </FONT></P>
<BLOCKQUOTE dir=ltr style="MARGIN-RIGHT: 0px">
<P><FONT face=Tahoma><STRONG>rundll32 TableTextService.dll RegisterProfile TableTextServiceUnicode.txt</STRONG></FONT></P></BLOCKQUOTE>
<P><FONT face=Tahoma>4) Say OK to the dialog that comes up verifying you want to install it:</FONT></P>
<P><IMG height=260 src="http://trigeminal.fmsinc.com/images/InstallUnicodeIMEVista4.jpg" width=380></P>
<P><FONT face=Tahoma>You can now add the <STRONG>Unicode IME</STRONG> to&nbsp;the Chinese (Taiwan) locale by going through the following steps that are illustrated here.</FONT></P>
<P><FONT face=Tahoma><IMG src="http://trigeminal.fmsinc.com/images/InstallUnicodeIMEVista1.jpg"></FONT></P>
<P><IMG src="http://trigeminal.fmsinc.com/images/InstallUnicodeIMEVista2.jpg"></P>
<P><IMG src="http://trigeminal.fmsinc.com/images/InstallUnicodeIMEVista3.jpg"></P>
<P><FONT face=Tahoma>And that is all you have to do. Now, when you type in an application like Notepad, you can switch to the IME and type in code point values like 00E5 or 0951 of whatever, and the character will be typed!</FONT></P>
<P><FONT face=Tahoma>Now even as a sample this <STRONG>is a work in progress</STRONG>, like for example I want to change some of the configuration settings so you can see the code point you are in the middle of typing.</FONT></P>
<P><FONT face=Tahoma>And I want it to be able to be available for other locales too, for obvious reasons.</FONT></P>
<P><FONT face=Tahoma>And this IME will not work in the console, sorry about that. I don't think that partiular limitation can be addressed, so pretend you never saw <STRONG><A href="http://archives.miloush.net/michkap/archive/2005/12/16/504511.html">this post</A></STRONG> before. :-)</FONT></P>
<P><FONT face=Tahoma>You get the idea -- it is a beta!</FONT></P>
<P><FONT face=Tahoma>There will be documentation on the format of the text file that will be available eventually, and I will probably blog about it a bit too in the future (plus maybe share some of my other samples, such as a Cantonese IME I have been working on).</FONT></P>
<P><FONT face=Tahoma>But if you are using a recent build of Vista and want to try out this sample, a meager attempt at a replacement version of the Unicode IME from prior versions, especially if you wanted to post feedback about it here.</FONT></P>
<P><FONT face=Tahoma>Enjoy!</FONT></P>
<hr/><p><a id="672440" href="#672440">#</a> <strong>dono</strong> on 20 Jul 2006 4:32 AM:</p><div style="margin-left: 1em">That's pretty cool.<br><br>I'm looking forward to a post about your Cantonese IME.<br>I'd like to design a special purpose IME sometime in the future.<br></div>
<p><a id="675031" href="#675031">#</a> <strong>Nick Lamb</strong> on 22 Jul 2006 2:50 PM:</p><div style="margin-left: 1em">Can users expect the final version to go beyond the BMP? Also it seems short-sighted to skip characters that are unused but might perhaps be allocated later. The principle of forwards compatibility seems to argue in favour of allowing these characters despite the modest increase in file size. It makes sense not to allow the user to enter U+FFFE since it does not and will never exist, but why not allow e.g. U+0620 which might some day get allocated ?</div>
<p><a id="675060" href="#675060">#</a> <strong>Michael S. Kaplan</strong> on 22 Jul 2006 3:20 PM:</p><div style="margin-left: 1em">Some excellent thoughts, Nick. In fact, you have inspired me to write a post about these issues, some of which may very well see themselves in the next release. :-) <br><br>Look for the post later today....</div>
<p><a id="758693" href="#758693">#</a> <strong>Omi</strong> on 17 Sep 2006 3:31 AM:</p><div style="margin-left: 1em">If it's just a test file that contains the mapping. Then I believe it's also possible to customize the mapping in the file, isn't it?<br><br>Is it legal?<br><br>Omi</div>
<p><a id="759088" href="#759088">#</a> <strong>Michael S. Kaplan</strong> on 17 Sep 2006 9:58 AM:</p><div style="margin-left: 1em">Well, to be honest I'd prefer if people held off on going that route until after the file format is better documented so they know what else they should change to allow for better interoperability (and to make sure that my version does not step on theirs and vice versa). <br><br>Not so much a legal issue as one of courtesy.... :-)</div>
<p><a id="759166" href="#759166">#</a> <strong>Omi</strong> on 17 Sep 2006 10:15 AM:</p><div style="margin-left: 1em">Is there any way to check this out under XP?</div>
<p><a id="759189" href="#759189">#</a> <strong>Michael S. Kaplan</strong> on 17 Sep 2006 10:31 AM:</p><div style="margin-left: 1em">No, there is not, as I have said before. These table driven Text Services Framework TIPs are an exciting Vista only feature at present, though one can make a good argument that investigating a possible downlevel use might make sense here. :-)</div>
<p><a id="760475" href="#760475">#</a> <strong>Omi</strong> on 18 Sep 2006 5:22 AM:</p><div style="margin-left: 1em">Can you please tell me how to get it under Vista RC-1 Build 5600? I went to put the TableTextServiceUnicode.txt file as above instructed, but it's already there. Now when I went to set this Unicode IME as my layout, it's not there (under regional and language options) So do you know any way?</div>
<p><a id="760615" href="#760615">#</a> <strong>Michael S. Kaplan</strong> on 18 Sep 2006 7:55 AM:</p><div style="margin-left: 1em">What do you mean it is already there? The file does not ship with Windows, so it would have to be something you placed with an earlier build. <br><br>Did you register it in the new build?</div>
<p><a id="760759" href="#760759">#</a> <strong>Omi</strong> on 18 Sep 2006 9:29 AM:</p><div style="margin-left: 1em">Already there means when I paste the txt file in the instructed folder, it asked me to replace existing one. My Vista is RC-1 x64 and it's a clean installation in a new HDD.<br><br>I didn't do anything else after that. Do you suggest to skip that step and follow the next steps or I should replace the file and follow all the steps?</div>
<p><a id="760792" href="#760792">#</a> <strong>Michael S. Kaplan</strong> on 18 Sep 2006 10:01 AM:</p><div style="margin-left: 1em">Microsoft Vista does not include a file called TableTextServiceUnicode.txt in any directory; if it is there, it is something you must have copied over at some point. <BR><BR>YES, register the file....</div>
<p><a id="761534" href="#761534">#</a> <strong>Omi</strong> on 19 Sep 2006 12:32 AM:</p><div style="margin-left: 1em">Is there any way to use this IME with other Languages?</div>
<p><a id="761558" href="#761558">#</a> <strong>Michael S. Kaplan</strong> on 19 Sep 2006 1:04 AM:</p><div style="margin-left: 1em">I guess that means it works? :-)<br><br>Not yet, but there will be in the updated version, coming out soon....</div>
<p><a id="799878" href="#799878">#</a> <strong>uccoffee</strong> on 7 Oct 2006 5:49 AM:</p><div style="margin-left: 1em">This doesnt work in VISTA RC2 ...</div>
<p><a id="800653" href="#800653">#</a> <strong>Michael S. Kaplan</strong> on 7 Oct 2006 11:23 AM:</p><div style="margin-left: 1em"><p>I will be posting updated files very very soon, hang in there!</p>
</div>
<p><a id="9132959" href="#9132959">#</a> <strong>Peter Gibbons</strong> on 22 Nov 2008 2:10 PM:</p><div style="margin-left: 1em"><p>In the next major service pack for Vista (Windows 7) it will again be included. This would also be a good step for the next minor one, SP2 ;-)</p></div>
<p><a id="9134694" href="#9134694">#</a> <strong>Michael S. Kaplan</strong> on 23 Nov 2008 12:30 PM:</p><div style="margin-left: 1em"><p>Are you asking or telling, Peter? :-)<br></p></div>
<p><a id="9135214" href="#9135214">#</a> <strong>Peter Gibbons</strong> on 23 Nov 2008 6:03 PM:</p><div style="margin-left: 1em"><p>Telling that it's in the 6801 Build and hoping it stays.</p>
<p>Having the charnames in the IME Pad tooltips or details list would be nice and also suggestion/autoselection of fonts that support a given character.</p></div>
<p><strong>brighthopes</strong> on 23 Dec 2009 1:59 AM:</p><div style="margin-left: 1em"><p>Wow, i'm so elated my feature is restored. Thank you so much. Now i don't have to make my eyes water staring through character lists.!!!</p></div>
<p><strong>Crowbar</strong> on 25 May 2012 8:29 PM:</p><div style="margin-left: 1em"><p>Thank you very much!!!</p>
<p>This is a good site!!</p>
</div>
<hr/><p><em>referenced by</em></p><div style="margin-left: 1em"><p>2008/06/26 <a href="http://archives.miloush.net/michkap/archive/2008/06/26/8654732.html">Using one Unicode input method at a time (Using the Unicode IME on XP)</a></p><p>2008/06/21 <a href="http://archives.miloush.net/michkap/archive/2008/06/21/8632391.html">Back to Sri Lanka (conceptually)</a></p><p>2008/01/21 <a href="http://archives.miloush.net/michkap/archive/2008/01/21/7178421.html">Behold the Table Driven Text Service, Part 0 (You have to start somewhere!)</a></p><p>2007/10/22 <a href="http://archives.miloush.net/michkap/archive/2007/10/22/5590751.html">We weren't Vista heroes, but I think we were kinda heroic</a></p><p>2006/09/17 <a href="http://archives.miloush.net/michkap/archive/2006/09/17/759687.html">And we are the knights who say நீ (NII)</a></p><p>2006/09/14 <a href="http://archives.miloush.net/michkap/archive/2006/09/14/754162.html">Why doesn't MSKLC have a numeric keypad?</a></p><p>2006/08/18 <a href="http://archives.miloush.net/michkap/archive/2006/08/18/706063.html">Creation of transliterating input methods</a></p><p>2006/07/27 <a href="http://archives.miloush.net/michkap/archive/2006/07/27/679538.html">The Cantonese IME (not for input of characters from Canton, Ohio)</a></p><p>2006/07/22 <a href="http://archives.miloush.net/michkap/archive/2006/07/22/675085.html">Behind the return of the Unicode IME</a></p></div><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2006/07/20/672931.html" title="MSDN Blogs has achieved Kieranosity">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2006/07/19/670674.html" title="Your data will be released, unharmed">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2006-07">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2006-07-20">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2006/07/20/671835.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:39 GMT -->
</html>