<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2006/06/11/626100.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:39 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>Why the Windows Shell can't provide the ultimate font solution for everyone (or even anyone!)</title></head><body>
<h1>Why the Windows Shell can't provide the ultimate font solution for everyone (or even anyone!)</h1>
<p><em>by Michael S. Kaplan, published on 2006/06/11 05:45 -04:00, original URI: http://blogs.msdn.com/b/michkap/archive/2006/06/11/626100.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<P><FONT face=Tahoma>A few days ago when I put up the post <STRONG><A href="http://archives.miloush.net/michkap/archive/2006/06/06/618628.html">Is this the Über-font post? No, but it is the teaser for it!</A></STRONG>, I did sort of promise that I'd deliver on a post explaining about the issues related to fonts on Windows that plague so many application developers, whether they are working&nbsp;on the Windows team, inside of Microsoft, or in the wider world....</FONT></P>
<P><FONT face=Tahoma>Well, today is the first part of that!</FONT></P>
<P><FONT face=Tahoma>To start with, I'll say that <A href="http://archives.miloush.net/michkap/archive/2006/04/28/585735.html"><STRONG>DEFAULT_GUI_FONT</STRONG></A>, <STRONG><A href="http://archives.miloush.net/michkap/archive/2006/03/18/554308.html">MS Shell Dlg</A></STRONG>, and <STRONG><A href="http://archives.miloush.net/michkap/archive/2006/03/18/554308.html">MS Shell Dlg 2</A></STRONG> have one elemental goal in common -- at various times in the life of Windows they were implemented to help give a consistent look and feel to Windows applications running in the Windows Shell.</FONT></P>
<P><FONT face=Tahoma>Now the Windows Shell has some pretty specific, historical&nbsp;characteristics that are relevant here -- like the fact that pretty much all of the UI in Windows (prior to <A href="http://archives.miloush.net/michkap/archive/2005/02/10/370460.html"><STRONG>LIPs</STRONG></A> at least!) would be in a single language. And with a single language kind of makes sense to be trying to use a single font, right? This whole functionality can be thought of as being user interface language based.</FONT></P>
<P><FONT face=Tahoma>Okay, so this functionality is potentially very useful for stuff in the Windows Shell, from control panel applets to the Start menu and so on. But applications like Media Player, MS Office applications, Visual Studio, or other apps inside of Microsoft tend to follow their own look and feel. Which means that in many cases none of those "Shell" fonts are the best choice for these other applications (especially if the list of UI languages they support is different, since it means there is a real possibility that the languages being covered may not be compatible.</FONT></P>
<P><FONT face=Tahoma>What is worse, everything outside of Microsoft has the same issues, but even more so -- because with the possible exception of Shell add-ins, they are even less likely to have a need or even a desire to have a completely consistent language, look and feel with Windows.</FONT></P>
<P><FONT face=Tahoma>The other problem that came up over time is that no one wanted to modify these fonts or their definitions over time, and between versions. Because there would be subtle differences in the metrics when comparing <STRONG><FONT face="Microsoft Sans Serif" size=4>Microsoft Sans Serif</FONT></STRONG> to <FONT face=Tahoma size=4><STRONG>Tahoma</STRONG></FONT> to <FONT face="Segoe UI" size=4><STRONG>Segoe UI</STRONG></FONT> to <STRONG><FONT face="MS Sans Serif" size=4>MS Sans Serif</FONT></STRONG> and so on. And that means that if you change the definition of the undrlying font technology used by the Shell that dialogs might start clipping text or looking inorrect.</FONT></P>
<P><FONT face=Tahoma>Which sort of explains why there is no brand new <STRONG><FONT face="Segoe UI">MS Shell Dlg 3</FONT></STRONG> that would support the new <STRONG><FONT face="Segoe UI">Segoe UI</FONT></STRONG>. Because after multiple versions of realizing how bad it would be,&nbsp;it has been, and it is to change the definitions of these built-in special fonts, and since the hit to developers of changing to use a different special font for each platform version is roughly equivalent to them having to change to a normal font for each platform version, there really is very little point to having a new <STRONG><FONT face="Segoe UI">MS Shell Dlg #</FONT></STRONG> in each new version of Windows that is unknown to prior versions.</FONT></P>
<P><FONT face=Tahoma>Especially when applications whose font changes yet no UI review is done may look really awful in the untested font.</FONT></P>
<P><FONT face=Tahoma>In practice, this affects not only the external customer applications and not only the non-Windows apps in Microsoft, but even applications in Windows do not tend to update their fonts universally to the new version. Which is the main reason that <A href="http://chris.pirillo.com/">Chris Pirillo</A> can find so much inconsistent font usage in posts of his&nbsp;like <A href="http://chris.pirillo.com/2006/05/24/windows-vista-feedback/">Windows Vista Feedback</A>. I know some may consider it nitpicky, but I think Chris has provided the ultimate proof that the current scheme does not even handle the limited scenario of the consistent UI in the Windows Shell all that effectively. So how could it ever hope to help everyone else?</FONT></P>
<P><FONT face=Tahoma>Now while the Shell folks were working on providing a way for Windows Shell applications (which as the above indicates has many flaws, by the way!), the folks in Microsoft Typography and on the GDI/Uniscribe text services teams were working hard to solve a very different problem -- how to make sure that whatever font was chosen for controls, that text would be displayable.</FONT></P>
<P><FONT face=Tahoma>Such a functionality could not be tied to only the UI language; it would need to be able to support languages/scripts outside the narrow scope of the UI language if Windows language support was going to be truly international. Though of course there are problems with these solutions as well, which will be the subject of a future post....</FONT></P>
<P><FONT face=Tahoma></FONT>&nbsp;</P>
<P><FONT face=Tahoma color=#ff1493><EM>This post brought to you by</EM> <FONT face="Microsoft Himalaya" size=6>༃</FONT> <EM>(U+0f03, a.k.a. TIBETAN MARK GTER&nbsp;YIG MGO -UM TSHEG MA)</EM></FONT></P>
<hr/><p><a id="627954" href="#627954">#</a> <strong>Adam</strong> on 12 Jun 2006 6:08 AM:</p><div style="margin-left: 1em">&quot;But applications like Media Player, MS Office applications, Visual Studio, or other apps inside of Microsoft tend to follow their own look and feel.&quot;<br><br>Why? If I want my UI to use MS Comic Sans all over, applications should respect that. What's the point in having a customisable UI if no-one's going to respect the settings? Very few applications should be picking specific fonts at all, and all that do should *only* be doing so in their client areas (e.g. Word picking document fonts, Explorer picking document fonts, etc...)<br><br>&quot;What is worse, everything outside of Microsoft has the same issues, but even more so [...]&quot;<br><br>So? Lead by example. Oh, wait a minute - that would require MS to follow their own UI guidelines and not reinvent their own menu bars, etc..., for each application first.<br><br>&quot;The [problem] is that no one wanted to modify these fonts [because] there would be subtle differences in the metrics when comparing [them]. [If] you change the [underlying font then] dialogs might start clipping text or looking inorrect. [...] The folks in Microsoft Typography and on the GDI/Uniscribe text services teams [are working hard] to make sure that whatever font was chosen for controls, that text would be displayable.&quot;<br><br>Right. And how is that not entirely due to Windows' pixel-based layout engine?<br><br>I'll agree that all the problems you've mentioned are very visibly triggered by changing fonts/text/sizes as part of the l10n process, but I don't see how that can be considered the _cause_. If controls dynamically changed their size based on their content (including fonts) then none of these problems would exist.<br><br>I'm looking forward to the next post in this series though...</div>
<p><a id="628275" href="#628275">#</a> <strong>Michael S. Kaplan</strong> on 12 Jun 2006 11:35 AM:</p><div style="margin-left: 1em">Hi Adam --<br><br>Applications are not always about taking on the user's 'skin' preferences. If you do not like their look, then you don't have to use that application. But it isn ot a requirement that people follow those settings.<br><br>We will have to agree to disagree on the other issue, as what you claim is not entirely true (the Windows dialog unit scheme is not a completely pixel-based layout, and it is not always reasonable to assume applications want to be as dynamic a you imply).<br><br>But I will be covering these issues soon. These first two posts are explaining why certain &quot;solutions&quot; are not the answer. Stay tuned. :-)</div>
<p><a id="628492" href="#628492">#</a> <strong>Mike</strong> on 12 Jun 2006 2:46 PM:</p><div style="margin-left: 1em">I think part of the problem is that pure win32 has no layout controls and therefore it's really difficult to make a UI that dynamically adjusts itself based on window size, font, etc.</div>
<p><a id="628962" href="#628962">#</a> <strong>Dean Harding</strong> on 12 Jun 2006 9:31 PM:</p><div style="margin-left: 1em">The problem with automatically resizing controls is that you can't get it to be &quot;pixel perfect&quot; - it's always just going to be a sort of &quot;approximately right&quot; (except when displayed with exactly the same settings as the original designer, hopefully).<br><br>Which may or may not be better than having text clipped or not sized properly, depending on the situation.<br><br>But do believe that it is the way to go. Especially in these days of high-resolution displays. The chances that a dialog will be displayed at exactly the same size as the original designer's is getting smaller anyway (for example, you might design your application at 96 DPI but display it on a 144 DPI display). While it may be practical to review/re-layout your dialogs for each supported OS version (and possibly also for each OS version + language supported, but even then you're moving into the realms of you-must-be-a-large-company-with-lots-of-designers-to-be-able-to-write-good-looking-apps) but it's impossible to expect anyone to review their dialog layouts on all OS versions, all languages AND all possible DPI-settings (simply because there's an infinite number of DPI settings).<br><br>So if you need some sort of dynamic resizing for high-DPI displays, then it seems to make sense to extend that for different fonts as well.<br><br>Which is why I'm welcoming Avalon/WPF. I don't know if it handles resizing based on what font is being used (though I hope it does) it certainly automatically handles the high-DPI issue well.</div>
<p><a id="629083" href="#629083">#</a> <strong>Michael S. Kaplan</strong> on 13 Jun 2006 12:23 AM:</p><div style="margin-left: 1em">As much as I appreciate everyone's efforts to continue &nbsp;to steer things off topic, I would love it if (at this point) everyone thinking about layout controls could simply bite their tongue for the moment. It will be much easier to steer through this complex topic if we can keep the issues of each topic where they belong so we can focus things a bit..... <BR><BR>This post and the one that followed it are about the attempts at "Shell" font solutions and why they do not work. <BR><BR>In future posts I will be talking about the solutions in GDI and Uniscribe. <BR><BR>And then I will talk about Avalon (WPF) and composite fonts -- both the good and the bad. At that point I will talk about some of the general features and also some of problems with other solutions involving dynamic layouts.... <BR><BR>This would be a great point to bring up the great feelings everyone has about this type of solution &nbsp;-- rather than spreading their (obviously) strong feelings haphazardly across other posts that are not about dynamic layouts. :-)</div>
<p><a id="629245" href="#629245">#</a> <strong>Adam</strong> on 13 Jun 2006 4:29 AM:</p><div style="margin-left: 1em">:)<br><br>Sorry for seeming like I'm trying to drag it off-topic. That wasn't my intention, so I'll wait patiently for the next post in the series.</div>
<p><a id="637557" href="#637557">#</a> <strong>Jerry Pisk</strong> on 19 Jun 2006 6:30 PM:</p><div style="margin-left: 1em">So basically if my application is required to support all Windows version out there I must use one of the fonts avilable with Windows 95 (Microsoft Sans Serif most likely). If I want my application to fit in Vista I have two options:<br><br>1. Create multiple versions of my resources, one for each versions of Windows, with that version's fonts (Microsoft Sans Serif, Tahoma, Segoe UI) and then load thr appropriate one. This would get harder if my application creates fonts of the fly (not that it should).<br><br>2. Tell all my users to upgrade to Vista or replace me.<br><br>Am I missing something here? Maybe we should all just follow what Microsoft is doing with their applications and completely disregard all UI recomendations and just develop our own UI. I mean, Office has been doing it ever since I have been using Office. Why does Windows even have UI API? Not even Microsoft is using it.</div>
<p><a id="637587" href="#637587">#</a> <strong>Michael S. Kaplan</strong> on 19 Jun 2006 6:52 PM:</p><div style="margin-left: 1em">Hi Jerry -- <br><br>It really is a problem, one that (if there were a setting that was documeneted as changing with each version) you would have to test in each version to avoid clipping, each time. Since no one likes that idea, moving to a new font has to be a conscious choice that does involve reviewing the results -- or it has to be an explicit decision to pick the font you want....</div>
<p><a id="641504" href="#641504">#</a> <strong>Jerry Pisk</strong> on 21 Jun 2006 11:14 AM:</p><div style="margin-left: 1em">I do agree with the set of problems that shell font substitution comes with. What I was wondering is how do you actually write an application that follows the look of the platform it runs on. Looks to me that creating separate resources for each known platform seems to be the only option. And at that point it's probably just easier to do what Office has been doing - ignore the platform's look and feel and use your own. Which makes a mockery of Microsoft's published UI guidelines (not necessarily a bad thing).</div>
<p><a id="641651" href="#641651">#</a> <strong>Michael S. Kaplan</strong> on 21 Jun 2006 11:58 AM:</p><div style="margin-left: 1em">Hi Jerry,<br><br>Well, given the vast number of differences even within what the Shell has in fonts that are used, I'd say that particular variability is not unreasonable -- just pick the piece of the platfrom you like the look of asnd go with that font. :-)<br><br>But this does not mean that all of the guidelines are unreasonable....</div>
<p><a id="6803896" href="#6803896">#</a> <strong>darkan9el</strong> on 19 Dec 2007 2:55 AM:</p><div style="margin-left: 1em"><p>So can the system font or Office 2007 font be changed and if so how?</p></div>
<hr/><p><em>referenced by</em></p><div style="margin-left: 1em"><p>2008/08/16 <a href="http://archives.miloush.net/michkap/archive/2008/08/16/8871262.html">Optimus: from science fiction to fiction to frustration to geek porn, in just 24 months</a></p><p>2007/02/05 <a href="http://archives.miloush.net/michkap/archive/2007/02/05/1606112.html">The myth of consistent user interfaces</a></p><p>2006/08/06 <a href="http://archives.miloush.net/michkap/archive/2006/08/06/690214.html">You say ĭtalics, I say ītalics. It is much more complicated in Cyrillic....</a></p><p>2006/06/16 <a href="http://archives.miloush.net/michkap/archive/2006/06/16/634124.html">Neither GDI nor Uniscribe solve the ultimate font problem completely, either</a></p><p>2006/06/12 <a href="http://archives.miloush.net/michkap/archive/2006/06/12/627185.html">More problems with the Shell's 'ultimate font' solutions</a></p></div><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2006/06/11/626293.html" title="Online persona and navel gazing">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2006/06/10/625998.html" title="Cut off from society?">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2006-06">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2006-06-11">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2006/06/11/626100.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:39 GMT -->
</html>