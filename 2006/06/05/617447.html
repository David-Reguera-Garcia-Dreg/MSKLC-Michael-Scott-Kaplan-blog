<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2006/06/05/617447.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:39 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>More on case insensitivity and its intuitivality</title></head><body>
<h1>More on case insensitivity and its intuitivality</h1>
<p><em>by Michael S. Kaplan, published on 2006/06/05 03:01 -04:00, original URI: http://blogs.msdn.com/b/michkap/archive/2006/06/05/617447.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<P><FONT face=Tahoma>Yesterday in '<STRONG><A HREF="http://archives.miloush.net/michkap/archive/2006/06/04/616904.html">Intuitivosity (intuitivality?) of case insensitivity</A></STRONG>' I talked a little a bit about some of the limitations in the Mac OS-X implementation of case insensitivity.</FONT></P>
<P><FONT face=Tahoma>I realized I needed to actually point out a little more information here to paint the full picture....</FONT></P>
<P><FONT face=Tahoma>On the surface this would suggest that Apple's OS only handles the casing of ASCII letters, but that would be misleading due to several related facts:</FONT></P>
<UL>
<LI><FONT face=Tahoma>They support Unicode names (cf: <A href="http://developer.apple.com/technotes/tn2002/tn2078.html">Apple TN2078</A>)</FONT></LI>
<LI><FONT face=Tahoma>Those names are stored in Unicode Normalization form D (cf: UAX #15: <A href="http://www.unicode.org/reports/tr15/">Unicode Normalization Forms</A>&nbsp;and <A href="http://developer.apple.com/technotes/tn2002/tn2078.html">Apple TN2078</A>)</FONT></LI>
<LI><FONT face=Tahoma>They claim to sometimes support case insensitivity, but not always (cf: <A href="http://developer.apple.com/documentation/MacOSX/Conceptual/BPFileSystem/Articles/FileSystemGuidelines.html">File System Guidelines</A>)</FONT></LI></UL>
<P><FONT face=Tahoma>Now I do not have a Mac or anything, but assuming the first two points are 100% true and third point is just a little misleading based on the the stuff Geoff noted that I talked about yesterday (i.e. the case insensitivity is incomplete rather than supported fully by some file systems/not at all by others).....</FONT></P>
<P><FONT face=Tahoma>#1&nbsp;The OS X&nbsp;file system is potentially much cooler than NTFS on Windows since it does Unicode normalization.</FONT></P>
<P><FONT face=Tahoma>#2 The OS X file system is potentially much lamer than NTFS on Windows if the only case insensivity is ASCII A-Z ~ a-z.</FONT></P>
<P><FONT face=Tahoma>#3 The OS X file system potentially mitigates Point #2 above for the Latin script since it fully decomposes everything and the "cased" portion of every Latin script letter is handled in a much smaller table than Windows has to cover the same area.</FONT></P>
<P><FONT face=Tahoma>#4 NTFS on Windows has&nbsp;a&nbsp;slightly higher maintainable burden since it has all of the characters in its casing tables since it would have to potentially update its tables more often to handle new Unicode characters that are added.</FONT></P>
<P><FONT face=Tahoma>#5 NTFS on Windows sees an effective mitigation in the fact that Unicode no longer adds precomposed character that can be decomposed into already existing sequences that are canonically equivalent, meaning this advantage would not apply to future versions.</FONT></P>
<P><FONT face=Tahoma>#6 If the OS X casing truly only handles ASCII A-Z then there is actually 3.6 buttloads of characters that it is not properly handling across other cased scripts from Cyrillic to Greek to Coptic to Armenian to Georgian. <EM><FONT color=#ff0000>Note: since I honestly do not know if this is the case, I hesistate to say whether Apple is lame on this point or not -- they may be just fine. <STRONG>Does anyone know?</STRONG></FONT></EM></FONT></P>
<P><FONT face=Tahoma>#7 NTFS on Windows is technically not case insensitive at its lowest levels, so in theory it has the same problem Geoff noted with some of the tools that are available on the Mac. The difference is that architecturally there is no way to get at this mode from within Win32, so Windows has a more complete wrapper that avoids the inconsistency that can be seen on Apple's platform....</FONT></P>
<P><FONT face=Tahoma>Ok, those are all the useful conclusions I was able to think of at the moment. :-)</FONT></P>
<P><FONT face=Tahoma></FONT>&nbsp;</P>
<P><FONT face=Tahoma color=#ff1493><EM>This post brought to you by</EM> <FONT size=6><STRONG>Ə</STRONG></FONT> <EM>and</EM> <FONT size=6><STRONG>ə</STRONG></FONT> <EM>(<A href="http://www.fileformat.info/info/unicode/char/018f">U+018f</A> and <A href="http://www.fileformat.info/info/unicode/char/0259">U+0259</A>, a.k.a. LATIN CAPITAL LETTER SCHWA and&nbsp;LATIN SMALL LETTER SCHWA)</EM></FONT></P>
<hr/><p><a id="617746" href="#617746">#</a> <strong>Rosyna</strong> on 5 Jun 2006 3:57 AM:</p><div style="margin-left: 1em">FWIW, I just tried named two files Ə and ə. OS X correctly gave me the error that &quot;ə&quot; was already taken. I'm note sure if you've had a chance to look at <a rel="nofollow" target="_new" href="http://developer.apple.com/technotes/tn/tn1150.html">http://developer.apple.com/technotes/tn/tn1150.html</a> but it is very informative (all about the HFS Plus format, the default format for OS X formatted volumes, and the only truly supported boot volume format (UFS is somewhat supported, with severe limitations).<br><br>I also tried РОССИЙСКОГО and российского and I correctly got the error about the file name being taken.<br><br>I don't have an Armenian or Greogian font to test this because I have no way to tell if the uppercase conversion is working.</div>
<p><a id="617747" href="#617747">#</a> <strong>Gabe</strong> on 5 Jun 2006 3:58 AM:</p><div style="margin-left: 1em">To address these points,<br><br>1. I don't know that storing filenames normalized is such a good idea. In the case of Form D, as used by HFS+, you're liable to make strings longer. This means that a filename you think is valid may be invalid because it turns out to be too long when normalized. It could also cause a problem of not getting back the same filename you saved, possibly causing you to not recognize what you just wrote. I would argue that normalization should be considered when doing comparisons (i.e. does the file already exist?), but not necessarily stored.<br><br>6. Judging by the algorithm presented at <a rel="nofollow" target="_new" href="http://developer.apple.com/technotes/tn/tn1150.html#StringComparisonAlgorithm">http://developer.apple.com/technotes/tn/tn1150.html#StringComparisonAlgorithm</a> it appears as though Apple has realized that cases exist outside ASCII.<br><br>7. The case-sensitive nature of filesystems such as NTFS is certainly available from Win32. If you look up CreateFile, you'll see the flag FILE_FLAG_POSIX_SEMANTICS has the following meaning: &quot;Indicates that the file is to be accessed according to POSIX rules. This includes allowing multiple files with names, differing only in case, for file systems that support such naming. Use care when using this option because files created with this flag may not be accessible by applications written for MS-DOS or 16-bit Windows.&quot;</div>
<p><a id="617883" href="#617883">#</a> <strong>Michael S. Kaplan</strong> on 5 Jun 2006 9:13 AM:</p><div style="margin-left: 1em">Hi Rosyna -- that is why I did not start slamming on them, since I suspected they might handle more than ASCII. :-)<br><br>Hi Gabe -- available, yes. But not from a mixed bag of tools where some work and some do not....</div>
<p><a id="617919" href="#617919">#</a> <strong>Kevin D. White</strong> on 5 Jun 2006 10:35 AM:</p><div style="margin-left: 1em">Hey - check your posting format. Google Reader is displaying some of the markup from your posts. I'm seeing things like:<br><br>PFONT face=TahomaYesterday in 'STRONGA HREF=&quot;/michkap/archive/2006/06/04/616904.aspx&quot;<br><br>The formatting for your posts is completely lost. All I see is a single line of wrapped text.</div>
<p><a id="617924" href="#617924">#</a> <strong>Michael S. Kaplan</strong> on 5 Jun 2006 10:39 AM:</p><div style="margin-left: 1em">Hi Kevin -- Sounds like a bug in Google Reader -- the formatting works well in FeedDemon and in Internet Explorer....</div>
<p><a id="617925" href="#617925">#</a> <strong>KJK::Hyperion</strong> on 5 Jun 2006 10:41 AM:</p><div style="margin-left: 1em">To everyone: case insensitivity is now (IIRC as of Windows XP SP2, possibly earlier) enforced by default, not just for files but for all named objects, regardless of subsystem and flags passed. It was a security issue. When case sensitivity was a settable flag, it was a bit too easy to hijack object names by exploiting the (undocumented) order in which names only differing in case were searched</div>
<p><a id="617935" href="#617935">#</a> <strong>Michael S. Kaplan</strong> on 5 Jun 2006 10:50 AM:</p><div style="margin-left: 1em">Hi KJK::Hyperion -- it was only ever CreateFile that allowed you to do it through Win32, the rest of the namespace has been case insensitive all along....</div>
<p><a id="617977" href="#617977">#</a> <strong>Lowell</strong> on 5 Jun 2006 11:52 AM:</p><div style="margin-left: 1em">I tried a few more experiments in HFS+, and concur that it does indeed recognize case outside ASCII. &nbsp;I tried several examples from the Latin Extended unicode block, and HFS+ consistently normalized the characters and was appropriately case-insensitive. &nbsp;(My testing was on OS version 10.3.9.)</div>
<p><a id="618146" href="#618146">#</a> <strong>Rosyna</strong> on 5 Jun 2006 3:38 PM:</p><div style="margin-left: 1em">Gabe, the round trip issues seems to have been specifically handled by Apple. IE, there's a huge table (<a rel="nofollow" target="_new" href="http://developer.apple.com/technotes/tn/tn1150table.html">http://developer.apple.com/technotes/tn/tn1150table.html</a>) that shows suggested sequences and whatnot. Some ranges in unicode were also changed in how they are stored in HFS+ to closer match HFS encodings (and to survive round trips). But remember, these technotes are mostly for people developing tools that work directly with the FS like Disk repair utilities or drivers for other platforms.</div>
<p><a id="620187" href="#620187">#</a> <strong>Gabe</strong> on 6 Jun 2006 10:55 PM:</p><div style="margin-left: 1em">Yes, Rosyna, I see they addressed the round trip issue, but I didn't see anything that actually explained how. For example, let's say you have the filename u+00E9. It will be stored decomposed as u+0065 u+0301. When you go to read the filename back in, it will be different.<br><br>Of course they may automatically recompose the filename back into u+00E9, but then you would get back the wrong thing if you wrote the filename decomposed in the first place.</div>
<p><strong>xSmurf</strong> on 20 Apr 2008 10:30 AM:</p><div style="margin-left: 1em"><p>Well, it does work with actual accents... Using true HFSX:</p>
<p><a rel="nofollow" target="_new" href="http://img230.imageshack.us/img230/1387/picture1dm1.png">http://img230.imageshack.us/img230/1387/picture1dm1.png</a></p>
<p>I've tried a couple of French accents also and it worked just fine.</p></div>
<hr/><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2006/06/05/617896.html" title="Is SQL Server really supporting UTF-16?">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2006/06/04/616904.html" title="Intuitivosity (intuitivality?) of case insensitivity">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2006-06">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2006-06-05">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2006/06/05/617447.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:39 GMT -->
</html>