<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2006/06/27/648723.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:39 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>MSKLC under Vista (or MSKLC under .NET 2.0)</title></head><body>
<h1>MSKLC under Vista (or MSKLC under .NET 2.0)</h1>
<p><em>by Michael S. Kaplan, published on 2006/06/27 11:02 -07:00, original URI: http://blogs.msdn.com/michkap/archive/2006/06/27/648723.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostOld -->
<P><FONT face=Tahoma>Earlier today when I talked about <STRONG><A href="http://archives.miloush.net/michkap/archive/2006/06/27/648618.html">Keyboards under LUA</A></STRONG>, i was very focused on installing the keyboard layouts that <A href="http://www.microsoft.com/globaldev/tools/msklc.mspx">MSKLC</A> creates under Vista.</FONT></P>
<P><FONT face=Tahoma>And I did talk a bit about what might be a Vista bug.</FONT></P>
<P><FONT face=Tahoma>But I didn't talk at all about <A href="http://www.microsoft.com/globaldev/tools/msklc.mspx">Microsoft Keyboard Layout Creator</A> itself. And it too has a bug that affects Vista most prominently (but can affect earlier versions of Windows, too).</FONT></P>
<P><FONT face=Tahoma>Let's say that you go to the <A href="http://go.microsoft.com/fwlink/?LinkId=17223">MSKLC download page</A> and download MSKLC.EXE. When you run the program, it pops up a nice dialog that clearly suggests wht you might want to do:</FONT></P>
<P><FONT face=Tahoma><IMG src="http://trigeminal.fmsinc.com/images/msklclua6.jpg"></FONT></P>
<P><FONT face=Tahoma>Unfortunately, if you hit the <STRONG><U>S</U>etup</STRONG> button, you will then get another dialog:</FONT></P>
<P><FONT face=Tahoma><IMG src="http://trigeminal.fmsinc.com/images/msklclua7.jpg"></FONT></P>
<P><FONT face=Tahoma>Huh? Doesn't Vista include the .NET Framework? What the hell is this dialog talking about, anyway?</FONT></P>
<P><FONT face=Tahoma>The problem here, which is actually a bug in the MSKLC setup, is that it is looking for the 1.0 or 1.1 version of the .NET Framework specifically. It is not thinking that the 2.0 version is the right one.</FONT></P>
<P><FONT face=Tahoma>In my defense, I was using the built-in stuff in Visual Studio setup projects to build the dependency. Maybe I forgot a setting or something. :-)</FONT></P>
<P><FONT face=Tahoma>In any case, if you click <STRONG>Yes</STRONG> on that dialog, you will be taken to the <A href="http://msdn.microsoft.com/netframework/downloads/updates/default.aspx">SDKs, Redistributables, &amp; Service Packs</A> page of the .NET Framework Developer Center. This too is all of the built in stuff from Visual Studio setups, which I have to admit is fairly cool.</FONT></P>
<P><FONT face=Tahoma>Unfortunately, that link contains only 2.0 versions of the .NET Framework for download. And if that were good enough, then you wouldn't have had the problem in the first place!</FONT></P>
<P><FONT face=Tahoma>Many people actually try installing that 2.0 downloiad, only to be told that it is already installed. And now they are really confused....</FONT></P>
<P><FONT face=Tahoma>(By the way, that seems like a bug in the page content to me; if Visual Studio 2003's setup projects create links to a&nbsp;download page, then that page ought to at least have a link to that version's .NET Framework!)</FONT></P>
<P><FONT face=Tahoma>In any case, the original page that comes up after you download MSKLC includes a <STRONG>What Others are Downloading</STRONG> list. Today that list looks like:</FONT></P>
<BLOCKQUOTE dir=ltr style="MARGIN-RIGHT: 0px">
<BLOCKQUOTE>
<P><FONT face=Tahoma>Others who downloaded <B>Microsoft Keyboard Layout Creator (MSKLC) Version 1.3.4073</B> also downloaded: </P>
<OL>
<LI><A href="http://www.microsoft.com/downloads/info.aspx?na=47&amp;p=1&amp;SrcDisplayLang=en&amp;SrcCategoryId=&amp;SrcFamilyId=FB7B3DCD-D4C1-4943-9C74-D8DF57EF19D7&amp;u=details.aspx%3ffamilyid%3d0856EACB-4362-4B0D-8EDD-AAB15C5E04F5%26displaylang%3den">Microsoft .NET Framework Version 2.0 Redistributable Package (x86)</A> 
<LI><A href="http://www.microsoft.com/downloads/info.aspx?na=47&amp;p=2&amp;SrcDisplayLang=en&amp;SrcCategoryId=&amp;SrcFamilyId=FB7B3DCD-D4C1-4943-9C74-D8DF57EF19D7&amp;u=details.aspx%3ffamilyid%3d262D25E3-F589-4842-8157-034D1E7CF3A3%26displaylang%3den">Microsoft .NET Framework Version 1.1 Redistributable Package</A> 
<LI><A href="http://www.microsoft.com/downloads/info.aspx?na=47&amp;p=3&amp;SrcDisplayLang=en&amp;SrcCategoryId=&amp;SrcFamilyId=FB7B3DCD-D4C1-4943-9C74-D8DF57EF19D7&amp;u=details.aspx%3ffamilyid%3d8F0A8DF6-4A21-4B43-BF53-14332EF092C9%26displaylang%3den">MDAC Utility: Component Checker</A><A href="http://www.microsoft.com/downloads/info.aspx?na=67&amp;p=&amp;SrcDisplayLang=en&amp;SrcCategoryId=&amp;SrcFamilyId=FB7B3DCD-D4C1-4943-9C74-D8DF57EF19D7&amp;u=%2fgenuine%2fdownloads%2fWhyValidate.aspx%3fFamilyID%3d8F0A8DF6-4A21-4B43-BF53-14332EF092C9%26displaylang%3den"><IMG title="This download is available to users running genuine Microsoft products. Click the icon for more information." style="POSITION: relative; TOP: 2px" alt="" hspace=4 src="http://img.microsoft.com/downloads/img/gaicon.gif" border=0 valign="absmiddle"></A> 
<LI><A href="http://www.microsoft.com/downloads/info.aspx?na=47&amp;p=4&amp;SrcDisplayLang=en&amp;SrcCategoryId=&amp;SrcFamilyId=FB7B3DCD-D4C1-4943-9C74-D8DF57EF19D7&amp;u=details.aspx%3ffamilyid%3dA8F5654F-088E-40B2-BBDB-A83353618B38%26displaylang%3den">Microsoft .NET Framework 1.1 Service Pack 1</A> 
<LI><A href="http://www.microsoft.com/downloads/info.aspx?na=47&amp;p=5&amp;SrcDisplayLang=en&amp;SrcCategoryId=&amp;SrcFamilyId=FB7B3DCD-D4C1-4943-9C74-D8DF57EF19D7&amp;u=details.aspx%3ffamilyid%3dFF98F35A-1FA6-4D71-A3F6-0BF37B212FBD%26displaylang%3den">IntelliType Pro 5.5 Keyboard Software for Windows</A></LI></OL></BLOCKQUOTE></BLOCKQUOTE></FONT>
<P><FONT face=Tahoma>Note item #2 on that list (the fact that it is #2 is because of that bug in the redist page content I mentioned above) and the fact that even if the 1.1 download were on the page there is no clear indication that it is what you need.</FONT></P>
<P><FONT face=Tahoma>Hopefully this blog post will help turn it around a little bit? :-)</FONT></P>
<P><FONT face=Tahoma>Interestingly enough, after you install the 1.1 .NET Framework and install MSKLC, you can go to <FONT color=#808080><STRIKE>Add or Remove Programs</STRIKE></FONT>Programs and Features in the Control Panel and uninstall the 1.1 .NET Framework. But Microsoft Keyboard Layout Creator will still run just fine. It is just a silly, setup-time restriction that has nothing to do with the actual functionality of MSKLC....</FONT></P>
<P><FONT face=Tahoma></FONT>&nbsp;</P>
<P><FONT face=Tahoma color=#ff1493><EM>This post brought to you by</EM> <STRONG><FONT size=8>à·›</FONT> </STRONG><EM>(<A href="http://www.fileformat.info/info/unicode/char/0dd8">U+0dd8</A>, a.k.a. SINHALA VOWEL SIGN KOMBU DEKA)</EM></FONT></P>
<hr/><p><a id="648734" href="#648734">#</a> <strong>Heath Stewart</strong> on Tuesday, June 27, 2006 2:14 PM:</p><div style="margin-left: 1em">The MSI doesn't require .NET - your bootstrap does. Likely in Visual Studio you checked .NET as a prerequisite. If you delete the [FXSection] from setup.ini it won't check for .NET. You must also be using a pre-release version since the &quot;supported&quot; Framework 2.0.31113 isn't valid, and is less than 2.0.50727 - the RTM runtime version for .NET 2.0.<br><br>The MSI still will do a runtime version check for .NET but since you don't seem to be using it, the check won't cause a problem. VSI (Visual Studio Installer project) injects that no matter what.</div>
<p><a id="648878" href="#648878">#</a> <strong>Rosyna</strong> on Tuesday, June 27, 2006 3:45 PM:</p><div style="margin-left: 1em">Why is this a Yes/No dialog? It's not asking a question so why is there a choice...?<br><br>You need to install .NET 1.1. Yes/No.</div>
<p><a id="648882" href="#648882">#</a> <strong>Michael S. Kaplan</strong> on Tuesday, June 27, 2006 3:48 PM:</p><div style="margin-left: 1em">Hi Rosyna, <br><br>I won't disagree, but it isn't my dialog. :-)</div>
<p><a id="648885" href="#648885">#</a> <strong>Michael S. Kaplan</strong> on Tuesday, June 27, 2006 3:49 PM:</p><div style="margin-left: 1em">Hi Heath, <br><br>Hmmmm... I (or someone) will have to look into this one a bit further.</div>
<p><a id="8355239" href="#8355239">#</a> <strong>Mihnea Docea</strong> on Thursday, April 03, 2008 7:12 PM:</p><div style="margin-left: 1em"><p>Thnx a million man. Tried everything installing .net 3.5 still no go.</p>
<p>Did a little research and found this awesome tutorial. </p>
<p>Great help thank you much.</p>
<p>You've got an entry in my blogroll now.</p></div>
<hr/><p><em>referenced by</em></p><div style="margin-left: 1em"><p>2007/01/30 <a href="http://archives.miloush.net/michkap/archive/2007/01/30/1557184.html">Not the coolest, but</a></p><p>2006/12/22 <a href="http://archives.miloush.net/michkap/archive/2006/12/22/1349745.html">Thumb twiddling?</a></p><p>2006/11/17 <a href="http://archives.miloush.net/michkap/archive/2006/11/17/1097666.html">What happened on Thursday morning?</a></p><p>2006/10/05 <a href="http://archives.miloush.net/michkap/archive/2006/10/05/792859.html">Why Michael's cool keyboard doesn't work</a></p><p>2006/09/13 <a href="http://archives.miloush.net/michkap/archive/2006/09/13/752086.html">MSKLC and Vista? MSKLC and 64-bit? Darn, we're 0 for 2....</a></p></div><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2006/06/28/648940.html" title="Every character has a story #21: U+0f77 U+0f79 (TIBETAN VOWEL SIGN VOCALIC [RR|LL])">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2006/06/27/648618.html" title="Keyboards under LUA">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2006-06">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2006-06-27">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2006/06/27/648723.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:39 GMT -->
</html>